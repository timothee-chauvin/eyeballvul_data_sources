{
  "id": "CVE-2023-28431",
  "details": "Frontier is an Ethereum compatibility layer for Substrate. Frontier's `modexp` precompile uses `num-bigint` crate under the hood. In the implementation prior to pull request 1017, the cases for modulus being even and modulus being odd are treated separately. Odd modulus uses the fast Montgomery multiplication, and even modulus uses the slow plain power algorithm. This gas cost discrepancy was not accounted for in the `modexp` precompile, leading to possible denial of service attacks.\n\nNo fixes for `num-bigint` are currently available, and thus this issue is fixed in the short term by raising the gas costs for even modulus, and in the long term fixing it in `num-bigint` or switching to another modexp implementation. The short-term fix for Frontier is deployed at pull request 1017. There are no known workarounds aside from applying the fix.",
  "aliases": [
    "GHSA-fcmm-54jp-7vf6"
  ],
  "modified": "2023-11-29T10:03:28.466893Z",
  "published": "2023-03-22T21:15:18Z",
  "withdrawn": "2024-05-15T05:32:53.745539Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/paritytech/frontier/security/advisories/GHSA-fcmm-54jp-7vf6"
    },
    {
      "type": "FIX",
      "url": "https://github.com/paritytech/frontier/commit/5af12e94d7dfc8a0208a290643a800f55de7b219"
    },
    {
      "type": "FIX",
      "url": "https://github.com/paritytech/frontier/pull/1017"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rust-num/num-bigint/blob/6f2b8e0fc218dbd0f49bebb8db2d1a771fe6bafa/src/biguint/power.rs#L134"
    }
  ],
  "affected": [
    {
      "ranges": [
        {
          "type": "GIT",
          "repo": "https://github.com/paritytech/frontier",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5af12e94d7dfc8a0208a290643a800f55de7b219"
            }
          ]
        }
      ],
      "versions": [
        "fc-consensus-v1.0.0",
        "fc-consensus-v2.0.0",
        "fc-db-v1.0.0",
        "fc-mapping-sync-v1.0.0",
        "fc-rpc-core-v1.0.0",
        "fc-rpc-v1.0.0",
        "fp-consensus-v1.0.0",
        "fp-evm-v1.0.0",
        "fp-evm-v2.0.0",
        "fp-rpc-v1.0.0",
        "fp-rpc-v2.0.0",
        "fp-rpc-v2.1.0",
        "fp-storage-v1.0.0",
        "fp-storage-v1.0.1",
        "fp-storage-v2.0.0",
        "pallet-dynamic-fee-v1.0.0",
        "pallet-dynamic-fee-v2.0.0",
        "pallet-dynamic-fee-v3.0.0",
        "pallet-ethereum-v1.0.0",
        "pallet-ethereum-v2.0.0",
        "pallet-ethereum-v3.0.0",
        "pallet-evm-precompile-blake2-v1.0.0",
        "pallet-evm-precompile-bn128-v1.0.0",
        "pallet-evm-precompile-dispatch-v1.0.0",
        "pallet-evm-precompile-ed25519-v1.0.0",
        "pallet-evm-precompile-modexp-v1.0.0",
        "pallet-evm-precompile-sha3fips-v1.0.0",
        "pallet-evm-precompile-simple-v1.0.0",
        "pallet-evm-v3.0.0",
        "pallet-evm-v4.0.0",
        "pallet-evm-v5.0.0"
      ],
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-28431.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  ]
}