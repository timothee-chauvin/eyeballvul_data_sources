{"schema_version":"1.7.3","id":"CVE-2024-52299","published":"2024-11-13T15:29:07Z","modified":"2025-10-22T18:45:07.365367Z","aliases":["GHSA-522m-m242-jr9p"],"summary":"The PDF viewer macro allows accessing any attachment without access right checks","details":"macro-pdfviewer is a PDF Viewer Macro for XWiki using Mozilla pdf.js. Any user with view right on XWiki.PDFViewerService can access any attachment stored in the wiki as the \"key\" that is passed to prevent this is computed incorrectly, calling skip on the digest stream doesn't update the digest. This is fixed in 2.5.6.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/xwikisas/macro-pdfviewer","events":[{"introduced":"468d3efe0b26e0e8d590dd07b57c1384ce45a853"},{"fixed":"8b5e3f4e44d9d0fe2447358fe4d1b706b7101633"}]}],"versions":["macro-pdfviewer-1.7","macro-pdfviewer-1.8","macro-pdfviewer-1.8.1","macro-pdfviewer-1.8.2","macro-pdfviewer-1.8.3","macro-pdfviewer-1.9","macro-pdfviewer-1.9.1","macro-pdfviewer-1.9.2","macro-pdfviewer-1.9.3","macro-pdfviewer-1.9.4","macro-pdfviewer-2.0","macro-pdfviewer-2.0.1","macro-pdfviewer-2.0.2","macro-pdfviewer-2.0.3","macro-pdfviewer-2.1","macro-pdfviewer-2.1.1","macro-pdfviewer-2.2","macro-pdfviewer-2.2-RC-1","macro-pdfviewer-2.2.1","macro-pdfviewer-2.3","macro-pdfviewer-2.3.1","macro-pdfviewer-2.3.2","macro-pdfviewer-2.3.3","macro-pdfviewer-2.4","macro-pdfviewer-2.5","macro-pdfviewer-2.5.1","macro-pdfviewer-2.5.2","macro-pdfviewer-2.5.3","macro-pdfviewer-2.5.4","macro-pdfviewer-2.5.5","xwiki-macro-pdfviewer-1.6.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-52299.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/xwikisas/macro-pdfviewer/security/advisories/GHSA-522m-m242-jr9p"}],"database_specific":{"cwe_ids":["CWE-340"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"}]}