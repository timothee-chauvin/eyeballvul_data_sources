{"schema_version":"1.7.3","id":"CVE-2021-30159","published":"2021-04-09T07:15:16.277Z","modified":"2025-11-20T11:43:50.483209Z","aliases":["BIT-mediawiki-2021-30159"],"related":["MGASA-2021-0218"],"details":"An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through 1.35.x before 1.35.2. Users can bypass intended restrictions on deleting pages in certain \"fast double move\" situations. MovePage::isValidMoveTarget() uses FOR UPDATE, but it's only called if Title::getArticleID() returns non-zero with no special flags. Next, MovePage::moveToInternal() will delete the page if getArticleID(READ_LATEST) is non-zero. Therefore, if the page is missing in the replica DB, isValidMove() will return true, and then moveToInternal() will unconditionally delete the page if it can be found in the master.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/wikimedia/mediawiki","events":[{"introduced":"0"},{"fixed":"ef13e11da4bcab62a8cc6f5459cd094e6881f326"}]}],"versions":["1.1.0","1.3.0beta1","1.31.0","1.31.0-rc.0","1.31.0-rc.1","1.31.0-rc.2","1.31.1","1.31.10","1.31.11","1.31.2","1.31.3","1.31.4","1.31.5","1.31.6","1.31.7","1.31.8","1.31.9","1.5.0alpha1","1.5.0alpha2","1.5.0beta1","1.5.0beta2","1.5.0beta3","1.5.0beta4","1.6.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-30159.json"}}],"references":[{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/26UJGHF7LJDOCQN6A3Z4PM7PYRKENJHE/"},{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2OMSV7B2TCFBOCICN3B4SMQP5HVRJQIT/"},{"type":"ADVISORY","url":"https://lists.debian.org/debian-lts-announce/2021/05/msg00003.html"},{"type":"ARTICLE","url":"https://lists.debian.org/debian-lts-announce/2021/05/msg00006.html"},{"type":"EVIDENCE","url":"https://phabricator.wikimedia.org/T272386"},{"type":"ADVISORY","url":"https://security.gentoo.org/glsa/202107-40"},{"type":"ADVISORY","url":"https://www.debian.org/security/2021/dsa-4889"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"}]}