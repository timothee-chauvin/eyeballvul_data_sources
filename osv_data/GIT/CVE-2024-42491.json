{"schema_version":"1.7.3","id":"CVE-2024-42491","published":"2024-09-05T17:17:56.961Z","modified":"2025-12-05T05:58:56.512587Z","aliases":["GHSA-v428-g3cw-7hv9"],"summary":"A malformed Contact or Record-Route URI in an incoming SIP request can cause Asterisk to crash when res_resolver_unbound is used","details":"Asterisk is an open-source private branch exchange (PBX). Prior to versions 18.24.3, 20.9.3, and 21.4.3 of Asterisk and versions 18.9-cert12 and 20.7-cert2 of certified-asterisk, if Asterisk attempts to send a SIP request to a URI whose host portion starts with `.1` or `[.1]`, and res_resolver_unbound is loaded, Asterisk will crash with a SEGV. To receive a patch, users should upgrade to one of the following versions: 18.24.3, 20.9.3, 21.4.3, certified-18.9-cert12, certified-20.7-cert2. Two workarounds are available. Disable res_resolver_unbound by setting `noload = res_resolver_unbound.so` in modules.conf, or set `rewrite_contact = yes` on all PJSIP endpoints. NOTE: This may not be appropriate for all Asterisk configurations.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"0"},{"fixed":"f8dddb0e3d8baa3e0649f0e878305f3f810016ac"},{"fixed":"d03864911eeba347b4378fbade5e1aa3bc697855"}],"database_specific":{"versions":[{"introduced":"0"},{"fixed":"18.24.3"},{"fixed":"18.9-cert12"}]}},{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"de4f63b4824c91a0cd9f3d95f3b7923bec71960c"},{"fixed":"c5e30b7e157b67ec6dba64d3b1a3a3cac907e524"},{"fixed":"4ca53af6d3313f23a1755298e5de7600b8435ae7"}],"database_specific":{"versions":[{"introduced":"19.0.0"},{"fixed":"20.9.3"},{"introduced":"19.0"},{"fixed":"20.7-cert2"}]}},{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"12da95e53ff42287ad69d6d5922e06c3d62010ac"},{"fixed":"489a05f269e005242027ab47d37fb6b6a1651989"}],"database_specific":{"versions":[{"introduced":"21.0.0"},{"fixed":"21.4.3"}]}}],"versions":["18.17.0","18.17.0-rc1","18.17.1","18.18.0","18.18.0-rc1","18.18.1","18.19.0","18.19.0-rc1","18.19.0-rc2","18.20.0","18.20.0-rc1","18.20.1","18.20.2","18.21.0","18.21.0-rc1","18.21.0-rc2","18.22.0","18.22.0-rc1","18.22.0-rc2","18.23.0","18.23.0-rc1","18.23.1","18.24.0","18.24.0-rc1","18.24.1","18.24.2","18.9.0","18.9.0-rc1","21.0.0","21.0.1","21.0.2","21.1.0","21.1.0-rc1","21.1.0-rc2","21.2.0","21.2.0-rc1","21.2.0-rc2","21.3.0","21.3.0-rc1","21.3.1","21.4.0","21.4.0-rc1","21.4.1","21.4.2","certified-18.9-cert10","certified-18.9-cert11","certified-18.9-cert4","certified-18.9-cert5","certified-18.9-cert6","certified-18.9-cert7","certified-18.9-cert8","certified-18.9-cert8-rc1","certified-18.9-cert8-rc2","certified-18.9-cert9","certified/18.9-cert1","certified/18.9-cert1-rc1","certified/18.9-cert2","certified/18.9-cert3","certified/18.9-cert4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42491.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2024/42xxx/CVE-2024-42491.json"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/42a2f4ccfa2c7062a15063e765916b3332e34cc4"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/4f01669c7c41c9184f3cce9a3cf1b2ebf6201742"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/50bf8d4d3064930d28ecf1ce3397b14574d514d2"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/7a0090325bfa9d778a39ae5f7d0a98109e4651c8"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/a15050650abf09c10a3c135fab148220cd41d3a0"},{"type":"ADVISORY","url":"https://github.com/asterisk/asterisk/security/advisories/GHSA-v428-g3cw-7hv9"},{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2024/10/msg00016.html"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2024-42491"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-252","CWE-476"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2024/42xxx/CVE-2024-42491.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H"}]}