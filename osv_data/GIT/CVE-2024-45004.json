{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-45004.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "68308234175516306646578375970814537689",
              "length": 747.0
            },
            "id": "CVE-2024-45004-07f0e601",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9e3b266afcfe4294e84496f50f006f029d3100db",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "trusted_dcp_seal"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "311427081740771020361875640430165496499",
                "99767184064476983537324434645696427142",
                "123211021360557341494652693352852187428",
                "173197387887389913725605443945398415320",
                "111535969572485856044665523074514480118",
                "245850986961885477962576934795144891707",
                "212951869408215143258942879642447384528",
                "196769076788977696779191376140767136231",
                "43103244271727635351686410349335013720",
                "275328451835976214701171198713738537849",
                "169042356888468167712545561064636922149",
                "328227130720661104244168640822064397818",
                "43507420470253347951665001315225819547",
                "98775344677274990204144460513416937859",
                "270873107861885737039894012102987365433",
                "218728775608135805452285454913241453657",
                "45854026418779177188145122125801377250",
                "52845576884277566900672045152395559700",
                "8942036452975565876236025446717254605",
                "44328865709801198663454466334196396279",
                "69923197647840037013609878153650180232",
                "319283735525959406826737783963891298594",
                "265949902477340072308307086838612169678",
                "299289068959794639087124059492076387336",
                "315586476255375498478333040410227537497",
                "295300365289357325594854597494037816282",
                "270767965658769395766412776000735395507",
                "273200244720181979398471964981180195181",
                "212504095492930799719186671414246321389",
                "230759735217648347512070679786851941885",
                "201971092730623092024441495110871027436",
                "304970793048810862315404089323387742576",
                "30421163766590163673237476639894925307",
                "189178794373715573692330615507505999304",
                "139802886123480453263012157001152942552",
                "160523077067056588530585030511388292146",
                "203502579203937978063411786621564110831",
                "331210186689313813308102957524079606699",
                "46977340184281674035377764510739688675",
                "311908180110160200823505772590686326978",
                "180858077588594556465898768960701591855",
                "206259710527606138132920154649641098583",
                "305997105370478123980996202307938404235",
                "116993624057910754454977625843606635238",
                "218591441835189060663402407567519994581",
                "513533647408936440951738497601570959",
                "244882995642179752327631015677720389575",
                "286105230608621228077618474420898683780",
                "92566196538511762258373113719214893295",
                "307294300716269148056959248860923353567",
                "106939787112725368108807400665031018550",
                "34634234026097502892212571698404254287"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-45004-1a53619c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "311427081740771020361875640430165496499",
                "99767184064476983537324434645696427142",
                "123211021360557341494652693352852187428",
                "173197387887389913725605443945398415320",
                "111535969572485856044665523074514480118",
                "245850986961885477962576934795144891707",
                "212951869408215143258942879642447384528",
                "196769076788977696779191376140767136231",
                "43103244271727635351686410349335013720",
                "275328451835976214701171198713738537849",
                "169042356888468167712545561064636922149",
                "328227130720661104244168640822064397818",
                "43507420470253347951665001315225819547",
                "98775344677274990204144460513416937859",
                "270873107861885737039894012102987365433",
                "218728775608135805452285454913241453657",
                "45854026418779177188145122125801377250",
                "52845576884277566900672045152395559700",
                "8942036452975565876236025446717254605",
                "44328865709801198663454466334196396279",
                "69923197647840037013609878153650180232",
                "319283735525959406826737783963891298594",
                "265949902477340072308307086838612169678",
                "299289068959794639087124059492076387336",
                "315586476255375498478333040410227537497",
                "295300365289357325594854597494037816282",
                "270767965658769395766412776000735395507",
                "273200244720181979398471964981180195181",
                "212504095492930799719186671414246321389",
                "230759735217648347512070679786851941885",
                "201971092730623092024441495110871027436",
                "304970793048810862315404089323387742576",
                "30421163766590163673237476639894925307",
                "189178794373715573692330615507505999304",
                "139802886123480453263012157001152942552",
                "160523077067056588530585030511388292146",
                "203502579203937978063411786621564110831",
                "331210186689313813308102957524079606699",
                "46977340184281674035377764510739688675",
                "311908180110160200823505772590686326978",
                "180858077588594556465898768960701591855",
                "206259710527606138132920154649641098583",
                "305997105370478123980996202307938404235",
                "116993624057910754454977625843606635238",
                "218591441835189060663402407567519994581",
                "513533647408936440951738497601570959",
                "244882995642179752327631015677720389575",
                "286105230608621228077618474420898683780",
                "92566196538511762258373113719214893295",
                "307294300716269148056959248860923353567",
                "106939787112725368108807400665031018550",
                "34634234026097502892212571698404254287"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-45004-47f4e6e5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9e3b266afcfe4294e84496f50f006f029d3100db",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "175051075041115876062388906190561339035",
              "length": 87.0
            },
            "id": "CVE-2024-45004-4eb2cb4b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9e3b266afcfe4294e84496f50f006f029d3100db",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "decrypt_blob_key"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "68308234175516306646578375970814537689",
              "length": 747.0
            },
            "id": "CVE-2024-45004-788b57e6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "trusted_dcp_seal"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "175051075041115876062388906190561339035",
              "length": 87.0
            },
            "id": "CVE-2024-45004-b3ed44fd",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "decrypt_blob_key"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "103510873438902758614977642237152235766",
              "length": 86.0
            },
            "id": "CVE-2024-45004-d7b7cdd6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9e3b266afcfe4294e84496f50f006f029d3100db",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "encrypt_blob_key"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "103510873438902758614977642237152235766",
              "length": 86.0
            },
            "id": "CVE-2024-45004-e2eff4f9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "encrypt_blob_key"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "260306225174574157158275024671667903139",
              "length": 894.0
            },
            "id": "CVE-2024-45004-f1fc4399",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "trusted_dcp_unseal"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "260306225174574157158275024671667903139",
              "length": 894.0
            },
            "id": "CVE-2024-45004-f4cb2a3b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9e3b266afcfe4294e84496f50f006f029d3100db",
            "target": {
              "file": "security/keys/trusted-keys/trusted_dcp.c",
              "function": "trusted_dcp_unseal"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "2e8a0f40a39cc253002f21c54e1b5b995e5ec510"
            },
            {
              "fixed": "9e3b266afcfe4294e84496f50f006f029d3100db"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "2e8a0f40a39cc253002f21c54e1b5b995e5ec510"
            },
            {
              "fixed": "0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.10.1",
        "v6.10.2",
        "v6.10.3",
        "v6.10.4",
        "v6.10.5",
        "v6.10.6",
        "v6.11-rc1",
        "v6.11-rc2",
        "v6.11-rc3",
        "v6.9"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-45004.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.10.0"
            },
            {
              "fixed": "6.10.7"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nKEYS: trusted: dcp: fix leak of blob encryption key\n\nTrusted keys unseal the key blob on load, but keep the sealed payload in\nthe blob field so that every subsequent read (export) will simply\nconvert this field to hex and send it to userspace.\n\nWith DCP-based trusted keys, we decrypt the blob encryption key (BEK)\nin the Kernel due hardware limitations and then decrypt the blob payload.\nBEK decryption is done in-place which means that the trusted key blob\nfield is modified and it consequently holds the BEK in plain text.\nEvery subsequent read of that key thus send the plain text BEK instead\nof the encrypted BEK to userspace.\n\nThis issue only occurs when importing a trusted DCP-based key and\nthen exporting it again. This should rarely happen as the common use cases\nare to either create a new trusted key and export it, or import a key\nblob and then just use it without exporting it again.\n\nFix this by performing BEK decryption and encryption in a dedicated\nbuffer. Further always wipe the plain text BEK buffer to prevent leaking\nthe key via uninitialized memory.",
  "id": "CVE-2024-45004",
  "modified": "2025-10-15T13:52:43.309981Z",
  "published": "2024-09-04T19:54:46Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9e3b266afcfe4294e84496f50f006f029d3100db"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "KEYS: trusted: dcp: fix leak of blob encryption key"
}