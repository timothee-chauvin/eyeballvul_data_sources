{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27304.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:11",
        "name": "golang-github-jackc-pgx",
        "purl": "pkg:deb/debian/golang-github-jackc-pgx?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "3.6.2-2",
        "4.15.0-1",
        "4.15.0-2",
        "4.15.0-3",
        "4.15.0-4",
        "4.18.1-1",
        "4.18.1-2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27304.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "golang-github-jackc-pgx",
        "purl": "pkg:deb/debian/golang-github-jackc-pgx?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "4.15.0-4",
        "4.18.1-1",
        "4.18.1-2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27304.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "golang-github-jackc-pgx",
        "purl": "pkg:deb/debian/golang-github-jackc-pgx?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "4.18.1-2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27304.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "945c2126f6db8f3bea7eeebe307c01fe92bca007"
            }
          ],
          "repo": "https://github.com/jackc/pgproto3",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "adbb38f298c76e283ffc7c7a3f571036fea47fd4"
            },
            {
              "fixed": "c543134753a0c5d22881c12404025724cb05ffd8"
            },
            {
              "fixed": "f94eb0e2f96782042c96801b5ac448f44f0a81df"
            }
          ],
          "repo": "https://github.com/jackc/pgx",
          "type": "GIT"
        }
      ],
      "versions": [
        "v1.0.0",
        "v1.1.0",
        "v2.0.0",
        "v2.0.0-alpha1",
        "v2.0.0-rc1",
        "v2.0.0-rc2",
        "v2.0.0-rc3",
        "v2.0.1",
        "v2.0.2",
        "v2.0.3",
        "v2.0.4",
        "v2.0.5",
        "v2.0.6",
        "v2.0.7",
        "v2.1.0",
        "v2.1.1",
        "v2.10.0",
        "v2.11.0",
        "v2.2.0",
        "v2.3.0",
        "v2.3.1",
        "v2.3.2",
        "v2.4.0",
        "v2.5.0",
        "v2.6.0",
        "v2.7.0",
        "v2.7.1",
        "v2.8.0",
        "v2.8.1",
        "v2.9.0",
        "v3.0.0",
        "v3.0.1",
        "v3.1.0",
        "v3.2.0",
        "v3.3.0",
        "v3.4.0",
        "v3.5.0",
        "v3.6.0",
        "v4.0.0",
        "v4.0.0-pre1",
        "v4.0.0-pre2",
        "v4.0.0-rc1",
        "v4.0.0-rc2",
        "v4.0.1",
        "v4.1.0",
        "v4.1.1",
        "v4.1.2",
        "v4.10.0",
        "v4.10.1",
        "v4.11.0",
        "v4.12.0",
        "v4.13.0",
        "v4.14.0",
        "v4.14.1",
        "v4.15.0",
        "v4.16.0",
        "v4.16.1",
        "v4.17.0",
        "v4.17.1",
        "v4.17.2",
        "v4.18.0",
        "v4.18.1",
        "v4.2.0",
        "v4.2.1",
        "v4.3.0",
        "v4.4.0",
        "v4.4.1",
        "v4.5.0",
        "v4.6.0",
        "v4.7.0",
        "v4.7.1",
        "v4.7.2",
        "v4.8.0",
        "v4.8.1",
        "v4.9.0",
        "v4.9.1",
        "v4.9.2",
        "v5.0.0",
        "v5.0.0-alpha.1",
        "v5.0.0-alpha.2",
        "v5.0.0-alpha.3",
        "v5.0.0-alpha.4",
        "v5.0.0-alpha.5",
        "v5.0.0-beta.1",
        "v5.0.0-beta.2",
        "v5.0.0-beta.3",
        "v5.0.0-beta.4",
        "v5.0.0-beta.5",
        "v5.0.1",
        "v5.0.2",
        "v5.0.3",
        "v5.0.4",
        "v5.1.0",
        "v5.1.1",
        "v5.2.0",
        "v5.3.0",
        "v5.3.1",
        "v5.4.0",
        "v5.4.1",
        "v5.4.2",
        "v5.4.3",
        "v5.5.0",
        "v5.5.1",
        "v5.5.2",
        "v5.5.3"
      ]
    }
  ],
  "aliases": [
    "CGA-rqqc-qwmr-qw72",
    "CGA-vmcg-54pm-cp7r",
    "GHSA-7jwh-3vrq-q3m8",
    "GHSA-mrww-27vc-gghv",
    "GO-2024-2606"
  ],
  "details": "pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control. The problem is resolved in v4.18.2 and v5.5.4. As a workaround, reject user input large enough to cause a single query or bind message to exceed 4 GB in size.",
  "id": "CVE-2024-27304",
  "modified": "2025-07-29T11:08:38.504339Z",
  "published": "2024-03-06T19:15:08Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8"
    },
    {
      "type": "ADVISORY",
      "url": "https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv"
    },
    {
      "type": "FIX",
      "url": "https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007"
    },
    {
      "type": "FIX",
      "url": "https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4"
    },
    {
      "type": "FIX",
      "url": "https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8"
    },
    {
      "type": "FIX",
      "url": "https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df"
    },
    {
      "type": "WEB",
      "url": "https://www.youtube.com/watch?v=Tfg1B8u1yvE"
    },
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2024-27304"
    }
  ],
  "related": [
    "CGA-496j-hq3q-g45c",
    "CGA-4hmc-wmfh-336v",
    "CGA-4jh3-23m4-8qxw",
    "CGA-4pf6-2r5m-jg84",
    "CGA-58x4-6pgc-mhxm",
    "CGA-6g9m-8268-h48w",
    "CGA-6m4m-677g-f3j4",
    "CGA-7wqj-fcvq-3g57",
    "CGA-8953-rp52-8xp5",
    "CGA-8hh7-4fgg-pjjg",
    "CGA-8hhm-2gj2-7frv",
    "CGA-8mrm-h5j2-wc3c",
    "CGA-8rhc-266p-3322",
    "CGA-975f-x654-5m52",
    "CGA-gfg8-q382-vxm2",
    "CGA-j8f9-v8xw-8p2v",
    "CGA-jm3p-w9q5-5wj3",
    "CGA-jm5f-hqm2-2pp9",
    "CGA-jqg9-q52j-xxqw",
    "CGA-m8pc-889r-jgcp",
    "CGA-p6wm-rhwf-ffhv",
    "CGA-p8fq-jpp9-hrv2",
    "CGA-pf5w-9mcq-4p9c",
    "CGA-pmm8-vv22-28g3",
    "CGA-ppxp-7x4f-jrj7",
    "CGA-qhmq-mvx6-h978",
    "CGA-v2cx-4q52-cqx9",
    "CGA-vjmx-qw83-7m7r",
    "CGA-wjrf-22hm-6qx8",
    "CGA-wrr7-hg7p-5m8c",
    "CGA-x6g9-7234-gh2m",
    "CGA-xrhq-f288-6rq9",
    "CGA-xvpj-wwc8-c4r5",
    "GHSA-7jwh-3vrq-q3m8",
    "GHSA-mrww-27vc-gghv"
  ],
  "schema_version": "1.7.0"
}