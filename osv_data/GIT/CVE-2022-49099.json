{"schema_version":"1.7.3","id":"CVE-2022-49099","published":"2025-02-26T01:54:50Z","modified":"2025-10-21T08:50:01.919855Z","related":["SUSE-SU-2025:1027-1","SUSE-SU-2025:1176-1","SUSE-SU-2025:1183-1","SUSE-SU-2025:1241-1"],"summary":"Drivers: hv: vmbus: Fix initialization of device object in vmbus_device_register()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nDrivers: hv: vmbus: Fix initialization of device object in vmbus_device_register()\n\nInitialize the device's dma_{mask,parms} pointers and the device's\ndma_mask value before invoking device_register().  Address the\nfollowing trace with 5.17-rc7:\n\n[   49.646839] WARNING: CPU: 0 PID: 189 at include/linux/dma-mapping.h:543\n\tnetvsc_probe+0x37a/0x3a0 [hv_netvsc]\n[   49.646928] Call Trace:\n[   49.646930]  <TASK>\n[   49.646935]  vmbus_probe+0x40/0x60 [hv_vmbus]\n[   49.646942]  really_probe+0x1ce/0x3b0\n[   49.646948]  __driver_probe_device+0x109/0x180\n[   49.646952]  driver_probe_device+0x23/0xa0\n[   49.646955]  __device_attach_driver+0x76/0xe0\n[   49.646958]  ? driver_allows_async_probing+0x50/0x50\n[   49.646961]  bus_for_each_drv+0x84/0xd0\n[   49.646964]  __device_attach+0xed/0x170\n[   49.646967]  device_initial_probe+0x13/0x20\n[   49.646970]  bus_probe_device+0x8f/0xa0\n[   49.646973]  device_add+0x41a/0x8e0\n[   49.646975]  ? hrtimer_init+0x28/0x80\n[   49.646981]  device_register+0x1b/0x20\n[   49.646983]  vmbus_device_register+0x5e/0xf0 [hv_vmbus]\n[   49.646991]  vmbus_add_channel_work+0x12d/0x190 [hv_vmbus]\n[   49.646999]  process_one_work+0x21d/0x3f0\n[   49.647002]  worker_thread+0x4a/0x3b0\n[   49.647005]  ? process_one_work+0x3f0/0x3f0\n[   49.647007]  kthread+0xff/0x130\n[   49.647011]  ? kthread_complete_and_exit+0x20/0x20\n[   49.647015]  ret_from_fork+0x22/0x30\n[   49.647020]  </TASK>\n[   49.647021] ---[ end trace 0000000000000000 ]---","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"743b237c3a7b0f5b44aa704aae8a1058877b6322"},{"fixed":"2fe4b8631427618175a32f125062df91a5fe3f73"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"743b237c3a7b0f5b44aa704aae8a1058877b6322"},{"fixed":"3a5469582c241abca22500f36a9cb8e9331969cf"}]}],"versions":["v5.16","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49099.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"261577810733189301401264432619358585872","length":1037},"id":"CVE-2022-49099-079b0cec","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fe4b8631427618175a32f125062df91a5fe3f73","target":{"file":"drivers/hv/vmbus_drv.c","function":"vmbus_device_register"}},{"deprecated":false,"digest":{"function_hash":"261577810733189301401264432619358585872","length":1037},"id":"CVE-2022-49099-37b34e71","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3a5469582c241abca22500f36a9cb8e9331969cf","target":{"file":"drivers/hv/vmbus_drv.c","function":"vmbus_device_register"}},{"deprecated":false,"digest":{"line_hashes":["293339556136865592677239895572776027149","312560126995432418923398963868571435127","25502968565924455014656440617338888631","280761334533928278631947952887025282402","244554659909473380528436881797218871324","177440655453247686767502596962254650685","142587895566256793913221953721804103313","156790452251976557788718474388261205846","327201766486574363139829305821016153236"],"threshold":0.9},"id":"CVE-2022-49099-3c3b2d77","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3a5469582c241abca22500f36a9cb8e9331969cf","target":{"file":"drivers/hv/vmbus_drv.c"}},{"deprecated":false,"digest":{"line_hashes":["293339556136865592677239895572776027149","312560126995432418923398963868571435127","25502968565924455014656440617338888631","280761334533928278631947952887025282402","244554659909473380528436881797218871324","177440655453247686767502596962254650685","142587895566256793913221953721804103313","156790452251976557788718474388261205846","327201766486574363139829305821016153236"],"threshold":0.9},"id":"CVE-2022-49099-4fcf5055","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fe4b8631427618175a32f125062df91a5fe3f73","target":{"file":"drivers/hv/vmbus_drv.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49099.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2fe4b8631427618175a32f125062df91a5fe3f73"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3a5469582c241abca22500f36a9cb8e9331969cf"}]}