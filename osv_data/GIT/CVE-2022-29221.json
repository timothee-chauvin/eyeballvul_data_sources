{"schema_version":"1.7.3","id":"CVE-2022-29221","published":"2022-05-24T00:00:00Z","modified":"2025-10-22T18:28:21.852920Z","aliases":["GHSA-634x-pc3q-cf4c"],"related":["MGASA-2022-0226"],"summary":"PHP Code Injection by malicious block or filename in Smarty","details":"Smarty is a template engine for PHP, facilitating the separation of presentation (HTML/CSS) from application logic. Prior to versions 3.1.45 and 4.1.1, template authors could inject php code by choosing a malicious {block} name or {include} file name. Sites that cannot fully trust template authors should upgrade to versions 3.1.45 or 4.1.1 to receive a patch for this issue. There are currently no known workarounds.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/smarty-php/smarty","events":[{"introduced":"0"},{"fixed":"a2713ab89e6d773bc4819f11857af7f6b2e353a9"}]},{"type":"GIT","repo":"https://github.com/smarty-php/smarty","events":[{"introduced":"baebd59bb4da9fca89da382811b38c8313949c49"},{"fixed":"71036be8be02bf93735c47b0b745f722efbc729f"}]}],"versions":["v2.6.24","v2.6.25","v2.6.26","v2.6.27","v2.6.28","v3.1.11","v3.1.12","v3.1.13","v3.1.14","v3.1.15","v3.1.16","v3.1.17","v3.1.18","v3.1.19","v3.1.20","v3.1.21","v3.1.23","v3.1.24","v3.1.25","v3.1.26","v3.1.27","v3.1.28","v3.1.29","v3.1.30","v3.1.31","v3.1.32","v3.1.33","v3.1.34","v3.1.35","v3.1.36","v3.1.37","v3.1.37.1","v3.1.38","v3.1.39","v3.1.40","v3.1.41","v3.1.42","v3.1.43","v3.1.44","v4.0.0","v4.0.1","v4.0.2","v4.0.3","v4.0.4","v4.1.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-29221.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/smarty-php/smarty/security/advisories/GHSA-634x-pc3q-cf4c"},{"type":"ADVISORY","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BRAJVDRGCIY5UZ2PQHKDTT7RMKG6WJQQ/"},{"type":"ADVISORY","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/L777JIBIWJV34HS7LXPIDWASG7TT4LNI/"},{"type":"ADVISORY","url":"https://security.gentoo.org/glsa/202209-09"},{"type":"ADVISORY","url":"https://www.debian.org/security/2022/dsa-5151"},{"type":"ARTICLE","url":"https://lists.debian.org/debian-lts-announce/2022/05/msg00044.html"},{"type":"FIX","url":"https://github.com/smarty-php/smarty/commit/64ad6442ca1da31cefdab5c9874262b702cccddd"},{"type":"WEB","url":"https://github.com/smarty-php/smarty/releases/tag/v3.1.45"},{"type":"WEB","url":"https://github.com/smarty-php/smarty/releases/tag/v4.1.1"}],"database_specific":{"cwe_ids":["CWE-94"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}