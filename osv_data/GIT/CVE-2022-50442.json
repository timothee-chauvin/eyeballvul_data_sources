{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50442.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331782101275392047763785095217417163116",
                "81498216517847192539907683327398666491",
                "27641526653406103539933540906535503730"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50442-2cd17be6",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b15374365c9d10445ea7d66cdf885457a0223fc2",
            "target": {
              "file": "fs/ntfs3/index.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331782101275392047763785095217417163116",
                "81498216517847192539907683327398666491",
                "27641526653406103539933540906535503730"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50442-2dcfed02",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d42ecda239cc13738d6fd84d098a32e67b368b9",
            "target": {
              "file": "fs/ntfs3/index.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "49370913624862683117012493557649465385",
              "length": 1467.0
            },
            "id": "CVE-2022-50442-34ac0412",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d42ecda239cc13738d6fd84d098a32e67b368b9",
            "target": {
              "file": "fs/ntfs3/index.c",
              "function": "indx_read"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331782101275392047763785095217417163116",
                "81498216517847192539907683327398666491",
                "27641526653406103539933540906535503730"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50442-3afb7216",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3cd9e5b41b83bb57ac3cf9888f9fef2a6ef8ed96",
            "target": {
              "file": "fs/ntfs3/index.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331782101275392047763785095217417163116",
                "81498216517847192539907683327398666491",
                "27641526653406103539933540906535503730"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50442-55255c8b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f6f75e8863f41c8b3dbfd9d99e3963aaca42601",
            "target": {
              "file": "fs/ntfs3/index.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "49370913624862683117012493557649465385",
              "length": 1467.0
            },
            "id": "CVE-2022-50442-881110e7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b15374365c9d10445ea7d66cdf885457a0223fc2",
            "target": {
              "file": "fs/ntfs3/index.c",
              "function": "indx_read"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "49370913624862683117012493557649465385",
              "length": 1467.0
            },
            "id": "CVE-2022-50442-d3a7def7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f6f75e8863f41c8b3dbfd9d99e3963aaca42601",
            "target": {
              "file": "fs/ntfs3/index.c",
              "function": "indx_read"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "49370913624862683117012493557649465385",
              "length": 1467.0
            },
            "id": "CVE-2022-50442-eda9f7a3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3cd9e5b41b83bb57ac3cf9888f9fef2a6ef8ed96",
            "target": {
              "file": "fs/ntfs3/index.c",
              "function": "indx_read"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e"
            },
            {
              "fixed": "3cd9e5b41b83bb57ac3cf9888f9fef2a6ef8ed96"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e"
            },
            {
              "fixed": "b15374365c9d10445ea7d66cdf885457a0223fc2"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e"
            },
            {
              "fixed": "3f6f75e8863f41c8b3dbfd9d99e3963aaca42601"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e"
            },
            {
              "fixed": "4d42ecda239cc13738d6fd84d098a32e67b368b9"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.14",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.27",
        "v5.15.28",
        "v5.15.29",
        "v5.15.3",
        "v5.15.30",
        "v5.15.31",
        "v5.15.32",
        "v5.15.33",
        "v5.15.34",
        "v5.15.35",
        "v5.15.36",
        "v5.15.37",
        "v5.15.38",
        "v5.15.39",
        "v5.15.4",
        "v5.15.40",
        "v5.15.41",
        "v5.15.42",
        "v5.15.43",
        "v5.15.44",
        "v5.15.45",
        "v5.15.46",
        "v5.15.47",
        "v5.15.48",
        "v5.15.49",
        "v5.15.5",
        "v5.15.50",
        "v5.15.51",
        "v5.15.52",
        "v5.15.53",
        "v5.15.54",
        "v5.15.55",
        "v5.15.56",
        "v5.15.57",
        "v5.15.58",
        "v5.15.59",
        "v5.15.6",
        "v5.15.60",
        "v5.15.61",
        "v5.15.62",
        "v5.15.63",
        "v5.15.64",
        "v5.15.65",
        "v5.15.66",
        "v5.15.67",
        "v5.15.68",
        "v5.15.69",
        "v5.15.7",
        "v5.15.70",
        "v5.15.71",
        "v5.15.72",
        "v5.15.73",
        "v5.15.74",
        "v5.15.75",
        "v5.15.76",
        "v5.15.77",
        "v5.15.78",
        "v5.15.79",
        "v5.15.8",
        "v5.15.80",
        "v5.15.81",
        "v5.15.82",
        "v5.15.83",
        "v5.15.84",
        "v5.15.85",
        "v5.15.86",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.0.1",
        "v6.0.10",
        "v6.0.11",
        "v6.0.12",
        "v6.0.13",
        "v6.0.14",
        "v6.0.15",
        "v6.0.16",
        "v6.0.2",
        "v6.0.3",
        "v6.0.4",
        "v6.0.5",
        "v6.0.6",
        "v6.0.7",
        "v6.0.8",
        "v6.0.9",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1",
        "v6.1.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50442.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.15.0"
            },
            {
              "fixed": "5.15.87"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "6.0.17"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.1.0"
            },
            {
              "fixed": "6.1.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/ntfs3: Validate buffer length while parsing index\n\nindx_read is called when we have some NTFS directory operations that\nneed more information from the index buffers. This adds a sanity check\nto make sure the returned index buffer length is legit, or we may have\nsome out-of-bound memory accesses.\n\n[  560.897595] BUG: KASAN: slab-out-of-bounds in hdr_find_e.isra.0+0x10c/0x320\n[  560.898321] Read of size 2 at addr ffff888009497238 by task exp/245\n[  560.898760]\n[  560.899129] CPU: 0 PID: 245 Comm: exp Not tainted 6.0.0-rc6 #37\n[  560.899505] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org 04/01/2014\n[  560.900170] Call Trace:\n[  560.900407]  <TASK>\n[  560.900732]  dump_stack_lvl+0x49/0x63\n[  560.901108]  print_report.cold+0xf5/0x689\n[  560.901395]  ? hdr_find_e.isra.0+0x10c/0x320\n[  560.901716]  kasan_report+0xa7/0x130\n[  560.901950]  ? hdr_find_e.isra.0+0x10c/0x320\n[  560.902208]  __asan_load2+0x68/0x90\n[  560.902427]  hdr_find_e.isra.0+0x10c/0x320\n[  560.902846]  ? cmp_uints+0xe0/0xe0\n[  560.903363]  ? cmp_sdh+0x90/0x90\n[  560.903883]  ? ntfs_bread_run+0x190/0x190\n[  560.904196]  ? rwsem_down_read_slowpath+0x750/0x750\n[  560.904969]  ? ntfs_fix_post_read+0xe0/0x130\n[  560.905259]  ? __kasan_check_write+0x14/0x20\n[  560.905599]  ? up_read+0x1a/0x90\n[  560.905853]  ? indx_read+0x22c/0x380\n[  560.906096]  indx_find+0x2ef/0x470\n[  560.906352]  ? indx_find_buffer+0x2d0/0x2d0\n[  560.906692]  ? __kasan_kmalloc+0x88/0xb0\n[  560.906977]  dir_search_u+0x196/0x2f0\n[  560.907220]  ? ntfs_nls_to_utf16+0x450/0x450\n[  560.907464]  ? __kasan_check_write+0x14/0x20\n[  560.907747]  ? mutex_lock+0x8f/0xe0\n[  560.907970]  ? __mutex_lock_slowpath+0x20/0x20\n[  560.908214]  ? kmem_cache_alloc+0x143/0x4b0\n[  560.908459]  ntfs_lookup+0xe0/0x100\n[  560.908788]  __lookup_slow+0x116/0x220\n[  560.909050]  ? lookup_fast+0x1b0/0x1b0\n[  560.909309]  ? lookup_fast+0x13f/0x1b0\n[  560.909601]  walk_component+0x187/0x230\n[  560.909944]  link_path_walk.part.0+0x3f0/0x660\n[  560.910285]  ? handle_lookup_down+0x90/0x90\n[  560.910618]  ? path_init+0x642/0x6e0\n[  560.911084]  ? percpu_counter_add_batch+0x6e/0xf0\n[  560.912559]  ? __alloc_file+0x114/0x170\n[  560.913008]  path_openat+0x19c/0x1d10\n[  560.913419]  ? getname_flags+0x73/0x2b0\n[  560.913815]  ? kasan_save_stack+0x3a/0x50\n[  560.914125]  ? kasan_save_stack+0x26/0x50\n[  560.914542]  ? __kasan_slab_alloc+0x6d/0x90\n[  560.914924]  ? kmem_cache_alloc+0x143/0x4b0\n[  560.915339]  ? getname_flags+0x73/0x2b0\n[  560.915647]  ? getname+0x12/0x20\n[  560.916114]  ? __x64_sys_open+0x4c/0x60\n[  560.916460]  ? path_lookupat.isra.0+0x230/0x230\n[  560.916867]  ? __isolate_free_page+0x2e0/0x2e0\n[  560.917194]  do_filp_open+0x15c/0x1f0\n[  560.917448]  ? may_open_dev+0x60/0x60\n[  560.917696]  ? expand_files+0xa4/0x3a0\n[  560.917923]  ? __kasan_check_write+0x14/0x20\n[  560.918185]  ? _raw_spin_lock+0x88/0xdb\n[  560.918409]  ? _raw_spin_lock_irqsave+0x100/0x100\n[  560.918783]  ? _find_next_bit+0x4a/0x130\n[  560.919026]  ? _raw_spin_unlock+0x19/0x40\n[  560.919276]  ? alloc_fd+0x14b/0x2d0\n[  560.919635]  do_sys_openat2+0x32a/0x4b0\n[  560.920035]  ? file_open_root+0x230/0x230\n[  560.920336]  ? __rcu_read_unlock+0x5b/0x280\n[  560.920813]  do_sys_open+0x99/0xf0\n[  560.921208]  ? filp_open+0x60/0x60\n[  560.921482]  ? exit_to_user_mode_prepare+0x49/0x180\n[  560.921867]  __x64_sys_open+0x4c/0x60\n[  560.922128]  do_syscall_64+0x3b/0x90\n[  560.922369]  entry_SYSCALL_64_after_hwframe+0x63/0xcd\n[  560.923030] RIP: 0033:0x7f7dff2e4469\n[  560.923681] Code: 00 f3 c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 088\n[  560.924451] RSP: 002b:00007ffd41a210b8 EFLAGS: 00000206 ORIG_RAX: 0000000000000002\n[  560.925168] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f7dff2e4469\n[  560.925655] RDX: 0000000000000000 RSI: 0000000000000002 RDI:\n---truncated---",
  "id": "CVE-2022-50442",
  "modified": "2025-10-21T13:04:01.087244Z",
  "published": "2025-10-01T11:42:18Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/3cd9e5b41b83bb57ac3cf9888f9fef2a6ef8ed96"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/3f6f75e8863f41c8b3dbfd9d99e3963aaca42601"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/4d42ecda239cc13738d6fd84d098a32e67b368b9"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/b15374365c9d10445ea7d66cdf885457a0223fc2"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "fs/ntfs3: Validate buffer length while parsing index"
}