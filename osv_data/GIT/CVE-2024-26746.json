{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26746.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "57322367627099980828634209050331564739",
              "length": 543.0
            },
            "id": "CVE-2024-26746-5a964ad4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d3ea125df37dc37972d581b74a5d3785c3f283ab",
            "target": {
              "file": "drivers/dma/idxd/init.c",
              "function": "idxd_init_evl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "57322367627099980828634209050331564739",
              "length": 543.0
            },
            "id": "CVE-2024-26746-92aac3b2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5e3022ea42e490a36ec6f2cfa6fc603deb0bace4",
            "target": {
              "file": "drivers/dma/idxd/init.c",
              "function": "idxd_init_evl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "45366986318708395973655548138483785185",
                "220803545593068855576977891417277434351",
                "83160022782379768693451037663986788741",
                "68615086940505189283707428092507588190",
                "179155774717882457022309769735435506088",
                "324977823170707645256724103872891335313",
                "169915248908986914956130940171710725641",
                "277425176908590821143091467621492842791",
                "106216304011562671914290631494337065856",
                "170816569559290302719326410053109575121",
                "41618999376758504840263379661427082643"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26746-ba100208",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5e3022ea42e490a36ec6f2cfa6fc603deb0bace4",
            "target": {
              "file": "drivers/dma/idxd/init.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "45366986318708395973655548138483785185",
                "220803545593068855576977891417277434351",
                "83160022782379768693451037663986788741",
                "68615086940505189283707428092507588190",
                "179155774717882457022309769735435506088",
                "324977823170707645256724103872891335313",
                "169915248908986914956130940171710725641",
                "277425176908590821143091467621492842791",
                "106216304011562671914290631494337065856",
                "170816569559290302719326410053109575121",
                "41618999376758504840263379661427082643"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26746-c3883636",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d3ea125df37dc37972d581b74a5d3785c3f283ab",
            "target": {
              "file": "drivers/dma/idxd/init.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "45366986318708395973655548138483785185",
                "220803545593068855576977891417277434351",
                "83160022782379768693451037663986788741",
                "68615086940505189283707428092507588190",
                "179155774717882457022309769735435506088",
                "324977823170707645256724103872891335313",
                "169915248908986914956130940171710725641",
                "277425176908590821143091467621492842791",
                "106216304011562671914290631494337065856",
                "170816569559290302719326410053109575121",
                "41618999376758504840263379661427082643"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26746-eccf7c8f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bb71e040323175e18c233a9afef32ba14fa64eb7",
            "target": {
              "file": "drivers/dma/idxd/init.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "57322367627099980828634209050331564739",
              "length": 543.0
            },
            "id": "CVE-2024-26746-edc5c85a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bb71e040323175e18c233a9afef32ba14fa64eb7",
            "target": {
              "file": "drivers/dma/idxd/init.c",
              "function": "idxd_init_evl"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "c2f156bf168fb42cd6ecd0a8e2204dbe542b8516"
            },
            {
              "fixed": "5e3022ea42e490a36ec6f2cfa6fc603deb0bace4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "c2f156bf168fb42cd6ecd0a8e2204dbe542b8516"
            },
            {
              "fixed": "bb71e040323175e18c233a9afef32ba14fa64eb7"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "c2f156bf168fb42cd6ecd0a8e2204dbe542b8516"
            },
            {
              "fixed": "d3ea125df37dc37972d581b74a5d3785c3f283ab"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.3",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.2",
        "v6.7.3",
        "v6.7.4",
        "v6.7.5",
        "v6.7.6",
        "v6.7.7",
        "v6.7.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26746.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.4.0"
            },
            {
              "fixed": "6.6.21"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.9"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndmaengine: idxd: Ensure safe user copy of completion record\n\nIf CONFIG_HARDENED_USERCOPY is enabled, copying completion record from\nevent log cache to user triggers a kernel bug.\n\n[ 1987.159822] usercopy: Kernel memory exposure attempt detected from SLUB object 'dsa0' (offset 74, size 31)!\n[ 1987.170845] ------------[ cut here ]------------\n[ 1987.176086] kernel BUG at mm/usercopy.c:102!\n[ 1987.180946] invalid opcode: 0000 [#1] PREEMPT SMP NOPTI\n[ 1987.186866] CPU: 17 PID: 528 Comm: kworker/17:1 Not tainted 6.8.0-rc2+ #5\n[ 1987.194537] Hardware name: Intel Corporation AvenueCity/AvenueCity, BIOS BHSDCRB1.86B.2492.D03.2307181620 07/18/2023\n[ 1987.206405] Workqueue: wq0.0 idxd_evl_fault_work [idxd]\n[ 1987.212338] RIP: 0010:usercopy_abort+0x72/0x90\n[ 1987.217381] Code: 58 65 9c 50 48 c7 c2 17 85 61 9c 57 48 c7 c7 98 fd 6b 9c 48 0f 44 d6 48 c7 c6 b3 08 62 9c 4c 89 d1 49 0f 44 f3 e8 1e 2e d5 ff <0f> 0b 49 c7 c1 9e 42 61 9c 4c 89 cf 4d 89 c8 eb a9 66 66 2e 0f 1f\n[ 1987.238505] RSP: 0018:ff62f5cf20607d60 EFLAGS: 00010246\n[ 1987.244423] RAX: 000000000000005f RBX: 000000000000001f RCX: 0000000000000000\n[ 1987.252480] RDX: 0000000000000000 RSI: ffffffff9c61429e RDI: 00000000ffffffff\n[ 1987.260538] RBP: ff62f5cf20607d78 R08: ff2a6a89ef3fffe8 R09: 00000000fffeffff\n[ 1987.268595] R10: ff2a6a89eed00000 R11: 0000000000000003 R12: ff2a66934849c89a\n[ 1987.276652] R13: 0000000000000001 R14: ff2a66934849c8b9 R15: ff2a66934849c899\n[ 1987.284710] FS:  0000000000000000(0000) GS:ff2a66b22fe40000(0000) knlGS:0000000000000000\n[ 1987.293850] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[ 1987.300355] CR2: 00007fe291a37000 CR3: 000000010fbd4005 CR4: 0000000000f71ef0\n[ 1987.308413] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n[ 1987.316470] DR3: 0000000000000000 DR6: 00000000fffe07f0 DR7: 0000000000000400\n[ 1987.324527] PKRU: 55555554\n[ 1987.327622] Call Trace:\n[ 1987.330424]  <TASK>\n[ 1987.332826]  ? show_regs+0x6e/0x80\n[ 1987.336703]  ? die+0x3c/0xa0\n[ 1987.339988]  ? do_trap+0xd4/0xf0\n[ 1987.343662]  ? do_error_trap+0x75/0xa0\n[ 1987.347922]  ? usercopy_abort+0x72/0x90\n[ 1987.352277]  ? exc_invalid_op+0x57/0x80\n[ 1987.356634]  ? usercopy_abort+0x72/0x90\n[ 1987.360988]  ? asm_exc_invalid_op+0x1f/0x30\n[ 1987.365734]  ? usercopy_abort+0x72/0x90\n[ 1987.370088]  __check_heap_object+0xb7/0xd0\n[ 1987.374739]  __check_object_size+0x175/0x2d0\n[ 1987.379588]  idxd_copy_cr+0xa9/0x130 [idxd]\n[ 1987.384341]  idxd_evl_fault_work+0x127/0x390 [idxd]\n[ 1987.389878]  process_one_work+0x13e/0x300\n[ 1987.394435]  ? __pfx_worker_thread+0x10/0x10\n[ 1987.399284]  worker_thread+0x2f7/0x420\n[ 1987.403544]  ? _raw_spin_unlock_irqrestore+0x2b/0x50\n[ 1987.409171]  ? __pfx_worker_thread+0x10/0x10\n[ 1987.414019]  kthread+0x107/0x140\n[ 1987.417693]  ? __pfx_kthread+0x10/0x10\n[ 1987.421954]  ret_from_fork+0x3d/0x60\n[ 1987.426019]  ? __pfx_kthread+0x10/0x10\n[ 1987.430281]  ret_from_fork_asm+0x1b/0x30\n[ 1987.434744]  </TASK>\n\nThe issue arises because event log cache is created using\nkmem_cache_create() which is not suitable for user copy.\n\nFix the issue by creating event log cache with\nkmem_cache_create_usercopy(), ensuring safe user copy.",
  "id": "CVE-2024-26746",
  "modified": "2025-10-21T18:17:05.619565Z",
  "published": "2024-04-04T08:20:13Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5e3022ea42e490a36ec6f2cfa6fc603deb0bace4"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/bb71e040323175e18c233a9afef32ba14fa64eb7"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d3ea125df37dc37972d581b74a5d3785c3f283ab"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "dmaengine: idxd: Ensure safe user copy of completion record"
}