{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52704.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "236723436722197098376982206779127060467",
                "125080581720476382875189344521686763047",
                "228044983507920151223161943833567898440",
                "211989627945530989916419517264992291658",
                "226686023544488491099600540233800173265",
                "79766840984151799044049505667847143706",
                "243720218427881366557219533618983500774",
                "137801471938717817197457536775122330463",
                "176395969858055213756320129294207844267",
                "38571701403772258190043588330835320889",
                "10931917793154705507730602786304854147",
                "80435997024275651529408610005022972803",
                "188487143935801815568191920614827919362",
                "10931285486604610611335673890003562548"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52704-52fbc119",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7f9f6c54da876b3f0bece2b569456ceb96965ed7",
            "target": {
              "file": "kernel/umh.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "152382453830146804617012425823040391279",
              "length": 862.0
            },
            "id": "CVE-2023-52704-c65b881e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7f9f6c54da876b3f0bece2b569456ceb96965ed7",
            "target": {
              "file": "kernel/umh.c",
              "function": "call_usermodehelper_exec"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "236723436722197098376982206779127060467",
                "125080581720476382875189344521686763047",
                "228044983507920151223161943833567898440",
                "211989627945530989916419517264992291658",
                "226686023544488491099600540233800173265",
                "79766840984151799044049505667847143706",
                "243720218427881366557219533618983500774",
                "137801471938717817197457536775122330463",
                "176395969858055213756320129294207844267",
                "38571701403772258190043588330835320889",
                "10931917793154705507730602786304854147",
                "80435997024275651529408610005022972803",
                "188487143935801815568191920614827919362",
                "10931285486604610611335673890003562548"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52704-e04cb5f3",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eedeb787ebb53de5c5dcf7b7b39d01bf1b0f037d",
            "target": {
              "file": "kernel/umh.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "152382453830146804617012425823040391279",
              "length": 862.0
            },
            "id": "CVE-2023-52704-f8b7ba0e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eedeb787ebb53de5c5dcf7b7b39d01bf1b0f037d",
            "target": {
              "file": "kernel/umh.c",
              "function": "call_usermodehelper_exec"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f5d39b020809146cc28e6e73369bf8065e0310aa"
            },
            {
              "fixed": "7f9f6c54da876b3f0bece2b569456ceb96965ed7"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f5d39b020809146cc28e6e73369bf8065e0310aa"
            },
            {
              "fixed": "eedeb787ebb53de5c5dcf7b7b39d01bf1b0f037d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1",
        "v6.1.10",
        "v6.1.11",
        "v6.1.12",
        "v6.1.2",
        "v6.1.3",
        "v6.1.4",
        "v6.1.5",
        "v6.1.6",
        "v6.1.7",
        "v6.1.8",
        "v6.1.9",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52704.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.1.0"
            },
            {
              "fixed": "6.1.13"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nfreezer,umh: Fix call_usermode_helper_exec() vs SIGKILL\n\nTetsuo-San noted that commit f5d39b020809 (\"freezer,sched: Rewrite\ncore freezer logic\") broke call_usermodehelper_exec() for the KILLABLE\ncase.\n\nSpecifically it was missed that the second, unconditional,\nwait_for_completion() was not optional and ensures the on-stack\ncompletion is unused before going out-of-scope.",
  "id": "CVE-2023-52704",
  "modified": "2025-10-15T03:55:34.279293Z",
  "published": "2024-05-21T15:22:53Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7f9f6c54da876b3f0bece2b569456ceb96965ed7"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/eedeb787ebb53de5c5dcf7b7b39d01bf1b0f037d"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "freezer,umh: Fix call_usermode_helper_exec() vs SIGKILL"
}