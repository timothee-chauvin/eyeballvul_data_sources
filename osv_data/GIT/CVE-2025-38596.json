{"schema_version":"1.7.3","id":"CVE-2025-38596","published":"2025-08-19T17:03:26.445Z","modified":"2025-11-20T09:29:44.933525Z","summary":"drm/panthor: Fix UAF in panthor_gem_create_with_handle() debugfs code","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/panthor: Fix UAF in panthor_gem_create_with_handle() debugfs code\n\nThe object is potentially already gone after the drm_gem_object_put().\nIn general the object should be fully constructed before calling\ndrm_gem_handle_create(), except the debugfs tracking uses a separate\nlock and list and separate flag to denotate whether the object is\nactually initialized.\n\nSince I'm touching this all anyway simplify this by only adding the\nobject to the debugfs when it's ready for that, which allows us to\ndelete that separate flag. panthor_gem_debugfs_bo_rm() already checks\nwhether we've actually been added to the list or this is some error\npath cleanup.\n\nv2: Fix build issues for !CONFIG_DEBUGFS (Adri√°n)\n\nv3: Add linebreak and remove outdated comment (Liviu)","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a3707f53eb3f4f3e7a30d720be0885f813d649bb"},{"fixed":"5f2be12442db6a2904e6e31b0e3b5ad5aebf868b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a3707f53eb3f4f3e7a30d720be0885f813d649bb"},{"fixed":"fe69a391808404977b1f002a6e7447de3de7a88e"}]}],"versions":["v6.15","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38596.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"29668367696989929928400561574091877628","length":59},"id":"CVE-2025-38596-110577ba","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c","function":"panthor_gem_debugfs_bo_add"}},{"deprecated":false,"digest":{"function_hash":"104656889442422910701009306012349332669","length":991},"id":"CVE-2025-38596-1699c566","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c","function":"panthor_gem_debugfs_print_bos"}},{"deprecated":false,"digest":{"function_hash":"75896944957819214619315012521818722363","length":1204},"id":"CVE-2025-38596-1e072f61","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c","function":"panthor_gem_debugfs_bo_print"}},{"deprecated":false,"digest":{"line_hashes":["234211030283798829029476598049027541383","324752874648052503220386530443685449994","56967252384793201796343438340110124401","111101351569995566597924884060197444752","49686441681818026156360488599382467864","104317714859594993114843672835977457630","65743790573251264318669125143753942406","195714856106472227718893023289110262862","103222345031563540952659537485316522336","88379609319768032055641612485294459347","305936792513958932723388733078759420366","174920081657249103296327029738805256687","112228763376472233638788804434127917640","3546252595351169269456798798696269941","61802842488020668630026788434686311458","90129306841531583209359621184988717940","95066964173195431695366438171733645095","136190803217602727349551580452879338787","34842415092930439703187896481770653320","244423523814936127291011392317752437090","132121261804758643446276019172093878912","305886742151432210565001629638191789852","305184385993609829316608929639911169433","192422587663265349698412681783454502018","224805650919769318688009334401277278617","94322966913652206543114691412238079846","25086917360053254863853520468876861691","60637803941514754680851453752932105504","319121630337311102503221069751701551675","64788014883671944394387045167123241271","288527958723995726983306362470992410788","86989810566231226407163059316939957057","300072317241218868002875887064251797308","116003903985343724208814385973535267431","149597880193134699304521871289117768689","327447643562559250383516378874249520459","198415305367988631102818847341433331135","324624651528506353426446238403829924476"],"threshold":0.9},"id":"CVE-2025-38596-2aab3849","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c"}},{"deprecated":false,"digest":{"line_hashes":["278762310154751581994594613944527254108","204468948271261216027634028544235889235","92529911313898064841252229300476333970","311621051233196307822610215792997713568"],"threshold":0.9},"id":"CVE-2025-38596-4c2a3a81","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.h"}},{"deprecated":false,"digest":{"function_hash":"330549459845571771543465799162636730681","length":137},"id":"CVE-2025-38596-5c1efe4f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c","function":"panthor_gem_debugfs_set_usage_flags"}},{"deprecated":false,"digest":{"function_hash":"157629322210194689646769528840020995664","length":647},"id":"CVE-2025-38596-85bd2e98","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c","function":"panthor_gem_create_with_handle"}},{"deprecated":false,"digest":{"function_hash":"1280689033384654378493510034186404237","length":394},"id":"CVE-2025-38596-ad4edeba","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c","function":"panthor_gem_debugfs_bo_add"}},{"deprecated":false,"digest":{"function_hash":"239084485532588790164834250481455764738","length":542},"id":"CVE-2025-38596-c597e87e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5f2be12442db6a2904e6e31b0e3b5ad5aebf868b","target":{"file":"drivers/gpu/drm/panthor/panthor_gem.c","function":"panthor_gem_create_object"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.16.1"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38596.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/5f2be12442db6a2904e6e31b0e3b5ad5aebf868b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fe69a391808404977b1f002a6e7447de3de7a88e"}]}