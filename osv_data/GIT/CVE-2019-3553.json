{"schema_version":"1.7.3","id":"CVE-2019-3553","published":"2020-03-10T21:15:11Z","modified":"2025-10-21T05:07:55.148079Z","related":["CGA-hmcg-x8rm-cvcp"],"details":"C++ Facebook Thrift servers would not error upon receiving messages declaring containers of sizes larger than the payload. As a result, malicious clients could send short messages which would result in a large memory allocation, potentially leading to denial of service. This issue affects Facebook Thrift prior to v2020.02.03.00.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/facebook/fbthrift","events":[{"introduced":"0"},{"fixed":"3f156207e8a6583d88999487e954320dc18955e6"},{"fixed":"c9a903e5902834e95bbd4ab0e9fa53ba0189f351"}]}],"versions":["0.19.0","v0.20.0","v0.24.0","v0.25.0","v0.26.0","v0.27.0","v0.28.0","v0.29.0","v0.30.0","v0.31.0","v2016.09.26.00","v2016.10.03.00","v2016.10.10.00","v2016.10.17.00","v2016.10.24.00","v2016.10.31.00","v2016.11.07.00","v2016.11.14.00","v2016.11.21.00","v2016.11.28.00","v2016.12.05.00","v2016.12.12.00","v2016.12.19.00","v2016.12.26.00","v2017.01.02.00","v2017.01.09.00","v2017.01.16.00","v2017.01.23.00","v2017.01.30.00","v2017.03.06.00","v2017.03.13.00","v2017.03.20.00","v2017.03.27.00","v2017.04.03.00","v2017.04.10.00","v2017.04.17.00","v2017.04.24.00","v2017.05.01.00","v2017.05.08.00","v2017.05.15.00","v2017.05.22.00","v2017.05.29.00","v2017.06.05.00","v2017.06.12.00","v2017.06.19.00","v2017.06.26.00","v2017.07.03.00","v2017.07.10.00","v2017.07.17.00","v2017.07.24.00","v2017.07.31.00","v2017.08.07.00","v2017.08.14.00","v2017.08.21.00","v2017.08.28.00","v2017.09.04.00","v2017.09.11.00","v2017.09.18.00","v2017.09.25.00","v2017.10.02.00","v2017.10.09.00","v2017.10.16.00","v2017.10.23.00","v2017.10.30.00","v2017.11.06.00","v2017.11.13.00","v2017.11.20.00","v2017.11.27.00","v2017.12.04.00","v2017.12.11.00","v2017.12.18.00","v2017.12.25.00","v2018.01.01.00","v2018.01.08.00","v2018.01.15.00","v2018.01.22.00","v2018.01.29.00","v2018.02.05.00","v2018.02.12.00","v2018.02.19.00","v2018.02.26.00","v2018.03.05.00","v2018.03.12.00","v2018.03.19.00","v2018.03.26.00","v2018.04.02.00","v2018.04.09.00","v2018.04.16.00","v2018.04.23.00","v2018.04.30.00","v2018.05.07.00","v2018.05.14.00","v2018.05.21.00","v2018.05.28.00","v2018.06.04.00","v2018.06.11.00","v2018.06.18.00","v2018.06.25.00","v2018.07.02.00","v2018.07.09.00","v2018.07.16.00","v2018.07.23.00","v2018.07.30.00","v2018.08.06.00","v2018.08.13.00","v2018.08.20.00","v2018.08.27.00","v2018.09.03.00","v2018.09.10.00","v2018.09.17.00","v2018.09.24.00","v2018.10.01.00","v2018.10.08.00","v2018.10.15.00","v2018.10.22.00","v2018.10.29.00","v2018.11.05.00","v2018.11.12.00","v2018.11.19.00","v2018.11.26.00","v2018.12.03.00","v2018.12.10.00","v2018.12.17.00","v2018.12.24.00","v2018.12.31.00","v2019.01.07.00","v2019.01.14.00","v2019.01.21.00","v2019.01.28.00","v2019.02.04.00","v2019.02.11.00","v2019.02.18.00","v2019.02.25.00","v2019.03.04.00","v2019.03.11.00","v2019.03.18.00","v2019.04.08.00","v2019.04.15.00","v2019.04.22.00","v2019.04.29.00","v2019.05.06.00","v2019.05.13.00","v2019.05.20.00","v2019.05.27.00","v2019.06.03.00","v2019.06.10.00","v2019.06.17.00","v2019.06.24.00","v2019.07.01.00","v2019.07.08.00","v2019.07.15.00","v2019.07.22.00","v2019.07.29.00","v2019.09.23.00","v2019.09.30.00","v2019.10.07.00","v2019.10.14.00","v2019.10.21.00","v2019.10.28.00","v2019.11.04.00","v2019.11.11.00","v2019.12.02.00","v2019.12.06.00","v2019.12.09.00","v2019.12.16.00","v2019.12.23.00","v2019.12.30.00","v2020.01.06.00","v2020.01.13.00","v2020.01.20.00","v2020.01.27.00"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2019-3553.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["44596890016633024641060470411155656877","331657705654131850442828927928062784103","62810701246369866615112618702708241448"],"threshold":0.9},"id":"CVE-2019-3553-05ac5954","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp2/protocol/Protocol.h"}},{"deprecated":false,"digest":{"function_hash":"174706121235900777254241968332960772258","length":526},"id":"CVE-2019-3553-163d2407","signature_type":"Function","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/c9a903e5902834e95bbd4ab0e9fa53ba0189f351","target":{"file":"thrift/lib/cpp2/protocol/CompactProtocol-inl.h","function":"CompactProtocolReader::readStringBody"}},{"deprecated":false,"digest":{"line_hashes":["4545242548456549856471385261797320583","6535706504946512896092844659658536142","58427431270480592947181406810742987856","323494517859915281965413108861047445416"],"threshold":0.9},"id":"CVE-2019-3553-4fbbacee","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/c9a903e5902834e95bbd4ab0e9fa53ba0189f351","target":{"file":"thrift/lib/cpp2/protocol/CompactProtocol-inl.h"}},{"deprecated":false,"digest":{"line_hashes":["212002469332875097723210544329375829725","153898754891649393942430316852394863342","227682968511353201476159449308733903653"],"threshold":0.9},"id":"CVE-2019-3553-66017512","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp2/protocol/NimbleProtocol.h"}},{"deprecated":false,"digest":{"line_hashes":["153527619121847531239303211989744505617","29902521812625455048072784516873614057","234442070744256819590778981643473786430","323494517859915281965413108861047445416"],"threshold":0.9},"id":"CVE-2019-3553-722b1184","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/c9a903e5902834e95bbd4ab0e9fa53ba0189f351","target":{"file":"thrift/lib/cpp2/protocol/BinaryProtocol-inl.h"}},{"deprecated":false,"digest":{"function_hash":"132259883174068687299136862608488877482","length":597},"id":"CVE-2019-3553-7fbf25b1","signature_type":"Function","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/c9a903e5902834e95bbd4ab0e9fa53ba0189f351","target":{"file":"thrift/lib/cpp2/protocol/BinaryProtocol-inl.h","function":"BinaryProtocolReader::readStringBody"}},{"deprecated":false,"digest":{"function_hash":"259773171914150900980400727678888402219","length":715},"id":"CVE-2019-3553-bd10f388","signature_type":"Function","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp2/protocol/detail/protocol_methods.h","function":"read"}},{"deprecated":false,"digest":{"line_hashes":["92725103026390205837140894194792057031","163628535947776537148403942477945916337","186176528405032179249056986190882403164","108587633537507210242609878158511307392"],"threshold":0.9},"id":"CVE-2019-3553-c2553062","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp/protocol/TProtocolException.cpp"}},{"deprecated":false,"digest":{"function_hash":"26855308651349703267568909715761752202","length":960},"id":"CVE-2019-3553-c7c20977","signature_type":"Function","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp2/protocol/detail/protocol_methods.h","function":"read"}},{"deprecated":false,"digest":{"line_hashes":["294201529193437677925246979548635543859","251498252870392571334876633397177745964","188361747536714763440835157316534382951","202539566248075939611767876272240491962"],"threshold":0.9},"id":"CVE-2019-3553-cd35344f","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp/protocol/TProtocolException.h"}},{"deprecated":false,"digest":{"function_hash":"274153452343210165639182471556544972289","length":1091},"id":"CVE-2019-3553-d27c367e","signature_type":"Function","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp2/protocol/detail/protocol_methods.h","function":"read"}},{"deprecated":false,"digest":{"line_hashes":["379873552829428259817983544756423750","38846893758077509604777492341125738089","148762455145767815842576259815983143114","40944184984363785666168465967920033607","12142979365642684022531327030095844492","177014993987220354725995233458164805066","66645819444173369681937423972076389364","56051993222598451186266254746257317861","54829995104402265666215148485616059909","225981421825697214061150032645037264591","332024401246044362683770948748881431480","110625175761543874526356140866117602619"],"threshold":0.9},"id":"CVE-2019-3553-e873b235","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6","target":{"file":"thrift/lib/cpp2/protocol/detail/protocol_methods.h"}}]}}],"references":[{"type":"FIX","url":"https://github.com/facebook/fbthrift/commit/3f156207e8a6583d88999487e954320dc18955e6"},{"type":"FIX","url":"https://github.com/facebook/fbthrift/commit/c9a903e5902834e95bbd4ab0e9fa53ba0189f351"},{"type":"ADVISORY","url":"https://www.facebook.com/security/advisories/cve-2019-3553"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}