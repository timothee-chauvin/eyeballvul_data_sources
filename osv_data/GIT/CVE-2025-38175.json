{"schema_version":"1.7.3","id":"CVE-2025-38175","published":"2025-07-04T10:39:56Z","modified":"2025-10-22T12:28:04.766862Z","summary":"binder: fix yet another UAF in binder_devices","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbinder: fix yet another UAF in binder_devices\n\nCommit e77aff5528a18 (\"binderfs: fix use-after-free in binder_devices\")\naddressed a use-after-free where devices could be released without first\nbeing removed from the binder_devices list. However, there is a similar\npath in binder_free_proc() that was missed:\n\n  ==================================================================\n  BUG: KASAN: slab-use-after-free in binder_remove_device+0xd4/0x100\n  Write of size 8 at addr ffff0000c773b900 by task umount/467\n  CPU: 12 UID: 0 PID: 467 Comm: umount Not tainted 6.15.0-rc7-00138-g57483a362741 #9 PREEMPT\n  Hardware name: linux,dummy-virt (DT)\n  Call trace:\n   binder_remove_device+0xd4/0x100\n   binderfs_evict_inode+0x230/0x2f0\n   evict+0x25c/0x5dc\n   iput+0x304/0x480\n   dentry_unlink_inode+0x208/0x46c\n   __dentry_kill+0x154/0x530\n   [...]\n\n  Allocated by task 463:\n   __kmalloc_cache_noprof+0x13c/0x324\n   binderfs_binder_device_create.isra.0+0x138/0xa60\n   binder_ctl_ioctl+0x1ac/0x230\n  [...]\n\n  Freed by task 215:\n   kfree+0x184/0x31c\n   binder_proc_dec_tmpref+0x33c/0x4ac\n   binder_deferred_func+0xc10/0x1108\n   process_one_work+0x520/0xba4\n  [...]\n  ==================================================================\n\nCall binder_remove_device() within binder_free_proc() to ensure the\ndevice is removed from the binder_devices list before being kfreed.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"12d909cac1e1c4147cc3417fee804ee12fc6b984"},{"fixed":"4a7694f499cae5b83412c5281bf2c961f34f2ed6"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"12d909cac1e1c4147cc3417fee804ee12fc6b984"},{"fixed":"72a726fb5f25fbb31d6060acfb671c1955831245"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"12d909cac1e1c4147cc3417fee804ee12fc6b984"},{"fixed":"9857af0fcff385c75433f2162c30c62eb912ef6d"}]}],"versions":["v6.13","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.10","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.14.6","v6.14.7","v6.14.8","v6.14.9","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38175.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["134152819784124310863192464914285987559","42993776665822737602429501201899198157","241125481736749023284307586980937264008","121612136222915372148089281876657488950"],"threshold":0.9},"id":"CVE-2025-38175-166d5501","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9857af0fcff385c75433f2162c30c62eb912ef6d","target":{"file":"drivers/android/binder.c"}},{"deprecated":false,"digest":{"line_hashes":["134152819784124310863192464914285987559","42993776665822737602429501201899198157","241125481736749023284307586980937264008","121612136222915372148089281876657488950"],"threshold":0.9},"id":"CVE-2025-38175-406bee46","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a7694f499cae5b83412c5281bf2c961f34f2ed6","target":{"file":"drivers/android/binder.c"}},{"deprecated":false,"digest":{"line_hashes":["134152819784124310863192464914285987559","42993776665822737602429501201899198157","241125481736749023284307586980937264008","121612136222915372148089281876657488950"],"threshold":0.9},"id":"CVE-2025-38175-4107f9a0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@72a726fb5f25fbb31d6060acfb671c1955831245","target":{"file":"drivers/android/binder.c"}},{"deprecated":false,"digest":{"function_hash":"51924594226598773162897995045918252197","length":615},"id":"CVE-2025-38175-73eabf94","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a7694f499cae5b83412c5281bf2c961f34f2ed6","target":{"file":"drivers/android/binder.c","function":"binder_free_proc"}},{"deprecated":false,"digest":{"function_hash":"51924594226598773162897995045918252197","length":615},"id":"CVE-2025-38175-95bd090e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9857af0fcff385c75433f2162c30c62eb912ef6d","target":{"file":"drivers/android/binder.c","function":"binder_free_proc"}},{"deprecated":false,"digest":{"function_hash":"51924594226598773162897995045918252197","length":615},"id":"CVE-2025-38175-b819410f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@72a726fb5f25fbb31d6060acfb671c1955831245","target":{"file":"drivers/android/binder.c","function":"binder_free_proc"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.14.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.15.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38175.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4a7694f499cae5b83412c5281bf2c961f34f2ed6"},{"type":"WEB","url":"https://git.kernel.org/stable/c/72a726fb5f25fbb31d6060acfb671c1955831245"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9857af0fcff385c75433f2162c30c62eb912ef6d"}]}