{"schema_version":"1.7.3","id":"CVE-2022-50071","published":"2025-06-18T11:02:15Z","modified":"2025-10-21T11:49:00.705332Z","summary":"mptcp: move subflow cleanup in mptcp_destroy_common()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: move subflow cleanup in mptcp_destroy_common()\n\nIf the mptcp socket creation fails due to a CGROUP_INET_SOCK_CREATE\neBPF program, the MPTCP protocol ends-up leaking all the subflows:\nthe related cleanup happens in __mptcp_destroy_sock() that is not\ninvoked in such code path.\n\nAddress the issue moving the subflow sockets cleanup in the\nmptcp_destroy_common() helper, which is invoked in every msk cleanup\npath.\n\nAdditionally get rid of the intermediate list_splice_init step, which\nis an unneeded relic from the past.\n\nThe issue is present since before the reported root cause commit, but\nany attempt to backport the fix before that hash will require a complete\nrewrite.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e16163b6e2b720fb74e5af758546f6dad27e6c9e"},{"fixed":"6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e16163b6e2b720fb74e5af758546f6dad27e6c9e"},{"fixed":"c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b"}]}],"versions":["v5.10","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.19.1","v5.19.2","v5.19.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50071.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["250268043861865639224538396777617541806","336370413127147760331564340405008077950","50136628214059218515612438064845461873","254478114598961340584973601359388659557"],"threshold":0.9},"id":"CVE-2022-50071-0b4907a6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/subflow.c"}},{"deprecated":false,"digest":{"line_hashes":["158092965545724079392855098095499498129","89473384065136485851843994069772030729","23286374900126775884490640571538454358","287656236897815752907358860909282885766","247784394618609524424345302196126248174","15955000450488260726325229988790835564","5588929658071896468335944914909107231","312421193347412021193621138691399109312","50942439851886631032281011698925192523","138042931257866202784878243366402462043","24390494746229946156472764730599146662","314350757874113107929730446799116872047","275032521152338674213852123302675345076","141165988738921320204704083766228675677","14033916853228018137950023104509820116","157855096660887971123869586211826462787","183305448865734324973376824283791231494","155417307164512913304306760835975840221","160376419512765626673169390496274685254","243432523861280306742851559524687223694","110518637166607091375933010983198844076","98065260502485878354221063160180763603","17919426722036544497561595537049163601","71151305858246776870573228187635269918","70647148670361211075594001974727555139","23842313111235317403110294930121136486","226559350206569487669484864224096404764","128693405788779817468393819808374504493","118518388858514703661321241691325666558","131921551268922724124362437874853695529","46824903825780073169262433192664490922","196428298429116682758284738226143443186","50338680495603326967279577082872146213","314900040056978416490280031567410629433","198729351496385987776531957636580079075","32914725363974667371376972221535774786","280231833834041533312542230945142310632","31251083439804424247350861807212235871","306934541221680968492228980713587402454","230468828823025589735826739549845655520","47860155339552266860221286564756407592","50190437112784048234430256098112080274","293733345530165934609513967817714385535"],"threshold":0.9},"id":"CVE-2022-50071-107ae154","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/protocol.c"}},{"deprecated":false,"digest":{"line_hashes":["98529447870674894148912438108990291582","79174805974054824491361631350668496119","313396755408160767990702794016312674609","136368605184385891327837981566154415861"],"threshold":0.9},"id":"CVE-2022-50071-16de2ab4","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/protocol.h"}},{"deprecated":false,"digest":{"line_hashes":["158092965545724079392855098095499498129","89473384065136485851843994069772030729","23286374900126775884490640571538454358","287656236897815752907358860909282885766","247784394618609524424345302196126248174","15955000450488260726325229988790835564","5588929658071896468335944914909107231","312421193347412021193621138691399109312","50942439851886631032281011698925192523","138042931257866202784878243366402462043","24390494746229946156472764730599146662","314350757874113107929730446799116872047","275032521152338674213852123302675345076","141165988738921320204704083766228675677","14033916853228018137950023104509820116","157855096660887971123869586211826462787","183305448865734324973376824283791231494","155417307164512913304306760835975840221","160376419512765626673169390496274685254","243432523861280306742851559524687223694","110518637166607091375933010983198844076","98065260502485878354221063160180763603","17919426722036544497561595537049163601","71151305858246776870573228187635269918","70647148670361211075594001974727555139","23842313111235317403110294930121136486","226559350206569487669484864224096404764","128693405788779817468393819808374504493","118518388858514703661321241691325666558","131921551268922724124362437874853695529","46824903825780073169262433192664490922","196428298429116682758284738226143443186","50338680495603326967279577082872146213","314900040056978416490280031567410629433","198729351496385987776531957636580079075","32914725363974667371376972221535774786","280231833834041533312542230945142310632","31251083439804424247350861807212235871","306934541221680968492228980713587402454","230468828823025589735826739549845655520","47860155339552266860221286564756407592","50190437112784048234430256098112080274","293733345530165934609513967817714385535"],"threshold":0.9},"id":"CVE-2022-50071-1ce87533","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/protocol.c"}},{"deprecated":false,"digest":{"function_hash":"48262656281799788775471416249519696241","length":264},"id":"CVE-2022-50071-1db1ee6f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/subflow.c","function":"mptcp_sock_destruct"}},{"deprecated":false,"digest":{"function_hash":"282165677725500612600099233353103506828","length":427},"id":"CVE-2022-50071-22a2352f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/protocol.c","function":"mptcp_destroy_common"}},{"deprecated":false,"digest":{"function_hash":"48262656281799788775471416249519696241","length":264},"id":"CVE-2022-50071-49a761c4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/subflow.c","function":"mptcp_sock_destruct"}},{"deprecated":false,"digest":{"function_hash":"299332952426296239911528516603435671503","length":118},"id":"CVE-2022-50071-6eadc45b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/protocol.c","function":"mptcp_destroy"}},{"deprecated":false,"digest":{"function_hash":"299332952426296239911528516603435671503","length":118},"id":"CVE-2022-50071-8171f1a4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/protocol.c","function":"mptcp_destroy"}},{"deprecated":false,"digest":{"function_hash":"152320548887360139530064990775913758996","length":657},"id":"CVE-2022-50071-82db2420","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/protocol.c","function":"__mptcp_destroy_sock"}},{"deprecated":false,"digest":{"line_hashes":["98529447870674894148912438108990291582","79174805974054824491361631350668496119","313396755408160767990702794016312674609","136368605184385891327837981566154415861"],"threshold":0.9},"id":"CVE-2022-50071-85481012","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/protocol.h"}},{"deprecated":false,"digest":{"function_hash":"56357920287835943016579647643849739248","length":986},"id":"CVE-2022-50071-a23a7ccb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/protocol.c","function":"mptcp_disconnect"}},{"deprecated":false,"digest":{"function_hash":"282165677725500612600099233353103506828","length":427},"id":"CVE-2022-50071-cae99d31","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/protocol.c","function":"mptcp_destroy_common"}},{"deprecated":false,"digest":{"function_hash":"152320548887360139530064990775913758996","length":657},"id":"CVE-2022-50071-d65df7ba","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693","target":{"file":"net/mptcp/protocol.c","function":"__mptcp_destroy_sock"}},{"deprecated":false,"digest":{"function_hash":"56357920287835943016579647643849739248","length":986},"id":"CVE-2022-50071-e1dd1332","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/protocol.c","function":"mptcp_disconnect"}},{"deprecated":false,"digest":{"line_hashes":["250268043861865639224538396777617541806","336370413127147760331564340405008077950","50136628214059218515612438064845461873","254478114598961340584973601359388659557"],"threshold":0.9},"id":"CVE-2022-50071-e2a2882f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b","target":{"file":"net/mptcp/subflow.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.11.0"},{"fixed":"5.19.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50071.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b"}]}