{"schema_version":"1.7.3","id":"CVE-2023-53303","published":"2025-09-16T08:11:33Z","modified":"2025-10-21T16:11:38.635490Z","summary":"net: microchip: vcap api: Fix possible memory leak for vcap_dup_rule()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnet: microchip: vcap api: Fix possible memory leak for vcap_dup_rule()\n\nInject fault When select CONFIG_VCAP_KUNIT_TEST, the below memory leak\noccurs. If kzalloc() for duprule succeeds, but the following\nkmemdup() fails, the duprule, ckf and caf memory will be leaked. So kfree\nthem in the error path.\n\nunreferenced object 0xffff122744c50600 (size 192):\n  comm \"kunit_try_catch\", pid 346, jiffies 4294896122 (age 911.812s)\n  hex dump (first 32 bytes):\n    10 27 00 00 04 00 00 00 1e 00 00 00 2c 01 00 00  .'..........,...\n    00 00 00 00 00 00 00 00 18 06 c5 44 27 12 ff ff  ...........D'...\n  backtrace:\n    [<00000000394b0db8>] __kmem_cache_alloc_node+0x274/0x2f8\n    [<0000000001bedc67>] kmalloc_trace+0x38/0x88\n    [<00000000b0612f98>] vcap_dup_rule+0x50/0x460\n    [<000000005d2d3aca>] vcap_add_rule+0x8cc/0x1038\n    [<00000000eef9d0f8>] test_vcap_xn_rule_creator.constprop.0.isra.0+0x238/0x494\n    [<00000000cbda607b>] vcap_api_rule_remove_in_front_test+0x1ac/0x698\n    [<00000000c8766299>] kunit_try_run_case+0xe0/0x20c\n    [<00000000c4fe9186>] kunit_generic_run_threadfn_adapter+0x50/0x94\n    [<00000000f6864acf>] kthread+0x2e8/0x374\n    [<0000000022e639b3>] ret_from_fork+0x10/0x20","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"814e7693207f1bd936d600f9b5467f133e3d6e40"},{"fixed":"a26ba60413b2c8f95daf0ee0152cf82abd7bfbe4"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"814e7693207f1bd936d600f9b5467f133e3d6e40"},{"fixed":"281f65d29d6da1a9b6907fb0b145aaf34f4e4822"}]}],"versions":["v6.2","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.5.1","v6.5.2","v6.5.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53303.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"303994217708030728024288469059316630310","length":873},"id":"CVE-2023-53303-3d7047da","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@281f65d29d6da1a9b6907fb0b145aaf34f4e4822","target":{"file":"drivers/net/ethernet/microchip/vcap/vcap_api.c","function":"vcap_dup_rule"}},{"deprecated":false,"digest":{"line_hashes":["226015324547271388311840034034745146943","298974068221330304217937248378416122140","62999454726334839032447011517022283601","117210947976611812620931319850944440484","208837219752011960677341708230255306191","36763897531785669767298126351273967993","202838619125008780675822206764011307874","175623075753275604684697312702019170002","288108735944781764158985118228651116349","138297154717460488855120381696352489114","14649108720388303931632987949059923670","128364853254523785149905010960565927525","214798127372920344544661392832432297519"],"threshold":0.9},"id":"CVE-2023-53303-8d770a71","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a26ba60413b2c8f95daf0ee0152cf82abd7bfbe4","target":{"file":"drivers/net/ethernet/microchip/vcap/vcap_api.c"}},{"deprecated":false,"digest":{"function_hash":"303994217708030728024288469059316630310","length":873},"id":"CVE-2023-53303-9cfc198c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a26ba60413b2c8f95daf0ee0152cf82abd7bfbe4","target":{"file":"drivers/net/ethernet/microchip/vcap/vcap_api.c","function":"vcap_dup_rule"}},{"deprecated":false,"digest":{"line_hashes":["226015324547271388311840034034745146943","298974068221330304217937248378416122140","62999454726334839032447011517022283601","117210947976611812620931319850944440484","208837219752011960677341708230255306191","36763897531785669767298126351273967993","202838619125008780675822206764011307874","175623075753275604684697312702019170002","288108735944781764158985118228651116349","138297154717460488855120381696352489114","14649108720388303931632987949059923670","128364853254523785149905010960565927525","214798127372920344544661392832432297519"],"threshold":0.9},"id":"CVE-2023-53303-d9490866","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@281f65d29d6da1a9b6907fb0b145aaf34f4e4822","target":{"file":"drivers/net/ethernet/microchip/vcap/vcap_api.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.3.0"},{"fixed":"6.5.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53303.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/281f65d29d6da1a9b6907fb0b145aaf34f4e4822"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a26ba60413b2c8f95daf0ee0152cf82abd7bfbe4"}]}