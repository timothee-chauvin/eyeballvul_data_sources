{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26990.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "55387072104228825521737997482659876500",
                "144707919624519973744047330289202053660",
                "134954231499274265978645624691135246637",
                "33812414090177196240032234062307176925",
                "243241513211532406037160625144292964356",
                "201207748364857277334796795574321164310",
                "328776639379537211068069939124167527752",
                "42202190384516066045283934941362275541",
                "233087428952926908080356688553495754161",
                "331441380338762776275638687981507059385",
                "10468123236445589258331115787686383256",
                "183513652304019780573696379267918106853",
                "318182755293282174658797861258588534937",
                "336436525881002475687731636457438345175",
                "12647045798598545291056467648953252994",
                "106425732344888144487596434658834421013",
                "296777941383141544628390444974061821145",
                "319550325130640348253835819952215474154",
                "20806875968841167156176968381681205719",
                "210945184509554704467715723933535360544"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26990-498cb018",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e20bff0f1b2de9cfe303dd35ff46470104a87404",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "55387072104228825521737997482659876500",
                "144707919624519973744047330289202053660",
                "134954231499274265978645624691135246637",
                "33812414090177196240032234062307176925",
                "243241513211532406037160625144292964356",
                "201207748364857277334796795574321164310",
                "328776639379537211068069939124167527752",
                "42202190384516066045283934941362275541",
                "233087428952926908080356688553495754161",
                "331441380338762776275638687981507059385",
                "10468123236445589258331115787686383256",
                "183513652304019780573696379267918106853",
                "318182755293282174658797861258588534937",
                "336436525881002475687731636457438345175",
                "12647045798598545291056467648953252994",
                "106425732344888144487596434658834421013",
                "296777941383141544628390444974061821145",
                "319550325130640348253835819952215474154",
                "20806875968841167156176968381681205719",
                "210945184509554704467715723933535360544"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26990-4e5bc9ea",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2673dfb591a359c75080dd5af3da484b89320d22",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "100669473334691478290167672122240295809",
              "length": 638.0
            },
            "id": "CVE-2024-26990-6d4754a9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e20bff0f1b2de9cfe303dd35ff46470104a87404",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c",
              "function": "clear_dirty_gfn_range"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45591004277328536419655150588791550349",
              "length": 857.0
            },
            "id": "CVE-2024-26990-7ad6b5b6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cdf811a937471af2d1facdf8ae80e5e68096f1ed",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c",
              "function": "clear_dirty_pt_masked"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45591004277328536419655150588791550349",
              "length": 857.0
            },
            "id": "CVE-2024-26990-a597da0f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e20bff0f1b2de9cfe303dd35ff46470104a87404",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c",
              "function": "clear_dirty_pt_masked"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "100669473334691478290167672122240295809",
              "length": 638.0
            },
            "id": "CVE-2024-26990-a908781b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2673dfb591a359c75080dd5af3da484b89320d22",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c",
              "function": "clear_dirty_gfn_range"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "120544134429434857402663478217494213326",
              "length": 596.0
            },
            "id": "CVE-2024-26990-bf3d9b3d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cdf811a937471af2d1facdf8ae80e5e68096f1ed",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c",
              "function": "clear_dirty_gfn_range"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "55387072104228825521737997482659876500",
                "144707919624519973744047330289202053660",
                "134954231499274265978645624691135246637",
                "33812414090177196240032234062307176925",
                "243241513211532406037160625144292964356",
                "201207748364857277334796795574321164310",
                "328776639379537211068069939124167527752",
                "175333789228036966417981094580245276739",
                "16837145786495554925352395044631699602",
                "331441380338762776275638687981507059385",
                "10468123236445589258331115787686383256",
                "183513652304019780573696379267918106853",
                "318182755293282174658797861258588534937",
                "336436525881002475687731636457438345175",
                "12647045798598545291056467648953252994",
                "106425732344888144487596434658834421013",
                "296777941383141544628390444974061821145",
                "319550325130640348253835819952215474154",
                "20806875968841167156176968381681205719",
                "210945184509554704467715723933535360544"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26990-cf4f67c5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cdf811a937471af2d1facdf8ae80e5e68096f1ed",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45591004277328536419655150588791550349",
              "length": 857.0
            },
            "id": "CVE-2024-26990-f1ac27f7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2673dfb591a359c75080dd5af3da484b89320d22",
            "target": {
              "file": "arch/x86/kvm/mmu/tdp_mmu.c",
              "function": "clear_dirty_pt_masked"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5982a5392663b30f57ee90b0372c19a7e9cb655a"
            },
            {
              "fixed": "cdf811a937471af2d1facdf8ae80e5e68096f1ed"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "5982a5392663b30f57ee90b0372c19a7e9cb655a"
            },
            {
              "fixed": "e20bff0f1b2de9cfe303dd35ff46470104a87404"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "5982a5392663b30f57ee90b0372c19a7e9cb655a"
            },
            {
              "fixed": "2673dfb591a359c75080dd5af3da484b89320d22"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.3",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4",
        "v6.8.5",
        "v6.8.6",
        "v6.8.7",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26990.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.4.0"
            },
            {
              "fixed": "6.6.29"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.8.8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: x86/mmu: Write-protect L2 SPTEs in TDP MMU when clearing dirty status\n\nCheck kvm_mmu_page_ad_need_write_protect() when deciding whether to\nwrite-protect or clear D-bits on TDP MMU SPTEs, so that the TDP MMU\naccounts for any role-specific reasons for disabling D-bit dirty logging.\n\nSpecifically, TDP MMU SPTEs must be write-protected when the TDP MMU is\nbeing used to run an L2 (i.e. L1 has disabled EPT) and PML is enabled.\nKVM always disables PML when running L2, even when L1 and L2 GPAs are in\nthe some domain, so failing to write-protect TDP MMU SPTEs will cause\nwrites made by L2 to not be reflected in the dirty log.\n\n[sean: massage shortlog and changelog, tweak ternary op formatting]",
  "id": "CVE-2024-26990",
  "modified": "2025-10-21T19:47:37.327873Z",
  "published": "2024-05-01T05:27:48Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/2673dfb591a359c75080dd5af3da484b89320d22"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/cdf811a937471af2d1facdf8ae80e5e68096f1ed"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e20bff0f1b2de9cfe303dd35ff46470104a87404"
    }
  ],
  "related": [
    "MGASA-2024-0263",
    "MGASA-2024-0266",
    "SUSE-SU-2024:2135-1",
    "SUSE-SU-2024:2203-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "summary": "KVM: x86/mmu: Write-protect L2 SPTEs in TDP MMU when clearing dirty status"
}