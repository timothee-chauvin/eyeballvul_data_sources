{
  "id": "CVE-2023-40271",
  "details": "In Trusted Firmware-M through TF-Mv1.8.0, for platforms that integrate the CryptoCell accelerator, when the CryptoCell PSA Driver software Interface is selected, and the Authenticated Encryption with Associated Data Chacha20-Poly1305 algorithm is used, with the single-part verification function (defined during the build-time configuration phase) implemented with a dedicated function (i.e., not relying on usage of multipart functions), the buffer comparison during the verification of the authentication tag does not happen on the full 16 bytes but just on the first 4 bytes, thus leading to the possibility that unauthenticated payloads might be identified as authentic. This affects TF-Mv1.6.0, TF-Mv1.6.1, TF-Mv1.7.0, and TF-Mv1.8.",
  "modified": "2025-01-14T11:55:31.856427Z",
  "published": "2023-09-08T02:15:08Z",
  "withdrawn": "2025-01-15T01:47:35.752599Z",
  "references": [
    {
      "type": "EVIDENCE",
      "url": "https://git.trustedfirmware.org/TF-M/trusted-firmware-m.git/tree/docs/security/security_advisories/cc3xx_partial_tag_compare_on_chacha20_poly1305.rst"
    },
    {
      "type": "WEB",
      "url": "https://tf-m-user-guide.trustedfirmware.org/releases/index.html"
    }
  ],
  "affected": [
    {
      "ranges": [
        {
          "type": "GIT",
          "repo": "https://git.trustedfirmware.org/TF-M/trusted-firmware-m.git",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "1f6d1dd69193bdfe42c40bb3cec1d91b0cc73080"
            },
            {
              "last_affected": "35ac80c8581d483da7d18cb8bcd20aaed096550c"
            },
            {
              "last_affected": "7387d88158701a3c51ad51c90a05326ee12847a8"
            },
            {
              "last_affected": "b725a1346cdb9ec75b1adcdc4c84705881e8fd4e"
            }
          ]
        }
      ],
      "versions": [
        "TF-Mv1.0",
        "TF-Mv1.0-RC1",
        "TF-Mv1.0-RC2",
        "TF-Mv1.0-RC3",
        "TF-Mv1.1",
        "TF-Mv1.1-RC1",
        "TF-Mv1.1-RC2",
        "TF-Mv1.2-RC1",
        "TF-Mv1.2-RC2",
        "TF-Mv1.2-RC3",
        "TF-Mv1.2.0",
        "TF-Mv1.3.0",
        "TF-Mv1.3.0-RC1",
        "TF-Mv1.3.0-RC2",
        "TF-Mv1.3.0-RC3",
        "TF-Mv1.4.0",
        "TF-Mv1.4.0-RC1",
        "TF-Mv1.4.0-RC2",
        "TF-Mv1.4.0-RC3",
        "TF-Mv1.5.0",
        "TF-Mv1.5.0-RC1",
        "TF-Mv1.5.0-RC2",
        "TF-Mv1.6.0",
        "TF-Mv1.6.0-RC1",
        "TF-Mv1.6.0-RC2",
        "TF-Mv1.6.0-RC3",
        "TF-Mv1.6.0-RC4",
        "TF-Mv1.6.1",
        "v1.0-beta"
      ],
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-40271.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
    }
  ]
}