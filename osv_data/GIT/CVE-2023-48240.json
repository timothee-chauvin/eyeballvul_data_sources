{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-48240.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "681ab3e0311dcb216cf970e2c2535982e077075a"
            },
            {
              "fixed": "46aeee9802007968c5f7cfa3e81ba4334f238025"
            }
          ],
          "repo": "https://github.com/xwiki/xwiki-commons",
          "type": "GIT"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-48240.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "298035680193996182981628145463993219431",
                "18378357981191011076218832285568832712"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-48240-4061bc02",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AllIT.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "207036142821354979040233296172926532379",
                "16897609987507175740099684416338815025",
                "67440695106450996629910683850285406377",
                "183891259699596835318551625396307698738"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-48240-5470fcc4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-api/src/main/java/org/xwiki/security/authentication/AuthenticationConfiguration.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "254749072393888171270831039046877844683",
                "71791414403254761388555917378600977809",
                "59753232574263293621990549165279701978",
                "88646466546052737898954424340442833145",
                "178869696628034503521384978788970254440",
                "118433412072461581284088920417591790344",
                "232348143805459038446536047439213909292",
                "80934402372060670833044401879705450740",
                "122637389109809672498932273567840897541",
                "136629427708303331156946996797907728113",
                "335169234537264977606956162811736708315",
                "77750045521176109009747790811654366091",
                "54499524370896796179719529550406667990"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-48240-5d68f252",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/main/java/org/xwiki/security/authentication/internal/DefaultAuthenticationConfiguration.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "93107920902646841664865145464523812365",
              "length": 358.0
            },
            "id": "CVE-2023-48240-96fe1c09",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-diff/xwiki-platform-diff-xml/src/main/java/org/xwiki/diff/xml/internal/DefaultDataURIConverter.java",
              "function": "convert"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "103580848808142600621421485892290665867",
              "length": 369.0
            },
            "id": "CVE-2023-48240-b8a46a5a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-diff/xwiki-platform-diff-xml/src/main/java/org/xwiki/diff/xml/internal/DefaultDataURIConverter.java",
              "function": "initialize"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "322652354271547476355300404218856718427",
                "324143813456478366400389790512450759149",
                "116279944345318808688487306904094610310",
                "223139154270466597697402881668617479011",
                "289600511416928513921679030836256776128",
                "778767891065808311857653294478715943",
                "192565389655409644287885813676215753556",
                "34249328946474502398256318922792392076",
                "159142714108657503721598651263402693753",
                "213329629908248279017624072054896373055",
                "157824916561464646601129615032871736282",
                "283079492003666257089328783641037642687",
                "168494734924854625356574764823610886494",
                "52006982042294448982602248417663600432",
                "255262741691307632068748234451032773503",
                "83934995343718356820800055203166548986",
                "144753441112241698088622729649622297438",
                "269254015524801713544408047890823106531",
                "90721906245882488768764041586471880370",
                "187737805210196596550697472314775525526",
                "75683810302702913469266537352432817714",
                "35181880885267806206602696180072712591",
                "67111603705479756886798795277395567750",
                "155525726856968088714911943096115713070",
                "193969460931748786450935787400208787376",
                "243247109043309444548984514683449157641",
                "10295713442186589875927395878024824476",
                "244627625360201966224475476283708302539",
                "210279706480330012077590167184791319687",
                "309871142097517517773753100224721992856",
                "113573216864751890510718586988202567219",
                "55710124592560006664858422539703716666",
                "104859862745945879287228119640679895913",
                "136533847618575019736719425595085553637",
                "324510381868870371838184954832036819818",
                "10232185696352814712510481452898843484",
                "47206102941356068209030879717740365016",
                "229713570585285779711465742452017009897",
                "142882410881191037912703984491388789107",
                "179750777094200061579314018286583853017",
                "80172191133405090239408433125040083730",
                "142737380848028657039450920444940970032",
                "103797305303902476182529188148939829367",
                "271277646944468010686778205164354852639",
                "196913926158294302154283452560585071948",
                "18985038126357205391587347260918537352",
                "53415904936674779893518145133770699646",
                "1826539971471198305269769481684311354",
                "3440251827446814485695159657108494353",
                "338876802736672357696711893662746252490",
                "63474592218028622417857581011480378280",
                "13996560078535527688216993381482232455",
                "156491443601052271755441474015015588666",
                "221126410697529404028796233108807838681",
                "94881874917145368282446368933715457142",
                "320384231980496534590305307206281134192",
                "175703596407349736206403208338284876232",
                "190326434773851336923791623488488037751",
                "216445545823859387184792045456124496268",
                "20700004511650038022790647100654819573",
                "144497692371337574513535612543025500387",
                "210969970932120911844912265231421951025",
                "162815175945657291778776852468685075016",
                "3050278692990853736031913082349442498",
                "3065595205165424538072093972663552163",
                "334007008171491829029980054694106561802",
                "304993466903957645551353566878790195246",
                "84369532473161796356852334865070223023",
                "131889600526898003976678842477414008807",
                "128564247719378977083641831536108032111",
                "103705546755983134656977106884001101228",
                "318611999712555560196572903675863362893",
                "80424940230344534010551664368827250268",
                "53281196817824535708201008976403347390",
                "271642309782003830433876363960557870602",
                "174872853864603287413362839635689162675",
                "228354418610271194415627078873076246693",
                "271555448537362821378581428604078426346",
                "175146598721638161963505317573539771194",
                "121823429977652581011595153437823479666",
                "291985027232509836304372192233831562871",
                "268044280363851667961263022986151411692",
                "200117645443063448327893846579451388956",
                "192163090699272839875784328229900312040",
                "47701807221164450618135778217958150573",
                "216838352935309053943216742510058037026",
                "294798973053713918657502664937620969225",
                "149393848776228355271646459424715029819",
                "263734999878610721449347953968170393581",
                "59330176049965448988375358901906886347",
                "81553910568684757289288867578539890140",
                "172768079765246229964669554221703481138",
                "34409010605667126409869090625013938629",
                "142972885732421498636996487012726062113",
                "137446721180266919025864823338291775731",
                "213788454700465264456485778371105169752",
                "46445013451084866876079479296680966640"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-48240-d061951e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-diff/xwiki-platform-diff-xml/src/main/java/org/xwiki/diff/xml/internal/DefaultDataURIConverter.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "9539766637151247903374626257126575424",
              "length": 203.0
            },
            "id": "CVE-2023-48240-db3b80c2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-diff/xwiki-platform-diff-xml/src/main/java/org/xwiki/diff/xml/internal/DefaultDataURIConverter.java",
              "function": "getAbsoluteURI"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "252521596078568947187749702298072101114",
              "length": 406.0
            },
            "id": "CVE-2023-48240-efb8087e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-diff/xwiki-platform-diff-xml/src/main/java/org/xwiki/diff/xml/internal/DefaultDataURIConverter.java",
              "function": "convert"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "11511218818771157652306317613238107528",
              "length": 601.0
            },
            "id": "CVE-2023-48240-fccf43b3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-diff/xwiki-platform-diff-xml/src/main/java/org/xwiki/diff/xml/internal/DefaultDataURIConverter.java",
              "function": "fetch"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "bff0203e739b6e3eb90af5736f04278c73c2a8bb"
            }
          ],
          "repo": "https://github.com/xwiki/xwiki-platform",
          "type": "GIT"
        }
      ],
      "versions": [
        "xwiki-application-calendar-1.0",
        "xwiki-platform-7.3-milestone-2",
        "xwiki-platform-7.4-milestone-1",
        "xwiki-platform-7.4-milestone-2",
        "xwiki-platform-8.0-milestone-1",
        "xwiki-platform-8.0-milestone-2",
        "xwiki-platform-8.1-milestone-1",
        "xwiki-platform-8.1-milestone-2",
        "xwiki-platform-8.2-milestone-1",
        "xwiki-platform-8.2-milestone-2",
        "xwiki-platform-8.3-milestone-1",
        "xwiki-platform-9.9-rc-2",
        "xwiki-plugin-tag-1.1"
      ]
    }
  ],
  "aliases": [
    "GHSA-7rfg-6273-f5wp"
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-201",
      "CWE-281",
      "CWE-918"
    ]
  },
  "details": "XWiki Platform is a generic wiki platform. The rendered diff in XWiki embeds images to be able to compare the contents and not display a difference for an actually unchanged image. For this, XWiki requests all embedded images on the server side. These requests are also sent for images from other domains and include all cookies that were sent in the original request to ensure that images with restricted view right can be compared. Starting in version 11.10.1 and prior to versions 14.10.15, 15.5.1, and 15.6, this allows an attacker to steal login and session cookies that allow impersonating the current user who views the diff. The attack can be triggered with an image that references the rendered diff, thus making it easy to trigger. Apart from stealing login cookies, this also allows server-side request forgery (the result of any successful request is returned in the image's source) and viewing protected content as once a resource is cached, it is returned for all users. As only successful requests are cached, the cache will be filled by the first user who is allowed to access the resource. This has been patched in XWiki 14.10.15, 15.5.1 and 15.6. The rendered diff now only downloads images from trusted domains. Further, cookies are only sent when the image's domain is the same the requested domain. The cache has been changed to be specific for each user. As a workaround, the image embedding feature can be disabled by deleting `xwiki-platform-diff-xml-<version>.jar` in `WEB-INF/lib/`.",
  "id": "CVE-2023-48240",
  "modified": "2025-10-24T04:20:27.075592Z",
  "published": "2023-11-20T17:48:03Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-7rfg-6273-f5wp"
    },
    {
      "type": "FIX",
      "url": "https://github.com/xwiki/xwiki-platform/commit/bff0203e739b6e3eb90af5736f04278c73c2a8bb"
    },
    {
      "type": "WEB",
      "url": "https://jira.xwiki.org/browse/XWIKI-20818"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "XWiki Platform sends cookies to external images in rendered diff and is vulnerable to server side request forgery"
}