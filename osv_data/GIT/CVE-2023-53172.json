{"schema_version":"1.7.3","id":"CVE-2023-53172","published":"2025-09-15T14:04:06.075Z","modified":"2025-11-19T14:58:43.896973Z","summary":"fsverity: reject FS_IOC_ENABLE_VERITY on mode 3 fds","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nfsverity: reject FS_IOC_ENABLE_VERITY on mode 3 fds\n\nCommit 56124d6c87fd (\"fsverity: support enabling with tree block size <\nPAGE_SIZE\") changed FS_IOC_ENABLE_VERITY to use __kernel_read() to read\nthe file's data, instead of direct pagecache accesses.\n\nAn unintended consequence of this is that the\n'WARN_ON_ONCE(!(file->f_mode & FMODE_READ))' in __kernel_read() became\nreachable by fuzz tests.  This happens if FS_IOC_ENABLE_VERITY is called\non a fd opened with access mode 3, which means \"ioctl access only\".\n\nArguably, FS_IOC_ENABLE_VERITY should work on ioctl-only fds.  But\nioctl-only fds are a weird Linux extension that is rarely used and that\nfew people even know about.  (The documentation for FS_IOC_ENABLE_VERITY\neven specifically says it requires O_RDONLY.)  It's probably not\nworthwhile to make the ioctl internally open a new fd just to handle\nthis case.  Thus, just reject the ioctl on such fds for now.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"56124d6c87fd749477425110d2564166621a89c4"},{"fixed":"85c039cff3c359967cafe90443c02321e950b216"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"56124d6c87fd749477425110d2564166621a89c4"},{"fixed":"04839139213cf60d4c5fc792214a08830e294ff8"}]}],"versions":["v6.2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53172.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.3.0"},{"fixed":"6.3.1"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53172.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/04839139213cf60d4c5fc792214a08830e294ff8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/85c039cff3c359967cafe90443c02321e950b216"}]}