{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49274.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "76085373866515557798827368159275791586",
              "length": 2258.0
            },
            "id": "CVE-2022-49274-0cea2d8e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eda31f77317647b9fbf889779ee1fb6907651865",
            "target": {
              "file": "fs/ocfs2/quota_local.c",
              "function": "ocfs2_local_read_info"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "329840176862260797734312178808728686873",
                "338259490252556236949578346906124091520",
                "268683900320854827695521143534176358450",
                "46520210490840964630491822268427246824",
                "334925699901506599862190586546732498416",
                "235340907913446615488772417041327511618",
                "153704732022704782821070367234281954114",
                "248593799449024584036420051409329610411",
                "21924831934455261910956640197078035089",
                "90893565522818494515500895631592245935",
                "301081149168384419179098275062702314910",
                "179788383686226963526022563735392542031",
                "270524895612317475588807348307923384397",
                "115164328033071649713408106484293743752",
                "174379390365980289535960460335433784068",
                "138910782303007800168038640775903017610",
                "196977723764028710839869886397210586404",
                "276245336513843733385619242028264955576",
                "271611006328908476513906203428339235744",
                "45211821966475237136831987483408193528",
                "138099477605506100449503020130293078502",
                "230536559273637323212713474854925255773",
                "300277685413380110061261594881246575462",
                "281822677410092733949481423667677594887",
                "13863012756218383549983254490856508747",
                "80679190811845912671331306584380165174",
                "268791353955385828288051145931268277878",
                "288702030366201730393257183805076605197"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-19a3bd5f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@01931e1c4e3de5d777253acae64c0e8fd071a1dd",
            "target": {
              "file": "fs/ocfs2/quota_global.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "161095714987642033522308503741876469406",
                "127259148067087325280899270425848109318",
                "129481920247143887245648662556312362065",
                "19511226123846373189100599557902467770",
                "1765015327815867194019875825022233055"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-1e1236ab",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7c5312fdb1dcfdc1951b018669af88d5d6420b31",
            "target": {
              "file": "fs/ocfs2/quota_local.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "76085373866515557798827368159275791586",
              "length": 2258.0
            },
            "id": "CVE-2022-49274-4fe918aa",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@de19433423c7bedabbd4f9a25f7dbc62c5e78921",
            "target": {
              "file": "fs/ocfs2/quota_local.c",
              "function": "ocfs2_local_read_info"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "161095714987642033522308503741876469406",
                "127259148067087325280899270425848109318",
                "129481920247143887245648662556312362065",
                "19511226123846373189100599557902467770",
                "1765015327815867194019875825022233055"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-62c1324c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@01931e1c4e3de5d777253acae64c0e8fd071a1dd",
            "target": {
              "file": "fs/ocfs2/quota_local.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "161095714987642033522308503741876469406",
                "127259148067087325280899270425848109318",
                "129481920247143887245648662556312362065",
                "19511226123846373189100599557902467770",
                "1765015327815867194019875825022233055"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-821fb3fb",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@de19433423c7bedabbd4f9a25f7dbc62c5e78921",
            "target": {
              "file": "fs/ocfs2/quota_local.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "141469270556022073215170185144799506165",
              "length": 2093.0
            },
            "id": "CVE-2022-49274-846a5eef",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7c5312fdb1dcfdc1951b018669af88d5d6420b31",
            "target": {
              "file": "fs/ocfs2/quota_global.c",
              "function": "ocfs2_global_read_info"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "329840176862260797734312178808728686873",
                "338259490252556236949578346906124091520",
                "268683900320854827695521143534176358450",
                "46520210490840964630491822268427246824",
                "334925699901506599862190586546732498416",
                "235340907913446615488772417041327511618",
                "153704732022704782821070367234281954114",
                "248593799449024584036420051409329610411",
                "21924831934455261910956640197078035089",
                "90893565522818494515500895631592245935",
                "301081149168384419179098275062702314910",
                "179788383686226963526022563735392542031",
                "270524895612317475588807348307923384397",
                "115164328033071649713408106484293743752",
                "174379390365980289535960460335433784068",
                "138910782303007800168038640775903017610",
                "196977723764028710839869886397210586404",
                "276245336513843733385619242028264955576",
                "271611006328908476513906203428339235744",
                "45211821966475237136831987483408193528",
                "138099477605506100449503020130293078502",
                "230536559273637323212713474854925255773",
                "300277685413380110061261594881246575462",
                "281822677410092733949481423667677594887",
                "13863012756218383549983254490856508747",
                "80679190811845912671331306584380165174",
                "268791353955385828288051145931268277878",
                "288702030366201730393257183805076605197"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-8cec5dda",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@de19433423c7bedabbd4f9a25f7dbc62c5e78921",
            "target": {
              "file": "fs/ocfs2/quota_global.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "76085373866515557798827368159275791586",
              "length": 2258.0
            },
            "id": "CVE-2022-49274-a644ab01",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7c5312fdb1dcfdc1951b018669af88d5d6420b31",
            "target": {
              "file": "fs/ocfs2/quota_local.c",
              "function": "ocfs2_local_read_info"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "141469270556022073215170185144799506165",
              "length": 2093.0
            },
            "id": "CVE-2022-49274-ac6cb2d0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eda31f77317647b9fbf889779ee1fb6907651865",
            "target": {
              "file": "fs/ocfs2/quota_global.c",
              "function": "ocfs2_global_read_info"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "161095714987642033522308503741876469406",
                "127259148067087325280899270425848109318",
                "129481920247143887245648662556312362065",
                "19511226123846373189100599557902467770",
                "1765015327815867194019875825022233055"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-b5a44255",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eda31f77317647b9fbf889779ee1fb6907651865",
            "target": {
              "file": "fs/ocfs2/quota_local.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "141469270556022073215170185144799506165",
              "length": 2093.0
            },
            "id": "CVE-2022-49274-d14783d0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@01931e1c4e3de5d777253acae64c0e8fd071a1dd",
            "target": {
              "file": "fs/ocfs2/quota_global.c",
              "function": "ocfs2_global_read_info"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "76085373866515557798827368159275791586",
              "length": 2258.0
            },
            "id": "CVE-2022-49274-d60d1307",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@01931e1c4e3de5d777253acae64c0e8fd071a1dd",
            "target": {
              "file": "fs/ocfs2/quota_local.c",
              "function": "ocfs2_local_read_info"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "329840176862260797734312178808728686873",
                "338259490252556236949578346906124091520",
                "268683900320854827695521143534176358450",
                "46520210490840964630491822268427246824",
                "334925699901506599862190586546732498416",
                "235340907913446615488772417041327511618",
                "153704732022704782821070367234281954114",
                "248593799449024584036420051409329610411",
                "21924831934455261910956640197078035089",
                "90893565522818494515500895631592245935",
                "301081149168384419179098275062702314910",
                "179788383686226963526022563735392542031",
                "270524895612317475588807348307923384397",
                "115164328033071649713408106484293743752",
                "174379390365980289535960460335433784068",
                "138910782303007800168038640775903017610",
                "196977723764028710839869886397210586404",
                "276245336513843733385619242028264955576",
                "271611006328908476513906203428339235744",
                "45211821966475237136831987483408193528",
                "138099477605506100449503020130293078502",
                "230536559273637323212713474854925255773",
                "300277685413380110061261594881246575462",
                "281822677410092733949481423667677594887",
                "13863012756218383549983254490856508747",
                "80679190811845912671331306584380165174",
                "268791353955385828288051145931268277878",
                "288702030366201730393257183805076605197"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-deff192f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eda31f77317647b9fbf889779ee1fb6907651865",
            "target": {
              "file": "fs/ocfs2/quota_global.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "329840176862260797734312178808728686873",
                "338259490252556236949578346906124091520",
                "268683900320854827695521143534176358450",
                "46520210490840964630491822268427246824",
                "334925699901506599862190586546732498416",
                "235340907913446615488772417041327511618",
                "153704732022704782821070367234281954114",
                "248593799449024584036420051409329610411",
                "21924831934455261910956640197078035089",
                "90893565522818494515500895631592245935",
                "301081149168384419179098275062702314910",
                "179788383686226963526022563735392542031",
                "270524895612317475588807348307923384397",
                "115164328033071649713408106484293743752",
                "174379390365980289535960460335433784068",
                "138910782303007800168038640775903017610",
                "196977723764028710839869886397210586404",
                "276245336513843733385619242028264955576",
                "271611006328908476513906203428339235744",
                "45211821966475237136831987483408193528",
                "138099477605506100449503020130293078502",
                "230536559273637323212713474854925255773",
                "300277685413380110061261594881246575462",
                "281822677410092733949481423667677594887",
                "13863012756218383549983254490856508747",
                "80679190811845912671331306584380165174",
                "268791353955385828288051145931268277878",
                "288702030366201730393257183805076605197"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49274-df8c82da",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7c5312fdb1dcfdc1951b018669af88d5d6420b31",
            "target": {
              "file": "fs/ocfs2/quota_global.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "141469270556022073215170185144799506165",
              "length": 2093.0
            },
            "id": "CVE-2022-49274-fb0cc662",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@de19433423c7bedabbd4f9a25f7dbc62c5e78921",
            "target": {
              "file": "fs/ocfs2/quota_global.c",
              "function": "ocfs2_global_read_info"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6c85c2c728193d19d6a908ae9fb312d0325e65ca"
            },
            {
              "fixed": "7c5312fdb1dcfdc1951b018669af88d5d6420b31"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6c85c2c728193d19d6a908ae9fb312d0325e65ca"
            },
            {
              "fixed": "01931e1c4e3de5d777253acae64c0e8fd071a1dd"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6c85c2c728193d19d6a908ae9fb312d0325e65ca"
            },
            {
              "fixed": "eda31f77317647b9fbf889779ee1fb6907651865"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6c85c2c728193d19d6a908ae9fb312d0325e65ca"
            },
            {
              "fixed": "de19433423c7bedabbd4f9a25f7dbc62c5e78921"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.27",
        "v5.15.28",
        "v5.15.29",
        "v5.15.3",
        "v5.15.30",
        "v5.15.31",
        "v5.15.32",
        "v5.15.4",
        "v5.15.5",
        "v5.15.6",
        "v5.15.7",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.16.1",
        "v5.16.10",
        "v5.16.11",
        "v5.16.12",
        "v5.16.13",
        "v5.16.14",
        "v5.16.15",
        "v5.16.16",
        "v5.16.17",
        "v5.16.18",
        "v5.16.2",
        "v5.16.3",
        "v5.16.4",
        "v5.16.5",
        "v5.16.6",
        "v5.16.7",
        "v5.16.8",
        "v5.16.9",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.17.1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49274.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.15.0"
            },
            {
              "fixed": "5.15.33"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.16.19"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.17.0"
            },
            {
              "fixed": "5.17.2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nocfs2: fix crash when mount with quota enabled\n\nThere is a reported crash when mounting ocfs2 with quota enabled.\n\n  RIP: 0010:ocfs2_qinfo_lock_res_init+0x44/0x50 [ocfs2]\n  Call Trace:\n    ocfs2_local_read_info+0xb9/0x6f0 [ocfs2]\n    dquot_load_quota_sb+0x216/0x470\n    dquot_load_quota_inode+0x85/0x100\n    ocfs2_enable_quotas+0xa0/0x1c0 [ocfs2]\n    ocfs2_fill_super.cold+0xc8/0x1bf [ocfs2]\n    mount_bdev+0x185/0x1b0\n    legacy_get_tree+0x27/0x40\n    vfs_get_tree+0x25/0xb0\n    path_mount+0x465/0xac0\n    __x64_sys_mount+0x103/0x140\n\nIt is caused by when initializing dqi_gqlock, the corresponding dqi_type\nand dqi_sb are not properly initialized.\n\nThis issue is introduced by commit 6c85c2c72819, which wants to avoid\naccessing uninitialized variables in error cases.  So make global quota\ninfo properly initialized.",
  "id": "CVE-2022-49274",
  "modified": "2025-10-21T09:42:31.384298Z",
  "published": "2025-02-26T01:56:19Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/01931e1c4e3de5d777253acae64c0e8fd071a1dd"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7c5312fdb1dcfdc1951b018669af88d5d6420b31"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/de19433423c7bedabbd4f9a25f7dbc62c5e78921"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/eda31f77317647b9fbf889779ee1fb6907651865"
    }
  ],
  "related": [
    "SUSE-SU-2025:1027-1",
    "SUSE-SU-2025:1176-1",
    "SUSE-SU-2025:1183-1",
    "SUSE-SU-2025:1241-1"
  ],
  "schema_version": "1.7.3",
  "summary": "ocfs2: fix crash when mount with quota enabled"
}