{"schema_version":"1.7.3","id":"CVE-2023-53353","published":"2025-09-17T14:56:43Z","modified":"2025-10-21T16:24:31.073186Z","summary":"accel/habanalabs: postpone mem_mgr IDR destruction to hpriv_release()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\naccel/habanalabs: postpone mem_mgr IDR destruction to hpriv_release()\n\nThe memory manager IDR is currently destroyed when user releases the\nfile descriptor.\nHowever, at this point the user context might be still held, and memory\nbuffers might be still in use.\nLater on, calls to release those buffers will fail due to not finding\ntheir handles in the IDR, leading to a memory leak.\nTo avoid this leak, split the IDR destruction from the memory manager\nfini, and postpone it to hpriv_release() when there is no user context\nand no buffers are used.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0feaf86d4e69507ab9b2af7dcc63a6886352d5db"},{"fixed":"840de329ca99cafd0cdde9c6ac160b1330942aba"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0feaf86d4e69507ab9b2af7dcc63a6886352d5db"},{"fixed":"2e8e9a895c4589f124a37fc84d123b5114406e94"}]}],"versions":["v5.0","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.3.1","v6.3.2","v6.3.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53353.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["290491451220813626714378491737625535868","212418474291994686156732025650279698123","90855872921856002540773388828111791452"],"threshold":0.9},"id":"CVE-2023-53353-0761f823","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/memory_mgr.c"}},{"deprecated":false,"digest":{"function_hash":"77310522060798871776730011112175983986","length":2917},"id":"CVE-2023-53353-2877721a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/habanalabs_drv.c","function":"hl_device_open"}},{"deprecated":false,"digest":{"function_hash":"22809416658400124537298092826739492563","length":348},"id":"CVE-2023-53353-462d64e1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/memory_mgr.c","function":"hl_mem_mgr_fini"}},{"deprecated":false,"digest":{"function_hash":"37472277111100367574198937387031726479","length":4272},"id":"CVE-2023-53353-4f16e324","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/device.c","function":"device_early_init"}},{"deprecated":false,"digest":{"line_hashes":["66454978991967411668858697694886250381","68888340494708007638536636718900266631","328313008270591973619821573912444113459","11041642679310286197206707453018253517","112020193723161120275743008330039586445","42340973215122190941912721260419804037","300207238128460475033248146088945752197","91200526880586816506633634987372488011","266452083692132534744072499765649523254","79227454087924855919526521857699777195","34000253264543260349503229337517358571","149105998976113246685480940644245678062","92173162062296860819005007698333120499","208110927889563615555199314614948216555","215477834907495242808445217776000084219"],"threshold":0.9},"id":"CVE-2023-53353-504d4ad6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/device.c"}},{"deprecated":false,"digest":{"line_hashes":["15601526016823499764807384275553244118","302880291731924322793738239117940508772","204667180019067354437196924881374068255","83188964758757293069135785759875621586"],"threshold":0.9},"id":"CVE-2023-53353-60ef2a39","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/habanalabs_drv.c"}},{"deprecated":false,"digest":{"line_hashes":["290491451220813626714378491737625535868","212418474291994686156732025650279698123","90855872921856002540773388828111791452"],"threshold":0.9},"id":"CVE-2023-53353-6a14f32c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/memory_mgr.c"}},{"deprecated":false,"digest":{"function_hash":"94107234587470474748543585992988858604","length":1413},"id":"CVE-2023-53353-70f21477","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/device.c","function":"hpriv_release"}},{"deprecated":false,"digest":{"function_hash":"57207204692066806858153753310181868903","length":2687},"id":"CVE-2023-53353-74d8933f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/habanalabs_drv.c","function":"hl_device_open"}},{"deprecated":false,"digest":{"function_hash":"104221980594587332716383962058929139352","length":783},"id":"CVE-2023-53353-88b74986","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/device.c","function":"device_early_fini"}},{"deprecated":false,"digest":{"line_hashes":["255604796598166082490859600615082620808","67108706536012956333871387010086636649","32660468329071604356001168408313865146","310705975933678142350011118895817489326"],"threshold":0.9},"id":"CVE-2023-53353-950185df","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/habanalabs.h"}},{"deprecated":false,"digest":{"function_hash":"22809416658400124537298092826739492563","length":348},"id":"CVE-2023-53353-a554c52f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/memory_mgr.c","function":"hl_mem_mgr_fini"}},{"deprecated":false,"digest":{"function_hash":"104221980594587332716383962058929139352","length":783},"id":"CVE-2023-53353-ac22c779","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/device.c","function":"device_early_fini"}},{"deprecated":false,"digest":{"line_hashes":["15601526016823499764807384275553244118","302880291731924322793738239117940508772","204667180019067354437196924881374068255","83188964758757293069135785759875621586"],"threshold":0.9},"id":"CVE-2023-53353-ca8202c8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/habanalabs_drv.c"}},{"deprecated":false,"digest":{"function_hash":"276654622071821167457963533742517103090","length":4554},"id":"CVE-2023-53353-cba5869b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/device.c","function":"device_early_init"}},{"deprecated":false,"digest":{"function_hash":"94107234587470474748543585992988858604","length":1413},"id":"CVE-2023-53353-eb64faaa","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/device.c","function":"hpriv_release"}},{"deprecated":false,"digest":{"line_hashes":["66454978991967411668858697694886250381","68888340494708007638536636718900266631","328313008270591973619821573912444113459","11041642679310286197206707453018253517","112020193723161120275743008330039586445","42340973215122190941912721260419804037","300207238128460475033248146088945752197","91200526880586816506633634987372488011","266452083692132534744072499765649523254","79227454087924855919526521857699777195","34000253264543260349503229337517358571","149105998976113246685480940644245678062","92173162062296860819005007698333120499","208110927889563615555199314614948216555","215477834907495242808445217776000084219"],"threshold":0.9},"id":"CVE-2023-53353-f327be6c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@840de329ca99cafd0cdde9c6ac160b1330942aba","target":{"file":"drivers/accel/habanalabs/common/device.c"}},{"deprecated":false,"digest":{"line_hashes":["255604796598166082490859600615082620808","67108706536012956333871387010086636649","32660468329071604356001168408313865146","310705975933678142350011118895817489326"],"threshold":0.9},"id":"CVE-2023-53353-f7da665e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8e9a895c4589f124a37fc84d123b5114406e94","target":{"file":"drivers/accel/habanalabs/common/habanalabs.h"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.1.0"},{"fixed":"6.3.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53353.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2e8e9a895c4589f124a37fc84d123b5114406e94"},{"type":"WEB","url":"https://git.kernel.org/stable/c/840de329ca99cafd0cdde9c6ac160b1330942aba"}]}