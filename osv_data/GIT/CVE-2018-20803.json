{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2018-20803.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "139958858292023220407277851330386797763",
              "length": 2928.0
            },
            "id": "CVE-2018-20803-96149a2d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/mongodb/mongo/commit/a2d97db8fe449d15eb8e275bbf318491781472bf",
            "target": {
              "file": "src/mongo/db/pipeline/expression.cpp",
              "function": "ExpressionPow::evaluateInternal"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "241066996160862899836546099868412052400",
                "21682787457093431054434758350009974422",
                "54529344314333602271013164858774647564"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2018-20803-ec2807dd",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/mongodb/mongo/commit/a2d97db8fe449d15eb8e275bbf318491781472bf",
            "target": {
              "file": "src/mongo/db/pipeline/expression_test.cpp"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "336961664729217287208137723740936276653",
                "20360739389438112206019796318411268586",
                "75297243289586287584631338378497197607",
                "187544480739398440179206210806269569323",
                "1519829466143959752550442959096219224",
                "133016130407300298775490156013360223651",
                "279973954769737135428886499370332096246",
                "139913373305457056017168295693503128162",
                "266381710184734716534425301261464050135",
                "86111653696594601973415674730812517768",
                "278470507623696223510614976337304013851",
                "104658900212543199122940644137032440731",
                "264264968579691905889133191036192135097",
                "11501062621330127501835619250158873971",
                "225269727539852051887058653008360625716",
                "105088911568494449119955270162351863506",
                "154343568969395713107905448438307770735",
                "168060102415266700988951913207970390604",
                "73371893523222233626008413526385999754",
                "297169675525516771532693136177305857563",
                "322555388281726210948915836132827742204",
                "93873689385766518772957378638730470460",
                "191440075756834404248097888413749411569",
                "278217707066359247731537644137144859250",
                "155722989796172006225860264569671152929",
                "56999388806733794552724779361234946731",
                "162956616974662798706394481519200528583",
                "5798029638062157718937825452697146224",
                "264388813643249337812315446123081762538",
                "199899103680757868597596334444260708470",
                "272459752871019654001640355678003188243",
                "174677929913129988363357907665642009474",
                "130063862173406330833817861960280640869",
                "259611833014841500906507705601865229650",
                "241211433128196488527332552486425985846",
                "114708481955328684545615269673560591226",
                "642699901226699385876520020546390507",
                "119589192656044712660438693805405998310",
                "252207656172562204602704323671392657408",
                "147631141055876356476019072940527241612",
                "7619686122713200969642493302134769953",
                "7530825882373265162140542777926780988",
                "195471005399019990048446141302473732902",
                "121293931979710939558414790436630427219",
                "31645819481757698377160488414439779437",
                "243071121899671333131723364774911153161",
                "30749148948744512892229890434460944771",
                "156622976014252529439525485288579272735",
                "156622976014252529439525485288579272735",
                "156622976014252529439525485288579272735",
                "156622976014252529439525485288579272735",
                "156622976014252529439525485288579272735",
                "201151840810529729265724050179351697800",
                "145717671154038164646778287981761169390",
                "229555866389076124315869573308038921223",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "44103920796925696049131345656882061909",
                "4696596228327038249778132106616268253",
                "21933772884539775867773931078892239972",
                "195385489061644947412398166514853202731",
                "264754226590633841173410727400720388933",
                "288566223801949885256275317682118983767",
                "123842215868550579093836884543981768754",
                "257233674237197085937756542338170449725",
                "171541937524020644162809262233879766176",
                "306128509997660105469981129748173391464",
                "71050043367518125411173712206786258685",
                "2879427025408776837660549409897201370",
                "84803977844530288232885702808605949901",
                "296414969697947272795375886172353830204",
                "293886036117787083488749751670878023837",
                "215702363654218543620551195515358481178",
                "258225767492803051591253852387262860269",
                "121408799333289590133711492868170297358",
                "113898132281464208618263865107852707815",
                "47813387314320178327675670713636609821"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2018-20803-ff5e6c75",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/mongodb/mongo/commit/a2d97db8fe449d15eb8e275bbf318491781472bf",
            "target": {
              "file": "src/mongo/db/pipeline/expression.cpp"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f4240c60f005be757399042dc12f6addbc3170c1"
            },
            {
              "fixed": "a2d97db8fe449d15eb8e275bbf318491781472bf"
            }
          ],
          "repo": "https://github.com/mongodb/mongo",
          "type": "GIT"
        }
      ],
      "versions": [
        "r3.4.0",
        "r3.4.1",
        "r3.4.1-rc0",
        "r3.4.10",
        "r3.4.10-rc0",
        "r3.4.11",
        "r3.4.11-rc0",
        "r3.4.12",
        "r3.4.12-rc0",
        "r3.4.13",
        "r3.4.14",
        "r3.4.14-rc0",
        "r3.4.15",
        "r3.4.15-rc0",
        "r3.4.16",
        "r3.4.16-rc0",
        "r3.4.17",
        "r3.4.17-rc0",
        "r3.4.18",
        "r3.4.18-rc0",
        "r3.4.2",
        "r3.4.2-rc0",
        "r3.4.3",
        "r3.4.3-rc0",
        "r3.4.3-rc1",
        "r3.4.3-rc2",
        "r3.4.4",
        "r3.4.4-rc0",
        "r3.4.5",
        "r3.4.5-rc0",
        "r3.4.5-rc1",
        "r3.4.5-rc2",
        "r3.4.5-rc3",
        "r3.4.5-rc4",
        "r3.4.6",
        "r3.4.6-rc0",
        "r3.4.7",
        "r3.4.7-rc0",
        "r3.4.8",
        "r3.4.8-rc0",
        "r3.4.8-rc1",
        "r3.4.9",
        "r3.4.9-rc0"
      ]
    }
  ],
  "details": "A user authorized to perform database queries may trigger denial of service by issuing specially crafted queries, which loop indefinitely in mathematics processing while retaining locks. This issue affects MongoDB Server v4.0 versions prior to 4.0.5; MongoDB Server v3.6 versions prior to 3.6.10 and\u00a0MongoDB Server v3.4 versions prior to 3.4.19.",
  "id": "CVE-2018-20803",
  "modified": "2025-10-21T04:35:33.152525Z",
  "published": "2020-11-23T18:15:10Z",
  "references": [
    {
      "type": "REPORT",
      "url": "https://jira.mongodb.org/browse/SERVER-38070"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ]
}