{
  "id": "CVE-2023-25575",
  "details": "API Platform Core is the server component of API Platform: hypermedia and GraphQL APIs. Resource properties secured with the `security` option of the `ApiPlatform\\Metadata\\ApiProperty` attribute can be disclosed to unauthorized users. The problem affects most serialization formats, including raw JSON, which is enabled by default when installing API Platform. Custom serialization formats may also be impacted. Only collection endpoints are affected by the issue, item endpoints are not. The JSON-LD format is not affected by the issue. The result of the security rule is only executed for the first item of the collection. The result of the rule is then cached and reused for the next items. This bug can leak data to unauthorized users when the rule depends on the value of a property of the item. This bug can also hide properties that should be displayed to authorized users. This issue impacts the 2.7, 3.0 and 3.1 branches. Please upgrade to versions 2.7.10, 3.0.12 or 3.1.3. As a workaround, replace the `cache_key` of the context array of the Serializer inside a custom normalizer that works on objects if the security option of the `ApiPlatform\\Metadata\\ApiProperty` attribute is used.",
  "aliases": [
    "GHSA-vr2x-7687-h6qv"
  ],
  "modified": "2024-05-14T12:45:03.546982Z",
  "published": "2023-02-28T23:15:11Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/api-platform/core/security/advisories/GHSA-vr2x-7687-h6qv"
    },
    {
      "type": "FIX",
      "url": "https://github.com/api-platform/core/commit/5723d68369722feefeb11e42528d9580db5dd0fb"
    }
  ],
  "affected": [
    {
      "ranges": [
        {
          "type": "GIT",
          "repo": "https://github.com/api-platform/core",
          "events": [
            {
              "introduced": "205f59f65f74de82fba07a170f8e6462eaaa8294"
            },
            {
              "introduced": "5cb0508dd86c15fcbf8ef8b9c3012a2c445f4d6f"
            },
            {
              "introduced": "ccc9ed86376fc32f0cdda4edd8705eb577e8d92c"
            },
            {
              "fixed": "5723d68369722feefeb11e42528d9580db5dd0fb"
            }
          ]
        }
      ],
      "versions": [
        "v2.6.0",
        "v2.6.1",
        "v2.6.2",
        "v2.6.3",
        "v2.6.3-alpha.1",
        "v2.6.3.alpha",
        "v2.6.4",
        "v2.6.5",
        "v2.6.6",
        "v2.6.7",
        "v2.6.8",
        "v2.7.0",
        "v2.7.0-alpha.1",
        "v2.7.0-alpha.2",
        "v2.7.0-alpha.3",
        "v2.7.0-alpha.4",
        "v2.7.0-alpha.5",
        "v2.7.0-alpha.6",
        "v2.7.0-alpha.7",
        "v2.7.0-beta.1",
        "v2.7.0-beta.2",
        "v2.7.0-beta.3",
        "v2.7.0-beta.4",
        "v2.7.0-beta.5",
        "v2.7.0-rc.1",
        "v2.7.0-rc.2",
        "v2.7.1",
        "v2.7.2",
        "v2.7.3",
        "v2.7.4",
        "v2.7.5",
        "v2.7.6",
        "v2.7.7",
        "v2.7.8",
        "v2.7.9",
        "v3.0.0"
      ],
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-25575.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
    }
  ]
}