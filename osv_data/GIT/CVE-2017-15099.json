{"schema_version":"1.7.3","id":"CVE-2017-15099","published":"2017-11-22T18:29:00Z","modified":"2025-10-24T03:56:35.472498Z","related":["MGASA-2017-0428","SUSE-SU-2017:3391-1","openSUSE-SU-2024:11184-1"],"details":"INSERT ... ON CONFLICT DO UPDATE commands in PostgreSQL 10.x before 10.1, 9.6.x before 9.6.6, and 9.5.x before 9.5.10 disclose table contents that the invoker lacks privilege to read. These exploits affect only tables where the attacker lacks full read access but has both INSERT and UPDATE privileges. Exploits bypass row level security policies and lack of SELECT privilege.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.postgresql.org/git/postgresql.git","events":[{"introduced":"0"},{"last_affected":"029386ccbddd0a33d481b94e511f5219b03e6636"},{"last_affected":"16e7c02c423449697b78ca857e5847981785e9ed"},{"last_affected":"254bb39b720426f7a4616cb6b40f810c44b24b20"},{"last_affected":"5df0e99bea1c3e5fbffa7fbd0982da88ea149bb6"},{"last_affected":"616eaa396a9bf82d8208a79367d784590be9370d"},{"last_affected":"6a18e4bc2d13d077c52cf90a4c6ec68343808ba7"},{"last_affected":"730811c7d1600b92d4bcb91ac66d2206cf3a06ef"},{"last_affected":"811b6c4a1df5d8323b532460ef2157e771dfb358"},{"last_affected":"8c894c5ff58ff41b59f1ba5c9d487aa9c3073a2f"},{"last_affected":"a721a1ba9cf6c86cb52f1bf325d5a27b64e870d6"},{"last_affected":"aa3bcba08d466bc6fd2558f8f0bf0e6d6c89b58b"},{"last_affected":"ba37ac217791dfdf2b327c4b75e7083b6b03a2f5"},{"last_affected":"bcbbc4cfc9ca163c4a562f24ff9e2fb070647786"},{"last_affected":"ca9cfed883333d5801716eb01cf28b6b5be2b5cd"},{"last_affected":"cdd4ed5449bf317cc71b45a8deee0173822e7592"},{"last_affected":"eb4dfa239e6f54fef5c486caf4b58a9805c19572"},{"last_affected":"eca2f8a7dd9bda862a25fcc57ddf77f7c0dc3afe"}]}],"versions":["PG95-1_01","REL6_1","REL6_1_1","REL6_2","REL6_2_1","REL6_3","REL6_3_2","REL6_5","REL7_0","REL7_1","REL7_1_BETA","REL7_1_BETA2","REL7_1_BETA3","REL7_2","REL7_2_BETA1","REL7_2_BETA2","REL7_2_BETA3","REL7_2_BETA4","REL7_2_BETA5","REL7_2_RC1","REL7_2_RC2","REL7_4_BETA1","REL7_4_BETA2","REL7_4_BETA3","REL7_4_BETA4","REL7_4_BETA5","REL7_4_RC1","REL8_0_0","REL8_0_0BETA1","REL8_0_0BETA2","REL8_0_0BETA3","REL8_0_0BETA4","REL8_0_0BETA5","REL8_0_0RC1","REL8_0_0RC2","REL8_0_0RC3","REL8_0_0RC4","REL8_0_0RC5","REL8_1_0","REL8_1_0BETA1","REL8_1_0BETA2","REL8_1_0BETA3","REL8_1_0BETA4","REL8_1_0RC1","REL8_2_0","REL8_2_BETA1","REL8_2_BETA2","REL8_2_BETA3","REL8_2_RC1","REL8_3_0","REL8_3_BETA1","REL8_3_BETA2","REL8_3_BETA3","REL8_3_BETA4","REL8_3_RC1","REL8_3_RC2","REL8_4_0","REL8_4_BETA1","REL8_4_BETA2","REL8_4_RC1","REL8_4_RC2","REL9_0_ALPHA5","REL9_0_BETA1","REL9_0_BETA2","REL9_0_BETA3","REL9_1_ALPHA1","REL9_1_ALPHA2","REL9_1_ALPHA3","REL9_1_ALPHA4","REL9_1_ALPHA5","REL9_1_BETA1","REL9_1_BETA2","REL9_2_BETA1","REL9_2_BETA2","REL9_3_BETA1","REL9_4_BETA1","REL9_5_0","REL9_5_1","REL9_5_2","REL9_5_3","REL9_5_4","REL9_5_5","REL9_5_6","REL9_5_7","REL9_5_8","REL9_5_ALPHA1","REL9_5_ALPHA2","REL9_5_BETA1","REL9_5_BETA2","REL9_5_RC1","REL9_6_0","REL9_6_1","REL9_6_BETA1","REL9_6_BETA2","REL9_6_BETA3","REL9_6_BETA4","REL9_6_RC1","REL_10_0","REL_10_BETA1","REL_10_BETA2","REL_10_BETA3","REL_10_BETA4","REL_10_RC1","Release_1_0_2","Release_2_0","Release_2_0_0","release-6-3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2017-15099.json"}}],"references":[{"type":"ADVISORY","url":"http://www.securityfocus.com/bid/101781"},{"type":"ADVISORY","url":"http://www.securitytracker.com/id/1039752"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2018:2511"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2018:2566"},{"type":"REPORT","url":"https://www.debian.org/security/2017/dsa-4028"},{"type":"REPORT","url":"https://www.postgresql.org/about/news/1801/"},{"type":"REPORT","url":"https://www.postgresql.org/support/security/"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"}]}