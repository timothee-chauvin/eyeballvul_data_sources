{"schema_version":"1.7.3","id":"CVE-2025-64525","published":"2025-11-13T15:58:16.797Z","modified":"2025-12-05T10:21:45.415320Z","aliases":["GHSA-hr2q-hp5q-x767"],"summary":"Astro: URL manipulation via unsanitized headers leads to path-based middleware protections bypass, potential SSRF/cache-poisoning, CVE-2025-61925 bypass","details":"Astro is a web framework. In Astro versions 2.16.0 up to but excluding 5.15.5 which utilizeon-demand rendering, request headers `x-forwarded-proto` and `x-forwarded-port` are insecurely used, without sanitization, to build the URL. This has several consequences, the most important of which are: middleware-based protected route bypass (only via `x-forwarded-proto`), DoS via cache poisoning (if a CDN is present), SSRF (only via `x-forwarded-proto`), URL pollution (potential SXSS, if a CDN is present), and WAF bypass. Version 5.15.5 contains a patch.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/withastro/astro","events":[{"introduced":"7bf7195f8cb00f52022bd411f9c18ffcc6b345e3"},{"fixed":"ab34340fc7bea4153018bb8b25b5f521cb08566c"}]}],"versions":["@astrojs/language-server@2.16.0","@astrojs/mdx@4.3.10","@astrojs/preact@4.1.3","@astrojs/react@4.4.2","@astrojs/solid-js@5.1.3","@astrojs/svelte@7.2.2","@astrojs/vue@5.1.3","astro-vscode@2.16.0","astro@5.15.3","astro@5.15.4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-64525.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/64xxx/CVE-2025-64525.json"},{"type":"WEB","url":"https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L121"},{"type":"WEB","url":"https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L97"},{"type":"FIX","url":"https://github.com/withastro/astro/commit/dafbb1ba29912099c4faff1440033edc768af8b4"},{"type":"ADVISORY","url":"https://github.com/withastro/astro/security/advisories/GHSA-hr2q-hp5q-x767"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-64525"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-918"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/64xxx/CVE-2025-64525.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L"}]}