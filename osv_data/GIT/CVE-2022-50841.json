{"schema_version":"1.7.3","id":"CVE-2022-50841","published":"2025-12-30T12:10:59.743Z","modified":"2026-01-02T20:57:33.079543Z","summary":"fs/ntfs3: Add overflow check for attribute size","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nfs/ntfs3: Add overflow check for attribute size\n\nThe offset addition could overflow and pass the used size check given an\nattribute with very large size (e.g., 0xffffff7f) while parsing MFT\nattributes. This could lead to out-of-bound memory R/W if we try to\naccess the next attribute derived by Add2Ptr(attr, asize)\n\n[   32.963847] BUG: unable to handle page fault for address: ffff956a83c76067\n[   32.964301] #PF: supervisor read access in kernel mode\n[   32.964526] #PF: error_code(0x0000) - not-present page\n[   32.964893] PGD 4dc01067 P4D 4dc01067 PUD 0\n[   32.965316] Oops: 0000 [#1] PREEMPT SMP NOPTI\n[   32.965727] CPU: 0 PID: 243 Comm: mount Not tainted 5.19.0+ #6\n[   32.966050] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org 04/01/2014\n[   32.966628] RIP: 0010:mi_enum_attr+0x44/0x110\n[   32.967239] Code: 89 f0 48 29 c8 48 89 c1 39 c7 0f 86 94 00 00 00 8b 56 04 83 fa 17 0f 86 88 00 00 00 89 d0 01 ca 48 01 f0 8d 4a 08 39 f9a\n[   32.968101] RSP: 0018:ffffba15c06a7c38 EFLAGS: 00000283\n[   32.968364] RAX: ffff956a83c76067 RBX: ffff956983c76050 RCX: 000000000000006f\n[   32.968651] RDX: 0000000000000067 RSI: ffff956983c760e8 RDI: 00000000000001c8\n[   32.968963] RBP: ffffba15c06a7c38 R08: 0000000000000064 R09: 00000000ffffff7f\n[   32.969249] R10: 0000000000000007 R11: ffff956983c760e8 R12: ffff95698225e000\n[   32.969870] R13: 0000000000000000 R14: ffffba15c06a7cd8 R15: ffff95698225e170\n[   32.970655] FS:  00007fdab8189e40(0000) GS:ffff9569fdc00000(0000) knlGS:0000000000000000\n[   32.971098] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[   32.971378] CR2: ffff956a83c76067 CR3: 0000000002c58000 CR4: 00000000000006f0\n[   32.972098] Call Trace:\n[   32.972842]  <TASK>\n[   32.973341]  ni_enum_attr_ex+0xda/0xf0\n[   32.974087]  ntfs_iget5+0x1db/0xde0\n[   32.974386]  ? slab_post_alloc_hook+0x53/0x270\n[   32.974778]  ? ntfs_fill_super+0x4c7/0x12a0\n[   32.975115]  ntfs_fill_super+0x5d6/0x12a0\n[   32.975336]  get_tree_bdev+0x175/0x270\n[   32.975709]  ? put_ntfs+0x150/0x150\n[   32.975956]  ntfs_fs_get_tree+0x15/0x20\n[   32.976191]  vfs_get_tree+0x2a/0xc0\n[   32.976374]  ? capable+0x19/0x20\n[   32.976572]  path_mount+0x484/0xaa0\n[   32.977025]  ? putname+0x57/0x70\n[   32.977380]  do_mount+0x80/0xa0\n[   32.977555]  __x64_sys_mount+0x8b/0xe0\n[   32.978105]  do_syscall_64+0x3b/0x90\n[   32.978830]  entry_SYSCALL_64_after_hwframe+0x63/0xcd\n[   32.979311] RIP: 0033:0x7fdab72e948a\n[   32.980015] Code: 48 8b 0d 11 fa 2a 00 f7 d8 64 89 01 48 83 c8 ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 49 89 ca b8 a5 00 00 008\n[   32.981251] RSP: 002b:00007ffd15b87588 EFLAGS: 00000206 ORIG_RAX: 00000000000000a5\n[   32.981832] RAX: ffffffffffffffda RBX: 0000557de0aaf060 RCX: 00007fdab72e948a\n[   32.982234] RDX: 0000557de0aaf260 RSI: 0000557de0aaf2e0 RDI: 0000557de0ab7ce0\n[   32.982714] RBP: 0000000000000000 R08: 0000557de0aaf280 R09: 0000000000000020\n[   32.983046] R10: 00000000c0ed0000 R11: 0000000000000206 R12: 0000557de0ab7ce0\n[   32.983494] R13: 0000557de0aaf260 R14: 0000000000000000 R15: 00000000ffffffff\n[   32.984094]  </TASK>\n[   32.984352] Modules linked in:\n[   32.984753] CR2: ffff956a83c76067\n[   32.985911] ---[ end trace 0000000000000000 ]---\n[   32.986555] RIP: 0010:mi_enum_attr+0x44/0x110\n[   32.987217] Code: 89 f0 48 29 c8 48 89 c1 39 c7 0f 86 94 00 00 00 8b 56 04 83 fa 17 0f 86 88 00 00 00 89 d0 01 ca 48 01 f0 8d 4a 08 39 f9a\n[   32.988232] RSP: 0018:ffffba15c06a7c38 EFLAGS: 00000283\n[   32.988532] RAX: ffff956a83c76067 RBX: ffff956983c76050 RCX: 000000000000006f\n[   32.988916] RDX: 0000000000000067 RSI: ffff956983c760e8 RDI: 00000000000001c8\n[   32.989356] RBP: ffffba15c06a7c38 R08: 0000000000000064 R09: 00000000ffffff7f\n[   32.989994] R10: 0000000000000007 R11: ffff956983c760e8 R12: ffff95698225e000\n[   32.990415] R13: 0000000000000000 R14: ffffba15c06a7cd8 R15: ffff95698225e170\n[   32.991011] FS:  \n---truncated---","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4342306f0f0d5ff4315a204d315c1b51b914fca5"},{"fixed":"d4489ba8fb806e07b43eecca5e9af5865d94cbf6"},{"fixed":"a1f0b873cf6ac1f00a749707d866494ed0708978"},{"fixed":"0bb9f93ba63acfdb7c363d9f9fc2199fc6fa913d"},{"fixed":"e19c6277652efba203af4ecd8eed4bd30a0054c9"}]}],"versions":["v5.14","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.34","v5.15.35","v5.15.36","v5.15.37","v5.15.38","v5.15.39","v5.15.4","v5.15.40","v5.15.41","v5.15.42","v5.15.43","v5.15.44","v5.15.45","v5.15.46","v5.15.47","v5.15.48","v5.15.49","v5.15.5","v5.15.50","v5.15.51","v5.15.52","v5.15.53","v5.15.54","v5.15.55","v5.15.56","v5.15.57","v5.15.58","v5.15.59","v5.15.6","v5.15.60","v5.15.61","v5.15.62","v5.15.63","v5.15.64","v5.15.65","v5.15.66","v5.15.67","v5.15.68","v5.15.69","v5.15.7","v5.15.70","v5.15.71","v5.15.72","v5.15.73","v5.15.74","v5.15.75","v5.15.76","v5.15.77","v5.15.78","v5.15.79","v5.15.8","v5.15.80","v5.15.81","v5.15.82","v5.15.83","v5.15.84","v5.15.85","v5.15.86","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.10","v6.0.11","v6.0.12","v6.0.13","v6.0.14","v6.0.15","v6.0.16","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.0.8","v6.0.9","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1","v6.1.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50841.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.15.0"},{"fixed":"5.15.87"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"6.0.17"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.1.0"},{"fixed":"6.1.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50841.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0bb9f93ba63acfdb7c363d9f9fc2199fc6fa913d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a1f0b873cf6ac1f00a749707d866494ed0708978"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d4489ba8fb806e07b43eecca5e9af5865d94cbf6"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e19c6277652efba203af4ecd8eed4bd30a0054c9"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50841.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-50841"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50841.json"}}