{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49082.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "138715177492879707545487565712308250236",
                "168810905721495156331400426354691712321",
                "151932566584958795897361690467742973048",
                "132041809884484188805778612372004380140",
                "90290774052948054474462052689636888232",
                "40239880305746175147592290047233568246",
                "182663802371834049308209531340465624538",
                "150465709304801243253380970917488610922",
                "270658810928179238052389398766804815578",
                "217800669081872265616154200529908151668",
                "68831315591365995888959815197683666200"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49082-17eca391",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1bb8a7fc64d63ec818e367e1b37676ea2ef2d20c",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320496949910039327477368574096815139223",
              "length": 1027.0
            },
            "id": "CVE-2022-49082-557066b0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1bb8a7fc64d63ec818e367e1b37676ea2ef2d20c",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c",
              "function": "_scsih_expander_node_remove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320496949910039327477368574096815139223",
              "length": 1027.0
            },
            "id": "CVE-2022-49082-5f0c868d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@87d663d40801dffc99a5ad3b0188ad3e2b4d1557",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c",
              "function": "_scsih_expander_node_remove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320496949910039327477368574096815139223",
              "length": 1027.0
            },
            "id": "CVE-2022-49082-93345b31",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@25c1353dca74ad7cf3fd7ce258fe7c957a147d5e",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c",
              "function": "_scsih_expander_node_remove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320496949910039327477368574096815139223",
              "length": 1027.0
            },
            "id": "CVE-2022-49082-95aa1ed3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@17d66b1c92bcb41e72271ec60069d3684aaa1c9c",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c",
              "function": "_scsih_expander_node_remove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "138715177492879707545487565712308250236",
                "168810905721495156331400426354691712321",
                "151932566584958795897361690467742973048",
                "132041809884484188805778612372004380140",
                "90290774052948054474462052689636888232",
                "40239880305746175147592290047233568246",
                "182663802371834049308209531340465624538",
                "150465709304801243253380970917488610922",
                "270658810928179238052389398766804815578",
                "217800669081872265616154200529908151668",
                "68831315591365995888959815197683666200"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49082-c548fed5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@87d663d40801dffc99a5ad3b0188ad3e2b4d1557",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "138715177492879707545487565712308250236",
                "168810905721495156331400426354691712321",
                "151932566584958795897361690467742973048",
                "132041809884484188805778612372004380140",
                "90290774052948054474462052689636888232",
                "40239880305746175147592290047233568246",
                "182663802371834049308209531340465624538",
                "150465709304801243253380970917488610922",
                "270658810928179238052389398766804815578",
                "217800669081872265616154200529908151668",
                "68831315591365995888959815197683666200"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49082-d8b666b6",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@25c1353dca74ad7cf3fd7ce258fe7c957a147d5e",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "138715177492879707545487565712308250236",
                "168810905721495156331400426354691712321",
                "151932566584958795897361690467742973048",
                "132041809884484188805778612372004380140",
                "90290774052948054474462052689636888232",
                "40239880305746175147592290047233568246",
                "182663802371834049308209531340465624538",
                "150465709304801243253380970917488610922",
                "270658810928179238052389398766804815578",
                "217800669081872265616154200529908151668",
                "68831315591365995888959815197683666200"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49082-dbe843b5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@17d66b1c92bcb41e72271ec60069d3684aaa1c9c",
            "target": {
              "file": "drivers/scsi/mpt3sas/mpt3sas_scsih.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "7d310f241001e090cf1ec0f3ae836b38d8c6ebec"
            },
            {
              "fixed": "25c1353dca74ad7cf3fd7ce258fe7c957a147d5e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "7d310f241001e090cf1ec0f3ae836b38d8c6ebec"
            },
            {
              "fixed": "17d66b1c92bcb41e72271ec60069d3684aaa1c9c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "7d310f241001e090cf1ec0f3ae836b38d8c6ebec"
            },
            {
              "fixed": "1bb8a7fc64d63ec818e367e1b37676ea2ef2d20c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "7d310f241001e090cf1ec0f3ae836b38d8c6ebec"
            },
            {
              "fixed": "87d663d40801dffc99a5ad3b0188ad3e2b4d1557"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.10",
        "v5.10-rc2",
        "v5.10-rc3",
        "v5.10-rc4",
        "v5.10-rc5",
        "v5.10-rc6",
        "v5.10-rc7",
        "v5.11",
        "v5.11-rc1",
        "v5.11-rc2",
        "v5.11-rc3",
        "v5.11-rc4",
        "v5.11-rc5",
        "v5.11-rc6",
        "v5.11-rc7",
        "v5.12",
        "v5.12-rc1",
        "v5.12-rc1-dontuse",
        "v5.12-rc2",
        "v5.12-rc3",
        "v5.12-rc4",
        "v5.12-rc5",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.27",
        "v5.15.28",
        "v5.15.29",
        "v5.15.3",
        "v5.15.30",
        "v5.15.31",
        "v5.15.32",
        "v5.15.33",
        "v5.15.4",
        "v5.15.5",
        "v5.15.6",
        "v5.15.7",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.16.1",
        "v5.16.10",
        "v5.16.11",
        "v5.16.12",
        "v5.16.13",
        "v5.16.14",
        "v5.16.15",
        "v5.16.16",
        "v5.16.17",
        "v5.16.18",
        "v5.16.19",
        "v5.16.2",
        "v5.16.3",
        "v5.16.4",
        "v5.16.5",
        "v5.16.6",
        "v5.16.7",
        "v5.16.8",
        "v5.16.9",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.17.1",
        "v5.17.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49082.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.11.0"
            },
            {
              "fixed": "5.15.34"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.16.20"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.17.0"
            },
            {
              "fixed": "5.17.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: mpt3sas: Fix use after free in _scsih_expander_node_remove()\n\nThe function mpt3sas_transport_port_remove() called in\n_scsih_expander_node_remove() frees the port field of the sas_expander\nstructure, leading to the following use-after-free splat from KASAN when\nthe ioc_info() call following that function is executed (e.g. when doing\nrmmod of the driver module):\n\n[ 3479.371167] ==================================================================\n[ 3479.378496] BUG: KASAN: use-after-free in _scsih_expander_node_remove+0x710/0x750 [mpt3sas]\n[ 3479.386936] Read of size 1 at addr ffff8881c037691c by task rmmod/1531\n[ 3479.393524]\n[ 3479.395035] CPU: 18 PID: 1531 Comm: rmmod Not tainted 5.17.0-rc8+ #1436\n[ 3479.401712] Hardware name: Supermicro Super Server/H12SSL-NT, BIOS 2.1 06/02/2021\n[ 3479.409263] Call Trace:\n[ 3479.411743]  <TASK>\n[ 3479.413875]  dump_stack_lvl+0x45/0x59\n[ 3479.417582]  print_address_description.constprop.0+0x1f/0x120\n[ 3479.423389]  ? _scsih_expander_node_remove+0x710/0x750 [mpt3sas]\n[ 3479.429469]  kasan_report.cold+0x83/0xdf\n[ 3479.433438]  ? _scsih_expander_node_remove+0x710/0x750 [mpt3sas]\n[ 3479.439514]  _scsih_expander_node_remove+0x710/0x750 [mpt3sas]\n[ 3479.445411]  ? _raw_spin_unlock_irqrestore+0x2d/0x40\n[ 3479.452032]  scsih_remove+0x525/0xc90 [mpt3sas]\n[ 3479.458212]  ? mpt3sas_expander_remove+0x1d0/0x1d0 [mpt3sas]\n[ 3479.465529]  ? down_write+0xde/0x150\n[ 3479.470746]  ? up_write+0x14d/0x460\n[ 3479.475840]  ? kernfs_find_ns+0x137/0x310\n[ 3479.481438]  pci_device_remove+0x65/0x110\n[ 3479.487013]  __device_release_driver+0x316/0x680\n[ 3479.493180]  driver_detach+0x1ec/0x2d0\n[ 3479.498499]  bus_remove_driver+0xe7/0x2d0\n[ 3479.504081]  pci_unregister_driver+0x26/0x250\n[ 3479.510033]  _mpt3sas_exit+0x2b/0x6cf [mpt3sas]\n[ 3479.516144]  __x64_sys_delete_module+0x2fd/0x510\n[ 3479.522315]  ? free_module+0xaa0/0xaa0\n[ 3479.527593]  ? __cond_resched+0x1c/0x90\n[ 3479.532951]  ? lockdep_hardirqs_on_prepare+0x273/0x3e0\n[ 3479.539607]  ? syscall_enter_from_user_mode+0x21/0x70\n[ 3479.546161]  ? trace_hardirqs_on+0x1c/0x110\n[ 3479.551828]  do_syscall_64+0x35/0x80\n[ 3479.556884]  entry_SYSCALL_64_after_hwframe+0x44/0xae\n[ 3479.563402] RIP: 0033:0x7f1fc482483b\n...\n[ 3479.943087] ==================================================================\n\nFix this by introducing the local variable port_id to store the port ID\nvalue before executing mpt3sas_transport_port_remove(). This local variable\nis then used in the call to ioc_info() instead of dereferencing the freed\nport structure.",
  "id": "CVE-2022-49082",
  "modified": "2025-10-14T20:24:09.992776Z",
  "published": "2025-02-26T01:54:42Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/17d66b1c92bcb41e72271ec60069d3684aaa1c9c"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1bb8a7fc64d63ec818e367e1b37676ea2ef2d20c"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/25c1353dca74ad7cf3fd7ce258fe7c957a147d5e"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/87d663d40801dffc99a5ad3b0188ad3e2b4d1557"
    }
  ],
  "related": [
    "SUSE-SU-2025:1027-1",
    "SUSE-SU-2025:1176-1",
    "SUSE-SU-2025:1183-1",
    "SUSE-SU-2025:1194-1",
    "SUSE-SU-2025:1241-1",
    "SUSE-SU-2025:1263-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "scsi: mpt3sas: Fix use after free in _scsih_expander_node_remove()"
}