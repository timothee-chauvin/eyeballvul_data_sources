{"schema_version":"1.7.3","id":"CVE-2024-56624","published":"2024-12-27T14:51:27.318Z","modified":"2025-11-20T07:02:38.145118Z","related":["USN-7379-2","USN-7380-1"],"summary":"iommufd: Fix out_fput in iommufd_fault_alloc()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\niommufd: Fix out_fput in iommufd_fault_alloc()\n\nAs fput() calls the file->f_op->release op, where fault obj and ictx are\ngetting released, there is no need to release these two after fput() one\nmore time, which would result in imbalanced refcounts:\n  refcount_t: decrement hit 0; leaking memory.\n  WARNING: CPU: 48 PID: 2369 at lib/refcount.c:31 refcount_warn_saturate+0x60/0x230\n  Call trace:\n   refcount_warn_saturate+0x60/0x230 (P)\n   refcount_warn_saturate+0x60/0x230 (L)\n   iommufd_fault_fops_release+0x9c/0xe0 [iommufd]\n  ...\n  VFS: Close: file count is 0 (f_op=iommufd_fops [iommufd])\n  WARNING: CPU: 48 PID: 2369 at fs/open.c:1507 filp_flush+0x3c/0xf0\n  Call trace:\n   filp_flush+0x3c/0xf0 (P)\n   filp_flush+0x3c/0xf0 (L)\n   __arm64_sys_close+0x34/0x98\n  ...\n  imbalanced put on file reference count\n  WARNING: CPU: 48 PID: 2369 at fs/file.c:74 __file_ref_put+0x100/0x138\n  Call trace:\n   __file_ref_put+0x100/0x138 (P)\n   __file_ref_put+0x100/0x138 (L)\n   __fput_sync+0x4c/0xd0\n\nDrop those two lines to fix the warnings above.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"07838f7fd529c8a6de44b601d4b7057e6c8d36ed"},{"fixed":"2b3f30c8edbf9a122ce01f13f0f41fbca5f1d41d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"07838f7fd529c8a6de44b601d4b7057e6c8d36ed"},{"fixed":"af7f4780514f850322b2959032ecaa96e4b26472"}]}],"versions":["v6.10","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.2","v6.12.3","v6.12.4","v6.13-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56624.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["201133933214389869207365209265155828509","48546815371032801088879330528293635801","17154678314192657719611386338519288840","46054519517103031150789658257126256838","259120365720777910266281913372512607068"],"threshold":0.9},"id":"CVE-2024-56624-14b49f32","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@af7f4780514f850322b2959032ecaa96e4b26472","target":{"file":"drivers/iommu/iommufd/fault.c"}},{"deprecated":false,"digest":{"function_hash":"9162579243831811206054069076341886525","length":1185},"id":"CVE-2024-56624-18066b48","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@af7f4780514f850322b2959032ecaa96e4b26472","target":{"file":"drivers/iommu/iommufd/fault.c","function":"iommufd_fault_alloc"}},{"deprecated":false,"digest":{"line_hashes":["201133933214389869207365209265155828509","48546815371032801088879330528293635801","17154678314192657719611386338519288840","46054519517103031150789658257126256838","259120365720777910266281913372512607068"],"threshold":0.9},"id":"CVE-2024-56624-64cc233b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2b3f30c8edbf9a122ce01f13f0f41fbca5f1d41d","target":{"file":"drivers/iommu/iommufd/fault.c"}},{"deprecated":false,"digest":{"function_hash":"9162579243831811206054069076341886525","length":1185},"id":"CVE-2024-56624-b52d14a1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2b3f30c8edbf9a122ce01f13f0f41fbca5f1d41d","target":{"file":"drivers/iommu/iommufd/fault.c","function":"iommufd_fault_alloc"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.12.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56624.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2b3f30c8edbf9a122ce01f13f0f41fbca5f1d41d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/af7f4780514f850322b2959032ecaa96e4b26472"}]}