{"schema_version":"1.7.3","id":"CVE-2025-37906","published":"2025-05-20T15:21:39.633Z","modified":"2025-11-20T08:39:35.346577Z","summary":"ublk: fix race between io_uring_cmd_complete_in_task and ublk_cancel_cmd","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nublk: fix race between io_uring_cmd_complete_in_task and ublk_cancel_cmd\n\nublk_cancel_cmd() calls io_uring_cmd_done() to complete uring_cmd, but\nwe may have scheduled task work via io_uring_cmd_complete_in_task() for\ndispatching request, then kernel crash can be triggered.\n\nFix it by not trying to canceling the command if ublk block request is\nstarted.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"216c8f5ef0f209a3797292c487bdaa6991ab4b92"},{"fixed":"fb2eb9ddf556f93fef45201e1f9d2b8674bcc975"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"216c8f5ef0f209a3797292c487bdaa6991ab4b92"},{"fixed":"f40139fde5278d81af3227444fd6e76a76b9506d"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.6","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37906.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"271752798979098057110832853081929286795","length":173},"id":"CVE-2025-37906-5b968ee2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f40139fde5278d81af3227444fd6e76a76b9506d","target":{"file":"drivers/block/ublk_drv.c","function":"ublk_cancel_queue"}},{"deprecated":false,"digest":{"function_hash":"202566693720753283311417873753614733485","length":412},"id":"CVE-2025-37906-81a20db2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f40139fde5278d81af3227444fd6e76a76b9506d","target":{"file":"drivers/block/ublk_drv.c","function":"ublk_cancel_cmd"}},{"deprecated":false,"digest":{"line_hashes":["238074979561376754509184114713083253622","299430584920422110871009415457336572675","262013171335013838330392074901479290838","223640362437637073029921966495694844586","170591014063213562312682750150841354434","97874949143677751815404237452311889489","249570616844075144838083130783794126951","170597658805214252056589854763202648090","38272870081062737621039552498699990185","304065550424304292450995893808394194322","81424488014543167777853098434908359716","184539574355789190611655476802344186393","239627173164802805399638993806166428777","134788671443159717440326717804970783055","14994168104475584140053230074261866559","225182825162415865968295348532372229987","301282047082979069411600825196669395665","108872536646881757067153508196962705446","150355944771350339451451060055854722227","229496398094716794368239511550428398158","98530296325927787106517165853203383363","203599470134293337851489459918123587727","187180887370893976772047819448673203391"],"threshold":0.9},"id":"CVE-2025-37906-9db320de","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f40139fde5278d81af3227444fd6e76a76b9506d","target":{"file":"drivers/block/ublk_drv.c"}},{"deprecated":false,"digest":{"function_hash":"99420117483499459982800634720064684969","length":488},"id":"CVE-2025-37906-bb3d15db","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f40139fde5278d81af3227444fd6e76a76b9506d","target":{"file":"drivers/block/ublk_drv.c","function":"ublk_uring_cmd_cancel_fn"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.14.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37906.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f40139fde5278d81af3227444fd6e76a76b9506d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fb2eb9ddf556f93fef45201e1f9d2b8674bcc975"}]}