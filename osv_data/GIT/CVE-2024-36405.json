{"schema_version":"1.7.3","id":"CVE-2024-36405","published":"2024-06-10T12:47:17Z","modified":"2025-10-27T12:10:47.658303Z","aliases":["GHSA-f2v9-5498-2vpp"],"related":["SUSE-SU-2025:0005-1","openSUSE-SU-2024:14039-1"],"summary":"Control-flow timing leak in Kyber reference implementation when compiled with Clang 15-18 for -Os, -O1 and other options","details":"liboqs is a C-language cryptographic library that provides implementations of post-quantum cryptography algorithms. A control-flow timing lean has been identified in the reference implementation of the Kyber key encapsulation mechanism when it is compiled with Clang 15-18 for `-Os`, `-O1`, and other compilation options. A proof-of-concept local attack on the reference implementation leaks the entire ML-KEM 512 secret key in ~10 minutes using end-to-end decapsulation timing measurements. The issue has been fixed in version 0.10.1. As a possible workaround, some compiler options may produce vectorized code that does not leak secret information, however relying on these compiler options as a workaround may not be reliable.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/open-quantum-safe/liboqs","events":[{"introduced":"0"},{"fixed":"982c762c242ef549c914891b47bf6e0ed6321f91"}]}],"versions":["0.10.0","0.2.0","0.3.0","0.4.0","0.5.0","0.6.0","0.6.0-rc1","0.6.0-rc2","0.6.0-rc3","0.7.0","0.7.0-rc3","0.7.0-rc4","0.7.1","0.7.1-rc1","0.7.2","0.7.2-rc1","0.7.2-rc2","0.8.0","0.8.0-rc1","0.9.0","0.9.0-rc1","ietf116","master-0.1.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-36405.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-089ba014","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-0a431f03","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-0c2f5121","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h"}},{"deprecated":false,"digest":{"function_hash":"318988264785853182587844791599630315127","length":444},"id":"CVE-2024-36405-187b9678","signature_type":"Function","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c","function":"poly_frommsg"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-2cc10014","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-33fb61c8","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["234689300167707083092684360083613531595","146167400202682821831380952758195444065","236930179887150445801603796343847781378","132795227996355397657871530656993888564","98085589001609537616281371573502341052","220137936012977417917610474229036188693","230950984777136591460947291073851511222","152441685494613281378637909075275929112","94291155035070951370862928007735827934","301827595347717556978065680018854490571","234954458262773481690591469489954392452","117445256152861512856057429889126623864","140998155976398254487220450403221579936"],"threshold":0.9},"id":"CVE-2024-36405-34c724c6","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c"}},{"deprecated":false,"digest":{"line_hashes":["234689300167707083092684360083613531595","146167400202682821831380952758195444065","236930179887150445801603796343847781378","132795227996355397657871530656993888564","98085589001609537616281371573502341052","220137936012977417917610474229036188693","230950984777136591460947291073851511222","152441685494613281378637909075275929112","94291155035070951370862928007735827934","301827595347717556978065680018854490571","234954458262773481690591469489954392452","117445256152861512856057429889126623864","140998155976398254487220450403221579936"],"threshold":0.9},"id":"CVE-2024-36405-3a2034c3","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c"}},{"deprecated":false,"digest":{"function_hash":"318988264785853182587844791599630315127","length":444},"id":"CVE-2024-36405-406f8286","signature_type":"Function","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c","function":"poly_frommsg"}},{"deprecated":false,"digest":{"line_hashes":["234689300167707083092684360083613531595","146167400202682821831380952758195444065","236930179887150445801603796343847781378","132795227996355397657871530656993888564","98085589001609537616281371573502341052","220137936012977417917610474229036188693","230950984777136591460947291073851511222","152441685494613281378637909075275929112","94291155035070951370862928007735827934","301827595347717556978065680018854490571","234954458262773481690591469489954392452","117445256152861512856057429889126623864","140998155976398254487220450403221579936"],"threshold":0.9},"id":"CVE-2024-36405-43cca0ef","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c"}},{"deprecated":false,"digest":{"line_hashes":["234689300167707083092684360083613531595","146167400202682821831380952758195444065","236930179887150445801603796343847781378","132795227996355397657871530656993888564","98085589001609537616281371573502341052","220137936012977417917610474229036188693","230950984777136591460947291073851511222","152441685494613281378637909075275929112","94291155035070951370862928007735827934","301827595347717556978065680018854490571","234954458262773481690591469489954392452","117445256152861512856057429889126623864","140998155976398254487220450403221579936"],"threshold":0.9},"id":"CVE-2024-36405-676f22b6","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-75045834","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-7ff444b0","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-825d4f5f","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-aba01a29","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h"}},{"deprecated":false,"digest":{"function_hash":"318988264785853182587844791599630315127","length":444},"id":"CVE-2024-36405-bce5f522","signature_type":"Function","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c","function":"poly_frommsg"}},{"deprecated":false,"digest":{"line_hashes":["234689300167707083092684360083613531595","146167400202682821831380952758195444065","236930179887150445801603796343847781378","132795227996355397657871530656993888564","98085589001609537616281371573502341052","220137936012977417917610474229036188693","230950984777136591460947291073851511222","152441685494613281378637909075275929112","94291155035070951370862928007735827934","301827595347717556978065680018854490571","234954458262773481690591469489954392452","117445256152861512856057429889126623864","140998155976398254487220450403221579936"],"threshold":0.9},"id":"CVE-2024-36405-c4cbbc8c","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-c7561182","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-cef25e27","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h"}},{"deprecated":false,"digest":{"function_hash":"318988264785853182587844791599630315127","length":444},"id":"CVE-2024-36405-dc90322e","signature_type":"Function","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c","function":"poly_frommsg"}},{"deprecated":false,"digest":{"line_hashes":["234689300167707083092684360083613531595","146167400202682821831380952758195444065","236930179887150445801603796343847781378","132795227996355397657871530656993888564","98085589001609537616281371573502341052","220137936012977417917610474229036188693","230950984777136591460947291073851511222","152441685494613281378637909075275929112","94291155035070951370862928007735827934","301827595347717556978065680018854490571","234954458262773481690591469489954392452","117445256152861512856057429889126623864","140998155976398254487220450403221579936"],"threshold":0.9},"id":"CVE-2024-36405-e076e7dc","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c"}},{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-e262c6f7","signature_type":"Line","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h"}},{"deprecated":false,"digest":{"function_hash":"318988264785853182587844791599630315127","length":444},"id":"CVE-2024-36405-e736d74a","signature_type":"Function","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c","function":"poly_frommsg"}},{"deprecated":false,"digest":{"function_hash":"318988264785853182587844791599630315127","length":444},"id":"CVE-2024-36405-f20fb8d7","signature_type":"Function","signature_version":"v1","source":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91","target":{"file":"src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c","function":"poly_frommsg"}}]}},{"ranges":[{"type":"GIT","repo":"https://github.com/pq-crystals/kyber","events":[{"introduced":"0"},{"fixed":"9b8d30698a3e7449aeb34e62339d4176f11e3c6c"}]}],"versions":["v3.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-36405.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["129159944488822175469922892442807990041"],"threshold":0.9},"id":"CVE-2024-36405-16c196d2","signature_type":"Line","signature_version":"v1","source":"https://github.com/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c","target":{"file":"ref/verify.h"}},{"deprecated":false,"digest":{"line_hashes":["234689300167707083092684360083613531595","146167400202682821831380952758195444065","236930179887150445801603796343847781378","132795227996355397657871530656993888564","98085589001609537616281371573502341052","220137936012977417917610474229036188693","230950984777136591460947291073851511222","152441685494613281378637909075275929112","94291155035070951370862928007735827934","301827595347717556978065680018854490571","234954458262773481690591469489954392452","117445256152861512856057429889126623864","140998155976398254487220450403221579936"],"threshold":0.9},"id":"CVE-2024-36405-230f7be1","signature_type":"Line","signature_version":"v1","source":"https://github.com/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c","target":{"file":"ref/poly.c"}},{"deprecated":false,"digest":{"function_hash":"318988264785853182587844791599630315127","length":444},"id":"CVE-2024-36405-c935abed","signature_type":"Function","signature_version":"v1","source":"https://github.com/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c","target":{"file":"ref/poly.c","function":"poly_frommsg"}}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/open-quantum-safe/liboqs/security/advisories/GHSA-f2v9-5498-2vpp"},{"type":"FIX","url":"https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91"},{"type":"FIX","url":"https://github.com/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c"},{"type":"WEB","url":"https://github.com/open-quantum-safe/liboqs/blob/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c#L166"}],"database_specific":{"cwe_ids":["CWE-208","CWE-385"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N"}]}