{"schema_version":"1.7.3","id":"CVE-2025-65110","published":"2026-01-05T21:22:35.941Z","modified":"2026-01-06T02:49:54.294135Z","aliases":["GHSA-829q-m3qg-ph8r"],"summary":"Vega Cross-Site Scripting (XSS) via expression abusing vlSelectionTuples function array map calls in environments with satisfactory function gadgets in the global scope","details":"Vega is a visualization grammar, a declarative format for creating, saving, and sharing interactive visualization designs. Prior to versions 6.1.2 and 5.6.3, applications meeting two conditions are at risk of arbitrary JavaScript code execution, even if \"safe mode\" expressionInterpreter is used. First, they use `vega` in an application that attaches both `vega` library and a `vega.View` instance similar to the Vega Editor to the global `window`, or has any other satisfactory function gadgets in the global scope. Second, they allow user-defined Vega `JSON` definitions (vs JSON that was is only provided through source code). This vulnerability allows for DOM XSS, potentially stored, potentially reflected, depending on how the library is being used. The vulnerability requires user interaction with the page to trigger. An attacker can exploit this issue by tricking a user into opening a malicious Vega specification. Successful exploitation allows the attacker to execute arbitrary JavaScript in the context of the applicationâ€™s domain. This can lead to theft of sensitive information such as authentication tokens, manipulation of data displayed to the user, or execution of unauthorized actions on behalf of the victim. This exploit compromises confidentiality and integrity of impacted applications.Patched versions are available in `vega-selections@6.1.2` (requires ESM) for Vega v6 and `vega-selections@5.6.3` (no ESM needed) for Vega v5. As a workaround, do not attach `vega` or `vega.View` instances to global variables or the window as the editor used to do. This is a development-only debugging practice that should not be used in any situation where Vega/Vega-lite definitions can come from untrusted parties.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/vega/vega","events":[{"introduced":"45ce7657f6212c448be409887018b693a8103fd4"},{"fixed":"18a55af6207fb183510659bdec3922eddc9a6022"}],"database_specific":{"versions":[{"introduced":"6.0.0"},{"fixed":"6.1.2"}]}}],"versions":["v6.0.0","v6.1.0","v6.1.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-65110.json","unresolved_ranges":[{"events":[{"introduced":"0"},{"fixed":"5.6.3"}]}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/65xxx/CVE-2025-65110.json"},{"type":"ADVISORY","url":"https://github.com/vega/vega/security/advisories/GHSA-829q-m3qg-ph8r"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-65110"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-79"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/65xxx/CVE-2025-65110.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N"}]}