{"schema_version":"1.7.3","id":"CVE-2022-24793","published":"2022-04-06T00:00:00Z","modified":"2025-10-22T18:28:09.045220Z","aliases":["GHSA-p6g5-v97c-w5q4"],"summary":"Potential heap buffer overflow when parsing DNS packets in PJSIP","details":"PJSIP is a free and open source multimedia communication library written in C. A buffer overflow vulnerability in versions 2.12 and prior affects applications that use PJSIP DNS resolution. It doesn't affect PJSIP users who utilize an external resolver. This vulnerability is related to CVE-2023-27585. The difference is that this issue is in parsing the query record `parse_rr()`, while the issue in CVE-2023-27585 is in `parse_query()`. A patch is available in the `master` branch of the `pjsip/pjproject` GitHub repository. A workaround is to disable DNS resolution in PJSIP config (by setting `nameserver_count` to zero) or use an external resolver instead.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/pjsip/pjproject","events":[{"introduced":"0"},{"fixed":"9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a"}]}],"versions":["2.10","2.11","2.12"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-24793.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"198495776557130318672044607160917970443","length":938},"id":"CVE-2022-24793-93499a2e","signature_type":"Function","signature_version":"v1","source":"https://github.com/pjsip/pjproject/commit/9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a","target":{"file":"pjlib-util/src/pjlib-util/dns.c","function":"get_name"}},{"deprecated":false,"digest":{"function_hash":"210412158702985084914946177520448558394","length":978},"id":"CVE-2022-24793-cd28ba85","signature_type":"Function","signature_version":"v1","source":"https://github.com/pjsip/pjproject/commit/9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a","target":{"file":"pjlib-util/src/pjlib-util/dns.c","function":"get_name_len"}},{"deprecated":false,"digest":{"function_hash":"163180352893616055095575327660539966113","length":783},"id":"CVE-2022-24793-d335082d","signature_type":"Function","signature_version":"v1","source":"https://github.com/pjsip/pjproject/commit/9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a","target":{"file":"pjlib-util/src/pjlib-util/dns.c","function":"parse_query"}},{"deprecated":false,"digest":{"line_hashes":["283931890585403783740392441174939066844","52462732774442254478866893348553121262","33820061129392376800496017025178908231","330104063948528098712685768623670153634","56143569188339154158711202583752432917","1967015151897079909308842027499246528","24298841527982211154545714781876699568","43813847655333468808587572425015639514","291750048179755166094432050918357816234","283931890585403783740392441174939066844","52462732774442254478866893348553121262","302653091123698002862946071284056368302","184619208182874672857300056619796453217","213404725765458326305176471168734873651","265003271010865074640873752727757005075","326443375720122069282354952012621462214","43813847655333468808587572425015639514","56418702424914331375819953047028438409","335815719307374725570438118390010388614","253939386599957052848001439478990865000","36492054604147735688432640720835652622"],"threshold":0.9},"id":"CVE-2022-24793-fddb2334","signature_type":"Line","signature_version":"v1","source":"https://github.com/pjsip/pjproject/commit/9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a","target":{"file":"pjlib-util/src/pjlib-util/dns.c"}}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/pjsip/pjproject/security/advisories/GHSA-p6g5-v97c-w5q4"},{"type":"ADVISORY","url":"https://security.gentoo.org/glsa/202210-37"},{"type":"ADVISORY","url":"https://www.debian.org/security/2022/dsa-5285"},{"type":"ARTICLE","url":"https://lists.debian.org/debian-lts-announce/2022/05/msg00047.html"},{"type":"ARTICLE","url":"https://lists.debian.org/debian-lts-announce/2022/11/msg00021.html"},{"type":"ARTICLE","url":"https://lists.debian.org/debian-lts-announce/2023/08/msg00038.html"},{"type":"FIX","url":"https://github.com/pjsip/pjproject/commit/9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a"}],"database_specific":{"cwe_ids":["CWE-120"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}