{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49464.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "236036515830488140961891649629195354859",
                "150495830330034177225581675782136589067",
                "282353820691550813755106848634241011766",
                "40010096100933864055392804002704123074",
                "164532410623264446901251574636471609214",
                "240522390772764144735548422265179188534",
                "218370244276760176010991797514825972128",
                "276977896474779397171429144908898635318",
                "201120918390560561092957719735885192458",
                "213790711655420078011573199766382080909",
                "209630754764801117131584732502309302638"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49464-0d00e630",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6b59e1907f58cf877c563dcf013159eb9f994b64",
            "target": {
              "file": "fs/erofs/decompressor.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "236036515830488140961891649629195354859",
                "150495830330034177225581675782136589067",
                "282353820691550813755106848634241011766",
                "40010096100933864055392804002704123074",
                "164532410623264446901251574636471609214",
                "240522390772764144735548422265179188534",
                "218370244276760176010991797514825972128",
                "276977896474779397171429144908898635318",
                "201120918390560561092957719735885192458",
                "213790711655420078011573199766382080909",
                "209630754764801117131584732502309302638"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49464-483d9bbd",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dcbe6803fffd387f72b48c2373b5f5ed12a5804b",
            "target": {
              "file": "fs/erofs/decompressor.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "160243789755671414605281990173963614771",
              "length": 968.0
            },
            "id": "CVE-2022-49464-6f7dd81d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dcbe6803fffd387f72b48c2373b5f5ed12a5804b",
            "target": {
              "file": "fs/erofs/decompressor.c",
              "function": "z_erofs_shifted_transform"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "236036515830488140961891649629195354859",
                "150495830330034177225581675782136589067",
                "282353820691550813755106848634241011766",
                "40010096100933864055392804002704123074",
                "164532410623264446901251574636471609214",
                "240522390772764144735548422265179188534",
                "218370244276760176010991797514825972128",
                "276977896474779397171429144908898635318",
                "201120918390560561092957719735885192458",
                "213790711655420078011573199766382080909",
                "209630754764801117131584732502309302638"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49464-88d6244a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d53a625f29074e7b8236c2c0e0922edb7608df9",
            "target": {
              "file": "fs/erofs/decompressor.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "160243789755671414605281990173963614771",
              "length": 968.0
            },
            "id": "CVE-2022-49464-b43b9985",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d53a625f29074e7b8236c2c0e0922edb7608df9",
            "target": {
              "file": "fs/erofs/decompressor.c",
              "function": "z_erofs_shifted_transform"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "160243789755671414605281990173963614771",
              "length": 968.0
            },
            "id": "CVE-2022-49464-c2993a7f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6b59e1907f58cf877c563dcf013159eb9f994b64",
            "target": {
              "file": "fs/erofs/decompressor.c",
              "function": "z_erofs_shifted_transform"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "ab749badf9f41f32509cd103391b81ea7e684b76"
            },
            {
              "fixed": "4d53a625f29074e7b8236c2c0e0922edb7608df9"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "ab749badf9f41f32509cd103391b81ea7e684b76"
            },
            {
              "fixed": "6b59e1907f58cf877c563dcf013159eb9f994b64"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "ab749badf9f41f32509cd103391b81ea7e684b76"
            },
            {
              "fixed": "dcbe6803fffd387f72b48c2373b5f5ed12a5804b"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.16",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.17.1",
        "v5.17.10",
        "v5.17.11",
        "v5.17.12",
        "v5.17.13",
        "v5.17.2",
        "v5.17.3",
        "v5.17.4",
        "v5.17.5",
        "v5.17.6",
        "v5.17.7",
        "v5.17.8",
        "v5.17.9",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.18.1",
        "v5.18.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49464.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.17.0"
            },
            {
              "fixed": "5.17.14"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "5.18.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: fix buffer copy overflow of ztailpacking feature\n\nI got some KASAN report as below:\n\n[   46.959738] ==================================================================\n[   46.960430] BUG: KASAN: use-after-free in z_erofs_shifted_transform+0x2bd/0x370\n[   46.960430] Read of size 4074 at addr ffff8880300c2f8e by task fssum/188\n...\n[   46.960430] Call Trace:\n[   46.960430]  <TASK>\n[   46.960430]  dump_stack_lvl+0x41/0x5e\n[   46.960430]  print_report.cold+0xb2/0x6b7\n[   46.960430]  ? z_erofs_shifted_transform+0x2bd/0x370\n[   46.960430]  kasan_report+0x8a/0x140\n[   46.960430]  ? z_erofs_shifted_transform+0x2bd/0x370\n[   46.960430]  kasan_check_range+0x14d/0x1d0\n[   46.960430]  memcpy+0x20/0x60\n[   46.960430]  z_erofs_shifted_transform+0x2bd/0x370\n[   46.960430]  z_erofs_decompress_pcluster+0xaae/0x1080\n\nThe root cause is that the tail pcluster won't be a complete filesystem\nblock anymore. So if ztailpacking is used, the second part of an\nuncompressed tail pcluster may not be ``rq->pageofs_out``.",
  "id": "CVE-2022-49464",
  "modified": "2025-10-21T10:10:22.257245Z",
  "published": "2025-02-26T02:13:10Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/4d53a625f29074e7b8236c2c0e0922edb7608df9"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6b59e1907f58cf877c563dcf013159eb9f994b64"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/dcbe6803fffd387f72b48c2373b5f5ed12a5804b"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "erofs: fix buffer copy overflow of ztailpacking feature"
}