{
  "id": "CVE-2023-36456",
  "details": "authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.\n\nThis poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.\n\nVersions 2023.4.3 and 2023.5.5 contain a patch for this issue.\n",
  "aliases": [
    "GHSA-cmxp-jcw7-jjjv"
  ],
  "modified": "2024-05-14T11:43:35.967901Z",
  "published": "2023-07-06T19:15:10Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/goauthentik/authentik/security/advisories/GHSA-cmxp-jcw7-jjjv"
    },
    {
      "type": "FIX",
      "url": "https://github.com/goauthentik/authentik/commit/15026748d19d490eb2baf9a9566ead4f805f7dff"
    },
    {
      "type": "FIX",
      "url": "https://github.com/goauthentik/authentik/commit/c07a48a3eccbd7b23026f72136d3392bbc6f795a"
    },
    {
      "type": "WEB",
      "url": "https://goauthentik.io/docs/releases/2023.4#fixed-in-202343"
    },
    {
      "type": "WEB",
      "url": "https://goauthentik.io/docs/releases/2023.5#fixed-in-202355"
    }
  ],
  "affected": [
    {
      "ranges": [
        {
          "type": "GIT",
          "repo": "https://github.com/goauthentik/authentik",
          "events": [
            {
              "introduced": "8faec99bd66fda7ee269bc21ec0cc37fc1a578d7"
            },
            {
              "fixed": "15026748d19d490eb2baf9a9566ead4f805f7dff"
            },
            {
              "fixed": "c07a48a3eccbd7b23026f72136d3392bbc6f795a"
            }
          ]
        }
      ],
      "versions": [
        "version/2023.5.0",
        "version/2023.5.1",
        "version/2023.5.2",
        "version/2023.5.3",
        "version/2023.5.4"
      ],
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-36456.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L"
    }
  ]
}