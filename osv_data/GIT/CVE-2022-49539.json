{"schema_version":"1.7.3","id":"CVE-2022-49539","published":"2025-02-26T02:13:55Z","modified":"2025-10-21T10:14:19.652155Z","summary":"rtw89: ser: fix CAM leaks occurring in L2 reset","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nrtw89: ser: fix CAM leaks occurring in L2 reset\n\nThe CAM, meaning address CAM and bssid CAM here, will get leaks during\nSER (system error recover) L2 reset process and ieee80211_restart_hw()\nwhich is called by L2 reset process eventually.\n\nThe normal flow would be like\n-> add interface (acquire 1)\n-> enter ips (release 1)\n-> leave ips (acquire 1)\n-> connection (occupy 1) <(A) 1 leak after L2 reset if non-sec connection>\n\nThe ieee80211_restart_hw() flow (under connection)\n-> ieee80211 reconfig\n-> add interface (acquire 1)\n-> leave ips (acquire 1)\n-> connection (occupy (A) + 2) <(B) 1 more leak>\n\nOriginally, CAM is released before HW restart only if connection is under\nsecurity. Now, release CAM whatever connection it is to fix leak in (A).\nOTOH, check if CAM is already valid to avoid acquiring multiple times to\nfix (B).\n\nBesides, if AP mode, release address CAM of all stations before HW restart.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e3ec7017f6a20d12ddd9fe23d345ebb7b8c104dd"},{"fixed":"f6aff772c9978844529618d86aafb53e5d3ae161"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e3ec7017f6a20d12ddd9fe23d345ebb7b8c104dd"},{"fixed":"b169f877f001a474fb89939842c390518160bcc5"}]}],"versions":["v5.15","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.18.1","v5.18.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49539.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"242123492443228769914205363856964949634","length":703},"id":"CVE-2022-49539-0efe8934","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b169f877f001a474fb89939842c390518160bcc5","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c","function":"rtw89_cam_init_addr_cam"}},{"deprecated":false,"digest":{"line_hashes":["297213909006213761492796119094311037195","6211393239731535108193666137253239380","293335105721325369981982205748444307913","223018339900978920204797437063288293863","123403527537348979603398653503492354817","182725378552473725348286219840287530842","48449379349258973105556764866005995454"],"threshold":0.9},"id":"CVE-2022-49539-3f78fa7c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6aff772c9978844529618d86aafb53e5d3ae161","target":{"file":"drivers/net/wireless/realtek/rtw89/ser.c"}},{"deprecated":false,"digest":{"function_hash":"46152952159159870476877747566324028555","length":425},"id":"CVE-2022-49539-41008aea","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b169f877f001a474fb89939842c390518160bcc5","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c","function":"rtw89_cam_init_bssid_cam"}},{"deprecated":false,"digest":{"line_hashes":["193234159149452472543293123345343716106","252352625785535920239463927519215845200","35240685517833498434005048422034006696","184327700455132691024853671733879885435","176174878005180764222521493972084595369","97222202774614246636821165264031486676","212869200269695990421400716510237113401","48472884814151645110156479994326395704","7963877577158482090991705471266441033","237330653010110910378830507836772054378","276842468830673007654220963813511301845","308417819194221269163943717874593374412"],"threshold":0.9},"id":"CVE-2022-49539-4c2d47dd","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6aff772c9978844529618d86aafb53e5d3ae161","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c"}},{"deprecated":false,"digest":{"function_hash":"106057099724657482652810582799034651915","length":263},"id":"CVE-2022-49539-6494605b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6aff772c9978844529618d86aafb53e5d3ae161","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c","function":"rtw89_cam_reset_key_iter"}},{"deprecated":false,"digest":{"line_hashes":["297213909006213761492796119094311037195","6211393239731535108193666137253239380","293335105721325369981982205748444307913","223018339900978920204797437063288293863","123403527537348979603398653503492354817","182725378552473725348286219840287530842","48449379349258973105556764866005995454"],"threshold":0.9},"id":"CVE-2022-49539-71f5bed5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b169f877f001a474fb89939842c390518160bcc5","target":{"file":"drivers/net/wireless/realtek/rtw89/ser.c"}},{"deprecated":false,"digest":{"function_hash":"310000665020755685389964795460173395893","length":201},"id":"CVE-2022-49539-795cbe75","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b169f877f001a474fb89939842c390518160bcc5","target":{"file":"drivers/net/wireless/realtek/rtw89/ser.c","function":"ser_reset_mac_binding"}},{"deprecated":false,"digest":{"function_hash":"242123492443228769914205363856964949634","length":703},"id":"CVE-2022-49539-b1a4d898","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6aff772c9978844529618d86aafb53e5d3ae161","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c","function":"rtw89_cam_init_addr_cam"}},{"deprecated":false,"digest":{"function_hash":"46152952159159870476877747566324028555","length":425},"id":"CVE-2022-49539-b7fadb41","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6aff772c9978844529618d86aafb53e5d3ae161","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c","function":"rtw89_cam_init_bssid_cam"}},{"deprecated":false,"digest":{"function_hash":"310000665020755685389964795460173395893","length":201},"id":"CVE-2022-49539-be429407","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6aff772c9978844529618d86aafb53e5d3ae161","target":{"file":"drivers/net/wireless/realtek/rtw89/ser.c","function":"ser_reset_mac_binding"}},{"deprecated":false,"digest":{"function_hash":"106057099724657482652810582799034651915","length":263},"id":"CVE-2022-49539-bfc51c9c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b169f877f001a474fb89939842c390518160bcc5","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c","function":"rtw89_cam_reset_key_iter"}},{"deprecated":false,"digest":{"line_hashes":["193234159149452472543293123345343716106","252352625785535920239463927519215845200","35240685517833498434005048422034006696","184327700455132691024853671733879885435","176174878005180764222521493972084595369","97222202774614246636821165264031486676","212869200269695990421400716510237113401","48472884814151645110156479994326395704","7963877577158482090991705471266441033","237330653010110910378830507836772054378","276842468830673007654220963813511301845","308417819194221269163943717874593374412"],"threshold":0.9},"id":"CVE-2022-49539-cda0e713","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b169f877f001a474fb89939842c390518160bcc5","target":{"file":"drivers/net/wireless/realtek/rtw89/cam.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.18.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49539.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b169f877f001a474fb89939842c390518160bcc5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f6aff772c9978844529618d86aafb53e5d3ae161"}]}