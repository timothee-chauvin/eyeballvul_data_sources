{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-3716.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "17736055569549823576078601167558441071",
                "252569956524523289579052347941166243611",
                "297470718666234456831894338929195417055"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2021-3716-07c259cd",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://gitlab.com/nbdkit/nbdkit@09a13dafb7bb3a38ab52eb5501cba786365ba7fd",
            "target": {
              "file": "server/protocol-handshake-newstyle.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "333482206296967489735886764046295964344",
                "119471980424718382355237920729822312416",
                "354708292059306544598635409003669673",
                "204350468158886587735548122882836647246"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2021-3716-37e6bdf7",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://gitlab.com/nbdkit/nbdkit@6c5faac6a37077cf2366388a80862bb00616d0d8",
            "target": {
              "file": "server/protocol-handshake-newstyle.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "278656485481587851966178619826305884851",
              "length": 9714.0
            },
            "id": "CVE-2021-3716-72881b3f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://gitlab.com/nbdkit/nbdkit@09a13dafb7bb3a38ab52eb5501cba786365ba7fd",
            "target": {
              "file": "server/protocol-handshake-newstyle.c",
              "function": "negotiate_handshake_newstyle_options"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "107471052006344028215705987130228423204",
              "length": 9751.0
            },
            "id": "CVE-2021-3716-82631061",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://gitlab.com/nbdkit/nbdkit@6c5faac6a37077cf2366388a80862bb00616d0d8",
            "target": {
              "file": "server/protocol-handshake-newstyle.c",
              "function": "negotiate_handshake_newstyle_options"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "09a13dafb7bb3a38ab52eb5501cba786365ba7fd"
            },
            {
              "fixed": "6c5faac6a37077cf2366388a80862bb00616d0d8"
            }
          ],
          "repo": "https://gitlab.com/nbdkit/nbdkit",
          "type": "GIT"
        }
      ],
      "versions": [
        "1.1.11",
        "v0.1.0",
        "v1.0.0",
        "v1.1.1",
        "v1.1.10",
        "v1.1.11",
        "v1.1.12",
        "v1.1.13",
        "v1.1.14",
        "v1.1.15",
        "v1.1.16",
        "v1.1.17",
        "v1.1.18",
        "v1.1.19",
        "v1.1.2",
        "v1.1.20",
        "v1.1.21",
        "v1.1.22",
        "v1.1.23",
        "v1.1.24",
        "v1.1.25",
        "v1.1.26",
        "v1.1.27",
        "v1.1.28",
        "v1.1.3",
        "v1.1.4",
        "v1.1.5",
        "v1.1.6",
        "v1.1.7",
        "v1.1.8",
        "v1.1.9",
        "v1.10.0",
        "v1.11.1",
        "v1.11.10",
        "v1.11.11",
        "v1.11.12",
        "v1.11.13",
        "v1.11.14",
        "v1.11.15",
        "v1.11.2",
        "v1.11.3",
        "v1.11.4",
        "v1.11.5",
        "v1.11.6",
        "v1.11.7",
        "v1.11.8",
        "v1.11.9",
        "v1.12.0",
        "v1.13.0",
        "v1.13.1",
        "v1.13.2",
        "v1.13.3",
        "v1.13.4",
        "v1.13.5",
        "v1.13.6",
        "v1.13.7",
        "v1.13.8",
        "v1.13.9",
        "v1.14.0",
        "v1.15.1",
        "v1.15.2",
        "v1.15.3",
        "v1.15.4",
        "v1.15.5",
        "v1.15.6",
        "v1.15.7",
        "v1.15.8",
        "v1.16.0",
        "v1.17.1",
        "v1.17.10",
        "v1.17.11",
        "v1.17.2",
        "v1.17.3",
        "v1.17.4",
        "v1.17.5",
        "v1.17.6",
        "v1.17.7",
        "v1.17.8",
        "v1.17.9",
        "v1.18.0",
        "v1.19.1",
        "v1.19.10",
        "v1.19.11",
        "v1.19.12",
        "v1.19.2",
        "v1.19.3",
        "v1.19.4",
        "v1.19.5",
        "v1.19.6",
        "v1.19.7",
        "v1.19.8",
        "v1.19.9",
        "v1.20.0",
        "v1.21.1",
        "v1.21.10",
        "v1.21.11",
        "v1.21.12",
        "v1.21.13",
        "v1.21.14",
        "v1.21.15",
        "v1.21.16",
        "v1.21.17",
        "v1.21.18",
        "v1.21.19",
        "v1.21.2",
        "v1.21.20",
        "v1.21.21",
        "v1.21.22",
        "v1.21.23",
        "v1.21.24",
        "v1.21.25",
        "v1.21.26",
        "v1.21.3",
        "v1.21.4",
        "v1.21.5",
        "v1.21.6",
        "v1.21.7",
        "v1.21.8",
        "v1.21.9",
        "v1.23.1",
        "v1.23.10",
        "v1.23.11",
        "v1.23.12",
        "v1.23.13",
        "v1.23.2",
        "v1.23.3",
        "v1.23.4",
        "v1.23.5",
        "v1.23.6",
        "v1.23.7",
        "v1.23.8",
        "v1.23.9",
        "v1.24.0",
        "v1.25.1",
        "v1.25.2",
        "v1.25.3",
        "v1.25.4",
        "v1.25.5",
        "v1.25.6",
        "v1.25.7",
        "v1.25.8",
        "v1.25.9",
        "v1.26.0",
        "v1.27.1",
        "v1.27.2",
        "v1.27.3",
        "v1.27.4",
        "v1.27.5",
        "v1.3.0",
        "v1.3.1",
        "v1.3.2",
        "v1.3.3",
        "v1.3.4",
        "v1.4.0",
        "v1.5.0",
        "v1.5.1",
        "v1.5.10",
        "v1.5.2",
        "v1.5.3",
        "v1.5.4",
        "v1.5.5",
        "v1.5.6",
        "v1.5.7",
        "v1.5.8",
        "v1.5.9",
        "v1.6.0",
        "v1.7.0",
        "v1.7.1",
        "v1.7.10",
        "v1.7.2",
        "v1.7.3",
        "v1.7.4",
        "v1.7.5",
        "v1.7.6",
        "v1.7.7",
        "v1.7.8",
        "v1.7.9",
        "v1.8.0",
        "v1.9.0",
        "v1.9.1",
        "v1.9.10",
        "v1.9.2",
        "v1.9.3",
        "v1.9.4",
        "v1.9.5",
        "v1.9.6",
        "v1.9.7",
        "v1.9.8",
        "v1.9.9"
      ]
    }
  ],
  "details": "A flaw was found in nbdkit due to to improperly caching plaintext state across the STARTTLS encryption boundary. A MitM attacker could use this flaw to inject a plaintext NBD_OPT_STRUCTURED_REPLY before proxying everything else a client sends to the server, potentially leading the client to terminate the NBD session. The highest threat from this vulnerability is to system availability.",
  "id": "CVE-2021-3716",
  "modified": "2025-10-10T03:23:57.318079Z",
  "published": "2022-03-02T23:15:09Z",
  "references": [
    {
      "type": "REPORT",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1994695"
    },
    {
      "type": "FIX",
      "url": "https://gitlab.com/nbdkit/nbdkit/-/commit/09a13dafb7bb3a38ab52eb5501cba786365ba7fd"
    },
    {
      "type": "FIX",
      "url": "https://gitlab.com/nbdkit/nbdkit/-/commit/6c5faac6a37077cf2366388a80862bb00616d0d8"
    },
    {
      "type": "ARTICLE",
      "url": "https://www.openwall.com/lists/oss-security/2021/08/18/2"
    },
    {
      "type": "WEB",
      "url": "https://listman.redhat.com/archives/libguestfs/2021-August/msg00083.html"
    }
  ],
  "related": [
    "ALSA-2022:1759",
    "RLSA-2022:1759",
    "openSUSE-SU-2024:11078-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
      "type": "CVSS_V3"
    }
  ]
}