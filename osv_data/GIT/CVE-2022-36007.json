{"schema_version":"1.7.3","id":"CVE-2022-36007","published":"2022-08-14T00:25:10Z","modified":"2025-12-04T10:29:58.863071Z","aliases":["GHSA-4mmh-5vw7-rgvj"],"summary":"Partial Path Traversal in com.github.jlangch:venice","details":"Venice is a Clojure inspired sandboxed Lisp dialect with excellent Java interoperability. A partial path traversal issue exists within the functions `load-file` and `load-resource`. These functions can be limited to load files from a list of load paths. Assuming Venice has been configured with the load paths: `[ \"/Users/foo/resources\" ]` When passing **relative** paths to these two vulnerable functions everything is fine: `(load-resource \"test.png\")` => loads the file \"/Users/foo/resources/test.png\" `(load-resource \"../resources-alt/test.png\")` => rejected, outside the load path When passing **absolute** paths to these two vulnerable functions Venice may return files outside the configured load paths: `(load-resource \"/Users/foo/resources/test.png\")` => loads the file \"/Users/foo/resources/test.png\" `(load-resource \"/Users/foo/resources-alt/test.png\")` => loads the file \"/Users/foo/resources-alt/test.png\" !!! The latter call suffers from the _Partial Path Traversal_ vulnerability. This issueâ€™s scope is limited to absolute paths whose name prefix matches a load path. E.g. for a load-path `\"/Users/foo/resources\"`, the actor can cause loading a resource also from `\"/Users/foo/resources-alt\"`, but not from `\"/Users/foo/images\"`. Versions of Venice before and including v1.10.17 are affected by this issue. Upgrade to Venice >= 1.10.18, if you are on a version < 1.10.18. There are currently no known workarounds.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/jlangch/venice","events":[{"introduced":"0"},{"fixed":"c942c73136333bc493050910f171a48e6f575b23"}]}],"versions":["0.9.10","0.9.8","1.10.8","v0.7.0","v0.7.1","v0.7.2","v0.8.0","v0.8.1","v0.8.2","v0.8.3","v0.8.4","v0.8.5","v0.9.0","v0.9.1","v0.9.12","v0.9.2","v0.9.3","v0.9.4","v0.9.5","v0.9.6","v0.9.7","v0.9.9","v1.0.0","v1.1.0","v1.1.1","v1.1.1-pre","v1.1.2","v1.1.3","v1.10.0","v1.10.1","v1.10.10","v1.10.11","v1.10.12","v1.10.13","v1.10.14","v1.10.15","v1.10.16","v1.10.2","v1.10.3","v1.10.4","v1.10.5","v1.10.6","v1.10.7","v1.10.9","v1.2.0","v1.2.1","v1.2.2","v1.3.0","v1.3.1","v1.3.2","v1.3.3","v1.3.4","v1.3.5","v1.3.6","v1.4.0","v1.4.1","v1.4.2","v1.4.3","v1.4.4","v1.4.5","v1.5.0","v1.5.1","v1.5.10","v1.5.11","v1.5.2","v1.5.3","v1.5.4","v1.5.5","v1.5.6","v1.5.7","v1.5.8","v1.5.9","v1.6.0","v1.6.1","v1.6.2","v1.6.3","v1.7.0","v1.7.1","v1.7.10","v1.7.11","v1.7.12","v1.7.13","v1.7.14","v1.7.15","v1.7.16","v1.7.17","v1.7.18","v1.7.19","v1.7.2","v1.7.20","v1.7.21","v1.7.22","v1.7.23","v1.7.24","v1.7.25","v1.7.26","v1.7.27","v1.7.28","v1.7.29","v1.7.3","v1.7.4","v1.7.5","v1.7.6","v1.7.7","v1.7.8","v1.7.9","v1.8.0","v1.8.1","v1.8.10","v1.8.11","v1.8.12","v1.8.13","v1.8.2","v1.8.3","v1.8.4","v1.8.5","v1.8.6","v1.8.7","v1.8.8","v1.8.9","v1.9.0","v1.9.1","v1.9.10","v1.9.11","v1.9.12","v1.9.13","v1.9.14","v1.9.15","v1.9.16","v1.9.17","v1.9.18","v1.9.19","v1.9.2","v1.9.20","v1.9.21","v1.9.22","v1.9.23","v1.9.24","v1.9.25","v1.9.26","v1.9.27","v1.9.28","v1.9.29","v1.9.3","v1.9.30","v1.9.31","v1.9.4","v1.9.5","v1.9.6","v1.9.7","v1.9.8","v1.9.9"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-36007.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["108898020225078872135214237211846103605","320940117593494428855040632200413588364","6466072299579698142389869701617685677","312049323961631633786917566869076141611"],"threshold":0.9},"id":"CVE-2022-36007-43381d1e","signature_type":"Line","signature_version":"v1","source":"https://github.com/jlangch/venice/commit/c942c73136333bc493050910f171a48e6f575b23","target":{"file":"src/main/java/com/github/jlangch/venice/impl/util/io/LoadPaths.java"}},{"deprecated":false,"digest":{"function_hash":"120759222316485299727856155757090479590","length":334},"id":"CVE-2022-36007-a4b2d774","signature_type":"Function","signature_version":"v1","source":"https://github.com/jlangch/venice/commit/c942c73136333bc493050910f171a48e6f575b23","target":{"file":"src/main/java/com/github/jlangch/venice/impl/util/io/LoadPaths.java","function":"isFileWithinDirectory"}}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/36xxx/CVE-2022-36007.json"},{"type":"FIX","url":"https://github.com/jlangch/venice/commit/215ae91bb964013b0a2d70718a692832d561ae0a"},{"type":"FIX","url":"https://github.com/jlangch/venice/commit/c942c73136333bc493050910f171a48e6f575b23"},{"type":"WEB","url":"https://github.com/jlangch/venice/releases/tag/v1.10.17"},{"type":"ADVISORY","url":"https://github.com/jlangch/venice/security/advisories/GHSA-4mmh-5vw7-rgvj"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-36007"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-22"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/36xxx/CVE-2022-36007.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N"}]}