{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-46247.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "036f153683e0d55b890305eb4c77680a0872fcba"
            }
          ],
          "repo": "https://github.com/vyperlang/vyper",
          "type": "GIT"
        }
      ],
      "versions": [
        "0.2.1",
        "pre-release",
        "v0.0.4",
        "v0.1.0-beta.1",
        "v0.1.0-beta.10",
        "v0.1.0-beta.11",
        "v0.1.0-beta.12",
        "v0.1.0-beta.13",
        "v0.1.0-beta.14",
        "v0.1.0-beta.15",
        "v0.1.0-beta.16",
        "v0.1.0-beta.17",
        "v0.1.0-beta.2",
        "v0.1.0-beta.3",
        "v0.1.0-beta.4",
        "v0.1.0-beta.5",
        "v0.1.0-beta.6",
        "v0.1.0-beta.7",
        "v0.1.0-beta.8",
        "v0.1.0-beta.9",
        "v0.2.0",
        "v0.2.1",
        "v0.2.10",
        "v0.2.11",
        "v0.2.12",
        "v0.2.13",
        "v0.2.14",
        "v0.2.15",
        "v0.2.16",
        "v0.2.2",
        "v0.2.3",
        "v0.2.4",
        "v0.2.5",
        "v0.2.6",
        "v0.2.7",
        "v0.2.8",
        "v0.2.9",
        "v0.3.0",
        "v0.3.1",
        "v0.3.2",
        "v0.3.3",
        "v0.3.4",
        "v0.3.5",
        "v0.3.6",
        "v0.3.7"
      ]
    }
  ],
  "aliases": [
    "GHSA-6m97-7527-mh74",
    "PYSEC-2023-307"
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-193",
      "CWE-682"
    ]
  },
  "details": "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine (EVM). Contracts containing large arrays might underallocate the number of slots they need by 1. Prior to v0.3.8, the calculation to determine how many slots a storage variable needed used `math.ceil(type_.size_in_bytes / 32)`. The intermediate floating point step can produce a rounding error if there are enough bits set in the IEEE-754 mantissa. Roughly speaking, if `type_.size_in_bytes` is large (> 2**46), and slightly less than a power of 2, the calculation can overestimate how many slots are needed by 1. If `type_.size_in_bytes` is slightly more than a power of 2, the calculation can underestimate how many slots are needed by 1. This issue is patched in version 0.3.8.",
  "id": "CVE-2023-46247",
  "modified": "2025-10-22T18:40:31.317860Z",
  "published": "2023-12-13T19:39:22Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74"
    },
    {
      "type": "FIX",
      "url": "https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb"
    },
    {
      "type": "WEB",
      "url": "https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
      "type": "CVSS_V3"
    }
  ],
  "summary": "Vyper has incorrect storage layout for contracts containing large arrays"
}