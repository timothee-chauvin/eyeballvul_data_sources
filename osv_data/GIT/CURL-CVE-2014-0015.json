{
  "id": "CURL-CVE-2014-0015",
  "summary": "re-use of wrong HTTP NTLM connection",
  "details": "libcurl can in some circumstances re-use the wrong connection when asked to\ndo an NTLM-authenticated HTTP or HTTPS request.\n\nlibcurl features a pool of recent connections so that subsequent requests\ncan re-use an existing connection to avoid overhead.\n\nWhen re-using a connection a range of criterion must first be met. Due to a\nlogical error in the code, a request that was issued by an application could\nwrongfully re-use an existing connection to the same server that was\nauthenticated using different credentials. One underlying reason being that\nNTLM authenticates connections and not requests, contrary to how HTTP is\ndesigned to work and how other authentication methods work.\n\nAn application that allows NTLM and another auth method (the bug only triggers\nif more than one auth method is asked for) to a server (that responds wanting\nNTLM) with user1:password1 and then does another operation to the same server\nwith user2:password2 (when the previous connection was left alive) - the\nsecond request re-uses the same connection and since it then sees that the\nNTLM negotiation is already made, it just sends the request over that\nconnection thinking it uses the user2 credentials when it is in fact still\nusing the connection authenticated for user1...\n\nThe set of auth methods to use is set with `CURLOPT_HTTPAUTH`.\n\nTwo common auth defines in libcurl are `CURLAUTH_ANY` and `CURLAUTH_ANYSAFE`.\nBoth of them ask for NTLM and other methods and can therefore trigger this\nproblem.\n\nApplications can disable libcurl's re-use of connections and thus mitigate\nthis problem, by using one of the following libcurl options to alter how\nconnections are or are not re-used: `CURLOPT_FRESH_CONNECT`,\n`CURLOPT_MAXCONNECTS` and `CURLMOPT_MAX_HOST_CONNECTIONS` (if using the\ncurl_multi API).",
  "aliases": [
    "CVE-2014-0015"
  ],
  "modified": "2024-06-07T13:53:51Z",
  "published": "2014-01-29T08:00:00Z",
  "database_specific": {
    "CWE": {
      "id": "CWE-305",
      "desc": "Authentication Bypass by Primary Weakness"
    },
    "package": "curl",
    "URL": "https://curl.se/docs/CVE-2014-0015.json",
    "severity": "Medium",
    "www": "https://curl.se/docs/CVE-2014-0015.html",
    "last_affected": "7.34.0"
  },
  "affected": [
    {
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "7.10.6"
            },
            {
              "fixed": "7.35.0"
            }
          ]
        },
        {
          "type": "GIT",
          "repo": "https://github.com/curl/curl.git",
          "events": [
            {
              "introduced": "73c5f24fa40460f41d6cd9114827383edc57e287"
            },
            {
              "fixed": "8ae35102c43d8d06572c3a1292eb6e27e663c78d"
            }
          ]
        }
      ],
      "versions": [
        "7.34.0",
        "7.33.0",
        "7.32.0",
        "7.31.0",
        "7.30.0",
        "7.29.0",
        "7.28.1",
        "7.28.0",
        "7.27.0",
        "7.26.0",
        "7.25.0",
        "7.24.0",
        "7.23.1",
        "7.23.0",
        "7.22.0",
        "7.21.7",
        "7.21.6",
        "7.21.5",
        "7.21.4",
        "7.21.3",
        "7.21.2",
        "7.21.1",
        "7.21.0",
        "7.20.1",
        "7.20.0",
        "7.19.7",
        "7.19.6",
        "7.19.5",
        "7.19.4",
        "7.19.3",
        "7.19.2",
        "7.19.1",
        "7.19.0",
        "7.18.2",
        "7.18.1",
        "7.18.0",
        "7.17.1",
        "7.17.0",
        "7.16.4",
        "7.16.3",
        "7.16.2",
        "7.16.1",
        "7.16.0",
        "7.15.5",
        "7.15.4",
        "7.15.3",
        "7.15.2",
        "7.15.1",
        "7.15.0",
        "7.14.1",
        "7.14.0",
        "7.13.2",
        "7.13.1",
        "7.13.0",
        "7.12.3",
        "7.12.2",
        "7.12.1",
        "7.12.0",
        "7.11.2",
        "7.11.1",
        "7.11.0",
        "7.10.8",
        "7.10.7",
        "7.10.6"
      ],
      "database_specific": {
        "source": "https://curl.se/docs/CURL-CVE-2014-0015.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "credits": [
    {
      "name": "Paras Sethia",
      "type": "FINDER"
    },
    {
      "name": "Daniel Stenberg",
      "type": "REMEDIATION_DEVELOPER"
    },
    {
      "name": "Yehezkel Horowitz",
      "type": "OTHER"
    }
  ]
}