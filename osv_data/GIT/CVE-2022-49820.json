{"schema_version":"1.7.3","id":"CVE-2022-49820","published":"2025-05-01T14:09:42Z","modified":"2025-10-21T11:05:32.633176Z","summary":"mctp i2c: don't count unused / invalid keys for flow release","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmctp i2c: don't count unused / invalid keys for flow release\n\nWe're currently hitting the WARN_ON in mctp_i2c_flow_release:\n\n    if (midev->release_count > midev->i2c_lock_count) {\n        WARN_ONCE(1, \"release count overflow\");\n\nThis may be hit if we expire a flow before sending the first packet it\ncontains - as we will not be pairing the increment of release_count\n(performed on flow release) with the i2c lock operation (only\nperformed on actual TX).\n\nTo fix this, only release a flow if we've encountered it previously (ie,\ndev_flow_state does not indicate NEW), as we will mark the flow as\nACTIVE at the same time as accounting for the i2c lock operation. We\nalso need to add an INVALID flow state, to indicate when we've done the\nrelease.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f5b8abf9fc3dacd7529d363e26fe8230935d65f8"},{"fixed":"a5915a9a3ab4067ef8996a57738d156eabeb3a12"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f5b8abf9fc3dacd7529d363e26fe8230935d65f8"},{"fixed":"9cbd48d5fa14e4c65f8580de16686077f7cea02b"}]}],"versions":["v5.17","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.0.8","v6.0.9","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49820.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["333617972549628535298264502713663018771","210957706991998266753296077983054855170","247386086100316793573821224146315950593","223334002401208004320658457910783765699","325391027806891039451086289948473131092","50075126082396427429742744797017188909","216050895810892199829037762570787242480","300896652581368283638445908368637333301","316239641014012644788093518398232302054","297676504752891195534008600971636002520","18694205940527987297834632961489023375","262086884349711917277534901619239946105","216386817806397153391205633558737614654","109559378124791005731698060002623045133","263294888252967875716220712534842821600","20016078966092240693793508788658121609","146282072971333579705395033855377951979","298699158789073412467720841020601502844","236144628404473629234242277483614976639","98905843379257825430713836393773635885","2804170733835986700777470210598642779","255118889829987799691511613034399710057","219787482586011836916497248837760765161","288927875636788266556063433612771696737","100389737148221030171624754826252888637"],"threshold":0.9},"id":"CVE-2022-49820-15dbea6c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a5915a9a3ab4067ef8996a57738d156eabeb3a12","target":{"file":"drivers/net/mctp/mctp-i2c.c"}},{"deprecated":false,"digest":{"function_hash":"90471337951120399436862708071531906877","length":423},"id":"CVE-2022-49820-21a526f0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9cbd48d5fa14e4c65f8580de16686077f7cea02b","target":{"file":"drivers/net/mctp/mctp-i2c.c","function":"mctp_i2c_release_flow"}},{"deprecated":false,"digest":{"line_hashes":["333617972549628535298264502713663018771","210957706991998266753296077983054855170","247386086100316793573821224146315950593","223334002401208004320658457910783765699","325391027806891039451086289948473131092","50075126082396427429742744797017188909","216050895810892199829037762570787242480","300896652581368283638445908368637333301","316239641014012644788093518398232302054","297676504752891195534008600971636002520","18694205940527987297834632961489023375","262086884349711917277534901619239946105","216386817806397153391205633558737614654","109559378124791005731698060002623045133","263294888252967875716220712534842821600","20016078966092240693793508788658121609","146282072971333579705395033855377951979","298699158789073412467720841020601502844","236144628404473629234242277483614976639","98905843379257825430713836393773635885","2804170733835986700777470210598642779","255118889829987799691511613034399710057","219787482586011836916497248837760765161","288927875636788266556063433612771696737","100389737148221030171624754826252888637"],"threshold":0.9},"id":"CVE-2022-49820-28682190","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9cbd48d5fa14e4c65f8580de16686077f7cea02b","target":{"file":"drivers/net/mctp/mctp-i2c.c"}},{"deprecated":false,"digest":{"function_hash":"90471337951120399436862708071531906877","length":423},"id":"CVE-2022-49820-2a8b5dc5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a5915a9a3ab4067ef8996a57738d156eabeb3a12","target":{"file":"drivers/net/mctp/mctp-i2c.c","function":"mctp_i2c_release_flow"}},{"deprecated":false,"digest":{"function_hash":"284136852730178846303618326466591411521","length":601},"id":"CVE-2022-49820-88758bda","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9cbd48d5fa14e4c65f8580de16686077f7cea02b","target":{"file":"drivers/net/mctp/mctp-i2c.c","function":"mctp_i2c_get_tx_flow_state"}},{"deprecated":false,"digest":{"function_hash":"284136852730178846303618326466591411521","length":601},"id":"CVE-2022-49820-de6fca0e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a5915a9a3ab4067ef8996a57738d156eabeb3a12","target":{"file":"drivers/net/mctp/mctp-i2c.c","function":"mctp_i2c_get_tx_flow_state"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.18.0"},{"fixed":"6.0.10"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49820.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9cbd48d5fa14e4c65f8580de16686077f7cea02b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a5915a9a3ab4067ef8996a57738d156eabeb3a12"}]}