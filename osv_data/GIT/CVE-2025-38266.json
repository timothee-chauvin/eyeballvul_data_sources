{"schema_version":"1.7.3","id":"CVE-2025-38266","published":"2025-07-10T07:37:34.431Z","modified":"2025-11-20T09:08:31.901870Z","summary":"pinctrl: mediatek: eint: Fix invalid pointer dereference for v1 platforms","details":"In the Linux kernel, the following vulnerability has been resolved:\n\npinctrl: mediatek: eint: Fix invalid pointer dereference for v1 platforms\n\nCommit 3ef9f710efcb (\"pinctrl: mediatek: Add EINT support for multiple\naddresses\") introduced an access to the 'soc' field of struct\nmtk_pinctrl in mtk_eint_do_init() and for that an include of\npinctrl-mtk-common-v2.h.\n\nHowever, pinctrl drivers relying on the v1 common driver include\npinctrl-mtk-common.h instead, which provides another definition of\nstruct mtk_pinctrl that does not contain an 'soc' field.\n\nSince mtk_eint_do_init() can be called both by v1 and v2 drivers, it\nwill now try to dereference an invalid pointer when called on v1\nplatforms. This has been observed on Genio 350 EVK (MT8365), which\ncrashes very early in boot (the kernel trace can only be seen with\nearlycon).\n\nIn order to fix this, since 'struct mtk_pinctrl' was only needed to get\na 'struct mtk_eint_pin', make 'struct mtk_eint_pin' a parameter\nof mtk_eint_do_init() so that callers need to supply it, removing\nmtk_eint_do_init()'s dependency on any particular 'struct mtk_pinctrl'.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3ef9f710efcb5cc1335b5b09c16c757f703d7e5f"},{"fixed":"9ebe21ede792cef851847648962c363cac67d17f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3ef9f710efcb5cc1335b5b09c16c757f703d7e5f"},{"fixed":"1c9977b263475373b31bbf86af94a5c9ae2be42c"}]}],"versions":["v6.14","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38266.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["232690613734030033680857777329358033866","231427838283803043903222786423871290774","62344145240469841952259266182141369412","14472902038769992706616975037228577632"],"threshold":0.9},"id":"CVE-2025-38266-03c0492a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c9977b263475373b31bbf86af94a5c9ae2be42c","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common.c"}},{"deprecated":false,"digest":{"line_hashes":["66081549352116349695650701617256584505","134081948012656766405305282384500594121","319305636472721304376372533878903846378","91843020579869701689100980901562988129","254164880348543318192382083821955602123","66614535049649843963037490048285881371","180522250111057706835941488240958833406","140411248449853663339024100817049906663","239386733802247769077083494950117955064","192916056596173604544224442174526875328","113255551094926353325536652794974506783","285811303754600606725867026010351756531","327283293058871282765259795561109211047","44866134698894518012433020324890905220","29721987426965299567606422065559518709","102677301054215940107984897423325166637","13509735864357676539613622700215408961","49058680511017007332355412787896767656","128227454653943538873954919467270227796","276782815262407443467079179646445927299","13119178334297064444146425207728814821","73859932162266566307624074203431255865","39562169089319969002898123108642872055","318343161513040947044256899848930352848","53220413607632276139312362617397030748","11520032031193458917686043621449578355","4316356402543020595318777423009717164","322908650589901400986280071634554519216","114923487976358417530315949841182858977","100968775637744544743651381809957442108","102411318653388722389405155366341222799"],"threshold":0.9},"id":"CVE-2025-38266-06d7d7f5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c9977b263475373b31bbf86af94a5c9ae2be42c","target":{"file":"drivers/pinctrl/mediatek/mtk-eint.c"}},{"deprecated":false,"digest":{"line_hashes":["312266668388680893920340587969703158578","301623707269063970681484975690477052769","281752574997997404111976799290788277311","97799560433677140857622136019309546021","265166840676468162309633774986818405520","60668067893945446527132887284448189206","179668054631396580465040392024403550651","98253494151375655996192817080838319602"],"threshold":0.9},"id":"CVE-2025-38266-0caeea83","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c9977b263475373b31bbf86af94a5c9ae2be42c","target":{"file":"drivers/pinctrl/mediatek/mtk-eint.h"}},{"deprecated":false,"digest":{"function_hash":"318701991656666414937109679449166391732","length":788},"id":"CVE-2025-38266-17bf6a50","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c9977b263475373b31bbf86af94a5c9ae2be42c","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common.c","function":"mtk_eint_init"}},{"deprecated":false,"digest":{"line_hashes":["323059621609148454441251748554458241607","278356263657294193640243049122631542132","77054382450487990708158818689458970961","21471668373324332848281791346895885669"],"threshold":0.9},"id":"CVE-2025-38266-1ad0c434","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9ebe21ede792cef851847648962c363cac67d17f","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common-v2.c"}},{"deprecated":false,"digest":{"function_hash":"254192751051054644884984300619742469769","length":3484},"id":"CVE-2025-38266-24ea1981","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9ebe21ede792cef851847648962c363cac67d17f","target":{"file":"drivers/pinctrl/mediatek/mtk-eint.c","function":"mtk_eint_do_init"}},{"deprecated":false,"digest":{"line_hashes":["232690613734030033680857777329358033866","231427838283803043903222786423871290774","62344145240469841952259266182141369412","14472902038769992706616975037228577632"],"threshold":0.9},"id":"CVE-2025-38266-2bf5eff8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9ebe21ede792cef851847648962c363cac67d17f","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common.c"}},{"deprecated":false,"digest":{"function_hash":"308453610423514099875052596769155242024","length":984},"id":"CVE-2025-38266-48e28594","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9ebe21ede792cef851847648962c363cac67d17f","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common.c","function":"mtk_eint_init"}},{"deprecated":false,"digest":{"function_hash":"69729339734316045815643311127798785060","length":3484},"id":"CVE-2025-38266-4ca6768c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c9977b263475373b31bbf86af94a5c9ae2be42c","target":{"file":"drivers/pinctrl/mediatek/mtk-eint.c","function":"mtk_eint_do_init"}},{"deprecated":false,"digest":{"function_hash":"30186593564627760608915559200239226041","length":1755},"id":"CVE-2025-38266-8905f499","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9ebe21ede792cef851847648962c363cac67d17f","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common-v2.c","function":"mtk_build_eint"}},{"deprecated":false,"digest":{"line_hashes":["312266668388680893920340587969703158578","301623707269063970681484975690477052769","281752574997997404111976799290788277311","97799560433677140857622136019309546021","265166840676468162309633774986818405520","60668067893945446527132887284448189206","179668054631396580465040392024403550651","98253494151375655996192817080838319602"],"threshold":0.9},"id":"CVE-2025-38266-8b02dab3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9ebe21ede792cef851847648962c363cac67d17f","target":{"file":"drivers/pinctrl/mediatek/mtk-eint.h"}},{"deprecated":false,"digest":{"line_hashes":["66081549352116349695650701617256584505","134081948012656766405305282384500594121","319305636472721304376372533878903846378","91843020579869701689100980901562988129","254164880348543318192382083821955602123","66614535049649843963037490048285881371","339581777623602329006369405136491348571","318222984371897573899513301251201441670","171405381012706253981935934373321140460","112929244884038365879027639691182772862","113255551094926353325536652794974506783","285811303754600606725867026010351756531","327283293058871282765259795561109211047","44866134698894518012433020324890905220","29721987426965299567606422065559518709","102677301054215940107984897423325166637","13509735864357676539613622700215408961","49058680511017007332355412787896767656","128227454653943538873954919467270227796","276782815262407443467079179646445927299","13119178334297064444146425207728814821","73859932162266566307624074203431255865","39562169089319969002898123108642872055","318343161513040947044256899848930352848","53220413607632276139312362617397030748","11520032031193458917686043621449578355","4316356402543020595318777423009717164","322908650589901400986280071634554519216","114923487976358417530315949841182858977","100968775637744544743651381809957442108","102411318653388722389405155366341222799"],"threshold":0.9},"id":"CVE-2025-38266-92ad8f6e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9ebe21ede792cef851847648962c363cac67d17f","target":{"file":"drivers/pinctrl/mediatek/mtk-eint.c"}},{"deprecated":false,"digest":{"line_hashes":["323059621609148454441251748554458241607","278356263657294193640243049122631542132","77054382450487990708158818689458970961","21471668373324332848281791346895885669"],"threshold":0.9},"id":"CVE-2025-38266-e7dfb147","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c9977b263475373b31bbf86af94a5c9ae2be42c","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common-v2.c"}},{"deprecated":false,"digest":{"function_hash":"5561876433122452434719568756550185231","length":1792},"id":"CVE-2025-38266-f02ef925","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c9977b263475373b31bbf86af94a5c9ae2be42c","target":{"file":"drivers/pinctrl/mediatek/pinctrl-mtk-common-v2.c","function":"mtk_build_eint"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.15.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38266.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1c9977b263475373b31bbf86af94a5c9ae2be42c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9ebe21ede792cef851847648962c363cac67d17f"}]}