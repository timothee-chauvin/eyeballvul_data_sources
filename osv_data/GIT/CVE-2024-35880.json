{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35880.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "10561518539720464169492306035996044965",
              "length": 182.0
            },
            "id": "CVE-2024-35880-11a788d5",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65938e81df2197203bda4b9a0c477e7987218d66",
            "target": {
              "file": "io_uring/kbuf.c",
              "function": "io_pbuf_get_address"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "311032835786016119934690125525536498574",
              "length": 162.0
            },
            "id": "CVE-2024-35880-2d670dd3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@561e4f9451d65fc2f7eef564e0064373e3019793",
            "target": {
              "file": "io_uring/kbuf.c",
              "function": "io_put_bl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "10561518539720464169492306035996044965",
              "length": 182.0
            },
            "id": "CVE-2024-35880-39d4d8b1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@561e4f9451d65fc2f7eef564e0064373e3019793",
            "target": {
              "file": "io_uring/kbuf.c",
              "function": "io_pbuf_get_address"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "148619581174758088467579322717331735019",
              "length": 871.0
            },
            "id": "CVE-2024-35880-3a068be7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5fd8e2359498043e0b5329a05f02d10a9eb91eb9",
            "target": {
              "file": "io_uring/io_uring.c",
              "function": "io_uring_validate_mmap_request"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "95818545586215157157259831862671631321",
                "331651796050668082473128933441155708630",
                "267728773019704302377907085384944080049",
                "161123357890607604479769586072703640890"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-3bfb0f4e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@561e4f9451d65fc2f7eef564e0064373e3019793",
            "target": {
              "file": "io_uring/kbuf.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "126546922977014551455331344985907300077",
                "171154406452288922193481529446545044259",
                "10563057753999284671294502214909601261",
                "255700859171222136171390326642392772227",
                "199823722296618448141168349503021419149",
                "6592176527561385907591478236220268729",
                "84841656621495190345867058245550302336",
                "49448657311443215706121549164538188128",
                "222625912023353490845572605583267862321",
                "18292364092951642973955853740433746299",
                "94257164686918878514685597384985557301"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-448533b8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5fd8e2359498043e0b5329a05f02d10a9eb91eb9",
            "target": {
              "file": "io_uring/io_uring.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "221110319928407456821249461643812224949",
                "264228609071127195845167718879500466122",
                "290320377451754634297851643630897347674",
                "333609601264973164109162069357894542385",
                "327660420074126905580084721113376551580",
                "100289365819527132679877980126695082958",
                "25225075324414706969106906914393136786",
                "84812459858876234289839659380484743773",
                "134359235407536284759473746121795808331",
                "283723811430282718040698466573448631551",
                "188629180980195952974921059201520373953",
                "272746322752827414579896619740484698402",
                "184859890547982114580986799457018783308",
                "338524967388514974476305837783891775672"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-491e4353",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5fd8e2359498043e0b5329a05f02d10a9eb91eb9",
            "target": {
              "file": "io_uring/kbuf.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "221110319928407456821249461643812224949",
                "264228609071127195845167718879500466122",
                "290320377451754634297851643630897347674",
                "333609601264973164109162069357894542385",
                "327660420074126905580084721113376551580",
                "100289365819527132679877980126695082958",
                "25225075324414706969106906914393136786",
                "84812459858876234289839659380484743773",
                "134359235407536284759473746121795808331",
                "283723811430282718040698466573448631551",
                "188629180980195952974921059201520373953",
                "272746322752827414579896619740484698402",
                "184859890547982114580986799457018783308",
                "338524967388514974476305837783891775672"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-53ac2ab7",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@561e4f9451d65fc2f7eef564e0064373e3019793",
            "target": {
              "file": "io_uring/kbuf.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "311032835786016119934690125525536498574",
              "length": 162.0
            },
            "id": "CVE-2024-35880-5c06ea53",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65938e81df2197203bda4b9a0c477e7987218d66",
            "target": {
              "file": "io_uring/kbuf.c",
              "function": "io_put_bl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "194743651187231526392101446217903612488",
                "34735060593785329388187546265435427247",
                "267728773019704302377907085384944080049",
                "161123357890607604479769586072703640890"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-5f2a5928",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5fd8e2359498043e0b5329a05f02d10a9eb91eb9",
            "target": {
              "file": "io_uring/kbuf.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "148619581174758088467579322717331735019",
              "length": 871.0
            },
            "id": "CVE-2024-35880-6098c7cb",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@561e4f9451d65fc2f7eef564e0064373e3019793",
            "target": {
              "file": "io_uring/io_uring.c",
              "function": "io_uring_validate_mmap_request"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "10561518539720464169492306035996044965",
              "length": 182.0
            },
            "id": "CVE-2024-35880-808aa0e2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5fd8e2359498043e0b5329a05f02d10a9eb91eb9",
            "target": {
              "file": "io_uring/kbuf.c",
              "function": "io_pbuf_get_address"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "56232200152502525409079050272721213312",
                "90114010787056598833882389784241822059",
                "96491214375871028556161373870954414449",
                "105804632235576554047933314084605094280"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-8cb110b4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65938e81df2197203bda4b9a0c477e7987218d66",
            "target": {
              "file": "io_uring/kbuf.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "148619581174758088467579322717331735019",
              "length": 871.0
            },
            "id": "CVE-2024-35880-8f8425e9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65938e81df2197203bda4b9a0c477e7987218d66",
            "target": {
              "file": "io_uring/io_uring.c",
              "function": "io_uring_validate_mmap_request"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "311032835786016119934690125525536498574",
              "length": 162.0
            },
            "id": "CVE-2024-35880-92cef46a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5fd8e2359498043e0b5329a05f02d10a9eb91eb9",
            "target": {
              "file": "io_uring/kbuf.c",
              "function": "io_put_bl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "126546922977014551455331344985907300077",
                "171154406452288922193481529446545044259",
                "10563057753999284671294502214909601261",
                "255700859171222136171390326642392772227",
                "199823722296618448141168349503021419149",
                "6592176527561385907591478236220268729",
                "84841656621495190345867058245550302336",
                "49448657311443215706121549164538188128",
                "222625912023353490845572605583267862321",
                "18292364092951642973955853740433746299",
                "94257164686918878514685597384985557301"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-a8d1d0e9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@561e4f9451d65fc2f7eef564e0064373e3019793",
            "target": {
              "file": "io_uring/io_uring.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "126546922977014551455331344985907300077",
                "171154406452288922193481529446545044259",
                "10563057753999284671294502214909601261",
                "255700859171222136171390326642392772227",
                "199823722296618448141168349503021419149",
                "6592176527561385907591478236220268729",
                "84841656621495190345867058245550302336",
                "49448657311443215706121549164538188128",
                "222625912023353490845572605583267862321",
                "18292364092951642973955853740433746299",
                "94257164686918878514685597384985557301"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-a9df10ba",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65938e81df2197203bda4b9a0c477e7987218d66",
            "target": {
              "file": "io_uring/io_uring.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "221110319928407456821249461643812224949",
                "264228609071127195845167718879500466122",
                "290320377451754634297851643630897347674",
                "333609601264973164109162069357894542385",
                "30069932503133437578991885056656415545",
                "100289365819527132679877980126695082958",
                "25225075324414706969106906914393136786",
                "84812459858876234289839659380484743773",
                "134359235407536284759473746121795808331",
                "283723811430282718040698466573448631551",
                "188629180980195952974921059201520373953",
                "272746322752827414579896619740484698402",
                "184859890547982114580986799457018783308",
                "338524967388514974476305837783891775672"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35880-aeb11496",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65938e81df2197203bda4b9a0c477e7987218d66",
            "target": {
              "file": "io_uring/kbuf.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "09f7520048eaaee9709091cd2787966f807da7c5"
            },
            {
              "fixed": "65938e81df2197203bda4b9a0c477e7987218d66"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "5cf4f52e6d8aa2d3b7728f568abbf9d42a3af252"
            },
            {
              "fixed": "5fd8e2359498043e0b5329a05f02d10a9eb91eb9"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "5cf4f52e6d8aa2d3b7728f568abbf9d42a3af252"
            },
            {
              "fixed": "561e4f9451d65fc2f7eef564e0064373e3019793"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4",
        "v6.9-rc1",
        "v6.9-rc2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35880.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.6.26"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.8.5"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nio_uring/kbuf: hold io_buffer_list reference over mmap\n\nIf we look up the kbuf, ensure that it doesn't get unregistered until\nafter we're done with it. Since we're inside mmap, we cannot safely use\nthe io_uring lock. Rely on the fact that we can lookup the buffer list\nunder RCU now and grab a reference to it, preventing it from being\nunregistered until we're done with it. The lookup returns the\nio_buffer_list directly with it referenced.",
  "id": "CVE-2024-35880",
  "modified": "2025-10-15T10:28:16.109674Z",
  "published": "2024-05-19T08:34:37Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/561e4f9451d65fc2f7eef564e0064373e3019793"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5fd8e2359498043e0b5329a05f02d10a9eb91eb9"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/65938e81df2197203bda4b9a0c477e7987218d66"
    }
  ],
  "related": [
    "SUSE-SU-2024:2571-1",
    "SUSE-SU-2024:2896-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "summary": "io_uring/kbuf: hold io_buffer_list reference over mmap"
}