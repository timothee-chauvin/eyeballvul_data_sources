{"schema_version":"1.7.3","id":"CVE-2025-38008","published":"2025-06-18T09:28:19.358Z","modified":"2025-11-20T09:06:01.140427Z","related":["SUSE-SU-2025:4057-1"],"summary":"mm/page_alloc: fix race condition in unaccepted memory handling","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmm/page_alloc: fix race condition in unaccepted memory handling\n\nThe page allocator tracks the number of zones that have unaccepted memory\nusing static_branch_enc/dec() and uses that static branch in hot paths to\ndetermine if it needs to deal with unaccepted memory.\n\nBorislav and Thomas pointed out that the tracking is racy: operations on\nstatic_branch are not serialized against adding/removing unaccepted pages\nto/from the zone.\n\nSanity checks inside static_branch machinery detects it:\n\nWARNING: CPU: 0 PID: 10 at kernel/jump_label.c:276 __static_key_slow_dec_cpuslocked+0x8e/0xa0\n\nThe comment around the WARN() explains the problem:\n\n\t/*\n\t * Warn about the '-1' case though; since that means a\n\t * decrement is concurrent with a first (0->1) increment. IOW\n\t * people are trying to disable something that wasn't yet fully\n\t * enabled. This suggests an ordering problem on the user side.\n\t */\n\nThe effect of this static_branch optimization is only visible on\nmicrobenchmark.\n\nInstead of adding more complexity around it, remove it altogether.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"dcdfdd40fa82b6704d2841938e5c8ec3051eb0d6"},{"fixed":"98fdd2f612e949c652693f6df00442c81037776d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"dcdfdd40fa82b6704d2841938e5c8ec3051eb0d6"},{"fixed":"74953f93f47a45296cc2a3fd04e2a3202ff3fa53"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"dcdfdd40fa82b6704d2841938e5c8ec3051eb0d6"},{"fixed":"71dda1cb10702dc2859f00eb789b0502de2176a9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"dcdfdd40fa82b6704d2841938e5c8ec3051eb0d6"},{"fixed":"fefc075182275057ce607effaa3daa9e6e3bdc73"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.14.6","v6.14.7","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.4","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.85","v6.6.86","v6.6.87","v6.6.88","v6.6.89","v6.6.9","v6.6.90","v6.6.91","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38008.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"335485981618011142839090844181035576698","length":535},"id":"CVE-2025-38008-2985a1a4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@71dda1cb10702dc2859f00eb789b0502de2176a9","target":{"file":"mm/page_alloc.c","function":"__free_unaccepted"}},{"deprecated":false,"digest":{"function_hash":"124739824017199644180637930739641859107","length":507},"id":"CVE-2025-38008-2a4220fa","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@71dda1cb10702dc2859f00eb789b0502de2176a9","target":{"file":"mm/page_alloc.c","function":"cond_accept_memory"}},{"deprecated":false,"digest":{"function_hash":"218421499594143415404538385941024367648","length":94},"id":"CVE-2025-38008-4e5e0bee","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@71dda1cb10702dc2859f00eb789b0502de2176a9","target":{"file":"mm/page_alloc.c","function":"has_unaccepted_memory"}},{"deprecated":false,"digest":{"function_hash":"218421499594143415404538385941024367648","length":94},"id":"CVE-2025-38008-6c9f9962","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@98fdd2f612e949c652693f6df00442c81037776d","target":{"file":"mm/page_alloc.c","function":"has_unaccepted_memory"}},{"deprecated":false,"digest":{"function_hash":"227181032593000946300848011269293657874","length":514},"id":"CVE-2025-38008-8586b5af","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@98fdd2f612e949c652693f6df00442c81037776d","target":{"file":"mm/page_alloc.c","function":"__free_unaccepted"}},{"deprecated":false,"digest":{"function_hash":"124739824017199644180637930739641859107","length":507},"id":"CVE-2025-38008-8f57edc8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@98fdd2f612e949c652693f6df00442c81037776d","target":{"file":"mm/page_alloc.c","function":"cond_accept_memory"}},{"deprecated":false,"digest":{"line_hashes":["244550191866800777197753122250703645731","201975527843158849176711219842714933182","270976587395924801358729554771870701822","31656851588541285860175698469233972120","306264075152111328348938649395979355498","45166868246878931699657148003137690497","129205067527128637201362926215423855703","202423362270462613329213603272123806054","178123138882542431360100371837608772142","95501117809487534886229287671400530256","164080487253350881112535011893273536374","115192341631128940041099772709389141619","82875060409987406868666474732638296399","44560830321116539707557853668827227549","75672370290425425760330546297904244442","125453484452089981548503225719445310685","8952656570546022754731961952842553833","338238407833189421802792256112099588974","36444574400997984462459280331535849887","308124255486911067837696642202977278343","145988464654178577693669186582402839806","155247499173711413621326089135621584537","25545939958222108899798534018808403941","97291207245497121729586226142321019089","194288003423939616021690639039707169692","35127774073409445503084606663236283648","73603348453900928254140019939767583264","58598695115507987630113471851573772846","42251366920055877346068275787128135659","299230019738702636892043038681957328927","197471252393155817755704621606587032918","168130925556014852592942287917522771247","231532815897628036579202663721355019248","103781566239846670354672887872449400355","210306359344666666373732825963289374404","16642559558686512066428175124895822450","137506914554051747756461645448181995971","312784573813241873626140174669149333579","61766013836493806438321270810571662409","339048606167803892827982092134167054797","329356551969205651139340923009548018378","99132911762047826438278571972655671898","240733917777178363384282741158307896719","110394516148844309823241179835826488955","194405543562710424901485317925410120317","338956951515970028620488331909843907560","211911984068276997304531638917331272904","169611283004560985250764933708416285532","251499781702906081390050412361456201227","40134716531743553842765248018766630920","275442537819407505467061949850176763973","194389429570014175551435885380093890154","127356485514392802767959255769665328084","197724038937509979717035078590416137733","206516041329284709621921800747804776788"],"threshold":0.9},"id":"CVE-2025-38008-9af8cd8e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@98fdd2f612e949c652693f6df00442c81037776d","target":{"file":"mm/page_alloc.c"}},{"deprecated":false,"digest":{"function_hash":"230898022352086357991204010481363519684","length":531},"id":"CVE-2025-38008-b0c545a3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@71dda1cb10702dc2859f00eb789b0502de2176a9","target":{"file":"mm/page_alloc.c","function":"__accept_page"}},{"deprecated":false,"digest":{"line_hashes":["306264075152111328348938649395979355498","45166868246878931699657148003137690497","129205067527128637201362926215423855703","202423362270462613329213603272123806054","10161773405589797746549350092299223879","273688716683517092567959103969879157601","125364649262960916119295065512774989089","309681476299922178426418672593812820788","49047079716541923762850302373413342185","287085844682440832426708609460351043850","262726538126459622469185478780829502115","291430751485827943791314681802775382969","149715509471384746704969751157778668556","70804636625506319038967434827957434613","210140522060250182942214179707674412223","281275737719135110490758456697998030879","17764185870389313406948430144326637357","42251366920055877346068275787128135659","299230019738702636892043038681957328927","26747450249042724536159322777099802377","146689527985352259422050221052195734505","21798901809249103530491890448135209869","162431303623170038783034653915720312941","155247499173711413621326089135621584537","25545939958222108899798534018808403941","97291207245497121729586226142321019089","194288003423939616021690639039707169692","15483236536515365300968142781023954252","210306359344666666373732825963289374404","16642559558686512066428175124895822450","137506914554051747756461645448181995971","312784573813241873626140174669149333579","61766013836493806438321270810571662409","339048606167803892827982092134167054797","304822166003565494028318616635927621873","34609478799460893773184886394661365477","196364373060596853561194208803552055198","91794977056983407133327819719872279145","149839602510794336803801974142248785976","257274272972384270578394905965989455658","338956951515970028620488331909843907560","211911984068276997304531638917331272904","169611283004560985250764933708416285532"],"threshold":0.9},"id":"CVE-2025-38008-dd67b5d9","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@71dda1cb10702dc2859f00eb789b0502de2176a9","target":{"file":"mm/page_alloc.c"}},{"deprecated":false,"digest":{"function_hash":"129770896838064952631060523882934100053","length":657},"id":"CVE-2025-38008-f3cb2aa2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@98fdd2f612e949c652693f6df00442c81037776d","target":{"file":"mm/page_alloc.c","function":"try_to_accept_memory_one"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.5.0"},{"fixed":"6.6.92"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.30"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.14.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38008.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/71dda1cb10702dc2859f00eb789b0502de2176a9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/74953f93f47a45296cc2a3fd04e2a3202ff3fa53"},{"type":"WEB","url":"https://git.kernel.org/stable/c/98fdd2f612e949c652693f6df00442c81037776d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fefc075182275057ce607effaa3daa9e6e3bdc73"}]}