{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38150.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "280269150363171445294923277203812749388",
              "length": 266.0
            },
            "id": "CVE-2025-38150-004d4cc1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2dd4781c5af99415ebbd2f7cc763feb109863c05",
            "target": {
              "file": "net/packet/af_packet.c",
              "function": "packet_dev_mclist_delete"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "306666814833995032073723786394877859691",
              "length": 1093.0
            },
            "id": "CVE-2025-38150-24eb1f12",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2dd4781c5af99415ebbd2f7cc763feb109863c05",
            "target": {
              "file": "net/packet/af_packet.c",
              "function": "packet_notifier"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "254236196358539088360731939628750706759",
                "45554007360557276267165699224240163831",
                "262536348536770526402297838286012164523",
                "322646199642158647550587423460422619670",
                "64324363948496998780867945735454113788",
                "267805836825496388468469017723825445713",
                "270218920522757645459707271260389106952",
                "306817865200744910047401637938074246456",
                "251388026780757325211594094357840508034",
                "306262208653434968970765433415349330601",
                "255018585092858417622925253652201123737",
                "251297418257542747714537852723569819213",
                "186114675099827187620030312150170678746",
                "18664713740116217845719674140694284537",
                "234045204924678385616659368671239915480",
                "144963369528058689856178981758428756559",
                "160532275209557527658086072616094190606",
                "93488987893683436039570378307519289821",
                "97415141348495571243138448356366305426",
                "6959909191358322342286639955370654569",
                "144922681763135814025915188997649137864",
                "295245776567196496190132612434312811300",
                "254461424442103821819540100543809032319",
                "321754315971329290325372870089634040943",
                "119009002820610990344721885401782817471",
                "258344850940093665697340177530525600461",
                "85567144690673750851748713226553294190",
                "109051600873822536243271052473038217680",
                "86126083372109158543921718923950060980"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-38150-3cdb33e4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d8d85ef0a631df9127f202e6371bb33a0b589952",
            "target": {
              "file": "net/packet/af_packet.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "290777121661136633965527138449276360933",
              "length": 1194.0
            },
            "id": "CVE-2025-38150-41395206",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2dd4781c5af99415ebbd2f7cc763feb109863c05",
            "target": {
              "file": "net/packet/af_packet.c",
              "function": "packet_mc_add"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "33845976587068890949548666934877420981",
                "265463245847595258034569686378819607050",
                "157476234832449001276139976447201336938",
                "119060732222843886468840269431583729009"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-38150-82e423bf",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2dd4781c5af99415ebbd2f7cc763feb109863c05",
            "target": {
              "file": "net/packet/internal.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "306666814833995032073723786394877859691",
              "length": 1093.0
            },
            "id": "CVE-2025-38150-88a6bdf7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d8d85ef0a631df9127f202e6371bb33a0b589952",
            "target": {
              "file": "net/packet/af_packet.c",
              "function": "packet_notifier"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "280269150363171445294923277203812749388",
              "length": 266.0
            },
            "id": "CVE-2025-38150-92d8eeb4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d8d85ef0a631df9127f202e6371bb33a0b589952",
            "target": {
              "file": "net/packet/af_packet.c",
              "function": "packet_dev_mclist_delete"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "290777121661136633965527138449276360933",
              "length": 1194.0
            },
            "id": "CVE-2025-38150-a7b2ca45",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d8d85ef0a631df9127f202e6371bb33a0b589952",
            "target": {
              "file": "net/packet/af_packet.c",
              "function": "packet_mc_add"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "254236196358539088360731939628750706759",
                "45554007360557276267165699224240163831",
                "262536348536770526402297838286012164523",
                "322646199642158647550587423460422619670",
                "64324363948496998780867945735454113788",
                "267805836825496388468469017723825445713",
                "270218920522757645459707271260389106952",
                "306817865200744910047401637938074246456",
                "251388026780757325211594094357840508034",
                "306262208653434968970765433415349330601",
                "255018585092858417622925253652201123737",
                "251297418257542747714537852723569819213",
                "186114675099827187620030312150170678746",
                "18664713740116217845719674140694284537",
                "234045204924678385616659368671239915480",
                "144963369528058689856178981758428756559",
                "160532275209557527658086072616094190606",
                "93488987893683436039570378307519289821",
                "97415141348495571243138448356366305426",
                "6959909191358322342286639955370654569",
                "144922681763135814025915188997649137864",
                "295245776567196496190132612434312811300",
                "254461424442103821819540100543809032319",
                "321754315971329290325372870089634040943",
                "119009002820610990344721885401782817471",
                "258344850940093665697340177530525600461",
                "85567144690673750851748713226553294190",
                "109051600873822536243271052473038217680",
                "86126083372109158543921718923950060980"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-38150-eb1b1555",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2dd4781c5af99415ebbd2f7cc763feb109863c05",
            "target": {
              "file": "net/packet/af_packet.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "33845976587068890949548666934877420981",
                "265463245847595258034569686378819607050",
                "157476234832449001276139976447201336938",
                "119060732222843886468840269431583729009"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-38150-fcd4b2b2",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d8d85ef0a631df9127f202e6371bb33a0b589952",
            "target": {
              "file": "net/packet/internal.h"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "ad7c7b2172c388818a111455643491d75f535e90"
            },
            {
              "fixed": "2dd4781c5af99415ebbd2f7cc763feb109863c05"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "ad7c7b2172c388818a111455643491d75f535e90"
            },
            {
              "fixed": "d8d85ef0a631df9127f202e6371bb33a0b589952"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.14",
        "v6.14-rc5",
        "v6.14-rc6",
        "v6.14-rc7",
        "v6.15",
        "v6.15-rc1",
        "v6.15-rc2",
        "v6.15-rc3",
        "v6.15-rc4",
        "v6.15-rc5",
        "v6.15-rc6",
        "v6.15-rc7",
        "v6.15.1",
        "v6.15.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38150.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.15.0"
            },
            {
              "fixed": "6.15.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_packet: move notifier's packet_dev_mc out of rcu critical section\n\nSyzkaller reports the following issue:\n\n BUG: sleeping function called from invalid context at kernel/locking/mutex.c:578\n __mutex_lock+0x106/0xe80 kernel/locking/mutex.c:746\n team_change_rx_flags+0x38/0x220 drivers/net/team/team_core.c:1781\n dev_change_rx_flags net/core/dev.c:9145 [inline]\n __dev_set_promiscuity+0x3f8/0x590 net/core/dev.c:9189\n netif_set_promiscuity+0x50/0xe0 net/core/dev.c:9201\n dev_set_promiscuity+0x126/0x260 net/core/dev_api.c:286 packet_dev_mc net/packet/af_packet.c:3698 [inline]\n packet_dev_mclist_delete net/packet/af_packet.c:3722 [inline]\n packet_notifier+0x292/0xa60 net/packet/af_packet.c:4247\n notifier_call_chain+0x1b3/0x3e0 kernel/notifier.c:85\n call_netdevice_notifiers_extack net/core/dev.c:2214 [inline]\n call_netdevice_notifiers net/core/dev.c:2228 [inline]\n unregister_netdevice_many_notify+0x15d8/0x2330 net/core/dev.c:11972\n rtnl_delete_link net/core/rtnetlink.c:3522 [inline]\n rtnl_dellink+0x488/0x710 net/core/rtnetlink.c:3564\n rtnetlink_rcv_msg+0x7cf/0xb70 net/core/rtnetlink.c:6955\n netlink_rcv_skb+0x219/0x490 net/netlink/af_netlink.c:2534\n\nCalling `PACKET_ADD_MEMBERSHIP` on an ops-locked device can trigger\nthe `NETDEV_UNREGISTER` notifier, which may require disabling promiscuous\nand/or allmulti mode. Both of these operations require acquiring\nthe netdev instance lock.\n\nMove the call to `packet_dev_mc` outside of the RCU critical section.\nThe `mclist` modifications (add, del, flush, unregister) are protected by\nthe RTNL, not the RCU. The RCU only protects the `sklist` and its\nassociated `sks`. The delayed operation on the `mclist` entry remains\nwithin the RTNL.",
  "id": "CVE-2025-38150",
  "modified": "2025-10-15T04:30:28.052515Z",
  "published": "2025-07-03T08:35:55Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/2dd4781c5af99415ebbd2f7cc763feb109863c05"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d8d85ef0a631df9127f202e6371bb33a0b589952"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "af_packet: move notifier's packet_dev_mc out of rcu critical section"
}