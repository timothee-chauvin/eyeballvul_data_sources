{"schema_version":"1.7.3","id":"CVE-2025-38431","published":"2025-07-25T14:22:34.363Z","modified":"2025-11-20T09:17:30.984241Z","summary":"smb: client: fix regression with native SMB symlinks","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nsmb: client: fix regression with native SMB symlinks\n\nSome users and customers reported that their backup/copy tools started\nto fail when the directory being copied contained symlink targets that\nthe client couldn't parse - even when those symlinks weren't followed.\n\nFix this by allowing lstat(2) and readlink(2) to succeed even when the\nclient can't resolve the symlink target, restoring old behavior.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"12b466eb52d926802b6898d2cb7e67386467f54a"},{"fixed":"6ddaf7567080c7de2e0c99efca2ee1e6b79beea5"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"12b466eb52d926802b6898d2cb7e67386467f54a"},{"fixed":"ff8abbd248c1f52df0c321690b88454b13ff54b2"}]}],"versions":["v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.2","v6.15.3","v6.15.4","v6.16-rc1","v6.16-rc2","v6.16-rc3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38431.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["162371644524792098640265567888297784619","130734416983232160800692231302125343065","254782156329356505459234934332953398428","239123614816887810049095791541338195617","39934624846458003206918310429478332103","237523289699076467867380218460724651124","312051064400369053162149737972150268090","92521923661101962664792617606259198316","195695934540888562241055055514873710771","16563239707340212925899619463079297240","279074387537809185870817133914175207098","196769926218283672735641671647828224048","291560322734202377104081119532252048528","265323786465770398738688400541812690454","39934624846458003206918310429478332103","237523289699076467867380218460724651124","312051064400369053162149737972150268090","92521923661101962664792617606259198316","199105109713045531584394031153466980899","317485157204476399322654574792495532545","2452491406126787114595964648116415216","298494999117992911052270475694140744760","142619512729141124907574016726962530498"],"threshold":0.9},"id":"CVE-2025-38431-627d2383","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ff8abbd248c1f52df0c321690b88454b13ff54b2","target":{"file":"fs/smb/client/reparse.c"}},{"deprecated":false,"digest":{"function_hash":"82580409891326102262992649813057854790","length":2865},"id":"CVE-2025-38431-a0648701","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ddaf7567080c7de2e0c99efca2ee1e6b79beea5","target":{"file":"fs/smb/client/reparse.c","function":"smb2_parse_native_symlink"}},{"deprecated":false,"digest":{"line_hashes":["162371644524792098640265567888297784619","130734416983232160800692231302125343065","254782156329356505459234934332953398428","239123614816887810049095791541338195617","39934624846458003206918310429478332103","237523289699076467867380218460724651124","312051064400369053162149737972150268090","92521923661101962664792617606259198316","195695934540888562241055055514873710771","16563239707340212925899619463079297240","279074387537809185870817133914175207098","196769926218283672735641671647828224048","291560322734202377104081119532252048528","265323786465770398738688400541812690454","39934624846458003206918310429478332103","237523289699076467867380218460724651124","312051064400369053162149737972150268090","92521923661101962664792617606259198316","199105109713045531584394031153466980899","317485157204476399322654574792495532545","2452491406126787114595964648116415216","298494999117992911052270475694140744760","142619512729141124907574016726962530498"],"threshold":0.9},"id":"CVE-2025-38431-b81cb4d3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ddaf7567080c7de2e0c99efca2ee1e6b79beea5","target":{"file":"fs/smb/client/reparse.c"}},{"deprecated":false,"digest":{"function_hash":"82580409891326102262992649813057854790","length":2865},"id":"CVE-2025-38431-d7c0a12d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ff8abbd248c1f52df0c321690b88454b13ff54b2","target":{"file":"fs/smb/client/reparse.c","function":"smb2_parse_native_symlink"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.15.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38431.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6ddaf7567080c7de2e0c99efca2ee1e6b79beea5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ff8abbd248c1f52df0c321690b88454b13ff54b2"}]}