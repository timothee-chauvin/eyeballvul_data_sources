{"schema_version":"1.7.3","id":"CVE-2025-38140","published":"2025-07-03T08:35:41.929Z","modified":"2025-11-20T09:01:54.857417Z","summary":"dm: limit swapping tables for devices with zone write plugs","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndm: limit swapping tables for devices with zone write plugs\n\ndm_revalidate_zones() only allowed new or previously unzoned devices to\ncall blk_revalidate_disk_zones(). If the device was already zoned,\ndisk->nr_zones would always equal md->nr_zones, so dm_revalidate_zones()\nreturned without doing any work. This would make the zoned settings for\nthe device not match the new table. If the device had zone write plug\nresources, it could run into errors like bdev_zone_is_seq() reading\ninvalid memory because disk->conv_zones_bitmap was the wrong size.\n\nIf the device doesn't have any zone write plug resources, calling\nblk_revalidate_disk_zones() will always correctly update device.  If\nblk_revalidate_disk_zones() fails, it can still overwrite or clear the\ncurrent disk->nr_zones value. In this case, DM must restore the previous\nvalue of disk->nr_zones, so that the zoned settings will continue to\nmatch the previous value that it fell back to.\n\nIf the device already has zone write plug resources,\nblk_revalidate_disk_zones() will not correctly update them, if it is\ncalled for arbitrary zoned device changes.  Since there is not much need\nfor this ability, the easiest solution is to disallow any table reloads\nthat change the zoned settings, for devices that already have zone plug\nresources.  Specifically, if a device already has zone plug resources\nallocated, it can only switch to another zoned table that also emulates\nzone append.  Also, it cannot change the device size or the zone size. A\ndevice can switch to an error target.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bb37d77239af25cde59693dbe3fac04dd17d7b29"},{"fixed":"ac8acb0bfd98a1c65f3ca9a3e217a766124eebd8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bb37d77239af25cde59693dbe3fac04dd17d7b29"},{"fixed":"121218bef4c1df165181f5cd8fc3a2246bac817e"}]}],"versions":["v5.13","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.2","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38140.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["59152965094667269638473185991302557359","333594081967694280359440548998562785390","192509881515359224250144876365593003780","114805808291709547200068127494308855464","279461819581150166653529424134869082381","203619221144887699821709689217280107922","223290878061897854874159336520490432689","69185033054438816846222732492953865231","314102350034986423444870551044659820041","244045003571477003737288082546773840628","183910763229482364792040222818354642101","280587556267715721034897735050583348309","314965479436850589873437024851937307022","219139597691927388773310522565025798312"],"threshold":0.9},"id":"CVE-2025-38140-110a81f6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm-table.c"}},{"deprecated":false,"digest":{"line_hashes":["210056694230502262893566497470194469902","129678794766612274940767606689379184982","178571049825870711190725893330225685836","122723184139753757595597204227819060450","294595424247787395605812296741138155411","46016547940323153067110535807106787575","260564547634688738514339390719271325827","66330769712301157785358590468412755830","239626659576870536235165979578387154905","175377040955264570229252087375423760896","100495499877464181346178416576181745192","67319510437164591466250985787720940963","70328469911390216312235156416368793478","295261307251925380702657450587770229380","232622969128715108369066946318162696697","170922173528087212532550305987232419754","5649365391794743673335318171345396869"],"threshold":0.9},"id":"CVE-2025-38140-144b03df","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm.h"}},{"deprecated":false,"digest":{"line_hashes":["129560221997927668008356622755152562862","55236637638318858285301823084834984715","260402079790740874283239565103080338129","191540116484484471194371998786014031333"],"threshold":0.9},"id":"CVE-2025-38140-51b0208e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm.c"}},{"deprecated":false,"digest":{"function_hash":"208277115925481625991325292385022042200","length":1535},"id":"CVE-2025-38140-7ef963d4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm-table.c","function":"dm_table_set_restrictions"}},{"deprecated":false,"digest":{"line_hashes":["121562112052033524396665468428020235485","217785921344649608470291163913078482268","293682894055235828234316988828617030650","72854678070073843935894311194627021935","197406244317566193666621358327216816779","178568509026210911215511890148441509981","23999711184337197265634835106769969337","243541954634672308875460805902009852601","47438935269881809294517229351555555915","298988426498103898009379941746490737736","39067472078428654904295102277190609319","270064186222201504327746867568238112485","256819159221107988203264315116984140449","129156422347405557091725452298509440202","197330157097641560915779388520915547436","3243868838728536246202290135195348053","155545938156156255558179789039550116682","80569649648317567389452527661275339259","35136424181158957441149315216599207570","329085747272758975664712390861518043942","310895465679433416108095816949285078027","331480075016963885550541329193528778442","92793480940348428793687717589432255229","4075621731810444788093152196191316678","35742620841416881923738170737292438575","26099735703414272319207124099422626199","39287836712532603365630953355871671826","218709439385507091696012410358432363024"],"threshold":0.9},"id":"CVE-2025-38140-bda0e307","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm-zone.c"}},{"deprecated":false,"digest":{"function_hash":"303855200947038864282053752508002111532","length":1040},"id":"CVE-2025-38140-d362f59f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm.c","function":"__bind"}},{"deprecated":false,"digest":{"function_hash":"269600708906893596567236515919050550943","length":683},"id":"CVE-2025-38140-d9461f0d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm-zone.c","function":"dm_revalidate_zones"}},{"deprecated":false,"digest":{"function_hash":"113740897709905937694676181869627227302","length":1187},"id":"CVE-2025-38140-e0df0993","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@121218bef4c1df165181f5cd8fc3a2246bac817e","target":{"file":"drivers/md/dm-zone.c","function":"dm_set_zones_restrictions"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.14.0"},{"fixed":"6.15.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38140.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/121218bef4c1df165181f5cd8fc3a2246bac817e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ac8acb0bfd98a1c65f3ca9a3e217a766124eebd8"}]}