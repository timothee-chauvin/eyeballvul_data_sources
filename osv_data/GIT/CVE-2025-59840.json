{"schema_version":"1.7.3","id":"CVE-2025-59840","published":"2025-11-13T19:54:26.256Z","modified":"2025-12-05T10:20:59.083570Z","aliases":["GHSA-7f2v-3qq3-vvjf"],"summary":"Vega Cross-Site Scripting (XSS) via expressions abusing toString calls in environments using the VEGA_DEBUG global variable","details":"Vega is a visualization grammar, a declarative format for creating, saving, and sharing interactive visualization designs. In Vega prior to version 6.2.0, applications meeting 2 conditions are at risk of arbitrary JavaScript code execution, even if \"safe mode\" expressionInterpreter is used. They are vulnerable if they use `vega` in an application that attaches `vega` library and a `vega.View` instance similar to the Vega Editor to the global `window` and if they allow user-defined Vega `JSON` definitions (vs JSON that was is only provided through source code). Patches are available in the following Vega applications. If using the latest Vega line (6.x), upgrade to `vega` `6.2.0` / `vega-expression` `6.1.0` / `vega-interpreter`  `2.2.1` (if using AST evaluator mode). If using Vega in a non-ESM environment, upgrade to `vega-expression` `5.2.1` / `1.2.1` (if using AST evaluator mode). Some workarounds are available. Do not attach `vega` View instances to global variables, and do not attach `vega` to the global window. These practices of attaching the vega library and View instances may be convenient for debugging, but should not be used in production or in any situation where vega/vega-lite definitions could be provided by untrusted parties.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/vega/vega","events":[{"introduced":"0"},{"last_affected":"4dea72921d25bf6ff6636a9f9cb6c63ff696932c"}],"database_specific":{"versions":[{"introduced":"0"},{"last_affected":"vega < 6.2.0"}]}}],"versions":["v1.0.0","v1.1.0","v1.2.0","v1.3.0","v1.3.1","v1.3.2","v1.3.3","v1.3.4","v1.4.0","v1.4.1","v1.4.2","v1.4.3","v1.5.0","v1.5.1","v1.5.4","v3.0.0","v3.0.0-beta.1","v3.0.0-beta.10","v3.0.0-beta.11","v3.0.0-beta.12","v3.0.0-beta.13","v3.0.0-beta.14","v3.0.0-beta.15","v3.0.0-beta.16","v3.0.0-beta.17","v3.0.0-beta.18","v3.0.0-beta.19","v3.0.0-beta.2","v3.0.0-beta.20","v3.0.0-beta.21","v3.0.0-beta.22","v3.0.0-beta.23","v3.0.0-beta.24","v3.0.0-beta.25","v3.0.0-beta.26","v3.0.0-beta.27","v3.0.0-beta.28","v3.0.0-beta.29","v3.0.0-beta.3","v3.0.0-beta.30","v3.0.0-beta.31","v3.0.0-beta.32","v3.0.0-beta.33","v3.0.0-beta.34","v3.0.0-beta.35","v3.0.0-beta.36","v3.0.0-beta.37","v3.0.0-beta.38","v3.0.0-beta.39","v3.0.0-beta.4","v3.0.0-beta.6","v3.0.0-beta.7","v3.0.0-beta.8","v3.0.0-rc1","v3.0.0-rc2","v3.0.0-rc3","v3.0.0-rc4","v3.0.0-rc5","v3.0.0-rc6","v3.0.0-rc7","v3.0.1","v3.0.10","v3.0.2","v3.0.3","v3.0.4","v3.0.5","v3.0.6","v3.0.7","v3.0.8","v3.0.9","v3.1.0","v3.2.0","v3.2.1","v3.3.0","v3.3.1","v4.0.0","v4.0.0-rc.1","v4.0.0-rc.3","v4.1.0","v4.2.0","v4.3.0","v4.4.0","v4.5.1","v5.0.0","v5.0.0-rc1","v5.0.0-rc2","v5.0.0-rc3","v5.0.0-rc4","v5.0.0-rc5","v5.1.0","v5.10.0","v5.10.1","v5.11.0","v5.11.1","v5.12.0","v5.12.1","v5.12.2","v5.12.3","v5.13.0","v5.14.0","v5.15.0","v5.16.0","v5.16.1","v5.17.0","v5.17.1","v5.17.2","v5.17.3","v5.18.0","v5.19.0","v5.19.1","v5.2.0","v5.20.0","v5.20.1","v5.20.2","v5.21.0","v5.22.0","v5.22.1","v5.23.0","v5.24.0","v5.25.0","v5.26.0","v5.26.1","v5.27.0","v5.28.0","v5.29.0","v5.3.0","v5.3.1","v5.3.2","v5.3.3","v5.3.4","v5.3.5","v5.30.0","v5.31.0","v5.32.0","v5.33.0","v5.4.0","v5.4.1","v5.5.0","v5.5.1","v5.5.2","v5.5.3","v5.6.0","v5.7.0","v5.7.1","v5.7.2","v5.7.3","v5.8.0","v5.8.1","v5.9.0","v5.9.1","v5.9.2","v6.0.0","v6.1.0","v6.1.1","v6.1.2","v6.2.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-59840.json","unresolved_ranges":[{"events":[{"introduced":"0"},{"last_affected":"vega-expression >= 6.0.0, < 6.1.0"}]},{"events":[{"introduced":"0"},{"last_affected":"vega-expression < 5.2.1"}]},{"events":[{"introduced":"0"},{"last_affected":"vega-interpreter >= 2.0.0, < 2.2.1"}]},{"events":[{"introduced":"0"},{"last_affected":"vega-interpreter < 1.2.1"}]}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/59xxx/CVE-2025-59840.json"},{"type":"ADVISORY","url":"https://github.com/vega/vega/security/advisories/GHSA-7f2v-3qq3-vvjf"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-59840"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-79"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/59xxx/CVE-2025-59840.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N"}]}