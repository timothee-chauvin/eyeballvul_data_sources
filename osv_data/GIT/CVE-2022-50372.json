{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50372.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "174995013714320549312491029557963206983",
                "225741083891792501969837686478156582262",
                "81222237700166858020079920688084111624",
                "173599409874349972975915198875107105558"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50372-1d4a893a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa5a70bdd5e565c8696fb04dfe18a4e8aff4695d",
            "target": {
              "file": "fs/cifs/smb2pdu.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "237151727711306910492846824016481450173",
              "length": 1791.0
            },
            "id": "CVE-2022-50372-76c06b09",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa5a70bdd5e565c8696fb04dfe18a4e8aff4695d",
            "target": {
              "file": "fs/cifs/smb2pdu.c",
              "function": "SMB2_sess_auth_rawntlmssp_negotiate"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "174995013714320549312491029557963206983",
                "225741083891792501969837686478156582262",
                "81222237700166858020079920688084111624",
                "173599409874349972975915198875107105558"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50372-e2aa1a04",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30b2d7f8f13664655480d6af45f60270b3eb6736",
            "target": {
              "file": "fs/cifs/smb2pdu.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "272148982756727382559083108072129359860",
              "length": 1797.0
            },
            "id": "CVE-2022-50372-fe6196cc",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30b2d7f8f13664655480d6af45f60270b3eb6736",
            "target": {
              "file": "fs/cifs/smb2pdu.c",
              "function": "SMB2_sess_auth_rawntlmssp_negotiate"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "49bd49f983b5026e4557d31c5d737d9657c4113e"
            },
            {
              "fixed": "fa5a70bdd5e565c8696fb04dfe18a4e8aff4695d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "49bd49f983b5026e4557d31c5d737d9657c4113e"
            },
            {
              "fixed": "30b2d7f8f13664655480d6af45f60270b3eb6736"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.0.1",
        "v6.0.2",
        "v6.0.3",
        "v6.0.4",
        "v6.0.5",
        "v6.1-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50372.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "6.0.6"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ncifs: Fix memory leak when build ntlmssp negotiate blob failed\n\nThere is a memory leak when mount cifs:\n  unreferenced object 0xffff888166059600 (size 448):\n    comm \"mount.cifs\", pid 51391, jiffies 4295596373 (age 330.596s)\n    hex dump (first 32 bytes):\n      fe 53 4d 42 40 00 00 00 00 00 00 00 01 00 82 00  .SMB@...........\n      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    backtrace:\n      [<0000000060609a61>] mempool_alloc+0xe1/0x260\n      [<00000000adfa6c63>] cifs_small_buf_get+0x24/0x60\n      [<00000000ebb404c7>] __smb2_plain_req_init+0x32/0x460\n      [<00000000bcf875b4>] SMB2_sess_alloc_buffer+0xa4/0x3f0\n      [<00000000753a2987>] SMB2_sess_auth_rawntlmssp_negotiate+0xf5/0x480\n      [<00000000f0c1f4f9>] SMB2_sess_setup+0x253/0x410\n      [<00000000a8b83303>] cifs_setup_session+0x18f/0x4c0\n      [<00000000854bd16d>] cifs_get_smb_ses+0xae7/0x13c0\n      [<000000006cbc43d9>] mount_get_conns+0x7a/0x730\n      [<000000005922d816>] cifs_mount+0x103/0xd10\n      [<00000000e33def3b>] cifs_smb3_do_mount+0x1dd/0xc90\n      [<0000000078034979>] smb3_get_tree+0x1d5/0x300\n      [<000000004371f980>] vfs_get_tree+0x41/0xf0\n      [<00000000b670d8a7>] path_mount+0x9b3/0xdd0\n      [<000000005e839a7d>] __x64_sys_mount+0x190/0x1d0\n      [<000000009404c3b9>] do_syscall_64+0x35/0x80\n\nWhen build ntlmssp negotiate blob failed, the session setup request\nshould be freed.",
  "id": "CVE-2022-50372",
  "modified": "2025-10-21T12:09:49.251608Z",
  "published": "2025-09-17T14:56:27Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/30b2d7f8f13664655480d6af45f60270b3eb6736"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/fa5a70bdd5e565c8696fb04dfe18a4e8aff4695d"
    }
  ],
  "related": [
    "SUSE-SU-2025:03614-1",
    "SUSE-SU-2025:03615-1",
    "SUSE-SU-2025:03628-1",
    "SUSE-SU-2025:3716-1",
    "SUSE-SU-2025:3761-1"
  ],
  "schema_version": "1.7.3",
  "summary": "cifs: Fix memory leak when build ntlmssp negotiate blob failed"
}