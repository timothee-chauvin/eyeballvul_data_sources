{"schema_version":"1.7.3","id":"CVE-2021-28398","published":"2022-09-05T17:15:19Z","modified":"2025-10-21T06:05:03.640388Z","related":["GHSA-cf8p-c88c-h9jf"],"details":"A privileged attacker in GeoNetwork before 3.12.0 and 4.x before 4.0.4 can use the directory harvester before-script to execute arbitrary OS commands remotely on the hosting infrastructure. A User Administrator or Administrator account is required to perform this. This occurs in the runBeforeScript method in harvesters/src/main/java/org/fao/geonet/kernel/harvest/harvester/localfilesystem/LocalFilesystemHarvester.java. The earliest affected version is 3.4.0.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/geonetwork/core-geonetwork","events":[{"introduced":"5b4f72acb979605e3aa49d923fd8e21c8ccf4591"},{"fixed":"72bf9606a19b80dff9cd56fbe3f718a932f21aa3"}]}],"versions":["3.4.0","3.4.1","3.4.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-28398.json"}}],"references":[{"type":"FIX","url":"https://geonetwork-opensource.org/manuals/trunk/en/overview/change-log/version-3.6.0.html"},{"type":"ADVISORY","url":"https://github.com/geonetwork/core-geonetwork"},{"type":"FIX","url":"https://github.com/geonetwork/core-geonetwork/security/advisories/GHSA-cf8p-c88c-h9jf"},{"type":"WEB","url":"https://geonetwork-opensource.org/"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"}]}