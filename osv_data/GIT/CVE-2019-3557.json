{"schema_version":"1.7.3","id":"CVE-2019-3557","published":"2019-01-15T22:29:00Z","modified":"2025-10-21T05:09:26.897746Z","details":"The implementations of streams for bz2 and php://output improperly implemented their readImpl functions, returning -1 consistently. This behavior caused some stream functions, such as stream_get_line, to trigger an out-of-bounds read when operating on such malformed streams. The implementations were updated to return valid values consistently. This affects all supported versions of HHVM (3.30 and 3.27.4 and below).","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/facebook/hhvm","events":[{"introduced":"0"},{"fixed":"6e4dd9ec3f14b48170fc45dc9d13a3261765f994"}]}],"versions":["HPHP-2.1.0","gcc-4.6","pre-hhvm","src-hphp"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2019-3557.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["142108827713512514436185405057893135105","269656250916374553211667901320829428383","319612009202422336968135164533114029828","15002152957258456447109582021990837697"],"threshold":0.9},"id":"CVE-2019-3557-43cc3ee9","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/hhvm/commit/6e4dd9ec3f14b48170fc45dc9d13a3261765f994","target":{"file":"hphp/runtime/base/output-file.cpp"}},{"deprecated":false,"digest":{"function_hash":"12047624258055674249961091365408552516","length":121},"id":"CVE-2019-3557-55b6d914","signature_type":"Function","signature_version":"v1","source":"https://github.com/facebook/hhvm/commit/6e4dd9ec3f14b48170fc45dc9d13a3261765f994","target":{"file":"hphp/runtime/base/output-file.cpp","function":"OutputFile::readImpl"}},{"deprecated":false,"digest":{"line_hashes":["110901687410337669414477894623879298352","95572666697477733803261616521873614957","106358059622253155722317322929847808364","122347618177407082596295890497230634246"],"threshold":0.9},"id":"CVE-2019-3557-a05c634b","signature_type":"Line","signature_version":"v1","source":"https://github.com/facebook/hhvm/commit/6e4dd9ec3f14b48170fc45dc9d13a3261765f994","target":{"file":"hphp/runtime/ext/bz2/bz2-file.cpp"}},{"deprecated":false,"digest":{"function_hash":"22265091904922056449492719171830689508","length":255},"id":"CVE-2019-3557-bb1a0814","signature_type":"Function","signature_version":"v1","source":"https://github.com/facebook/hhvm/commit/6e4dd9ec3f14b48170fc45dc9d13a3261765f994","target":{"file":"hphp/runtime/ext/bz2/bz2-file.cpp","function":"BZ2File::readImpl"}}]}}],"references":[{"type":"FIX","url":"https://github.com/facebook/hhvm/commit/6e4dd9ec3f14b48170fc45dc9d13a3261765f994"},{"type":"ADVISORY","url":"https://hhvm.com/blog/2019/01/14/hhvm-3.30.2.html"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}