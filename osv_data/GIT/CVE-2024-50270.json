{"schema_version":"1.7.3","id":"CVE-2024-50270","published":"2024-11-19T01:30:08.406Z","modified":"2025-11-20T06:29:34.174325Z","related":["USN-7276-1","USN-7277-1"],"summary":"mm/damon/core: avoid overflow in damon_feed_loop_next_input()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmm/damon/core: avoid overflow in damon_feed_loop_next_input()\n\ndamon_feed_loop_next_input() is inefficient and fragile to overflows. \nSpecifically, 'score_goal_diff_bp' calculation can overflow when 'score'\nis high.  The calculation is actually unnecessary at all because 'goal' is\na constant of value 10,000.  Calculation of 'compensation' is again\nfragile to overflow.  Final calculation of return value for under-achiving\ncase is again fragile to overflow when the current score is\nunder-achieving the target.\n\nAdd two corner cases handling at the beginning of the function to make the\nbody easier to read, and rewrite the body of the function to avoid\noverflows and the unnecessary bp value calcuation.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"9294a037c01564786abb15436529fae3863268a2"},{"fixed":"2d339a1f0f16ff5dea58e612ff336f0be0d041e9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"9294a037c01564786abb15436529fae3863268a2"},{"fixed":"4401e9d10ab0281a520b9f8c220f30f60b5c248f"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.11.3","v6.11.4","v6.11.5","v6.11.6","v6.11.7","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.7","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50270.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["65007457704835016912843392364820075915","18131834065874344434162307907086289227","57689691378413592056556118884961617239","229037255500069284876288717038641999470","279352029221015755351321984534269289864","297224604114163644713369135778344676967","259431149945055396546434218827259364781","197240358591484510567005081583006889645","249422535912121485057019600658733096898","6797142119710021453109066728496160023","114065727357876668559590005542754969662","70073655670053196866780735453742696688"],"threshold":0.9},"id":"CVE-2024-50270-b6c35416","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d339a1f0f16ff5dea58e612ff336f0be0d041e9","target":{"file":"mm/damon/core.c"}},{"deprecated":false,"digest":{"function_hash":"79762859361694990612954926748024666449","length":410},"id":"CVE-2024-50270-c0ca9a2f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d339a1f0f16ff5dea58e612ff336f0be0d041e9","target":{"file":"mm/damon/core.c","function":"damon_feed_loop_next_input"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.11.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50270.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2d339a1f0f16ff5dea58e612ff336f0be0d041e9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4401e9d10ab0281a520b9f8c220f30f60b5c248f"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}