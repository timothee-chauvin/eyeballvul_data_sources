{"schema_version":"1.7.3","id":"CVE-2025-38688","published":"2025-09-04T15:32:42.607Z","modified":"2025-11-20T10:26:04.181070Z","related":["MGASA-2025-0234","MGASA-2025-0235"],"summary":"iommufd: Prevent ALIGN() overflow","details":"In the Linux kernel, the following vulnerability has been resolved:\n\niommufd: Prevent ALIGN() overflow\n\nWhen allocating IOVA the candidate range gets aligned to the target\nalignment. If the range is close to ULONG_MAX then the ALIGN() can\nwrap resulting in a corrupted iova.\n\nOpen code the ALIGN() using get_add_overflow() to prevent this.\nThis simplifies the checks as we don't need to check for length earlier\neither.\n\nConsolidate the two copies of this code under a single helper.\n\nThis bug would allow userspace to create a mapping that overlaps with some\nother mapping or a reserved range.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"51fe6141f0f64ae0bbc096a41a07572273e8c0ef"},{"fixed":"d19b817540c0abe84854a64ee9ee34cecc3bbeef"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"51fe6141f0f64ae0bbc096a41a07572273e8c0ef"},{"fixed":"ebb6021560b94649bec6b8faba6fe0dca2218e81"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"51fe6141f0f64ae0bbc096a41a07572273e8c0ef"},{"fixed":"e42a046bb41dcdde4f766a17d8211842007ed537"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"51fe6141f0f64ae0bbc096a41a07572273e8c0ef"},{"fixed":"79fad1917802c28de51a479318a056a6fbe3e2f2"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"51fe6141f0f64ae0bbc096a41a07572273e8c0ef"},{"fixed":"b42497e3c0e74db061eafad41c0cd7243c46436b"}]}],"versions":["v6.1","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.35","v6.12.36","v6.12.37","v6.12.38","v6.12.39","v6.12.4","v6.12.40","v6.12.41","v6.12.42","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.10","v6.15.2","v6.15.3","v6.15.4","v6.15.5","v6.15.6","v6.15.7","v6.15.8","v6.15.9","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.100","v6.6.101","v6.6.102","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.85","v6.6.86","v6.6.87","v6.6.88","v6.6.89","v6.6.9","v6.6.90","v6.6.91","v6.6.92","v6.6.93","v6.6.94","v6.6.95","v6.6.96","v6.6.97","v6.6.98","v6.6.99","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38688.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"233589220468212233255247410013641227241","length":413},"id":"CVE-2025-38688-01e4c79c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e42a046bb41dcdde4f766a17d8211842007ed537","target":{"file":"drivers/iommu/iommufd/io_pagetable.c","function":"__alloc_iova_check_hole"}},{"deprecated":false,"digest":{"function_hash":"233589220468212233255247410013641227241","length":413},"id":"CVE-2025-38688-0ea7695d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d19b817540c0abe84854a64ee9ee34cecc3bbeef","target":{"file":"drivers/iommu/iommufd/io_pagetable.c","function":"__alloc_iova_check_hole"}},{"deprecated":false,"digest":{"function_hash":"233589220468212233255247410013641227241","length":413},"id":"CVE-2025-38688-1646a332","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ebb6021560b94649bec6b8faba6fe0dca2218e81","target":{"file":"drivers/iommu/iommufd/io_pagetable.c","function":"__alloc_iova_check_hole"}},{"deprecated":false,"digest":{"line_hashes":["156479895442245577972849383869803125709","120423311677018900146268936631185682211","261169513608983466675526650742264434226","22230938975993561732067647476556165802","77291322962189458116717697203606993781","21491644473629645377898153069758664321","188613046505049541423048484997683543279","303259237557656731271162493509856838827","44998615657189270632539397210780052772","185869539087754602803324177359470923676","307115974034251641939736775896081470908","262175708105207338822537385082078423796","7247739569570786104464193542456926041","240922507861931214090558502151661879742","114153893669554029888104137621147849187","208163863007192525912239245098661203453","200741609244541950876630789970492963412","128032107604971601666225689001557742252","77291322962189458116717697203606993781","108777087282719599764088856407474218044","198702309974408958123589502120480358849","220476645331248341649930006650522368527","77686258195652329560897125406856711325","20126400372206569798784504574518746341","73798573082153298731841609276605433398","131018988478466659197791742863547976792","297088960873551872896522543501913979608","232745844763934340247804468388470801793","35377060870015491722897253724679381057","252347138143295119550924547804615068854"],"threshold":0.9},"id":"CVE-2025-38688-4e29b4a0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e42a046bb41dcdde4f766a17d8211842007ed537","target":{"file":"drivers/iommu/iommufd/io_pagetable.c"}},{"deprecated":false,"digest":{"line_hashes":["156479895442245577972849383869803125709","120423311677018900146268936631185682211","261169513608983466675526650742264434226","22230938975993561732067647476556165802","77291322962189458116717697203606993781","21491644473629645377898153069758664321","188613046505049541423048484997683543279","303259237557656731271162493509856838827","44998615657189270632539397210780052772","185869539087754602803324177359470923676","307115974034251641939736775896081470908","262175708105207338822537385082078423796","7247739569570786104464193542456926041","240922507861931214090558502151661879742","114153893669554029888104137621147849187","208163863007192525912239245098661203453","200741609244541950876630789970492963412","128032107604971601666225689001557742252","77291322962189458116717697203606993781","108777087282719599764088856407474218044","198702309974408958123589502120480358849","220476645331248341649930006650522368527","77686258195652329560897125406856711325","20126400372206569798784504574518746341","73798573082153298731841609276605433398","131018988478466659197791742863547976792","297088960873551872896522543501913979608","232745844763934340247804468388470801793","35377060870015491722897253724679381057","15684886207696187356445556443772770526"],"threshold":0.9},"id":"CVE-2025-38688-b10a0363","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d19b817540c0abe84854a64ee9ee34cecc3bbeef","target":{"file":"drivers/iommu/iommufd/io_pagetable.c"}},{"deprecated":false,"digest":{"function_hash":"18498634528452173555409925472397936453","length":413},"id":"CVE-2025-38688-dcfcadc2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e42a046bb41dcdde4f766a17d8211842007ed537","target":{"file":"drivers/iommu/iommufd/io_pagetable.c","function":"__alloc_iova_check_used"}},{"deprecated":false,"digest":{"function_hash":"18498634528452173555409925472397936453","length":413},"id":"CVE-2025-38688-df929e9c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ebb6021560b94649bec6b8faba6fe0dca2218e81","target":{"file":"drivers/iommu/iommufd/io_pagetable.c","function":"__alloc_iova_check_used"}},{"deprecated":false,"digest":{"line_hashes":["156479895442245577972849383869803125709","120423311677018900146268936631185682211","261169513608983466675526650742264434226","22230938975993561732067647476556165802","77291322962189458116717697203606993781","21491644473629645377898153069758664321","188613046505049541423048484997683543279","303259237557656731271162493509856838827","44998615657189270632539397210780052772","185869539087754602803324177359470923676","307115974034251641939736775896081470908","262175708105207338822537385082078423796","7247739569570786104464193542456926041","240922507861931214090558502151661879742","114153893669554029888104137621147849187","208163863007192525912239245098661203453","200741609244541950876630789970492963412","128032107604971601666225689001557742252","77291322962189458116717697203606993781","108777087282719599764088856407474218044","198702309974408958123589502120480358849","220476645331248341649930006650522368527","77686258195652329560897125406856711325","20126400372206569798784504574518746341","73798573082153298731841609276605433398","131018988478466659197791742863547976792","297088960873551872896522543501913979608","232745844763934340247804468388470801793","35377060870015491722897253724679381057","15684886207696187356445556443772770526"],"threshold":0.9},"id":"CVE-2025-38688-f38a2b6f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ebb6021560b94649bec6b8faba6fe0dca2218e81","target":{"file":"drivers/iommu/iommufd/io_pagetable.c"}},{"deprecated":false,"digest":{"function_hash":"18498634528452173555409925472397936453","length":413},"id":"CVE-2025-38688-f6d84405","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d19b817540c0abe84854a64ee9ee34cecc3bbeef","target":{"file":"drivers/iommu/iommufd/io_pagetable.c","function":"__alloc_iova_check_used"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.103"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.43"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.15.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.16.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38688.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/79fad1917802c28de51a479318a056a6fbe3e2f2"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b42497e3c0e74db061eafad41c0cd7243c46436b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d19b817540c0abe84854a64ee9ee34cecc3bbeef"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e42a046bb41dcdde4f766a17d8211842007ed537"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ebb6021560b94649bec6b8faba6fe0dca2218e81"}]}