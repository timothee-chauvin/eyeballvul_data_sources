{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35917.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "26009330636640040962166486618429033241",
              "length": 1855.0
            },
            "id": "CVE-2024-35917-0bd99450",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d3d74e45a060d218fe4b0c9174f0a77517509d8e",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_int_jit_compile"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "26009330636640040962166486618429033241",
              "length": 1855.0
            },
            "id": "CVE-2024-35917-1e858b0a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3062bdb859b6e2567e7f5c8cde20c0250bb130f",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_int_jit_compile"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "40426479464887600431918660719014077291",
              "length": 609.0
            },
            "id": "CVE-2024-35917-24180c7f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7ded842b356d151ece8ac4985940438e6d3998bb",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_jit_epilogue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "56176622506541462722681377773353618713",
              "length": 286.0
            },
            "id": "CVE-2024-35917-2493d7e4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d3d74e45a060d218fe4b0c9174f0a77517509d8e",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_jit_plt"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "26009330636640040962166486618429033241",
              "length": 1855.0
            },
            "id": "CVE-2024-35917-3794d79f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7ded842b356d151ece8ac4985940438e6d3998bb",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_int_jit_compile"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "105917023297953212386514112734003925260",
                "79569957144557323048178516908412718477",
                "242678793686420369686479535214183494570",
                "55124488266189034717777542486260076289",
                "30599145934957703515275141354764986022",
                "22187300045414543922688778335284885370",
                "108356092680865995676024278875265449772",
                "205886237933048807001362414940948619942",
                "36581922521378553418965673078334159120",
                "198612486409494058711276278301811471244",
                "72970091157970761533291002768452646367",
                "82289976992778485971883717827909615752",
                "132736579040588725150463968815144718111",
                "233260983880366746330857047924983294487",
                "216704168437792365991713943113937547700",
                "283865392601908358474126906105513649024",
                "42224693429317895140032386946119454190",
                "18292508079238723467371166017694418563",
                "318394032268431612271712399699408604753",
                "54338912515853096144290387052468047603",
                "41995926205853581944355646084904592727",
                "330740523252197733231116531879484270439",
                "50035058304887749642933347342595774659",
                "58837811202747529341276000822814914815",
                "31688554599350648149911485877768765137",
                "120021013540160978746007752551881763727",
                "177415162275420337358210411787844265583",
                "313145161933586665945035752921649488194",
                "30128415312942080971984656554251480978",
                "40002455914050349552130088986620843675",
                "122136392416802763709358839798708276502",
                "281817976867294782725703530803209039804",
                "132585632060890170030167702692010739841",
                "261882061492427208032933017943416707162",
                "98946466092059072532105690426475371242",
                "337856952101095616478061016928513753560",
                "113189787266830674542245667622858578350",
                "98230970188138150179429648872401970999",
                "115174873888347333720547101813058078664",
                "72813322356635486852226326427784251739",
                "54317926399504578425565155207207650898",
                "283673401425952813940108062636008469973",
                "104843974347396270812867483564435875871",
                "5321892878073362866259679605785567474",
                "13052976546855073153093868637502652133",
                "106856607271762775554227085687594499132",
                "30732971426094930296852639002308449079",
                "162216283479324719487344589564232048797",
                "279195790455674547743213074125454010548",
                "296905664512758286193399593260596426830",
                "275059998812951112520586115047148389653",
                "308746760408227279020211894337353545600"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35917-522bf76a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7ded842b356d151ece8ac4985940438e6d3998bb",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "56176622506541462722681377773353618713",
              "length": 286.0
            },
            "id": "CVE-2024-35917-628cdbe4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7ded842b356d151ece8ac4985940438e6d3998bb",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_jit_plt"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "40426479464887600431918660719014077291",
              "length": 609.0
            },
            "id": "CVE-2024-35917-62d21883",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3062bdb859b6e2567e7f5c8cde20c0250bb130f",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_jit_epilogue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "211793325828624741781924698710907652280",
              "length": 1041.0
            },
            "id": "CVE-2024-35917-66df1a91",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7ded842b356d151ece8ac4985940438e6d3998bb",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_arch_text_poke"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "211793325828624741781924698710907652280",
              "length": 1041.0
            },
            "id": "CVE-2024-35917-a281cbc1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d3d74e45a060d218fe4b0c9174f0a77517509d8e",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_arch_text_poke"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "40426479464887600431918660719014077291",
              "length": 609.0
            },
            "id": "CVE-2024-35917-a3cdd420",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d3d74e45a060d218fe4b0c9174f0a77517509d8e",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_jit_epilogue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "56176622506541462722681377773353618713",
              "length": 286.0
            },
            "id": "CVE-2024-35917-a62f0fc1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3062bdb859b6e2567e7f5c8cde20c0250bb130f",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_jit_plt"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "105917023297953212386514112734003925260",
                "79569957144557323048178516908412718477",
                "242678793686420369686479535214183494570",
                "55124488266189034717777542486260076289",
                "30599145934957703515275141354764986022",
                "22187300045414543922688778335284885370",
                "108356092680865995676024278875265449772",
                "205886237933048807001362414940948619942",
                "36581922521378553418965673078334159120",
                "198612486409494058711276278301811471244",
                "72970091157970761533291002768452646367",
                "82289976992778485971883717827909615752",
                "132736579040588725150463968815144718111",
                "233260983880366746330857047924983294487",
                "216704168437792365991713943113937547700",
                "283865392601908358474126906105513649024",
                "42224693429317895140032386946119454190",
                "18292508079238723467371166017694418563",
                "318394032268431612271712399699408604753",
                "54338912515853096144290387052468047603",
                "41995926205853581944355646084904592727",
                "330740523252197733231116531879484270439",
                "50035058304887749642933347342595774659",
                "58837811202747529341276000822814914815",
                "31688554599350648149911485877768765137",
                "120021013540160978746007752551881763727",
                "177415162275420337358210411787844265583",
                "313145161933586665945035752921649488194",
                "30128415312942080971984656554251480978",
                "40002455914050349552130088986620843675",
                "122136392416802763709358839798708276502",
                "281817976867294782725703530803209039804",
                "132585632060890170030167702692010739841",
                "261882061492427208032933017943416707162",
                "98946466092059072532105690426475371242",
                "337856952101095616478061016928513753560",
                "113189787266830674542245667622858578350",
                "98230970188138150179429648872401970999",
                "115174873888347333720547101813058078664",
                "72813322356635486852226326427784251739",
                "54317926399504578425565155207207650898",
                "283673401425952813940108062636008469973",
                "104843974347396270812867483564435875871",
                "5321892878073362866259679605785567474",
                "13052976546855073153093868637502652133",
                "106856607271762775554227085687594499132",
                "30732971426094930296852639002308449079",
                "162216283479324719487344589564232048797",
                "279195790455674547743213074125454010548",
                "296905664512758286193399593260596426830",
                "275059998812951112520586115047148389653",
                "308746760408227279020211894337353545600"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35917-ad65eb98",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3062bdb859b6e2567e7f5c8cde20c0250bb130f",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "211793325828624741781924698710907652280",
              "length": 1041.0
            },
            "id": "CVE-2024-35917-d3ae4709",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3062bdb859b6e2567e7f5c8cde20c0250bb130f",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c",
              "function": "bpf_arch_text_poke"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "105917023297953212386514112734003925260",
                "79569957144557323048178516908412718477",
                "242678793686420369686479535214183494570",
                "55124488266189034717777542486260076289",
                "30599145934957703515275141354764986022",
                "22187300045414543922688778335284885370",
                "108356092680865995676024278875265449772",
                "205886237933048807001362414940948619942",
                "36581922521378553418965673078334159120",
                "198612486409494058711276278301811471244",
                "72970091157970761533291002768452646367",
                "82289976992778485971883717827909615752",
                "132736579040588725150463968815144718111",
                "233260983880366746330857047924983294487",
                "216704168437792365991713943113937547700",
                "283865392601908358474126906105513649024",
                "42224693429317895140032386946119454190",
                "18292508079238723467371166017694418563",
                "318394032268431612271712399699408604753",
                "54338912515853096144290387052468047603",
                "41995926205853581944355646084904592727",
                "330740523252197733231116531879484270439",
                "50035058304887749642933347342595774659",
                "58837811202747529341276000822814914815",
                "31688554599350648149911485877768765137",
                "120021013540160978746007752551881763727",
                "177415162275420337358210411787844265583",
                "313145161933586665945035752921649488194",
                "30128415312942080971984656554251480978",
                "40002455914050349552130088986620843675",
                "122136392416802763709358839798708276502",
                "281817976867294782725703530803209039804",
                "132585632060890170030167702692010739841",
                "261882061492427208032933017943416707162",
                "98946466092059072532105690426475371242",
                "337856952101095616478061016928513753560",
                "113189787266830674542245667622858578350",
                "98230970188138150179429648872401970999",
                "115174873888347333720547101813058078664",
                "72813322356635486852226326427784251739",
                "54317926399504578425565155207207650898",
                "283673401425952813940108062636008469973",
                "104843974347396270812867483564435875871",
                "5321892878073362866259679605785567474",
                "13052976546855073153093868637502652133",
                "106856607271762775554227085687594499132",
                "30732971426094930296852639002308449079",
                "162216283479324719487344589564232048797",
                "279195790455674547743213074125454010548",
                "296905664512758286193399593260596426830",
                "275059998812951112520586115047148389653",
                "308746760408227279020211894337353545600"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35917-f5601c2c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d3d74e45a060d218fe4b0c9174f0a77517509d8e",
            "target": {
              "file": "arch/s390/net/bpf_jit_comp.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f1d5df84cd8c3ec6460c78f5b86be7c84577a83f"
            },
            {
              "fixed": "c3062bdb859b6e2567e7f5c8cde20c0250bb130f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f1d5df84cd8c3ec6460c78f5b86be7c84577a83f"
            },
            {
              "fixed": "d3d74e45a060d218fe4b0c9174f0a77517509d8e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f1d5df84cd8c3ec6460c78f5b86be7c84577a83f"
            },
            {
              "fixed": "7ded842b356d151ece8ac4985940438e6d3998bb"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.2",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35917.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.3.0"
            },
            {
              "fixed": "6.6.26"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.8.5"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ns390/bpf: Fix bpf_plt pointer arithmetic\n\nKui-Feng Lee reported a crash on s390x triggered by the\ndummy_st_ops/dummy_init_ptr_arg test [1]:\n\n  [<0000000000000002>] 0x2\n  [<00000000009d5cde>] bpf_struct_ops_test_run+0x156/0x250\n  [<000000000033145a>] __sys_bpf+0xa1a/0xd00\n  [<00000000003319dc>] __s390x_sys_bpf+0x44/0x50\n  [<0000000000c4382c>] __do_syscall+0x244/0x300\n  [<0000000000c59a40>] system_call+0x70/0x98\n\nThis is caused by GCC moving memcpy() after assignments in\nbpf_jit_plt(), resulting in NULL pointers being written instead of\nthe return and the target addresses.\n\nLooking at the GCC internals, the reordering is allowed because the\nalias analysis thinks that the memcpy() destination and the assignments'\nleft-hand-sides are based on different objects: new_plt and\nbpf_plt_ret/bpf_plt_target respectively, and therefore they cannot\nalias.\n\nThis is in turn due to a violation of the C standard:\n\n  When two pointers are subtracted, both shall point to elements of the\n  same array object, or one past the last element of the array object\n  ...\n\nFrom the C's perspective, bpf_plt_ret and bpf_plt are distinct objects\nand cannot be subtracted. In the practical terms, doing so confuses the\nGCC's alias analysis.\n\nThe code was written this way in order to let the C side know a few\noffsets defined in the assembly. While nice, this is by no means\nnecessary. Fix the noncompliance by hardcoding these offsets.\n\n[1] https://lore.kernel.org/bpf/c9923c1d-971d-4022-8dc8-1364e929d34c@gmail.com/",
  "id": "CVE-2024-35917",
  "modified": "2025-10-15T10:34:45.299540Z",
  "published": "2024-05-19T08:35:09Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7ded842b356d151ece8ac4985940438e6d3998bb"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c3062bdb859b6e2567e7f5c8cde20c0250bb130f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d3d74e45a060d218fe4b0c9174f0a77517509d8e"
    }
  ],
  "related": [
    "SUSE-SU-2024:2135-1",
    "SUSE-SU-2024:2203-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "summary": "s390/bpf: Fix bpf_plt pointer arithmetic"
}