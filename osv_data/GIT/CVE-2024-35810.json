{"schema_version":"1.7.3","id":"CVE-2024-35810","published":"2024-05-17T13:23:16Z","modified":"2025-10-21T21:02:44.664685Z","related":["RLSA-2024:5101","RLSA-2024:5102","RXSA-2024:5101","SUSE-SU-2024:2135-1","SUSE-SU-2024:2203-1","SUSE-SU-2024:2973-1"],"summary":"drm/vmwgfx: Fix the lifetime of the bo cursor memory","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/vmwgfx: Fix the lifetime of the bo cursor memory\n\nThe cleanup can be dispatched while the atomic update is still active,\nwhich means that the memory acquired in the atomic update needs to\nnot be invalidated by the cleanup. The buffer objects in vmw_plane_state\ninstead of using the builtin map_and_cache were trying to handle\nthe lifetime of the mapped memory themselves, leading to crashes.\n\nUse the map_and_cache instead of trying to manage the lifetime of the\nbuffer objects held by the vmw_plane_state.\n\nFixes kernel oops'es in IGT's kms_cursor_legacy forked-bo.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bb6780aa5a1d99e86757c0c96bfae65a46cf839e"},{"fixed":"86cb706a40b7e6b2221ee49a298a65ad9b46c02d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bb6780aa5a1d99e86757c0c96bfae65a46cf839e"},{"fixed":"104a5b2772bc7c0715ae7355ccf9d294a472765c"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bb6780aa5a1d99e86757c0c96bfae65a46cf839e"},{"fixed":"ed381800ea6d9a4c7f199235a471c0c48100f0ae"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bb6780aa5a1d99e86757c0c96bfae65a46cf839e"},{"fixed":"9a9e8a7159ca09af9b1a300a6c8e8b6ff7501c76"}]}],"versions":["v6.1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.3","v6.6.4","v6.6.5","v6.6.6","v6.6.7","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.7.1","v6.7.10","v6.7.11","v6.7.2","v6.7.3","v6.7.4","v6.7.5","v6.7.6","v6.7.7","v6.7.8","v6.7.9","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.8.1","v6.8.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35810.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"188462800572742250401926076156778148341","length":302},"id":"CVE-2024-35810-1497b602","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86cb706a40b7e6b2221ee49a298a65ad9b46c02d","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c","function":"vmw_du_cursor_plane_acquire_image"}},{"deprecated":false,"digest":{"line_hashes":["105246835205072455086032443495845769933","324443653563342364646209533591367356391","243825154070160168016521899494216285141","27803554149794057394688803378910970137","156092629427465719969581777719581422140","116639971706766191994762705450375912520","202929798097335871050766765015955188106","298556914435323752195244513879503748300","61583434545308794796639222594422376595","46953187225846334044564649307540388688","23113933055417121034098551228275895306","81837527091395943262133404653389261425","184425133519996438741389746846297929134","330800046974924853137814545362210879353","82338947488047439625151148721694842650","167164488584117904308021583518269539204","65196554490752158818706931487207406057","314534738342467730673312992012863494460","92737637762463984851834253877699251614","285916369598799625058906002496186232936","243168270917316131488973660834163762520","237839003587747176050478052087113563490","204642167937421041274808138407145431742","144913591759353466547362779046823229638","154186353206309268507055202725959873560"],"threshold":0.9},"id":"CVE-2024-35810-5424c768","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9a9e8a7159ca09af9b1a300a6c8e8b6ff7501c76","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c"}},{"deprecated":false,"digest":{"function_hash":"123908312453321429327635018065724440560","length":695},"id":"CVE-2024-35810-5e030dc4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86cb706a40b7e6b2221ee49a298a65ad9b46c02d","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c","function":"vmw_du_cursor_plane_cleanup_fb"}},{"deprecated":false,"digest":{"function_hash":"123908312453321429327635018065724440560","length":695},"id":"CVE-2024-35810-8df0ceb2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@104a5b2772bc7c0715ae7355ccf9d294a472765c","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c","function":"vmw_du_cursor_plane_cleanup_fb"}},{"deprecated":false,"digest":{"function_hash":"123908312453321429327635018065724440560","length":695},"id":"CVE-2024-35810-bb13da14","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9a9e8a7159ca09af9b1a300a6c8e8b6ff7501c76","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c","function":"vmw_du_cursor_plane_cleanup_fb"}},{"deprecated":false,"digest":{"function_hash":"188462800572742250401926076156778148341","length":302},"id":"CVE-2024-35810-c7762a93","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@104a5b2772bc7c0715ae7355ccf9d294a472765c","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c","function":"vmw_du_cursor_plane_acquire_image"}},{"deprecated":false,"digest":{"function_hash":"188462800572742250401926076156778148341","length":302},"id":"CVE-2024-35810-d8178d8e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9a9e8a7159ca09af9b1a300a6c8e8b6ff7501c76","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c","function":"vmw_du_cursor_plane_acquire_image"}},{"deprecated":false,"digest":{"line_hashes":["105246835205072455086032443495845769933","324443653563342364646209533591367356391","243825154070160168016521899494216285141","27803554149794057394688803378910970137","156092629427465719969581777719581422140","116639971706766191994762705450375912520","202929798097335871050766765015955188106","298556914435323752195244513879503748300","61583434545308794796639222594422376595","46953187225846334044564649307540388688","23113933055417121034098551228275895306","81837527091395943262133404653389261425","184425133519996438741389746846297929134","330800046974924853137814545362210879353","82338947488047439625151148721694842650","167164488584117904308021583518269539204","65196554490752158818706931487207406057","314534738342467730673312992012863494460","92737637762463984851834253877699251614","285916369598799625058906002496186232936","243168270917316131488973660834163762520","237839003587747176050478052087113563490","204642167937421041274808138407145431742","144913591759353466547362779046823229638","154186353206309268507055202725959873560"],"threshold":0.9},"id":"CVE-2024-35810-fc349fc5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@104a5b2772bc7c0715ae7355ccf9d294a472765c","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c"}},{"deprecated":false,"digest":{"line_hashes":["105246835205072455086032443495845769933","324443653563342364646209533591367356391","243825154070160168016521899494216285141","27803554149794057394688803378910970137","156092629427465719969581777719581422140","116639971706766191994762705450375912520","202929798097335871050766765015955188106","298556914435323752195244513879503748300","61583434545308794796639222594422376595","46953187225846334044564649307540388688","23113933055417121034098551228275895306","81837527091395943262133404653389261425","184425133519996438741389746846297929134","330800046974924853137814545362210879353","82338947488047439625151148721694842650","167164488584117904308021583518269539204","65196554490752158818706931487207406057","314534738342467730673312992012863494460","92737637762463984851834253877699251614","285916369598799625058906002496186232936","243168270917316131488973660834163762520","237839003587747176050478052087113563490","204642167937421041274808138407145431742","144913591759353466547362779046823229638","154186353206309268507055202725959873560"],"threshold":0.9},"id":"CVE-2024-35810-fffa1951","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86cb706a40b7e6b2221ee49a298a65ad9b46c02d","target":{"file":"drivers/gpu/drm/vmwgfx/vmwgfx_kms.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.24"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.7.12"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.8.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35810.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/104a5b2772bc7c0715ae7355ccf9d294a472765c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/86cb706a40b7e6b2221ee49a298a65ad9b46c02d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9a9e8a7159ca09af9b1a300a6c8e8b6ff7501c76"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ed381800ea6d9a4c7f199235a471c0c48100f0ae"}]}