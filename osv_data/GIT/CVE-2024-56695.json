{"schema_version":"1.7.3","id":"CVE-2024-56695","published":"2024-12-28T09:46:19.468Z","modified":"2025-11-20T07:14:07.202523Z","summary":"drm/amdkfd: Use dynamic allocation for CU occupancy array in 'kfd_get_cu_occupancy()'","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amdkfd: Use dynamic allocation for CU occupancy array in 'kfd_get_cu_occupancy()'\n\nThe `kfd_get_cu_occupancy` function previously declared a large\n`cu_occupancy` array as a local variable, which could lead to stack\noverflows due to excessive stack usage. This commit replaces the static\narray allocation with dynamic memory allocation using `kcalloc`,\nthereby reducing the stack size.\n\nThis change avoids the risk of stack overflows in kernel space,  in\nscenarios where `AMDGPU_MAX_QUEUES` is large. The  allocated memory is\nfreed using `kfree` before the function returns  to prevent memory\nleaks.\n\nFixes the below with gcc W=1:\ndrivers/gpu/drm/amd/amdgpu/../amdkfd/kfd_process.c: In function ‘kfd_get_cu_occupancy’:\ndrivers/gpu/drm/amd/amdgpu/../amdkfd/kfd_process.c:322:1: warning: the frame size of 1056 bytes is larger than 1024 bytes [-Wframe-larger-than=]\n  322 | }\n      | ^","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"6ae9e1aba97e4cdaa31a0bfdc07497ad0e915c84"},{"fixed":"6d9f07196389f35a3afebcf1a12c1425725caddd"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"6ae9e1aba97e4cdaa31a0bfdc07497ad0e915c84"},{"fixed":"922f0e00017b09d9d47e3efac008c8b20ed546a0"}]}],"versions":["v6.11","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56695.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["176966913561780040759370932617080347659","146234109991809005835180295558376855689","282001813323975356002086814653252342267","337937939629683753940869003177859215968","161667135106895500044970718805170408832","267518564533605187041506622082211797931","249875868240950000171910269195697915944","249746243949191169574488586536776021063","73996291707247286249221841920899015290","73528426054474099372359074828067238030","180089490343533807518769497827956233383","259867336322027861937889078884554042601","323510572218166168879101582818907759581"],"threshold":0.9},"id":"CVE-2024-56695-2611ca4f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d9f07196389f35a3afebcf1a12c1425725caddd","target":{"file":"drivers/gpu/drm/amd/amdkfd/kfd_process.c"}},{"deprecated":false,"digest":{"line_hashes":["176966913561780040759370932617080347659","146234109991809005835180295558376855689","282001813323975356002086814653252342267","337937939629683753940869003177859215968","161667135106895500044970718805170408832","267518564533605187041506622082211797931","249875868240950000171910269195697915944","249746243949191169574488586536776021063","73996291707247286249221841920899015290","73528426054474099372359074828067238030","180089490343533807518769497827956233383","259867336322027861937889078884554042601","323510572218166168879101582818907759581"],"threshold":0.9},"id":"CVE-2024-56695-2b38982c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@922f0e00017b09d9d47e3efac008c8b20ed546a0","target":{"file":"drivers/gpu/drm/amd/amdkfd/kfd_process.c"}},{"deprecated":false,"digest":{"function_hash":"24963789325589310444107016966961985049","length":1149},"id":"CVE-2024-56695-62759927","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@922f0e00017b09d9d47e3efac008c8b20ed546a0","target":{"file":"drivers/gpu/drm/amd/amdkfd/kfd_process.c","function":"kfd_get_cu_occupancy"}},{"deprecated":false,"digest":{"function_hash":"24963789325589310444107016966961985049","length":1149},"id":"CVE-2024-56695-e7eabd19","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d9f07196389f35a3afebcf1a12c1425725caddd","target":{"file":"drivers/gpu/drm/amd/amdkfd/kfd_process.c","function":"kfd_get_cu_occupancy"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.12.0"},{"fixed":"6.12.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56695.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6d9f07196389f35a3afebcf1a12c1425725caddd"},{"type":"WEB","url":"https://git.kernel.org/stable/c/922f0e00017b09d9d47e3efac008c8b20ed546a0"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}