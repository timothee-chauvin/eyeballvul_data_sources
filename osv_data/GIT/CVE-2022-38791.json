{"schema_version":"1.7.3","id":"CVE-2022-38791","published":"2022-08-27T20:15:08Z","modified":"2025-10-21T07:33:23.312927Z","aliases":["BIT-mariadb-2022-38791","BIT-mariadb-min-2022-38791","BIT-mysql-client-2022-38791"],"related":["ALSA-2023:5259","ALSA-2023:5683","ALSA-2023:5684","RLSA-2023:5683","SUSE-RU-2022:3855-1","SUSE-RU-2023:3956-1","SUSE-RU-2023:4991-1","SUSE-SU-2022:3391-1","SUSE-SU-2023:0631-1","openSUSE-SU-2024:12360-1"],"details":"In MariaDB before 10.9.2, compress_write in extra/mariabackup/ds_compress.cc does not release data_mutex upon a stream write failure, which allows local users to trigger a deadlock.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/mariadb/server","events":[{"introduced":"20ae591abd0bfe1bfaee546989ee163f4ef832b1"},{"fixed":"faddcf3c395da640b760c3f701f5bc1f3baae6c4"}]}],"versions":["mariadb-10.0.31","mariadb-10.0.32","mariadb-10.0.33","mariadb-10.0.34","mariadb-10.0.35","mariadb-10.0.36","mariadb-10.0.37","mariadb-10.0.38","mariadb-10.1.23","mariadb-10.1.24","mariadb-10.1.25","mariadb-10.1.26","mariadb-10.1.27","mariadb-10.1.28","mariadb-10.1.29","mariadb-10.1.30","mariadb-10.1.31","mariadb-10.1.32","mariadb-10.1.33","mariadb-10.1.34","mariadb-10.1.35","mariadb-10.1.36","mariadb-10.1.37","mariadb-10.1.38","mariadb-10.1.39","mariadb-10.1.40","mariadb-10.1.41","mariadb-10.1.42","mariadb-10.1.43","mariadb-10.1.44","mariadb-10.1.45","mariadb-10.1.46","mariadb-10.1.47","mariadb-10.2.10","mariadb-10.2.11","mariadb-10.2.12","mariadb-10.2.13","mariadb-10.2.14","mariadb-10.2.15","mariadb-10.2.16","mariadb-10.2.17","mariadb-10.2.18","mariadb-10.2.19","mariadb-10.2.20","mariadb-10.2.21","mariadb-10.2.22","mariadb-10.2.23","mariadb-10.2.24","mariadb-10.2.25","mariadb-10.2.26","mariadb-10.2.27","mariadb-10.2.28","mariadb-10.2.29","mariadb-10.2.30","mariadb-10.2.31","mariadb-10.2.32","mariadb-10.2.33","mariadb-10.2.34","mariadb-10.2.35","mariadb-10.2.36","mariadb-10.2.37","mariadb-10.2.38","mariadb-10.2.39","mariadb-10.2.40","mariadb-10.2.41","mariadb-10.2.42","mariadb-10.2.43","mariadb-10.2.6","mariadb-10.2.7","mariadb-10.2.8","mariadb-10.2.9","mariadb-10.3.0","mariadb-10.3.1","mariadb-10.3.10","mariadb-10.3.11","mariadb-10.3.12","mariadb-10.3.13","mariadb-10.3.14","mariadb-10.3.15","mariadb-10.3.16","mariadb-10.3.17","mariadb-10.3.18","mariadb-10.3.19","mariadb-10.3.2","mariadb-10.3.20","mariadb-10.3.21","mariadb-10.3.22","mariadb-10.3.23","mariadb-10.3.24","mariadb-10.3.25","mariadb-10.3.26","mariadb-10.3.27","mariadb-10.3.28","mariadb-10.3.29","mariadb-10.3.3","mariadb-10.3.30","mariadb-10.3.31","mariadb-10.3.32","mariadb-10.3.33","mariadb-10.3.34","mariadb-10.3.35","mariadb-10.3.4","mariadb-10.3.5","mariadb-10.3.6","mariadb-10.3.7","mariadb-10.3.8","mariadb-10.3.9","mariadb-5.5.55","mariadb-5.5.56","mariadb-5.5.57","mariadb-5.5.58","mariadb-5.5.59","mariadb-5.5.60","mariadb-5.5.61","mariadb-5.5.62","mariadb-5.5.63","mariadb-5.5.64","mariadb-5.5.65","mariadb-5.5.66","mariadb-5.5.67","mariadb-5.5.68","mariadb-galera-10.0.30","mariadb-galera-10.0.31","mariadb-galera-10.0.32","mariadb-galera-10.0.33","mariadb-galera-10.0.34","mariadb-galera-10.0.35","mariadb-galera-10.0.36","mariadb-galera-10.0.37","mariadb-galera-5.5.52","mariadb-galera-5.5.53","mariadb-galera-5.5.54","mariadb-galera-5.5.55","mariadb-galera-5.5.56","mariadb-galera-5.5.57","mariadb-galera-5.5.58","mariadb-galera-5.5.59","mariadb-galera-5.5.60","mariadb-galera-5.5.61","mariadb-galera-5.5.62","mysql-5.5.55","mysql-5.5.56","mysql-5.5.57","mysql-5.5.58","mysql-5.5.59","mysql-5.5.60","mysql-5.5.61","mysql-5.5.62"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-38791.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"96567548985656349046472553596954460768","length":1094},"id":"CVE-2022-38791-bab28f5d","signature_type":"Function","signature_version":"v1","source":"https://github.com/mariadb/server/commit/faddcf3c395da640b760c3f701f5bc1f3baae6c4","target":{"file":"sql/strfunc.cc","function":"find_set"}},{"deprecated":false,"digest":{"line_hashes":["271363707396860767418283350345897486504","120596951573328682502907908502941671745","115421961338400510566446524145876737974","64074615696916198601226435566349591945"],"threshold":0.9},"id":"CVE-2022-38791-ee10862f","signature_type":"Line","signature_version":"v1","source":"https://github.com/mariadb/server/commit/faddcf3c395da640b760c3f701f5bc1f3baae6c4","target":{"file":"sql/strfunc.cc"}}]}}],"references":[{"type":"REPORT","url":"https://jira.mariadb.org/browse/MDEV-28719"},{"type":"ADVISORY","url":"https://security.netapp.com/advisory/ntap-20221104-0008/"},{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WCOEGSVMIEXDZHBOSV6WVF7FAVRBR2JE/"},{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WTVAONAZXJFGHAJ4RP2OF3EAMQCOTDSQ/"},{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZHISY4YVO4S5QJYYIXCIAXBM7INOL4VY/"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}