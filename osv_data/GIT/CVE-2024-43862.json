{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-43862.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "20740072137009281349350578299792062091",
              "length": 408.0
            },
            "id": "CVE-2024-43862-01941ccf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f223d2b4acb7a45a6e0581cb380e1af1a6dc7ab9",
            "target": {
              "file": "drivers/net/wan/fsl_qmc_hdlc.c",
              "function": "qmc_hdlc_framer_set_carrier"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "20740072137009281349350578299792062091",
              "length": 408.0
            },
            "id": "CVE-2024-43862-407896a4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c4d6a347ba7babdf9d90a0eb24048c266cae0532",
            "target": {
              "file": "drivers/net/wan/fsl_qmc_hdlc.c",
              "function": "qmc_hdlc_framer_set_carrier"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "28228004335657255289253530106873102786",
                "108633874786781509025509400107515682653",
                "178006172893886914201166760762460180990",
                "300599645067697801138404862884748424034",
                "76952190781384241812217903752204516082",
                "72673587874167480060413186968159981996",
                "284240013726518183652518478220493264045",
                "321788702126407268843977218276552146428",
                "134966255198210771474709576290665649072",
                "130212230855278936647664690917704868391",
                "98976211020400016443267448875055964661",
                "4717012556471578044033317537121395970",
                "65672234561733040270577315574594168925",
                "220861654524224943384897013369825453226",
                "239025179319858953869411980837939684723",
                "66708753513305385883319394525518157490"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-43862-5cc05464",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c4d6a347ba7babdf9d90a0eb24048c266cae0532",
            "target": {
              "file": "drivers/net/wan/fsl_qmc_hdlc.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "28228004335657255289253530106873102786",
                "108633874786781509025509400107515682653",
                "178006172893886914201166760762460180990",
                "300599645067697801138404862884748424034",
                "76952190781384241812217903752204516082",
                "72673587874167480060413186968159981996",
                "284240013726518183652518478220493264045",
                "321788702126407268843977218276552146428",
                "134966255198210771474709576290665649072",
                "130212230855278936647664690917704868391",
                "98976211020400016443267448875055964661",
                "4717012556471578044033317537121395970",
                "65672234561733040270577315574594168925",
                "220861654524224943384897013369825453226",
                "239025179319858953869411980837939684723",
                "66708753513305385883319394525518157490"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-43862-b8489d76",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f223d2b4acb7a45a6e0581cb380e1af1a6dc7ab9",
            "target": {
              "file": "drivers/net/wan/fsl_qmc_hdlc.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "54762918ca856028d33d1d56d017a4d7706c6196"
            },
            {
              "fixed": "f223d2b4acb7a45a6e0581cb380e1af1a6dc7ab9"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "54762918ca856028d33d1d56d017a4d7706c6196"
            },
            {
              "fixed": "c4d6a347ba7babdf9d90a0eb24048c266cae0532"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.10.1",
        "v6.10.2",
        "v6.10.3",
        "v6.8",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-43862.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.9.0"
            },
            {
              "fixed": "6.10.4"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: wan: fsl_qmc_hdlc: Convert carrier_lock spinlock to a mutex\n\nThe carrier_lock spinlock protects the carrier detection. While it is\nheld, framer_get_status() is called which in turn takes a mutex.\nThis is not correct and can lead to a deadlock.\n\nA run with PROVE_LOCKING enabled detected the issue:\n  [ BUG: Invalid wait context ]\n  ...\n  c204ddbc (&framer->mutex){+.+.}-{3:3}, at: framer_get_status+0x40/0x78\n  other info that might help us debug this:\n  context-{4:4}\n  2 locks held by ifconfig/146:\n  #0: c0926a38 (rtnl_mutex){+.+.}-{3:3}, at: devinet_ioctl+0x12c/0x664\n  #1: c2006a40 (&qmc_hdlc->carrier_lock){....}-{2:2}, at: qmc_hdlc_framer_set_carrier+0x30/0x98\n\nAvoid the spinlock usage and convert carrier_lock to a mutex.",
  "id": "CVE-2024-43862",
  "modified": "2025-10-15T13:52:38.431180Z",
  "published": "2024-08-20T23:45:26Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c4d6a347ba7babdf9d90a0eb24048c266cae0532"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f223d2b4acb7a45a6e0581cb380e1af1a6dc7ab9"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "net: wan: fsl_qmc_hdlc: Convert carrier_lock spinlock to a mutex"
}