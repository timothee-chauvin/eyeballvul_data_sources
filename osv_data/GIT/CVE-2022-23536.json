{"schema_version":"1.7.3","id":"CVE-2022-23536","published":"2022-12-19T21:10:21Z","modified":"2025-10-22T18:26:32.477456Z","aliases":["GHSA-cq2g-pw6q-hf7j","GO-2022-1175"],"summary":"Alertmanager can expose local files content via specially crafted config","details":"Cortex provides multi-tenant, long term storage for Prometheus. A local file inclusion vulnerability exists in Cortex versions 1.13.0, 1.13.1 and 1.14.0, where a malicious actor could remotely read local files as a result of parsing maliciously crafted Alertmanager configurations when submitted to the Alertmanager Set Configuration API. Only users of the Alertmanager service where `-experimental.alertmanager.enable-api` or `enable_api: true` is configured are affected. Affected Cortex users are advised to upgrade to patched versions 1.13.2 or 1.14.1. However as a workaround, Cortex administrators may reject Alertmanager configurations containing the `api_key_file` setting in the `opsgenie_configs` section before sending to the Set Alertmanager Configuration API.\n","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/cortexproject/cortex","events":[{"introduced":"69139acb73354e5b9e1aa41c1cba49631c2815f1"},{"last_affected":"de2ef5e836206ca9796945029b6b6f097fd11b26"}]},{"type":"GIT","repo":"https://github.com/cortexproject/cortex","events":[{"introduced":"0"},{"last_affected":"06d73136a372fa446dbb7ea36a4430aeeba553d8"}]}],"versions":["v0.1.0","v0.1.0-rc.0","v0.2.0","v0.2.0-rc.0","v0.3.0","v0.3.0-rc.0","v0.4.0","v0.6.0","v0.6.0-rc.0","v0.7.0","v0.7.0-rc.0","v1.0.0","v1.0.0-rc.0","v1.0.1","v1.1.0","v1.1.0-rc.0","v1.10.0","v1.10.0-rc.0","v1.10.0-rc.1","v1.12.0-rc.0","v1.14.0","v1.2.0","v1.2.0-rc.1","v1.3.0","v1.3.0-rc.0","v1.3.0-rc.1","v1.3.0-rc.2","v1.4.0","v1.4.0-rc.0","v1.4.0-rc.1","v1.5.0","v1.5.0-rc.0","v1.5.0-rc.1","v1.6.0","v1.6.0-rc.0","v1.6.0-rc.1","v1.7.0","v1.7.0-rc.0","v1.7.0-rc.1","v1.7.0-rc.2","v1.7.1","v1.8.0","v1.8.0-rc.0","v1.8.0-rc.1","v1.8.1","v1.9.0","v1.9.0-rc.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-23536.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/cortexproject/cortex/security/advisories/GHSA-cq2g-pw6q-hf7j"},{"type":"WEB","url":"https://cortexmetrics.io/docs/api/#set-alertmanager-configuration"},{"type":"WEB","url":"https://github.com/cortexproject/cortex/releases/tag/v1.13.2"},{"type":"WEB","url":"https://github.com/cortexproject/cortex/releases/tag/v1.14.1"}],"database_specific":{"cwe_ids":["CWE-184","CWE-641","CWE-73"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"}]}