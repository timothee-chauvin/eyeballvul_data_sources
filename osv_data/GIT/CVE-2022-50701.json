{"schema_version":"1.7.3","id":"CVE-2022-50701","published":"2025-12-24T10:55:17.090Z","modified":"2025-12-24T20:35:26.045503Z","summary":"wifi: mt76: mt7921s: fix slab-out-of-bounds access in sdio host","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: mt76: mt7921s: fix slab-out-of-bounds access in sdio host\n\nSDIO may need addtional 511 bytes to align bus operation. If the tailroom\nof this skb is not big enough, we would access invalid memory region.\nFor low level operation, increase skb size to keep valid memory access in\nSDIO host.\n\nError message:\n[69.951] BUG: KASAN: slab-out-of-bounds in sg_copy_buffer+0xe9/0x1a0\n[69.951] Read of size 64 at addr ffff88811c9cf000 by task kworker/u16:7/451\n[69.951] CPU: 4 PID: 451 Comm: kworker/u16:7 Tainted: G W  OE  6.1.0-rc5 #1\n[69.951] Workqueue: kvub300c vub300_cmndwork_thread [vub300]\n[69.951] Call Trace:\n[69.951]  <TASK>\n[69.952]  dump_stack_lvl+0x49/0x63\n[69.952]  print_report+0x171/0x4a8\n[69.952]  kasan_report+0xb4/0x130\n[69.952]  kasan_check_range+0x149/0x1e0\n[69.952]  memcpy+0x24/0x70\n[69.952]  sg_copy_buffer+0xe9/0x1a0\n[69.952]  sg_copy_to_buffer+0x12/0x20\n[69.952]  __command_write_data.isra.0+0x23c/0xbf0 [vub300]\n[69.952]  vub300_cmndwork_thread+0x17f3/0x58b0 [vub300]\n[69.952]  process_one_work+0x7ee/0x1320\n[69.952]  worker_thread+0x53c/0x1240\n[69.952]  kthread+0x2b8/0x370\n[69.952]  ret_from_fork+0x1f/0x30\n[69.952]  </TASK>\n\n[69.952] Allocated by task 854:\n[69.952]  kasan_save_stack+0x26/0x50\n[69.952]  kasan_set_track+0x25/0x30\n[69.952]  kasan_save_alloc_info+0x1b/0x30\n[69.952]  __kasan_kmalloc+0x87/0xa0\n[69.952]  __kmalloc_node_track_caller+0x63/0x150\n[69.952]  kmalloc_reserve+0x31/0xd0\n[69.952]  __alloc_skb+0xfc/0x2b0\n[69.952]  __mt76_mcu_msg_alloc+0xbf/0x230 [mt76]\n[69.952]  mt76_mcu_send_and_get_msg+0xab/0x110 [mt76]\n[69.952]  __mt76_mcu_send_firmware.cold+0x94/0x15d [mt76]\n[69.952]  mt76_connac_mcu_send_ram_firmware+0x415/0x54d [mt76_connac_lib]\n[69.952]  mt76_connac2_load_ram.cold+0x118/0x4bc [mt76_connac_lib]\n[69.952]  mt7921_run_firmware.cold+0x2e9/0x405 [mt7921_common]\n[69.952]  mt7921s_mcu_init+0x45/0x80 [mt7921s]\n[69.953]  mt7921_init_work+0xe1/0x2a0 [mt7921_common]\n[69.953]  process_one_work+0x7ee/0x1320\n[69.953]  worker_thread+0x53c/0x1240\n[69.953]  kthread+0x2b8/0x370\n[69.953]  ret_from_fork+0x1f/0x30\n[69.953] The buggy address belongs to the object at ffff88811c9ce800\n             which belongs to the cache kmalloc-2k of size 2048\n[69.953] The buggy address is located 0 bytes to the right of\n             2048-byte region [ffff88811c9ce800, ffff88811c9cf000)\n\n[69.953] Memory state around the buggy address:\n[69.953]  ffff88811c9cef00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n[69.953]  ffff88811c9cef80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n[69.953] >ffff88811c9cf000: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n[69.953]                    ^\n[69.953]  ffff88811c9cf080: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n[69.953]  ffff88811c9cf100: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"764dee47e2c1ed828c8a51cbf58f89b5e3ded11b"},{"fixed":"8b5174a7f25d03df0ffa171ff86de383a89e8e89"},{"fixed":"0b358e36433d2c46a65488a146bf8b4623fc5bbb"},{"fixed":"aec4cf2ea0797e28f18f8dbe01943a56d987fe56"}]}],"versions":["v5.15","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1","v6.1.10","v6.1.11","v6.1.12","v6.1.13","v6.1.14","v6.1.15","v6.1.2","v6.1.3","v6.1.4","v6.1.5","v6.1.6","v6.1.7","v6.1.8","v6.1.9","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.2.1","v6.2.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50701.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"6.1.16"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.2.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50701.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0b358e36433d2c46a65488a146bf8b4623fc5bbb"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8b5174a7f25d03df0ffa171ff86de383a89e8e89"},{"type":"WEB","url":"https://git.kernel.org/stable/c/aec4cf2ea0797e28f18f8dbe01943a56d987fe56"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50701.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-50701"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50701.json"}}