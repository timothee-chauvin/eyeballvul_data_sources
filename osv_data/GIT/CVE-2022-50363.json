{"schema_version":"1.7.3","id":"CVE-2022-50363","published":"2025-09-17T14:56:15Z","modified":"2025-10-21T12:34:54.209420Z","summary":"skmsg: pass gfp argument to alloc_sk_msg()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nskmsg: pass gfp argument to alloc_sk_msg()\n\nsyzbot found that alloc_sk_msg() could be called from a\nnon sleepable context. sk_psock_verdict_recv() uses\nrcu_read_lock() protection.\n\nWe need the callers to pass a gfp_t argument to avoid issues.\n\nsyzbot report was:\n\nBUG: sleeping function called from invalid context at include/linux/sched/mm.h:274\nin_atomic(): 0, irqs_disabled(): 0, non_block: 0, pid: 3613, name: syz-executor414\npreempt_count: 0, expected: 0\nRCU nest depth: 1, expected: 0\nINFO: lockdep is turned off.\nCPU: 0 PID: 3613 Comm: syz-executor414 Not tainted 6.0.0-syzkaller-09589-g55be6084c8e0 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/22/2022\nCall Trace:\n<TASK>\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0x1e3/0x2cb lib/dump_stack.c:106\n__might_resched+0x538/0x6a0 kernel/sched/core.c:9877\nmight_alloc include/linux/sched/mm.h:274 [inline]\nslab_pre_alloc_hook mm/slab.h:700 [inline]\nslab_alloc_node mm/slub.c:3162 [inline]\nslab_alloc mm/slub.c:3256 [inline]\nkmem_cache_alloc_trace+0x59/0x310 mm/slub.c:3287\nkmalloc include/linux/slab.h:600 [inline]\nkzalloc include/linux/slab.h:733 [inline]\nalloc_sk_msg net/core/skmsg.c:507 [inline]\nsk_psock_skb_ingress_self+0x5c/0x330 net/core/skmsg.c:600\nsk_psock_verdict_apply+0x395/0x440 net/core/skmsg.c:1014\nsk_psock_verdict_recv+0x34d/0x560 net/core/skmsg.c:1201\ntcp_read_skb+0x4a1/0x790 net/ipv4/tcp.c:1770\ntcp_rcv_established+0x129d/0x1a10 net/ipv4/tcp_input.c:5971\ntcp_v4_do_rcv+0x479/0xac0 net/ipv4/tcp_ipv4.c:1681\nsk_backlog_rcv include/net/sock.h:1109 [inline]\n__release_sock+0x1d8/0x4c0 net/core/sock.c:2906\nrelease_sock+0x5d/0x1c0 net/core/sock.c:3462\ntcp_sendmsg+0x36/0x40 net/ipv4/tcp.c:1483\nsock_sendmsg_nosec net/socket.c:714 [inline]\nsock_sendmsg net/socket.c:734 [inline]\n__sys_sendto+0x46d/0x5f0 net/socket.c:2117\n__do_sys_sendto net/socket.c:2129 [inline]\n__se_sys_sendto net/socket.c:2125 [inline]\n__x64_sys_sendto+0xda/0xf0 net/socket.c:2125\ndo_syscall_x64 arch/x86/entry/common.c:50 [inline]\ndo_syscall_64+0x2b/0x70 arch/x86/entry/common.c:80\nentry_SYSCALL_64_after_hwframe+0x63/0xcd","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"43312915b5ba20741617dd2119e835205fa8580c"},{"fixed":"693ddd6ffc05b228ea1638f9d757c5d3541f9446"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"43312915b5ba20741617dd2119e835205fa8580c"},{"fixed":"2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08"}]}],"versions":["v5.19","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50363.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"102098537532290566953808030058039163341","length":338},"id":"CVE-2022-50363-0fd4f22c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08","target":{"file":"net/core/skmsg.c","function":"sk_psock_skb_ingress_self"}},{"deprecated":false,"digest":{"line_hashes":["229452102957379191913871064181873348929","153898101173589119330595526367468466180","260464576495366690756928523548652603270","74790632991535810180751669926296273578","257894133043422923466010280567996454176","210519996352128180716943458595428412975","239226862638713733589167232627520870043","220258341501724707692432138740829190020","331732581346530595593761499306746754950","275737833402941748217959303442171802414","270996951016077943528650188911471507219","312012890413340095817918658385395780085","87828967025472695927505233631100021165","94428139301278787847501941831980350333","299615154737511438127474328430947440162"],"threshold":0.9},"id":"CVE-2022-50363-2448eea2","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08","target":{"file":"net/core/skmsg.c"}},{"deprecated":false,"digest":{"function_hash":"145322599998130742086748057811178862965","length":220},"id":"CVE-2022-50363-32187d42","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08","target":{"file":"net/core/skmsg.c","function":"alloc_sk_msg"}},{"deprecated":false,"digest":{"function_hash":"102098537532290566953808030058039163341","length":338},"id":"CVE-2022-50363-55955187","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@693ddd6ffc05b228ea1638f9d757c5d3541f9446","target":{"file":"net/core/skmsg.c","function":"sk_psock_skb_ingress_self"}},{"deprecated":false,"digest":{"line_hashes":["229452102957379191913871064181873348929","153898101173589119330595526367468466180","260464576495366690756928523548652603270","74790632991535810180751669926296273578","257894133043422923466010280567996454176","210519996352128180716943458595428412975","239226862638713733589167232627520870043","220258341501724707692432138740829190020","331732581346530595593761499306746754950","275737833402941748217959303442171802414","270996951016077943528650188911471507219","312012890413340095817918658385395780085","87828967025472695927505233631100021165","94428139301278787847501941831980350333","299615154737511438127474328430947440162"],"threshold":0.9},"id":"CVE-2022-50363-88269e57","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@693ddd6ffc05b228ea1638f9d757c5d3541f9446","target":{"file":"net/core/skmsg.c"}},{"deprecated":false,"digest":{"function_hash":"145322599998130742086748057811178862965","length":220},"id":"CVE-2022-50363-af3b4a2f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@693ddd6ffc05b228ea1638f9d757c5d3541f9446","target":{"file":"net/core/skmsg.c","function":"alloc_sk_msg"}},{"deprecated":false,"digest":{"function_hash":"183748507571598420491894646599975785796","length":233},"id":"CVE-2022-50363-cbd84b54","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08","target":{"file":"net/core/skmsg.c","function":"sk_psock_create_ingress_msg"}},{"deprecated":false,"digest":{"function_hash":"183748507571598420491894646599975785796","length":233},"id":"CVE-2022-50363-e84fbf15","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@693ddd6ffc05b228ea1638f9d757c5d3541f9446","target":{"file":"net/core/skmsg.c","function":"sk_psock_create_ingress_msg"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.0.0"},{"fixed":"6.0.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50363.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08"},{"type":"WEB","url":"https://git.kernel.org/stable/c/693ddd6ffc05b228ea1638f9d757c5d3541f9446"}]}