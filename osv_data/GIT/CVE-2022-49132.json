{"schema_version":"1.7.3","id":"CVE-2022-49132","published":"2025-02-26T01:55:07Z","modified":"2025-10-21T09:22:19.650787Z","related":["SUSE-SU-2025:1027-1","SUSE-SU-2025:1176-1","SUSE-SU-2025:1183-1","SUSE-SU-2025:1241-1"],"summary":"ath11k: pci: fix crash on suspend if board file is not found","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nath11k: pci: fix crash on suspend if board file is not found\n\nMario reported that the kernel was crashing on suspend if ath11k was not able\nto find a board file:\n\n[  473.693286] PM: Suspending system (s2idle)\n[  473.693291] printk: Suspending console(s) (use no_console_suspend to debug)\n[  474.407787] BUG: unable to handle page fault for address: 0000000000002070\n[  474.407791] #PF: supervisor read access in kernel mode\n[  474.407794] #PF: error_code(0x0000) - not-present page\n[  474.407798] PGD 0 P4D 0\n[  474.407801] Oops: 0000 [#1] PREEMPT SMP NOPTI\n[  474.407805] CPU: 2 PID: 2350 Comm: kworker/u32:14 Tainted: G        W         5.16.0 #248\n[...]\n[  474.407868] Call Trace:\n[  474.407870]  <TASK>\n[  474.407874]  ? _raw_spin_lock_irqsave+0x2a/0x60\n[  474.407882]  ? lock_timer_base+0x72/0xa0\n[  474.407889]  ? _raw_spin_unlock_irqrestore+0x29/0x3d\n[  474.407892]  ? try_to_del_timer_sync+0x54/0x80\n[  474.407896]  ath11k_dp_rx_pktlog_stop+0x49/0xc0 [ath11k]\n[  474.407912]  ath11k_core_suspend+0x34/0x130 [ath11k]\n[  474.407923]  ath11k_pci_pm_suspend+0x1b/0x50 [ath11k_pci]\n[  474.407928]  pci_pm_suspend+0x7e/0x170\n[  474.407935]  ? pci_pm_freeze+0xc0/0xc0\n[  474.407939]  dpm_run_callback+0x4e/0x150\n[  474.407947]  __device_suspend+0x148/0x4c0\n[  474.407951]  async_suspend+0x20/0x90\ndmesg-efi-164255130401001:\nOops#1 Part1\n[  474.407955]  async_run_entry_fn+0x33/0x120\n[  474.407959]  process_one_work+0x220/0x3f0\n[  474.407966]  worker_thread+0x4a/0x3d0\n[  474.407971]  kthread+0x17a/0x1a0\n[  474.407975]  ? process_one_work+0x3f0/0x3f0\n[  474.407979]  ? set_kthread_struct+0x40/0x40\n[  474.407983]  ret_from_fork+0x22/0x30\n[  474.407991]  </TASK>\n\nThe issue here is that board file loading happens after ath11k_pci_probe()\nsuccesfully returns (ath11k initialisation happends asynchronously) and the\nsuspend handler is still enabled, of course failing as ath11k is not properly\ninitialised. Fix this by checking ATH11K_FLAG_QMI_FAIL during both suspend and\nresume.\n\nTested-on: WCN6855 hw2.0 PCI WLAN.HSP.1.1-03003-QCAHSPSWPL_V1_V2_SILICONZ_LITE-2","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d5c65159f2895379e11ca13f62feabe93278985d"},{"fixed":"fed4cef115ab21a18faf499b3fa9b9a4b544f941"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d5c65159f2895379e11ca13f62feabe93278985d"},{"fixed":"f3c5ef433da82d257337424b3647ce9dcb37d4b5"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d5c65159f2895379e11ca13f62feabe93278985d"},{"fixed":"aeed776c00e804a0f7896db39c7c661cea34ee1f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d5c65159f2895379e11ca13f62feabe93278985d"},{"fixed":"b4f4c56459a5c744f7f066b9fc2b54ea995030c5"}]}],"versions":["v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.4","v5.15.5","v5.15.6","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.1","v5.16.10","v5.16.11","v5.16.12","v5.16.13","v5.16.14","v5.16.15","v5.16.16","v5.16.17","v5.16.18","v5.16.19","v5.16.2","v5.16.3","v5.16.4","v5.16.5","v5.16.6","v5.16.7","v5.16.8","v5.16.9","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.2","v5.4","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49132.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["88832925128698567088346764160475459681","281527576647134202073375568491727842422","64207412618424575027680607275252850484","269004578257681199716055898747960608015","111783634103466129328447654924094951613","17237773550206849624259733958411548856"],"threshold":0.9},"id":"CVE-2022-49132-272dda19","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b4f4c56459a5c744f7f066b9fc2b54ea995030c5","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c"}},{"deprecated":false,"digest":{"function_hash":"274352960104413565507433628951086324520","length":197},"id":"CVE-2022-49132-4a7f9d73","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f3c5ef433da82d257337424b3647ce9dcb37d4b5","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_suspend"}},{"deprecated":false,"digest":{"line_hashes":["88832925128698567088346764160475459681","281527576647134202073375568491727842422","64207412618424575027680607275252850484","269004578257681199716055898747960608015","111783634103466129328447654924094951613","17237773550206849624259733958411548856"],"threshold":0.9},"id":"CVE-2022-49132-534603c4","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aeed776c00e804a0f7896db39c7c661cea34ee1f","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c"}},{"deprecated":false,"digest":{"function_hash":"112618126440754824902436528906742190994","length":196},"id":"CVE-2022-49132-72521fdb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aeed776c00e804a0f7896db39c7c661cea34ee1f","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_resume"}},{"deprecated":false,"digest":{"function_hash":"112618126440754824902436528906742190994","length":196},"id":"CVE-2022-49132-817d7efd","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fed4cef115ab21a18faf499b3fa9b9a4b544f941","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_resume"}},{"deprecated":false,"digest":{"function_hash":"274352960104413565507433628951086324520","length":197},"id":"CVE-2022-49132-8b38ff5c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aeed776c00e804a0f7896db39c7c661cea34ee1f","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_suspend"}},{"deprecated":false,"digest":{"function_hash":"274352960104413565507433628951086324520","length":197},"id":"CVE-2022-49132-a011deb5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fed4cef115ab21a18faf499b3fa9b9a4b544f941","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_suspend"}},{"deprecated":false,"digest":{"function_hash":"112618126440754824902436528906742190994","length":196},"id":"CVE-2022-49132-a4e4f6de","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b4f4c56459a5c744f7f066b9fc2b54ea995030c5","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_resume"}},{"deprecated":false,"digest":{"line_hashes":["88832925128698567088346764160475459681","281527576647134202073375568491727842422","64207412618424575027680607275252850484","269004578257681199716055898747960608015","111783634103466129328447654924094951613","17237773550206849624259733958411548856"],"threshold":0.9},"id":"CVE-2022-49132-adcebe93","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fed4cef115ab21a18faf499b3fa9b9a4b544f941","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c"}},{"deprecated":false,"digest":{"function_hash":"274352960104413565507433628951086324520","length":197},"id":"CVE-2022-49132-b51b4d7b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b4f4c56459a5c744f7f066b9fc2b54ea995030c5","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_suspend"}},{"deprecated":false,"digest":{"line_hashes":["88832925128698567088346764160475459681","281527576647134202073375568491727842422","64207412618424575027680607275252850484","269004578257681199716055898747960608015","111783634103466129328447654924094951613","17237773550206849624259733958411548856"],"threshold":0.9},"id":"CVE-2022-49132-b66937d7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f3c5ef433da82d257337424b3647ce9dcb37d4b5","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c"}},{"deprecated":false,"digest":{"function_hash":"112618126440754824902436528906742190994","length":196},"id":"CVE-2022-49132-f8de2eec","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f3c5ef433da82d257337424b3647ce9dcb37d4b5","target":{"file":"drivers/net/wireless/ath/ath11k/pci.c","function":"ath11k_pci_pm_resume"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.6.0"},{"fixed":"5.15.34"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.16.20"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49132.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/aeed776c00e804a0f7896db39c7c661cea34ee1f"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b4f4c56459a5c744f7f066b9fc2b54ea995030c5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f3c5ef433da82d257337424b3647ce9dcb37d4b5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fed4cef115ab21a18faf499b3fa9b9a4b544f941"}]}