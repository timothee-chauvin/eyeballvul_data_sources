{"schema_version":"1.7.3","id":"CVE-2025-64484","published":"2025-11-10T21:33:58.018Z","modified":"2025-11-20T10:09:31.185812Z","aliases":["BIT-oauth2-proxy-2025-64484","GHSA-vjrc-mh2v-45x6","GO-2025-4113"],"summary":"OAuth2-Proxy vulnerable to header smuggling via underscore, leading to potential privilege escalation","details":"OAuth2-Proxy is an open-source tool that can act as either a standalone reverse proxy or a middleware component integrated into existing reverse proxy or load balancer setups. In versions prior to 7.13.0, all deployments of OAuth2 Proxy in front of applications that normalize underscores to dashes in HTTP headers (e.g., WSGI-based frameworks such as Django, Flask, FastAPI, and PHP applications). Authenticated users can inject underscore variants of X-Forwarded-* headers that bypass the proxyâ€™s filtering logic, potentially escalating privileges in the upstream app. OAuth2 Proxy authentication/authorization itself is not compromised. The problem has been patched with v7.13.0. By default all specified headers will now be normalized, meaning that both capitalization and the use of underscores (_) versus dashes (-) will be ignored when matching headers to be stripped. For example, both `X-Forwarded-For` and `X_Forwarded-for` will now be treated as equivalent and stripped away. For those who have a rational that requires keeping a similar looking header and not stripping it, the maintainers introduced a new configuration field for Headers managed through the AlphaConfig called `InsecureSkipHeaderNormalization`. As a workaround, ensure filtering and processing logic in upstream services don't treat underscores and hyphens in Headers the same way.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/oauth2-proxy/oauth2-proxy","events":[{"introduced":"0"},{"fixed":"082b49aaeb656fea23ad9accdc5a4be9218bb0d4"}],"database_specific":{"versions":[{"introduced":"0"},{"fixed":"7.13.0"}]}}],"versions":["v0.1","v1.0","v1.1","v1.1.1","v2.0","v2.0.1","v2.1","v2.2","v3.0.0","v3.1.0","v3.2.0","v4.0.0","v4.1.0","v5.0.0","v5.1.0","v6.0.0","v6.1.0","v6.1.1","v7.0.0","v7.0.1","v7.1.0","v7.1.1","v7.1.2","v7.1.3","v7.10.0","v7.11.0","v7.12.0","v7.2.0","v7.2.1","v7.3.0","v7.4.0","v7.5.0","v7.5.1","v7.6.0","v7.7.0","v7.7.1","v7.8.0","v7.8.1","v7.8.2","v7.9.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-64484.json"}}],"references":[{"type":"WEB","url":"https://datatracker.ietf.org/doc/html/rfc2616#section-4.2"},{"type":"WEB","url":"https://datatracker.ietf.org/doc/html/rfc822#section-3.2"},{"type":"ADVISORY","url":"https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-vjrc-mh2v-45x6"},{"type":"WEB","url":"https://github.security.telekom.com/2020/05/smuggling-http-headers-through-reverse-proxies.html"},{"type":"WEB","url":"https://www.uptimia.com/questions/why-are-http-headers-with-underscores-dropped-by-nginx"}],"database_specific":{"cwe_ids":["CWE-644"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N"}]}