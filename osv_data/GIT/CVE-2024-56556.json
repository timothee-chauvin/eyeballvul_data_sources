{"schema_version":"1.7.3","id":"CVE-2024-56556","published":"2024-12-27T14:23:02.556Z","modified":"2025-11-20T07:10:07.434043Z","aliases":["A-380855429","ASB-A-380855429"],"summary":"binder: fix node UAF in binder_add_freeze_work()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbinder: fix node UAF in binder_add_freeze_work()\n\nIn binder_add_freeze_work() we iterate over the proc->nodes with the\nproc->inner_lock held. However, this lock is temporarily dropped in\norder to acquire the node->lock first (lock nesting order). This can\nrace with binder_node_release() and trigger a use-after-free:\n\n  ==================================================================\n  BUG: KASAN: slab-use-after-free in _raw_spin_lock+0xe4/0x19c\n  Write of size 4 at addr ffff53c04c29dd04 by task freeze/640\n\n  CPU: 5 UID: 0 PID: 640 Comm: freeze Not tainted 6.11.0-07343-ga727812a8d45 #17\n  Hardware name: linux,dummy-virt (DT)\n  Call trace:\n   _raw_spin_lock+0xe4/0x19c\n   binder_add_freeze_work+0x148/0x478\n   binder_ioctl+0x1e70/0x25ac\n   __arm64_sys_ioctl+0x124/0x190\n\n  Allocated by task 637:\n   __kmalloc_cache_noprof+0x12c/0x27c\n   binder_new_node+0x50/0x700\n   binder_transaction+0x35ac/0x6f74\n   binder_thread_write+0xfb8/0x42a0\n   binder_ioctl+0x18f0/0x25ac\n   __arm64_sys_ioctl+0x124/0x190\n\n  Freed by task 637:\n   kfree+0xf0/0x330\n   binder_thread_read+0x1e88/0x3a68\n   binder_ioctl+0x16d8/0x25ac\n   __arm64_sys_ioctl+0x124/0x190\n  ==================================================================\n\nFix the race by taking a temporary reference on the node before\nreleasing the proc->inner lock. This ensures the node remains alive\nwhile in use.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d579b04a52a183db47dfcb7a44304d7747d551e1"},{"fixed":"38fbefeb2c140b581ed7de8117a5c90d6dd89c22"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d579b04a52a183db47dfcb7a44304d7747d551e1"},{"fixed":"dc8aea47b928cc153b591b3558829ce42f685074"}]}],"versions":["v6.11","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.2","v6.12.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56556.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"262406987265569266840292832199140035606","length":906},"id":"CVE-2024-56556-14a59844","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dc8aea47b928cc153b591b3558829ce42f685074","target":{"file":"drivers/android/binder.c","function":"binder_add_freeze_work"}},{"deprecated":false,"digest":{"line_hashes":["113519457968663428999208588565149208277","170010042509868609093064495653733499150","287081010186543995319927861005993002505","229127503102060396528631827471930645155","11689548084189178092449762277363402699","308705181095334396650545508353199661537","29260424378624128962858238439959502242","70896399710500306485788527988469956839","53363189695888639846966353040402251777","13493924392500315384052105706430377807","318166828823032113599958020370579404951","232576272002824891944472990703476826977","104828980373488623326297477565762392975","143616812705682324535196470326086591925","93895699590936234032737886626640673819","261512501167427232020980221916131799687","111401035767074571420544699882214607823"],"threshold":0.9},"id":"CVE-2024-56556-3cdc476f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@38fbefeb2c140b581ed7de8117a5c90d6dd89c22","target":{"file":"drivers/android/binder.c"}},{"deprecated":false,"digest":{"line_hashes":["113519457968663428999208588565149208277","170010042509868609093064495653733499150","287081010186543995319927861005993002505","229127503102060396528631827471930645155","11689548084189178092449762277363402699","308705181095334396650545508353199661537","29260424378624128962858238439959502242","70896399710500306485788527988469956839","53363189695888639846966353040402251777","13493924392500315384052105706430377807","318166828823032113599958020370579404951","232576272002824891944472990703476826977","104828980373488623326297477565762392975","143616812705682324535196470326086591925","93895699590936234032737886626640673819","261512501167427232020980221916131799687","111401035767074571420544699882214607823"],"threshold":0.9},"id":"CVE-2024-56556-9b69e46a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dc8aea47b928cc153b591b3558829ce42f685074","target":{"file":"drivers/android/binder.c"}},{"deprecated":false,"digest":{"function_hash":"262406987265569266840292832199140035606","length":906},"id":"CVE-2024-56556-ad006fae","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@38fbefeb2c140b581ed7de8117a5c90d6dd89c22","target":{"file":"drivers/android/binder.c","function":"binder_add_freeze_work"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.12.0"},{"fixed":"6.12.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56556.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/38fbefeb2c140b581ed7de8117a5c90d6dd89c22"},{"type":"WEB","url":"https://git.kernel.org/stable/c/dc8aea47b928cc153b591b3558829ce42f685074"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}