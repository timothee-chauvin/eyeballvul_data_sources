{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49334.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "14439872449110486227384767057766461762",
                "46618838516996011369680556704199506503",
                "158410758069945922339704784408695865564",
                "197137328188606109257646065087060248212"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-13abdc12",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@95c8181b4947e000f3b9b8e5918d899fce77b93d",
            "target": {
              "file": "mm/huge_memory.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "146161676761896145154023187259949690281",
              "length": 261.0
            },
            "id": "CVE-2022-49334-3ba0100f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@95c8181b4947e000f3b9b8e5918d899fce77b93d",
            "target": {
              "file": "lib/xarray.c",
              "function": "xas_destroy"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "58166498896075545065489132005732286922",
                "293227256705637170156392078359087468126",
                "113545793483317555763583195201160832195",
                "328307685314738441633531478718782912029"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-40211901",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@69a37a8ba1b408a1c7616494aa7018e4b3844cbe",
            "target": {
              "file": "include/linux/xarray.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "58166498896075545065489132005732286922",
                "293227256705637170156392078359087468126",
                "113545793483317555763583195201160832195",
                "328307685314738441633531478718782912029"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-52d96dde",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@95c8181b4947e000f3b9b8e5918d899fce77b93d",
            "target": {
              "file": "include/linux/xarray.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "268391243922141939653220614045715535418",
              "length": 2081.0
            },
            "id": "CVE-2022-49334-5bfabb2c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@95c8181b4947e000f3b9b8e5918d899fce77b93d",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "split_huge_page_to_list"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "58166498896075545065489132005732286922",
                "293227256705637170156392078359087468126",
                "113545793483317555763583195201160832195",
                "328307685314738441633531478718782912029"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-6101b7ea",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0c84962e297927ba57fd6ddc2bb000c9d149655",
            "target": {
              "file": "include/linux/xarray.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "14439872449110486227384767057766461762",
                "46618838516996011369680556704199506503",
                "158410758069945922339704784408695865564",
                "197137328188606109257646065087060248212"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-67b06bd9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0c84962e297927ba57fd6ddc2bb000c9d149655",
            "target": {
              "file": "mm/huge_memory.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "192681137181484380147435557065738872474",
                "40401710955296260149344318763598141690",
                "311531085406068640529856430631555080744",
                "229917287419915864395665490153695034461"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-992e8e48",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0c84962e297927ba57fd6ddc2bb000c9d149655",
            "target": {
              "file": "lib/xarray.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "14439872449110486227384767057766461762",
                "46618838516996011369680556704199506503",
                "158410758069945922339704784408695865564",
                "197137328188606109257646065087060248212"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-9cf1d2f2",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@69a37a8ba1b408a1c7616494aa7018e4b3844cbe",
            "target": {
              "file": "mm/huge_memory.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "192681137181484380147435557065738872474",
                "40401710955296260149344318763598141690",
                "311531085406068640529856430631555080744",
                "229917287419915864395665490153695034461"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-ad3293b2",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@69a37a8ba1b408a1c7616494aa7018e4b3844cbe",
            "target": {
              "file": "lib/xarray.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "146161676761896145154023187259949690281",
              "length": 261.0
            },
            "id": "CVE-2022-49334-c172cd5b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0c84962e297927ba57fd6ddc2bb000c9d149655",
            "target": {
              "file": "lib/xarray.c",
              "function": "xas_destroy"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "146161676761896145154023187259949690281",
              "length": 261.0
            },
            "id": "CVE-2022-49334-f0899c3e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@69a37a8ba1b408a1c7616494aa7018e4b3844cbe",
            "target": {
              "file": "lib/xarray.c",
              "function": "xas_destroy"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "268391243922141939653220614045715535418",
              "length": 2081.0
            },
            "id": "CVE-2022-49334-f512768c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@69a37a8ba1b408a1c7616494aa7018e4b3844cbe",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "split_huge_page_to_list"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "192681137181484380147435557065738872474",
                "40401710955296260149344318763598141690",
                "311531085406068640529856430631555080744",
                "229917287419915864395665490153695034461"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49334-f8b40df4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@95c8181b4947e000f3b9b8e5918d899fce77b93d",
            "target": {
              "file": "lib/xarray.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "126062752058791351616220767325603239755",
              "length": 2050.0
            },
            "id": "CVE-2022-49334-fe84a024",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c0c84962e297927ba57fd6ddc2bb000c9d149655",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "split_huge_page_to_list"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6b24ca4a1a8d4ee3221d6d44ddbb99f542e4bda3"
            },
            {
              "fixed": "c0c84962e297927ba57fd6ddc2bb000c9d149655"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6b24ca4a1a8d4ee3221d6d44ddbb99f542e4bda3"
            },
            {
              "fixed": "95c8181b4947e000f3b9b8e5918d899fce77b93d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6b24ca4a1a8d4ee3221d6d44ddbb99f542e4bda3"
            },
            {
              "fixed": "69a37a8ba1b408a1c7616494aa7018e4b3844cbe"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.16",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.17.1",
        "v5.17.10",
        "v5.17.11",
        "v5.17.12",
        "v5.17.13",
        "v5.17.14",
        "v5.17.2",
        "v5.17.3",
        "v5.17.4",
        "v5.17.5",
        "v5.17.6",
        "v5.17.7",
        "v5.17.8",
        "v5.17.9",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.18.1",
        "v5.18.2",
        "v5.18.3",
        "v5.19-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49334.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.17.0"
            },
            {
              "fixed": "5.17.15"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "5.18.4"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/huge_memory: Fix xarray node memory leak\n\nIf xas_split_alloc() fails to allocate the necessary nodes to complete the\nxarray entry split, it sets the xa_state to -ENOMEM, which xas_nomem()\nthen interprets as \"Please allocate more memory\", not as \"Please free\nany unnecessary memory\" (which was the intended outcome).  It's confusing\nto use xas_nomem() to free memory in this context, so call xas_destroy()\ninstead.",
  "id": "CVE-2022-49334",
  "modified": "2025-10-21T09:44:11.576343Z",
  "published": "2025-02-26T02:10:52Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/69a37a8ba1b408a1c7616494aa7018e4b3844cbe"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/95c8181b4947e000f3b9b8e5918d899fce77b93d"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c0c84962e297927ba57fd6ddc2bb000c9d149655"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "mm/huge_memory: Fix xarray node memory leak"
}