{"schema_version":"1.7.3","id":"CVE-2024-56544","published":"2024-12-27T14:11:25.801Z","modified":"2025-11-20T07:35:26.626548Z","related":["USN-7276-1","USN-7277-1"],"summary":"udmabuf: change folios array from kmalloc to kvmalloc","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nudmabuf: change folios array from kmalloc to kvmalloc\n\nWhen PAGE_SIZE 4096, MAX_PAGE_ORDER 10, 64bit machine,\npage_alloc only support 4MB.\nIf above this, trigger this warn and return NULL.\n\nudmabuf can change size limit, if change it to 3072(3GB), and then alloc\n3GB udmabuf, will fail create.\n\n[ 4080.876581] ------------[ cut here ]------------\n[ 4080.876843] WARNING: CPU: 3 PID: 2015 at mm/page_alloc.c:4556 __alloc_pages+0x2c8/0x350\n[ 4080.878839] RIP: 0010:__alloc_pages+0x2c8/0x350\n[ 4080.879470] Call Trace:\n[ 4080.879473]  <TASK>\n[ 4080.879473]  ? __alloc_pages+0x2c8/0x350\n[ 4080.879475]  ? __warn.cold+0x8e/0xe8\n[ 4080.880647]  ? __alloc_pages+0x2c8/0x350\n[ 4080.880909]  ? report_bug+0xff/0x140\n[ 4080.881175]  ? handle_bug+0x3c/0x80\n[ 4080.881556]  ? exc_invalid_op+0x17/0x70\n[ 4080.881559]  ? asm_exc_invalid_op+0x1a/0x20\n[ 4080.882077]  ? udmabuf_create+0x131/0x400\n\nBecause MAX_PAGE_ORDER, kmalloc can max alloc 4096 * (1 << 10), 4MB\nmemory, each array entry is pointer(8byte), so can save 524288 pages(2GB).\n\nFurther more, costly order(order 3) may not be guaranteed that it can be\napplied for, due to fragmentation.\n\nThis patch change udmabuf array use kvmalloc_array, this can fallback\nalloc into vmalloc, which can guarantee allocation for any size and does\nnot affect the performance of kmalloc allocations.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"fbb0de795078190a9834b3409e4b009cfb18a6d4"},{"fixed":"2acc6192aa8570661ed37868c02c03002b1dc290"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"fbb0de795078190a9834b3409e4b009cfb18a6d4"},{"fixed":"85bb72397cb63649fe493c96e27e1d0e4ed2ff63"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"fbb0de795078190a9834b3409e4b009cfb18a6d4"},{"fixed":"1c0844c6184e658064e14c4335885785ad3bf84b"}]}],"versions":["v4.19","v4.19-rc2","v4.19-rc3","v4.19-rc4","v4.19-rc5","v4.19-rc6","v4.19-rc7","v4.19-rc8","v4.20","v4.20-rc1","v4.20-rc2","v4.20-rc3","v4.20-rc4","v4.20-rc5","v4.20-rc6","v4.20-rc7","v5.0","v5.0-rc1","v5.0-rc2","v5.0-rc3","v5.0-rc4","v5.0-rc5","v5.0-rc6","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.10","v6.11.2","v6.11.3","v6.11.4","v6.11.5","v6.11.6","v6.11.7","v6.11.8","v6.11.9","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56544.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["310594491149123501713882331885422152745","286627747344699406967815321517644027809","314892665876235894060177452163528938316","136036325309679434600698443918404533667","158619274290045778950479025824623237174","294780983258194652616646564244919910987","316005644419869889367674757253857717262","180461652616658921319216367618225584003","191948497421871957404084099990122201004","261012558615206333196311575072208167627","250626673539172901299962636853510475532","23223455027621689243705802713139994052","215662620359409427211511704558172325190","64218477284500337034752297955664294517","43509404512721875363996769685743465706","283673220055444386321670224614623507726","99010144458559175903106892047391671954","258395270496472043664539130960026651853","176982847022160492249697032827240431766","134717640057789025891126565827951871043","227802461538590291803575506009654469795","207067490649063683096851599687133442489","70247092833329047239172481006654992746","109859932592586099536804128696177439376","303365925542494014114173270542354226750","49289393942035631744757407452833937109","95100755558456989376816912895607048009","246976945787209936874274229752690907044","214610415914309012508000308030856748447","56866626100035293279121295155753200345","25567816079547964633002000868692639010","278484486464258383822757574559609957342","72316380111591531909462447907163760531","338498572994862199198593581713236067417","109814382201545929912923568530896938190","42962460898338508336611434610050337772","820153527545708899133397826466112356","126181866285513773789919846582245562090","250626673539172901299962636853510475532","257866532682303956541056824568596253906","251853187490857880817400426998241697783"],"threshold":0.9},"id":"CVE-2024-56544-8aae44ec","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@85bb72397cb63649fe493c96e27e1d0e4ed2ff63","target":{"file":"drivers/dma-buf/udmabuf.c"}},{"deprecated":false,"digest":{"line_hashes":["310594491149123501713882331885422152745","286627747344699406967815321517644027809","314892665876235894060177452163528938316","136036325309679434600698443918404533667","158619274290045778950479025824623237174","294780983258194652616646564244919910987","316005644419869889367674757253857717262","180461652616658921319216367618225584003","191948497421871957404084099990122201004","261012558615206333196311575072208167627","250626673539172901299962636853510475532","23223455027621689243705802713139994052","215662620359409427211511704558172325190","64218477284500337034752297955664294517","43509404512721875363996769685743465706","283673220055444386321670224614623507726","99010144458559175903106892047391671954","258395270496472043664539130960026651853","176982847022160492249697032827240431766","134717640057789025891126565827951871043","227802461538590291803575506009654469795","207067490649063683096851599687133442489","70247092833329047239172481006654992746","109859932592586099536804128696177439376","303365925542494014114173270542354226750","49289393942035631744757407452833937109","95100755558456989376816912895607048009","246976945787209936874274229752690907044","214610415914309012508000308030856748447","56866626100035293279121295155753200345","25567816079547964633002000868692639010","278484486464258383822757574559609957342","72316380111591531909462447907163760531","338498572994862199198593581713236067417","109814382201545929912923568530896938190","42962460898338508336611434610050337772","820153527545708899133397826466112356","126181866285513773789919846582245562090","250626673539172901299962636853510475532","257866532682303956541056824568596253906","251853187490857880817400426998241697783"],"threshold":0.9},"id":"CVE-2024-56544-d54f52f5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2acc6192aa8570661ed37868c02c03002b1dc290","target":{"file":"drivers/dma-buf/udmabuf.c"}},{"deprecated":false,"digest":{"line_hashes":["310594491149123501713882331885422152745","286627747344699406967815321517644027809","314892665876235894060177452163528938316","136036325309679434600698443918404533667","158619274290045778950479025824623237174","294780983258194652616646564244919910987","316005644419869889367674757253857717262","180461652616658921319216367618225584003","191948497421871957404084099990122201004","261012558615206333196311575072208167627","250626673539172901299962636853510475532","23223455027621689243705802713139994052","215662620359409427211511704558172325190","64218477284500337034752297955664294517","43509404512721875363996769685743465706","283673220055444386321670224614623507726","99010144458559175903106892047391671954","258395270496472043664539130960026651853","176982847022160492249697032827240431766","134717640057789025891126565827951871043","227802461538590291803575506009654469795","207067490649063683096851599687133442489","70247092833329047239172481006654992746","109859932592586099536804128696177439376","303365925542494014114173270542354226750","49289393942035631744757407452833937109","95100755558456989376816912895607048009","246976945787209936874274229752690907044","214610415914309012508000308030856748447","56866626100035293279121295155753200345","25567816079547964633002000868692639010","278484486464258383822757574559609957342","72316380111591531909462447907163760531","338498572994862199198593581713236067417","109814382201545929912923568530896938190","42962460898338508336611434610050337772","820153527545708899133397826466112356","126181866285513773789919846582245562090","250626673539172901299962636853510475532","257866532682303956541056824568596253906","251853187490857880817400426998241697783"],"threshold":0.9},"id":"CVE-2024-56544-e500ad74","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c0844c6184e658064e14c4335885785ad3bf84b","target":{"file":"drivers/dma-buf/udmabuf.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"4.20.0"},{"fixed":"6.11.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.12.0"},{"fixed":"6.12.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-56544.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1c0844c6184e658064e14c4335885785ad3bf84b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2acc6192aa8570661ed37868c02c03002b1dc290"},{"type":"WEB","url":"https://git.kernel.org/stable/c/85bb72397cb63649fe493c96e27e1d0e4ed2ff63"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}