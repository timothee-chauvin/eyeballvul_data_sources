{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49778.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "306507672363475253427361777728457269675",
                "9357714687907280558954832401085388196",
                "152418771722077316736892683180079830641",
                "99900829397867285954818794022758846211",
                "70631202160218115849736981995842136215",
                "258195420320358054058039893982258404691",
                "250317684160790416534387891613344669217",
                "50749555854767041715198201017025996800"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49778-2ceec40c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5b47348fc0b18a78c96f8474cc90b7525ad1bbfe",
            "target": {
              "file": "arch/arm64/include/asm/pgtable.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "306507672363475253427361777728457269675",
                "9357714687907280558954832401085388196",
                "152418771722077316736892683180079830641",
                "99900829397867285954818794022758846211",
                "70631202160218115849736981995842136215",
                "258195420320358054058039893982258404691",
                "250317684160790416534387891613344669217",
                "50749555854767041715198201017025996800"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49778-6509daa4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d458046df634088611d44fd77f45465e833ef78",
            "target": {
              "file": "arch/arm64/include/asm/pgtable.h"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "42b2547137f5c974bb1bfd657c869fe96b96d86f"
            },
            {
              "fixed": "2d458046df634088611d44fd77f45465e833ef78"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "42b2547137f5c974bb1bfd657c869fe96b96d86f"
            },
            {
              "fixed": "5b47348fc0b18a78c96f8474cc90b7525ad1bbfe"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.18",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.0.1",
        "v6.0.2",
        "v6.0.3",
        "v6.0.4",
        "v6.0.5",
        "v6.0.6",
        "v6.0.7",
        "v6.0.8",
        "v6.0.9",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49778.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.19.0"
            },
            {
              "fixed": "6.0.10"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\narm64/mm: fix incorrect file_map_count for non-leaf pmd/pud\n\nThe page table check trigger BUG_ON() unexpectedly when collapse hugepage:\n\n ------------[ cut here ]------------\n kernel BUG at mm/page_table_check.c:82!\n Internal error: Oops - BUG: 00000000f2000800 [#1] SMP\n Dumping ftrace buffer:\n    (ftrace buffer empty)\n Modules linked in:\n CPU: 6 PID: 68 Comm: khugepaged Not tainted 6.1.0-rc3+ #750\n Hardware name: linux,dummy-virt (DT)\n pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n pc : page_table_check_clear.isra.0+0x258/0x3f0\n lr : page_table_check_clear.isra.0+0x240/0x3f0\n[...]\n Call trace:\n  page_table_check_clear.isra.0+0x258/0x3f0\n  __page_table_check_pmd_clear+0xbc/0x108\n  pmdp_collapse_flush+0xb0/0x160\n  collapse_huge_page+0xa08/0x1080\n  hpage_collapse_scan_pmd+0xf30/0x1590\n  khugepaged_scan_mm_slot.constprop.0+0x52c/0xac8\n  khugepaged+0x338/0x518\n  kthread+0x278/0x2f8\n  ret_from_fork+0x10/0x20\n[...]\n\nSince pmd_user_accessible_page() doesn't check if a pmd is leaf, it\ndecrease file_map_count for a non-leaf pmd comes from collapse_huge_page().\nand so trigger BUG_ON() unexpectedly.\n\nFix this problem by using pmd_leaf() insteal of pmd_present() in\npmd_user_accessible_page(). Moreover, use pud_leaf() for\npud_user_accessible_page() too.",
  "id": "CVE-2022-49778",
  "modified": "2025-10-21T10:59:26.779458Z",
  "published": "2025-05-01T14:09:13Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/2d458046df634088611d44fd77f45465e833ef78"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5b47348fc0b18a78c96f8474cc90b7525ad1bbfe"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "arm64/mm: fix incorrect file_map_count for non-leaf pmd/pud"
}