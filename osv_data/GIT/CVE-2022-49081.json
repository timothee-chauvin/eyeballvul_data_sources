{"schema_version":"1.7.3","id":"CVE-2022-49081","published":"2025-02-26T01:54:41Z","modified":"2025-10-21T09:07:21.801147Z","summary":"highmem: fix checks in __kmap_local_sched_{in,out}","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nhighmem: fix checks in __kmap_local_sched_{in,out}\n\nWhen CONFIG_DEBUG_KMAP_LOCAL is enabled __kmap_local_sched_{in,out} check\nthat even slots in the tsk->kmap_ctrl.pteval are unmapped.  The slots are\ninitialized with 0 value, but the check is done with pte_none.  0 pte\nhowever does not necessarily mean that pte_none will return true.  e.g.\non xtensa it returns false, resulting in the following runtime warnings:\n\n WARNING: CPU: 0 PID: 101 at mm/highmem.c:627 __kmap_local_sched_out+0x51/0x108\n CPU: 0 PID: 101 Comm: touch Not tainted 5.17.0-rc7-00010-gd3a1cdde80d2-dirty #13\n Call Trace:\n   dump_stack+0xc/0x40\n   __warn+0x8f/0x174\n   warn_slowpath_fmt+0x48/0xac\n   __kmap_local_sched_out+0x51/0x108\n   __schedule+0x71a/0x9c4\n   preempt_schedule_irq+0xa0/0xe0\n   common_exception_return+0x5c/0x93\n   do_wp_page+0x30e/0x330\n   handle_mm_fault+0xa70/0xc3c\n   do_page_fault+0x1d8/0x3c4\n   common_exception+0x7f/0x7f\n\n WARNING: CPU: 0 PID: 101 at mm/highmem.c:664 __kmap_local_sched_in+0x50/0xe0\n CPU: 0 PID: 101 Comm: touch Tainted: G        W         5.17.0-rc7-00010-gd3a1cdde80d2-dirty #13\n Call Trace:\n   dump_stack+0xc/0x40\n   __warn+0x8f/0x174\n   warn_slowpath_fmt+0x48/0xac\n   __kmap_local_sched_in+0x50/0xe0\n   finish_task_switch$isra$0+0x1ce/0x2f8\n   __schedule+0x86e/0x9c4\n   preempt_schedule_irq+0xa0/0xe0\n   common_exception_return+0x5c/0x93\n   do_wp_page+0x30e/0x330\n   handle_mm_fault+0xa70/0xc3c\n   do_page_fault+0x1d8/0x3c4\n   common_exception+0x7f/0x7f\n\nFix it by replacing !pte_none(pteval) with pte_val(pteval) != 0.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5fbda3ecd14a5343644979c98d6eb65b7e7de9d8"},{"fixed":"c21d040de6225414547d9bd31cd200f290991c85"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5fbda3ecd14a5343644979c98d6eb65b7e7de9d8"},{"fixed":"85550b0f5fa5dd3c30469ea702c44444ef242c83"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5fbda3ecd14a5343644979c98d6eb65b7e7de9d8"},{"fixed":"7dd5b3b97716a611fcf67d92fd2370fcb8d50372"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5fbda3ecd14a5343644979c98d6eb65b7e7de9d8"},{"fixed":"66f133ceab7456c789f70a242991ed1b27ba1c3d"}]}],"versions":["v5.10","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.4","v5.15.5","v5.15.6","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.1","v5.16.10","v5.16.11","v5.16.12","v5.16.13","v5.16.14","v5.16.15","v5.16.16","v5.16.17","v5.16.18","v5.16.19","v5.16.2","v5.16.3","v5.16.4","v5.16.5","v5.16.6","v5.16.7","v5.16.8","v5.16.9","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.2","v5.18-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49081.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"164826743307082486980978044720728457238","length":562},"id":"CVE-2022-49081-0a29a856","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@66f133ceab7456c789f70a242991ed1b27ba1c3d","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_in"}},{"deprecated":false,"digest":{"function_hash":"186872154984334371173310814619961620342","length":569},"id":"CVE-2022-49081-1103aca7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@85550b0f5fa5dd3c30469ea702c44444ef242c83","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_out"}},{"deprecated":false,"digest":{"function_hash":"186872154984334371173310814619961620342","length":569},"id":"CVE-2022-49081-11a31b3b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c21d040de6225414547d9bd31cd200f290991c85","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_out"}},{"deprecated":false,"digest":{"line_hashes":["228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913","228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913"],"threshold":0.9},"id":"CVE-2022-49081-22c2e94c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@85550b0f5fa5dd3c30469ea702c44444ef242c83","target":{"file":"mm/highmem.c"}},{"deprecated":false,"digest":{"line_hashes":["228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913","228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913"],"threshold":0.9},"id":"CVE-2022-49081-2af1504a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@66f133ceab7456c789f70a242991ed1b27ba1c3d","target":{"file":"mm/highmem.c"}},{"deprecated":false,"digest":{"line_hashes":["228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913","228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913"],"threshold":0.9},"id":"CVE-2022-49081-3868cb0e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7dd5b3b97716a611fcf67d92fd2370fcb8d50372","target":{"file":"mm/highmem.c"}},{"deprecated":false,"digest":{"function_hash":"164826743307082486980978044720728457238","length":562},"id":"CVE-2022-49081-75823e9b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c21d040de6225414547d9bd31cd200f290991c85","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_in"}},{"deprecated":false,"digest":{"function_hash":"164826743307082486980978044720728457238","length":562},"id":"CVE-2022-49081-7ee71871","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7dd5b3b97716a611fcf67d92fd2370fcb8d50372","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_in"}},{"deprecated":false,"digest":{"function_hash":"164826743307082486980978044720728457238","length":562},"id":"CVE-2022-49081-89933cc6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@85550b0f5fa5dd3c30469ea702c44444ef242c83","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_in"}},{"deprecated":false,"digest":{"function_hash":"186872154984334371173310814619961620342","length":569},"id":"CVE-2022-49081-b91189c0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7dd5b3b97716a611fcf67d92fd2370fcb8d50372","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_out"}},{"deprecated":false,"digest":{"line_hashes":["228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913","228139517829977112064270241649169712891","258108900850298624410529796070536767223","239972167232019512164113696831126981759","296765964846472315784145903840112681913"],"threshold":0.9},"id":"CVE-2022-49081-bb6ae6ab","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c21d040de6225414547d9bd31cd200f290991c85","target":{"file":"mm/highmem.c"}},{"deprecated":false,"digest":{"function_hash":"186872154984334371173310814619961620342","length":569},"id":"CVE-2022-49081-da0ec138","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@66f133ceab7456c789f70a242991ed1b27ba1c3d","target":{"file":"mm/highmem.c","function":"__kmap_local_sched_out"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.11.0"},{"fixed":"5.15.34"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.16.20"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49081.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/66f133ceab7456c789f70a242991ed1b27ba1c3d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7dd5b3b97716a611fcf67d92fd2370fcb8d50372"},{"type":"WEB","url":"https://git.kernel.org/stable/c/85550b0f5fa5dd3c30469ea702c44444ef242c83"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c21d040de6225414547d9bd31cd200f290991c85"}]}