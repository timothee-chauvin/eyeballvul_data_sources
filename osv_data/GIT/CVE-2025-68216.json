{"schema_version":"1.7.3","id":"CVE-2025-68216","published":"2025-12-16T13:57:11.303Z","modified":"2025-12-16T20:24:51.517089Z","summary":"LoongArch: BPF: Disable trampoline for kernel module function trace","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nLoongArch: BPF: Disable trampoline for kernel module function trace\n\nThe current LoongArch BPF trampoline implementation is incompatible\nwith tracing functions in kernel modules. This causes several severe\nand user-visible problems:\n\n* The `bpf_selftests/module_attach` test fails consistently.\n* Kernel lockup when a BPF program is attached to a module function [1].\n* Critical kernel modules like WireGuard experience traffic disruption\n  when their functions are traced with fentry [2].\n\nGiven the severity and the potential for other unknown side-effects, it\nis safest to disable the feature entirely for now. This patch prevents\nthe BPF subsystem from allowing trampoline attachments to kernel module\nfunctions on LoongArch.\n\nThis is a temporary mitigation until the core issues in the trampoline\ncode for kernel module handling can be identified and fixed.\n\n[root@fedora bpf]# ./test_progs -a module_attach -v\nbpf_testmod.ko is already unloaded.\nLoading bpf_testmod.ko...\nSuccessfully loaded bpf_testmod.ko.\ntest_module_attach:PASS:skel_open 0 nsec\ntest_module_attach:PASS:set_attach_target 0 nsec\ntest_module_attach:PASS:set_attach_target_explicit 0 nsec\ntest_module_attach:PASS:skel_load 0 nsec\nlibbpf: prog 'handle_fentry': failed to attach: -ENOTSUPP\nlibbpf: prog 'handle_fentry': failed to auto-attach: -ENOTSUPP\ntest_module_attach:FAIL:skel_attach skeleton attach failed: -524\nSummary: 0/0 PASSED, 0 SKIPPED, 1 FAILED\nSuccessfully unloaded bpf_testmod.ko.\n\n[1]: https://lore.kernel.org/loongarch/CAK3+h2wDmpC-hP4u4pJY8T-yfKyk4yRzpu2LMO+C13FMT58oqQ@mail.gmail.com/\n[2]: https://lore.kernel.org/loongarch/CAK3+h2wYcpc+OwdLDUBvg2rF9rvvyc5amfHT-KcFaK93uoELPg@mail.gmail.com/","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f9b6b41f0cf31791541cea9644ddbedb46465801"},{"fixed":"44eb3849378be5f72b8be03edbacbdcd6f5eade4"},{"fixed":"677e6123e3d24adaa252697dc89740f2ac07664e"}]}],"versions":["v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.17.3","v6.17.4","v6.17.5","v6.17.6","v6.17.7","v6.17.8","v6.17.9","v6.18-rc1","v6.18-rc2","v6.18-rc3","v6.18-rc4","v6.18-rc5","v6.18-rc6"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-68216.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.17.0"},{"fixed":"6.17.10"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-68216.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/44eb3849378be5f72b8be03edbacbdcd6f5eade4"},{"type":"WEB","url":"https://git.kernel.org/stable/c/677e6123e3d24adaa252697dc89740f2ac07664e"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/68xxx/CVE-2025-68216.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-68216"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/68xxx/CVE-2025-68216.json"}}