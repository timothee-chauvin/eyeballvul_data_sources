{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26623.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "56797000374556326816342338319980567290",
              "length": 417.0
            },
            "id": "CVE-2024-26623-023ab684",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_adminq_isr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "234586813960680396754438113762951704567",
                "126200251812607224843171685320458265330",
                "107893086643002473961149692877524226760",
                "48275965586292444143169888682135359927"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-0cd91613",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "279203898321532155175011892107624251995",
                "306932158444229233415326382568795326287",
                "124117122149586648564903006025843621446",
                "297998503063779147290784154849579521508",
                "180993448894811418894929394262015262307",
                "248318429127475618020413892394942182979",
                "146974373098562296240139403828140853645",
                "156791802433966866570957641658985541886",
                "245485638643751007143033413735879998415"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-10262dd4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "125880923063915187004296338229917954678",
              "length": 1596.0
            },
            "id": "CVE-2024-26623-125e95be",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_adminq_post"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "64387002090417370160664080227918563432",
              "length": 501.0
            },
            "id": "CVE-2024-26623-152e519d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c",
              "function": "pdsc_fw_down"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "217938519821521868641254105273712880772",
                "137019353904961869604866707955138907390",
                "166050509949227698219681265668177074123",
                "307566832525705789790449099912800005198",
                "311654749322025755997789150252296656285",
                "148843549960961299199312202795865265940",
                "255851383942271878659110910703534553681",
                "194538648306247065254225056635477854186",
                "49263674128217745432906776469412834173",
                "262722291800861204411322515417325955750",
                "328529906940881932816444928613765290417",
                "133613899659196700438251864993451747955",
                "133169777026050451922340855399271873658",
                "176157020817959073688290390841046448376",
                "286175132518827130510914997204149371334",
                "229203764644907727829743838366047089977",
                "338790752063557292669469391084838016469",
                "14527330212889191807762505593345352113",
                "273772453520794493863772444376103132055",
                "269781904012950169041342292789354617805",
                "79575215308500180711179895455260178119",
                "101522949069001276456189468136214360401",
                "320976825269222020062080233649711297707",
                "253916594956790192325190125575241104464",
                "316003206817732148140037082191806251446",
                "303593492548314739389486100509607547860",
                "194837140564233528802107164436780825316"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-180c9576",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "217938519821521868641254105273712880772",
                "137019353904961869604866707955138907390",
                "166050509949227698219681265668177074123",
                "307566832525705789790449099912800005198",
                "311654749322025755997789150252296656285",
                "148843549960961299199312202795865265940",
                "255851383942271878659110910703534553681",
                "194538648306247065254225056635477854186",
                "49263674128217745432906776469412834173",
                "262722291800861204411322515417325955750",
                "328529906940881932816444928613765290417",
                "133613899659196700438251864993451747955",
                "133169777026050451922340855399271873658",
                "176157020817959073688290390841046448376",
                "286175132518827130510914997204149371334",
                "229203764644907727829743838366047089977",
                "338790752063557292669469391084838016469",
                "14527330212889191807762505593345352113",
                "273772453520794493863772444376103132055",
                "269781904012950169041342292789354617805",
                "79575215308500180711179895455260178119",
                "101522949069001276456189468136214360401",
                "320976825269222020062080233649711297707",
                "253916594956790192325190125575241104464",
                "316003206817732148140037082191806251446",
                "303593492548314739389486100509607547860",
                "194837140564233528802107164436780825316"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-47ffbc3e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "64387002090417370160664080227918563432",
              "length": 501.0
            },
            "id": "CVE-2024-26623-487a3dad",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c",
              "function": "pdsc_fw_down"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "234586813960680396754438113762951704567",
                "126200251812607224843171685320458265330",
                "107893086643002473961149692877524226760",
                "48275965586292444143169888682135359927"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-52cb413e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "234586813960680396754438113762951704567",
                "126200251812607224843171685320458265330",
                "107893086643002473961149692877524226760",
                "48275965586292444143169888682135359927"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-67b7fb61",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "64387002090417370160664080227918563432",
              "length": 501.0
            },
            "id": "CVE-2024-26623-6f6bb187",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c",
              "function": "pdsc_fw_down"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "43305453231245078077614130005381880313",
              "length": 1070.0
            },
            "id": "CVE-2024-26623-7ce3494b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c",
              "function": "pdsc_setup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "56797000374556326816342338319980567290",
              "length": 417.0
            },
            "id": "CVE-2024-26623-8cf0c4c3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_adminq_isr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "56797000374556326816342338319980567290",
              "length": 417.0
            },
            "id": "CVE-2024-26623-9463729a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_adminq_isr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "43305453231245078077614130005381880313",
              "length": 1070.0
            },
            "id": "CVE-2024-26623-94d0f7b0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c",
              "function": "pdsc_setup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320248798767888608282809921744402177241",
              "length": 1232.0
            },
            "id": "CVE-2024-26623-9d35e4be",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_process_adminq"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "340052440820913132288168118028068133133",
              "length": 1066.0
            },
            "id": "CVE-2024-26623-a63c69ba",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c",
              "function": "pdsc_setup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "187875137042972988756999546398726979152",
                "256531081947367230069656391458396004525",
                "215072495017353373299157364363357112663",
                "297998503063779147290784154849579521508",
                "180993448894811418894929394262015262307",
                "248318429127475618020413892394942182979",
                "146974373098562296240139403828140853645",
                "156791802433966866570957641658985541886",
                "245485638643751007143033413735879998415"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-acf66d2b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "125880923063915187004296338229917954678",
              "length": 1596.0
            },
            "id": "CVE-2024-26623-b3cd77dd",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_adminq_post"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "279203898321532155175011892107624251995",
                "306932158444229233415326382568795326287",
                "124117122149586648564903006025843621446",
                "297998503063779147290784154849579521508",
                "180993448894811418894929394262015262307",
                "248318429127475618020413892394942182979",
                "146974373098562296240139403828140853645",
                "156791802433966866570957641658985541886",
                "245485638643751007143033413735879998415"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-bb1674ea",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320248798767888608282809921744402177241",
              "length": 1232.0
            },
            "id": "CVE-2024-26623-c1a8165f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5939feb63ea1f011027576c64b68b681cbad31ca",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_process_adminq"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "125880923063915187004296338229917954678",
              "length": 1596.0
            },
            "id": "CVE-2024-26623-c61981c0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_adminq_post"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320248798767888608282809921744402177241",
              "length": 1232.0
            },
            "id": "CVE-2024-26623-cb994078",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@22cd6046eb2148b18990257505834dd45c672a1b",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c",
              "function": "pdsc_process_adminq"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "217938519821521868641254105273712880772",
                "137019353904961869604866707955138907390",
                "166050509949227698219681265668177074123",
                "307566832525705789790449099912800005198",
                "311654749322025755997789150252296656285",
                "148843549960961299199312202795865265940",
                "255851383942271878659110910703534553681",
                "194538648306247065254225056635477854186",
                "49263674128217745432906776469412834173",
                "262722291800861204411322515417325955750",
                "328529906940881932816444928613765290417",
                "133613899659196700438251864993451747955",
                "133169777026050451922340855399271873658",
                "176157020817959073688290390841046448376",
                "286175132518827130510914997204149371334",
                "229203764644907727829743838366047089977",
                "338790752063557292669469391084838016469",
                "14527330212889191807762505593345352113",
                "273772453520794493863772444376103132055",
                "269781904012950169041342292789354617805",
                "79575215308500180711179895455260178119",
                "101522949069001276456189468136214360401",
                "320976825269222020062080233649711297707",
                "253916594956790192325190125575241104464",
                "316003206817732148140037082191806251446",
                "303593492548314739389486100509607547860",
                "194837140564233528802107164436780825316"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26623-cf647586",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e82a8745b951b1e794cc780d46f3fbee5e93447",
            "target": {
              "file": "drivers/net/ethernet/amd/pds_core/adminq.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "01ba61b55b2041a39c54aefb3153c770dd59a0ef"
            },
            {
              "fixed": "22cd6046eb2148b18990257505834dd45c672a1b"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "01ba61b55b2041a39c54aefb3153c770dd59a0ef"
            },
            {
              "fixed": "5939feb63ea1f011027576c64b68b681cbad31ca"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "01ba61b55b2041a39c54aefb3153c770dd59a0ef"
            },
            {
              "fixed": "7e82a8745b951b1e794cc780d46f3fbee5e93447"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.3",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.2",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.2",
        "v6.7.3",
        "v6.8-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26623.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.4.0"
            },
            {
              "fixed": "6.6.16"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.4"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\npds_core: Prevent race issues involving the adminq\n\nThere are multiple paths that can result in using the pdsc's\nadminq.\n\n[1] pdsc_adminq_isr and the resulting work from queue_work(),\n    i.e. pdsc_work_thread()->pdsc_process_adminq()\n\n[2] pdsc_adminq_post()\n\nWhen the device goes through reset via PCIe reset and/or\na fw_down/fw_up cycle due to bad PCIe state or bad device\nstate the adminq is destroyed and recreated.\n\nA NULL pointer dereference can happen if [1] or [2] happens\nafter the adminq is already destroyed.\n\nIn order to fix this, add some further state checks and\nimplement reference counting for adminq uses. Reference\ncounting was used because multiple threads can attempt to\naccess the adminq at the same time via [1] or [2]. Additionally,\nmultiple clients (i.e. pds-vfio-pci) can be using [2]\nat the same time.\n\nThe adminq_refcnt is initialized to 1 when the adminq has been\nallocated and is ready to use. Users/clients of the adminq\n(i.e. [1] and [2]) will increment the refcnt when they are using\nthe adminq. When the driver goes into a fw_down cycle it will\nset the PDSC_S_FW_DEAD bit and then wait for the adminq_refcnt\nto hit 1. Setting the PDSC_S_FW_DEAD before waiting will prevent\nany further adminq_refcnt increments. Waiting for the\nadminq_refcnt to hit 1 allows for any current users of the adminq\nto finish before the driver frees the adminq. Once the\nadminq_refcnt hits 1 the driver clears the refcnt to signify that\nthe adminq is deleted and cannot be used. On the fw_up cycle the\ndriver will once again initialize the adminq_refcnt to 1 allowing\nthe adminq to be used again.",
  "id": "CVE-2024-26623",
  "modified": "2025-10-15T08:01:33.178050Z",
  "published": "2024-03-06T06:45:32Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/22cd6046eb2148b18990257505834dd45c672a1b"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5939feb63ea1f011027576c64b68b681cbad31ca"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7e82a8745b951b1e794cc780d46f3fbee5e93447"
    }
  ],
  "related": [
    "SUSE-SU-2024:2802-1",
    "SUSE-SU-2024:2896-1",
    "SUSE-SU-2024:2973-1",
    "USN-6765-1",
    "USN-6818-2",
    "USN-6819-2"
  ],
  "schema_version": "1.7.3",
  "summary": "pds_core: Prevent race issues involving the adminq"
}