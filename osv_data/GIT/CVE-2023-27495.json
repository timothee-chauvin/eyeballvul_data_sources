{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-27495.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "42a4f1cec962cc791f33bb190678a3ce4ebce226"
            }
          ],
          "repo": "https://github.com/fastify/csrf-protection",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "ff62a22164dd3d9c352437ce58a0685619e774d1"
            },
            {
              "fixed": "e746cf735e926330b803112eb439635bb8693c74"
            }
          ],
          "repo": "https://github.com/fastify/csrf-protection",
          "type": "GIT"
        }
      ],
      "versions": [
        "v1.0.4",
        "v2.0.0",
        "v3.0.0",
        "v3.0.1",
        "v3.1.0",
        "v4.0.0",
        "v4.0.1",
        "v5.0.0",
        "v5.1.0",
        "v6.0.0",
        "v6.1.0",
        "v6.2.0"
      ]
    }
  ],
  "aliases": [
    "GHSA-qrgf-9gpc-vrxw"
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-352"
    ]
  },
  "details": "@fastify/csrf-protection is a plugin which helps protect Fastify servers against CSRF attacks. The CSRF protection enforced by the @fastify/csrf-protection library in combination with @fastify/cookie can be bypassed from network and same-site attackers under certain conditions. @fastify/csrf-protection supports an optional userInfo parameter that binds the CSRF token to the user. This parameter has been introduced to prevent cookie-tossing attacks as a fix for CVE-2021-29624. Whenever userInfo parameter is missing, or its value can be predicted for the target user account, network and same-site attackers can 1. fixate a _csrf cookie in the victim's browser, and 2. forge CSRF tokens that are valid for the victim's session. This allows attackers to bypass the CSRF protection mechanism. As a fix, @fastify/csrf-protection starting from version 6.3.0 (and v4.1.0) includes a server-defined secret hmacKey that cryptographically binds the CSRF token to the value of the _csrf cookie and the userInfo parameter, making tokens non-spoofable by attackers. This protection is effective as long as the userInfo parameter is unique for each user. This is patched in versions 6.3.0 and v4.1.0. Users are advised to upgrade. Users unable to upgrade may use a random, non-predictable userInfo parameter for each user as a mitigation.",
  "id": "CVE-2023-27495",
  "modified": "2025-10-22T18:37:21.665477Z",
  "published": "2023-04-20T17:05:21Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/fastify/csrf-protection/security/advisories/GHSA-qrgf-9gpc-vrxw"
    },
    {
      "type": "FIX",
      "url": "https://github.com/fastify/csrf-protection/commit/be3e5761f37aa05c7c1ac8ed44499c51ecec8058"
    },
    {
      "type": "WEB",
      "url": "https://www.cvedetails.com/cve/CVE-2021-29624"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N",
      "type": "CVSS_V3"
    }
  ],
  "summary": "Bypass of CSRF protection in the presence of predictable userInfo in @fastify/csrf-protection"
}