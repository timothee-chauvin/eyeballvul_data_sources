{"schema_version":"1.7.3","id":"CVE-2024-39296","published":"2024-06-25T14:22:40Z","modified":"2025-10-21T22:43:59.188748Z","related":["MGASA-2024-0263","MGASA-2024-0266","SUSE-SU-2024:2571-1","SUSE-SU-2024:2896-1","SUSE-SU-2024:2973-1"],"summary":"bonding: fix oops during rmmod","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbonding: fix oops during rmmod\n\n\"rmmod bonding\" causes an oops ever since commit cc317ea3d927 (\"bonding:\nremove redundant NULL check in debugfs function\").  Here are the relevant\nfunctions being called:\n\nbonding_exit()\n  bond_destroy_debugfs()\n    debugfs_remove_recursive(bonding_debug_root);\n    bonding_debug_root = NULL; <--------- SET TO NULL HERE\n  bond_netlink_fini()\n    rtnl_link_unregister()\n      __rtnl_link_unregister()\n        unregister_netdevice_many_notify()\n          bond_uninit()\n            bond_debug_unregister()\n              (commit removed check for bonding_debug_root == NULL)\n              debugfs_remove()\n              simple_recursive_removal()\n                down_write() -> OOPS\n\nHowever, reverting the bad commit does not solve the problem completely\nbecause the original code contains a race that could cause the same\noops, although it was much less likely to be triggered unintentionally:\n\nCPU1\n  rmmod bonding\n    bonding_exit()\n      bond_destroy_debugfs()\n        debugfs_remove_recursive(bonding_debug_root);\n\nCPU2\n  echo -bond0 > /sys/class/net/bonding_masters\n    bond_uninit()\n      bond_debug_unregister()\n        if (!bonding_debug_root)\n\nCPU1\n        bonding_debug_root = NULL;\n\nSo do NOT revert the bad commit (since the removed checks were racy\nanyway), and instead change the order of actions taken during module\nremoval.  The same oops can also happen if there is an error during\nmodule init, so apply the same fix there.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"cc317ea3d9272fab4f6fef527c865f30ca479394"},{"fixed":"f07224c16678a8af54ddc059b3d2d51885d7f35e"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"cc317ea3d9272fab4f6fef527c865f30ca479394"},{"fixed":"cf48aee81103ca06d09d73d33fb72f1191069aa6"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"cc317ea3d9272fab4f6fef527c865f30ca479394"},{"fixed":"a45835a0bb6ef7d5ddbc0714dd760de979cb6ece"}]}],"versions":["v6.5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.4","v6.6.5","v6.6.6","v6.6.7","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7","v6.9.1","v6.9.2","v6.9.3","v6.9.4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-39296.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"316093534281802161879985484023379567642","length":593},"id":"CVE-2024-39296-01933d22","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a45835a0bb6ef7d5ddbc0714dd760de979cb6ece","target":{"file":"drivers/net/bonding/bond_main.c","function":"bonding_init"}},{"deprecated":false,"digest":{"function_hash":"316093534281802161879985484023379567642","length":593},"id":"CVE-2024-39296-076f2c00","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf48aee81103ca06d09d73d33fb72f1191069aa6","target":{"file":"drivers/net/bonding/bond_main.c","function":"bonding_init"}},{"deprecated":false,"digest":{"line_hashes":["53637207350822064337929699918299945520","84901842680048164395282207306650868432","270996472396251076908943905279055206693","202242528525159827891216795886954261745","299082746368330266186112994752118313412","166354178240017068504716725119118900284","263140034541626741357621655077701729821","39363590276273397346658878522763344902","178183712553058260655158952434425807548","114674232663102653144170012360496749444","114464581154612318585244125257259770832","77191506392078510643587017720165323652","243204285480992752284558003562794544866","76653783558554450893649497874168703147","185576577435926383735038051753331249440","305262286620905639756406825095811057164","339857955367995143369833656888098072577","263428136090024864121984903784237868879","188039107007855529236788650137889426420","277236242884115533818618482536920524050","23587673973886844135974355617224731554","110344710917104042823841133517182501241","294214927947032127902383928622685437847"],"threshold":0.9},"id":"CVE-2024-39296-11002540","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f07224c16678a8af54ddc059b3d2d51885d7f35e","target":{"file":"drivers/net/bonding/bond_main.c"}},{"deprecated":false,"digest":{"function_hash":"208926820030834793719763284438883133254","length":223},"id":"CVE-2024-39296-6b6de507","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f07224c16678a8af54ddc059b3d2d51885d7f35e","target":{"file":"drivers/net/bonding/bond_main.c","function":"bonding_exit"}},{"deprecated":false,"digest":{"function_hash":"316093534281802161879985484023379567642","length":593},"id":"CVE-2024-39296-75960460","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f07224c16678a8af54ddc059b3d2d51885d7f35e","target":{"file":"drivers/net/bonding/bond_main.c","function":"bonding_init"}},{"deprecated":false,"digest":{"function_hash":"208926820030834793719763284438883133254","length":223},"id":"CVE-2024-39296-8db070f3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a45835a0bb6ef7d5ddbc0714dd760de979cb6ece","target":{"file":"drivers/net/bonding/bond_main.c","function":"bonding_exit"}},{"deprecated":false,"digest":{"function_hash":"208926820030834793719763284438883133254","length":223},"id":"CVE-2024-39296-c55820f7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf48aee81103ca06d09d73d33fb72f1191069aa6","target":{"file":"drivers/net/bonding/bond_main.c","function":"bonding_exit"}},{"deprecated":false,"digest":{"line_hashes":["53637207350822064337929699918299945520","84901842680048164395282207306650868432","270996472396251076908943905279055206693","202242528525159827891216795886954261745","299082746368330266186112994752118313412","166354178240017068504716725119118900284","263140034541626741357621655077701729821","39363590276273397346658878522763344902","178183712553058260655158952434425807548","114674232663102653144170012360496749444","114464581154612318585244125257259770832","77191506392078510643587017720165323652","243204285480992752284558003562794544866","76653783558554450893649497874168703147","185576577435926383735038051753331249440","305262286620905639756406825095811057164","339857955367995143369833656888098072577","263428136090024864121984903784237868879","188039107007855529236788650137889426420","277236242884115533818618482536920524050","23587673973886844135974355617224731554","110344710917104042823841133517182501241","294214927947032127902383928622685437847"],"threshold":0.9},"id":"CVE-2024-39296-d8a73d60","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a45835a0bb6ef7d5ddbc0714dd760de979cb6ece","target":{"file":"drivers/net/bonding/bond_main.c"}},{"deprecated":false,"digest":{"line_hashes":["53637207350822064337929699918299945520","84901842680048164395282207306650868432","270996472396251076908943905279055206693","202242528525159827891216795886954261745","299082746368330266186112994752118313412","166354178240017068504716725119118900284","263140034541626741357621655077701729821","39363590276273397346658878522763344902","178183712553058260655158952434425807548","114674232663102653144170012360496749444","114464581154612318585244125257259770832","77191506392078510643587017720165323652","243204285480992752284558003562794544866","76653783558554450893649497874168703147","185576577435926383735038051753331249440","305262286620905639756406825095811057164","339857955367995143369833656888098072577","263428136090024864121984903784237868879","188039107007855529236788650137889426420","277236242884115533818618482536920524050","23587673973886844135974355617224731554","110344710917104042823841133517182501241","294214927947032127902383928622685437847"],"threshold":0.9},"id":"CVE-2024-39296-fd472cac","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf48aee81103ca06d09d73d33fb72f1191069aa6","target":{"file":"drivers/net/bonding/bond_main.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.6.0"},{"fixed":"6.6.34"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.9.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-39296.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a45835a0bb6ef7d5ddbc0714dd760de979cb6ece"},{"type":"WEB","url":"https://git.kernel.org/stable/c/cf48aee81103ca06d09d73d33fb72f1191069aa6"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f07224c16678a8af54ddc059b3d2d51885d7f35e"}]}