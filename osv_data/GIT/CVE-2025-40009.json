{"schema_version":"1.7.3","id":"CVE-2025-40009","published":"2025-10-20T15:26:55Z","modified":"2025-10-22T17:09:48.727139Z","summary":"fs/proc/task_mmu: check p->vec_buf for NULL","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nfs/proc/task_mmu: check p->vec_buf for NULL\n\nWhen the PAGEMAP_SCAN ioctl is invoked with vec_len = 0 reaches\npagemap_scan_backout_range(), kernel panics with null-ptr-deref:\n\n[   44.936808] Oops: general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] SMP DEBUG_PAGEALLOC KASAN NOPTI\n[   44.937797] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]\n[   44.938391] CPU: 1 UID: 0 PID: 2480 Comm: reproducer Not tainted 6.17.0-rc6 #22 PREEMPT(none)\n[   44.939062] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014\n[   44.939935] RIP: 0010:pagemap_scan_thp_entry.isra.0+0x741/0xa80\n\n<snip registers, unreliable trace>\n\n[   44.946828] Call Trace:\n[   44.947030]  <TASK>\n[   44.949219]  pagemap_scan_pmd_entry+0xec/0xfa0\n[   44.952593]  walk_pmd_range.isra.0+0x302/0x910\n[   44.954069]  walk_pud_range.isra.0+0x419/0x790\n[   44.954427]  walk_p4d_range+0x41e/0x620\n[   44.954743]  walk_pgd_range+0x31e/0x630\n[   44.955057]  __walk_page_range+0x160/0x670\n[   44.956883]  walk_page_range_mm+0x408/0x980\n[   44.958677]  walk_page_range+0x66/0x90\n[   44.958984]  do_pagemap_scan+0x28d/0x9c0\n[   44.961833]  do_pagemap_cmd+0x59/0x80\n[   44.962484]  __x64_sys_ioctl+0x18d/0x210\n[   44.962804]  do_syscall_64+0x5b/0x290\n[   44.963111]  entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nvec_len = 0 in pagemap_scan_init_bounce_buffer() means no buffers are\nallocated and p->vec_buf remains set to NULL.\n\nThis breaks an assumption made later in pagemap_scan_backout_range(), that\npage_region is always allocated for p->vec_buf_index.\n\nFix it by explicitly checking p->vec_buf for NULL before dereferencing.\n\nOther sites that might run into same deref-issue are already (directly or\ntransitively) protected by checking p->vec_buf.\n\nNote:\nFrom PAGEMAP_SCAN man page, it seems vec_len = 0 is valid when no output\nis requested and it's only the side effects caller is interested in,\nhence it passes check in pagemap_scan_get_args().\n\nThis issue was found by syzkaller.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"52526ca7fdb905a768a93f8faa418e9b988fc34b"},{"fixed":"ca988dcdc6683ecd9de5f525ce469588a9141c21"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"52526ca7fdb905a768a93f8faa418e9b988fc34b"},{"fixed":"a2cb8818a3d915cd33a1e8b2babc1bb0c34862c3"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"52526ca7fdb905a768a93f8faa418e9b988fc34b"},{"fixed":"28aa29986dde79e8466bc87569141291053833f5"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.35","v6.12.36","v6.12.37","v6.12.38","v6.12.39","v6.12.4","v6.12.40","v6.12.41","v6.12.42","v6.12.43","v6.12.44","v6.12.45","v6.12.46","v6.12.47","v6.12.48","v6.12.49","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.16.4","v6.16.5","v6.16.6","v6.16.7","v6.16.8","v6.16.9","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.6","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40009.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.50"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.16.10"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40009.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/28aa29986dde79e8466bc87569141291053833f5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a2cb8818a3d915cd33a1e8b2babc1bb0c34862c3"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ca988dcdc6683ecd9de5f525ce469588a9141c21"}]}