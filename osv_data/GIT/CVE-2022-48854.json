{"schema_version":"1.7.3","id":"CVE-2022-48854","published":"2024-07-16T12:25:20.477Z","modified":"2025-11-19T12:28:25.532175Z","summary":"net: arc_emac: Fix use after free in arc_mdio_probe()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnet: arc_emac: Fix use after free in arc_mdio_probe()\n\nIf bus->state is equal to MDIOBUS_ALLOCATED, mdiobus_free(bus) will free\nthe \"bus\". But bus->name is still used in the next line, which will lead\nto a use after free.\n\nWe can fix it by putting the name in a local variable and make the\nbus->name point to the rodata section \"name\",then use the name in the\nerror message without referring to bus to avoid the uaf.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"95b5fc03c189e4ea5c63785274cc0b77fcc3a818"},{"fixed":"84c831803785c2c3bec5c28c0e8a0b72f6b41d4d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"95b5fc03c189e4ea5c63785274cc0b77fcc3a818"},{"fixed":"bc0e610a6eb0d46e4123fafdbe5e6141d9fff3be"}]}],"versions":["v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.1","v5.16.10","v5.16.11","v5.16.12","v5.16.13","v5.16.14","v5.16.2","v5.16.3","v5.16.4","v5.16.5","v5.16.6","v5.16.7","v5.16.8","v5.16.9","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48854.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["10287063606193245314401671439376698621","14012427813342695727379388780826070768","207633167572623237530869704637555035781","258142805824084957333673566851725025156","124393442133896243312283661340864652641","80427585043288507218419330850050216131","313467410140712451909103309822426557052","119927725676246962851155241145933172064","155463338721502716300080080413464999816","56363703714154936046730532310728391452","211283129903723491002774195276745496490","236006322445643356445545927241865898333"],"threshold":0.9},"id":"CVE-2022-48854-668f6e3d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84c831803785c2c3bec5c28c0e8a0b72f6b41d4d","target":{"file":"drivers/net/ethernet/arc/emac_mdio.c"}},{"deprecated":false,"digest":{"line_hashes":["10287063606193245314401671439376698621","14012427813342695727379388780826070768","207633167572623237530869704637555035781","258142805824084957333673566851725025156","124393442133896243312283661340864652641","80427585043288507218419330850050216131","313467410140712451909103309822426557052","119927725676246962851155241145933172064","155463338721502716300080080413464999816","56363703714154936046730532310728391452","211283129903723491002774195276745496490","236006322445643356445545927241865898333"],"threshold":0.9},"id":"CVE-2022-48854-6d8237b0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bc0e610a6eb0d46e4123fafdbe5e6141d9fff3be","target":{"file":"drivers/net/ethernet/arc/emac_mdio.c"}},{"deprecated":false,"digest":{"function_hash":"162364795709204383093178416368933934679","length":987},"id":"CVE-2022-48854-6e1399f3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bc0e610a6eb0d46e4123fafdbe5e6141d9fff3be","target":{"file":"drivers/net/ethernet/arc/emac_mdio.c","function":"arc_mdio_probe"}},{"deprecated":false,"digest":{"function_hash":"162364795709204383093178416368933934679","length":987},"id":"CVE-2022-48854-be165b12","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84c831803785c2c3bec5c28c0e8a0b72f6b41d4d","target":{"file":"drivers/net/ethernet/arc/emac_mdio.c","function":"arc_mdio_probe"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.16.15"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48854.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/84c831803785c2c3bec5c28c0e8a0b72f6b41d4d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/bc0e610a6eb0d46e4123fafdbe5e6141d9fff3be"}]}