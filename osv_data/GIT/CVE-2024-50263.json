{"schema_version":"1.7.3","id":"CVE-2024-50263","published":"2024-11-11T13:58:18.577Z","modified":"2025-11-20T06:31:18.906640Z","related":["USN-7276-1","USN-7277-1","openSUSE-SU-2024:14500-1","openSUSE-SU-2025:14705-1"],"summary":"fork: only invoke khugepaged, ksm hooks if no error","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nfork: only invoke khugepaged, ksm hooks if no error\n\nThere is no reason to invoke these hooks early against an mm that is in an\nincomplete state.\n\nThe change in commit d24062914837 (\"fork: use __mt_dup() to duplicate\nmaple tree in dup_mmap()\") makes this more pertinent as we may be in a\nstate where entries in the maple tree are not yet consistent.\n\nTheir placement early in dup_mmap() only appears to have been meaningful\nfor early error checking, and since functionally it'd require a very small\nallocation to fail (in practice 'too small to fail') that'd only occur in\nthe most dire circumstances, meaning the fork would fail or be OOM'd in\nany case.\n\nSince both khugepaged and KSM tracking are there to provide optimisations\nto memory performance rather than critical functionality, it doesn't\nreally matter all that much if, under such dire memory pressure, we fail\nto register an mm with these.\n\nAs a result, we follow the example of commit d2081b2bf819 (\"mm:\nkhugepaged: make khugepaged_enter() void function\") and make ksm_fork() a\nvoid function also.\n\nWe only expose the mm to these functions once we are done with them and\nonly if no error occurred in the fork operation.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d2406291483775ecddaee929231a39c70c08fda2"},{"fixed":"3b85aa0da8cd01173b9afd1f70080fbb9576c4b0"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d2406291483775ecddaee929231a39c70c08fda2"},{"fixed":"985da552a98e27096444508ce5d853244019111f"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.11.3","v6.11.4","v6.11.5","v6.11.6","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.7","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50263.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"91920218682077855692239824890670477616","length":77},"id":"CVE-2024-50263-30fcaca0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@985da552a98e27096444508ce5d853244019111f","target":{"file":"include/linux/ksm.h","function":"ksm_fork"}},{"deprecated":false,"digest":{"function_hash":"189894818360745619538307896757308571527","length":2776},"id":"CVE-2024-50263-439b615a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@985da552a98e27096444508ce5d853244019111f","target":{"file":"kernel/fork.c","function":"dup_mmap"}},{"deprecated":false,"digest":{"function_hash":"189894818360745619538307896757308571527","length":2776},"id":"CVE-2024-50263-5d15036f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3b85aa0da8cd01173b9afd1f70080fbb9576c4b0","target":{"file":"kernel/fork.c","function":"dup_mmap"}},{"deprecated":false,"digest":{"function_hash":"84760689328152593105781512269849568699","length":161},"id":"CVE-2024-50263-5e9fc7fb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@985da552a98e27096444508ce5d853244019111f","target":{"file":"include/linux/ksm.h","function":"ksm_fork"}},{"deprecated":false,"digest":{"function_hash":"84760689328152593105781512269849568699","length":161},"id":"CVE-2024-50263-6d93a301","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3b85aa0da8cd01173b9afd1f70080fbb9576c4b0","target":{"file":"include/linux/ksm.h","function":"ksm_fork"}},{"deprecated":false,"digest":{"line_hashes":["43922912996801267314373780921945554627","191317136944401003881984414725583638856","295223300240775274129141321447923452781","276565004574056345938513179917925798879","302977900577580731066216454210667236790","135951231852240395486201650357119615360","273189372603516184247684660334103759365","238593020140305946621224561574449785826","237301596853475896021786720373264372504","38905567776047086985024009656682828194","174571364502053485560884710506041461382"],"threshold":0.9},"id":"CVE-2024-50263-76b61f41","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3b85aa0da8cd01173b9afd1f70080fbb9576c4b0","target":{"file":"kernel/fork.c"}},{"deprecated":false,"digest":{"line_hashes":["226809722774128763037447946674022217015","255793815657773245732920137084575329260","247197083997453296127564946437470961856","215608687854973302218387042188653532560","118955987235336971416963361845998944896","326451784271745906673327319114424512410","249815895267356155693631571233550534772","240646536789821012853002392700073039553","96153464176207458126186278517809461522","97492581543166422361132953820153025754","97473658046745857347560898295304701448","66175613744828856989605195558279529911","160320439753937433302183354226563477965","240646536789821012853002392700073039553"],"threshold":0.9},"id":"CVE-2024-50263-797bf34b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3b85aa0da8cd01173b9afd1f70080fbb9576c4b0","target":{"file":"include/linux/ksm.h"}},{"deprecated":false,"digest":{"line_hashes":["226809722774128763037447946674022217015","255793815657773245732920137084575329260","247197083997453296127564946437470961856","215608687854973302218387042188653532560","118955987235336971416963361845998944896","326451784271745906673327319114424512410","249815895267356155693631571233550534772","240646536789821012853002392700073039553","96153464176207458126186278517809461522","97492581543166422361132953820153025754","97473658046745857347560898295304701448","66175613744828856989605195558279529911","160320439753937433302183354226563477965","240646536789821012853002392700073039553"],"threshold":0.9},"id":"CVE-2024-50263-a21006a8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@985da552a98e27096444508ce5d853244019111f","target":{"file":"include/linux/ksm.h"}},{"deprecated":false,"digest":{"line_hashes":["43922912996801267314373780921945554627","191317136944401003881984414725583638856","295223300240775274129141321447923452781","276565004574056345938513179917925798879","302977900577580731066216454210667236790","135951231852240395486201650357119615360","273189372603516184247684660334103759365","238593020140305946621224561574449785826","237301596853475896021786720373264372504","38905567776047086985024009656682828194","174571364502053485560884710506041461382"],"threshold":0.9},"id":"CVE-2024-50263-f7b16585","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@985da552a98e27096444508ce5d853244019111f","target":{"file":"kernel/fork.c"}},{"deprecated":false,"digest":{"function_hash":"91920218682077855692239824890670477616","length":77},"id":"CVE-2024-50263-fe197012","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3b85aa0da8cd01173b9afd1f70080fbb9576c4b0","target":{"file":"include/linux/ksm.h","function":"ksm_fork"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.11.7"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50263.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3b85aa0da8cd01173b9afd1f70080fbb9576c4b0"},{"type":"WEB","url":"https://git.kernel.org/stable/c/985da552a98e27096444508ce5d853244019111f"},{"type":"WEB","url":"https://project-zero.issues.chromium.org/issues/373391951"}]}