{"schema_version":"1.7.3","id":"CVE-2025-38010","published":"2025-06-18T09:28:20.715Z","modified":"2025-11-20T09:10:45.268579Z","related":["SUSE-SU-2025:02249-1","SUSE-SU-2025:02538-1","SUSE-SU-2025:02923-1"],"summary":"phy: tegra: xusb: Use a bitmask for UTMI pad power state tracking","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nphy: tegra: xusb: Use a bitmask for UTMI pad power state tracking\n\nThe current implementation uses bias_pad_enable as a reference count to\nmanage the shared bias pad for all UTMI PHYs. However, during system\nsuspension with connected USB devices, multiple power-down requests for\nthe UTMI pad result in a mismatch in the reference count, which in turn\nproduces warnings such as:\n\n[  237.762967] WARNING: CPU: 10 PID: 1618 at tegra186_utmi_pad_power_down+0x160/0x170\n[  237.763103] Call trace:\n[  237.763104]  tegra186_utmi_pad_power_down+0x160/0x170\n[  237.763107]  tegra186_utmi_phy_power_off+0x10/0x30\n[  237.763110]  phy_power_off+0x48/0x100\n[  237.763113]  tegra_xusb_enter_elpg+0x204/0x500\n[  237.763119]  tegra_xusb_suspend+0x48/0x140\n[  237.763122]  platform_pm_suspend+0x2c/0xb0\n[  237.763125]  dpm_run_callback.isra.0+0x20/0xa0\n[  237.763127]  __device_suspend+0x118/0x330\n[  237.763129]  dpm_suspend+0x10c/0x1f0\n[  237.763130]  dpm_suspend_start+0x88/0xb0\n[  237.763132]  suspend_devices_and_enter+0x120/0x500\n[  237.763135]  pm_suspend+0x1ec/0x270\n\nThe root cause was traced back to the dynamic power-down changes\nintroduced in commit a30951d31b25 (\"xhci: tegra: USB2 pad power controls\"),\nwhere the UTMI pad was being powered down without verifying its current\nstate. This unbalanced behavior led to discrepancies in the reference\ncount.\n\nTo rectify this issue, this patch replaces the single reference counter\nwith a bitmask, renamed to utmi_pad_enabled. Each bit in the mask\ncorresponds to one of the four USB2 PHYs, allowing us to track each pad's\nenablement status individually.\n\nWith this change:\n  - The bias pad is powered on only when the mask is clear.\n  - Each UTMI pad is powered on or down based on its corresponding bit\n    in the mask, preventing redundant operations.\n  - The overall power state of the shared bias pad is maintained\n    correctly during suspend/resume cycles.\n\nThe mutex used to prevent race conditions during UTMI pad enable/disable\noperations has been moved from the tegra186_utmi_bias_pad_power_on/off\nfunctions to the parent functions tegra186_utmi_pad_power_on/down. This\nchange ensures that there are no race conditions when updating the bitmask.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a30951d31b250bf3479c00e93646b6cc6fb42a56"},{"fixed":"ba25131b3c1ceec303839b2462586d7673788197"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a30951d31b250bf3479c00e93646b6cc6fb42a56"},{"fixed":"1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a30951d31b250bf3479c00e93646b6cc6fb42a56"},{"fixed":"628bec9ed68a2204184fc8230a2609075b08666e"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a30951d31b250bf3479c00e93646b6cc6fb42a56"},{"fixed":"b47158fb42959c417ff2662075c0d46fb783d5d1"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.14.6","v6.14.7","v6.15-rc1","v6.2","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.85","v6.6.86","v6.6.87","v6.6.88","v6.6.89","v6.6.9","v6.6.90","v6.6.91","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38010.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"3531130533867153759902854878014189866","length":1675},"id":"CVE-2025-38010-0ae4a409","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_bias_pad_power_on"}},{"deprecated":false,"digest":{"function_hash":"282612943309042235489249425680364240938","length":653},"id":"CVE-2025-38010-0e61d4ac","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@628bec9ed68a2204184fc8230a2609075b08666e","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_pad_power_on"}},{"deprecated":false,"digest":{"function_hash":"305137709016953509725829316424314877562","length":500},"id":"CVE-2025-38010-2b0f3cb5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@628bec9ed68a2204184fc8230a2609075b08666e","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_pad_power_down"}},{"deprecated":false,"digest":{"function_hash":"3531130533867153759902854878014189866","length":1675},"id":"CVE-2025-38010-2eed4e15","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@628bec9ed68a2204184fc8230a2609075b08666e","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_bias_pad_power_on"}},{"deprecated":false,"digest":{"function_hash":"305137709016953509725829316424314877562","length":500},"id":"CVE-2025-38010-5692c488","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_pad_power_down"}},{"deprecated":false,"digest":{"function_hash":"3531130533867153759902854878014189866","length":1675},"id":"CVE-2025-38010-5efcba79","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b47158fb42959c417ff2662075c0d46fb783d5d1","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_bias_pad_power_on"}},{"deprecated":false,"digest":{"function_hash":"201975707164457615458884124957183250802","length":687},"id":"CVE-2025-38010-72dfba7b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b47158fb42959c417ff2662075c0d46fb783d5d1","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_bias_pad_power_off"}},{"deprecated":false,"digest":{"function_hash":"305137709016953509725829316424314877562","length":500},"id":"CVE-2025-38010-7e576778","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b47158fb42959c417ff2662075c0d46fb783d5d1","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_pad_power_down"}},{"deprecated":false,"digest":{"function_hash":"282612943309042235489249425680364240938","length":653},"id":"CVE-2025-38010-8336cd86","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b47158fb42959c417ff2662075c0d46fb783d5d1","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_pad_power_on"}},{"deprecated":false,"digest":{"function_hash":"282612943309042235489249425680364240938","length":653},"id":"CVE-2025-38010-a56dcdef","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_pad_power_on"}},{"deprecated":false,"digest":{"line_hashes":["88454282468418921345826556141291462382","260178788154395891046561724478224954859","181302572620269451536479081014839990582","69071013888289406613983777867237413181","211883694308950706766378592479994335113","330616327172854005369854040373512971923","32655402971691291272989995030732724303","293675589729773900430092041471243025423","177947618922547737962348541337176208464","123119902079026617349967383354724258750","103169039014201799841566636744894060569","152202649059290785464951334821846032266","192046475314175277754987848741895301592","60929024174610906933677506032160111840","201255588723371147623620431137094617377","285943148213764685389127562189902031347","209977192875683236773498248684706412949","71319399610636514528131854935940809089","431014637827300994408167260136144395","92235491294346925112351051350937292299","22338254084637906054583703033340919133","216564805967252757531700241183934877342","239959586558545950524364414729897770318","173562496641550940925976249476928653274","243264353142383910866831592716585273446","61839138403698291214190345377819660901","5204271193673227066199916571837439815","84425696297412671313894401031227015073","96970484939616104745505113672745045688","263643438222584107916032900081573111846","163811352222832428303801956234596201713","224359623689862903820083492619332384406","125625819885881891336922229043348482137","10384183336560171527588179207073479907","56819018014729086716340196539133735084","299349024062195675330842123849756095575","38794091492396688681424166562253819204","168494527673943602462473157568185871060","81510222745282593584660148332438539444","60243356284775718268785780637304709276","258642583261528952693931735736729024040","247402425111413101818748097433913574167","223281658391274329372007262964628910642","194129827618695373052061093174515977728","194510057074218781779342996737362658395","222117908075215687255450955439366574685","33349928628793167197706886156367606398","279916932661140212924780030628544845893","117635244807308973342267588072821840576","244335037491758765621650509193922485413","166620016481318962990336106097145137536","112729426791514777508945260281312424781","157327810355681572924139285009152620035","101082189813586966881639513613368817585","252000270005929414880645891546719449375","244939149816718179714724808587330563088","236666203438095061454998411488453256417","308018860868630547635387409643266525018","212265102959060916322634987269016917324"],"threshold":0.9},"id":"CVE-2025-38010-a868cfaf","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9","target":{"file":"drivers/phy/tegra/xusb-tegra186.c"}},{"deprecated":false,"digest":{"function_hash":"201975707164457615458884124957183250802","length":687},"id":"CVE-2025-38010-cd887a32","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@628bec9ed68a2204184fc8230a2609075b08666e","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_bias_pad_power_off"}},{"deprecated":false,"digest":{"function_hash":"201975707164457615458884124957183250802","length":687},"id":"CVE-2025-38010-d3a07d73","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9","target":{"file":"drivers/phy/tegra/xusb-tegra186.c","function":"tegra186_utmi_bias_pad_power_off"}},{"deprecated":false,"digest":{"line_hashes":["88454282468418921345826556141291462382","260178788154395891046561724478224954859","181302572620269451536479081014839990582","69071013888289406613983777867237413181","211883694308950706766378592479994335113","330616327172854005369854040373512971923","32655402971691291272989995030732724303","293675589729773900430092041471243025423","177947618922547737962348541337176208464","123119902079026617349967383354724258750","103169039014201799841566636744894060569","152202649059290785464951334821846032266","192046475314175277754987848741895301592","60929024174610906933677506032160111840","201255588723371147623620431137094617377","285943148213764685389127562189902031347","209977192875683236773498248684706412949","71319399610636514528131854935940809089","431014637827300994408167260136144395","92235491294346925112351051350937292299","22338254084637906054583703033340919133","216564805967252757531700241183934877342","239959586558545950524364414729897770318","173562496641550940925976249476928653274","243264353142383910866831592716585273446","61839138403698291214190345377819660901","5204271193673227066199916571837439815","84425696297412671313894401031227015073","96970484939616104745505113672745045688","263643438222584107916032900081573111846","163811352222832428303801956234596201713","224359623689862903820083492619332384406","125625819885881891336922229043348482137","10384183336560171527588179207073479907","56819018014729086716340196539133735084","299349024062195675330842123849756095575","38794091492396688681424166562253819204","168494527673943602462473157568185871060","81510222745282593584660148332438539444","60243356284775718268785780637304709276","258642583261528952693931735736729024040","247402425111413101818748097433913574167","223281658391274329372007262964628910642","194129827618695373052061093174515977728","194510057074218781779342996737362658395","222117908075215687255450955439366574685","33349928628793167197706886156367606398","279916932661140212924780030628544845893","117635244807308973342267588072821840576","244335037491758765621650509193922485413","166620016481318962990336106097145137536","112729426791514777508945260281312424781","157327810355681572924139285009152620035","101082189813586966881639513613368817585","252000270005929414880645891546719449375","244939149816718179714724808587330563088","236666203438095061454998411488453256417","308018860868630547635387409643266525018","212265102959060916322634987269016917324"],"threshold":0.9},"id":"CVE-2025-38010-f4f7a13d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@628bec9ed68a2204184fc8230a2609075b08666e","target":{"file":"drivers/phy/tegra/xusb-tegra186.c"}},{"deprecated":false,"digest":{"line_hashes":["88454282468418921345826556141291462382","260178788154395891046561724478224954859","181302572620269451536479081014839990582","69071013888289406613983777867237413181","211883694308950706766378592479994335113","330616327172854005369854040373512971923","32655402971691291272989995030732724303","293675589729773900430092041471243025423","177947618922547737962348541337176208464","123119902079026617349967383354724258750","103169039014201799841566636744894060569","152202649059290785464951334821846032266","192046475314175277754987848741895301592","60929024174610906933677506032160111840","201255588723371147623620431137094617377","285943148213764685389127562189902031347","209977192875683236773498248684706412949","71319399610636514528131854935940809089","431014637827300994408167260136144395","92235491294346925112351051350937292299","22338254084637906054583703033340919133","216564805967252757531700241183934877342","239959586558545950524364414729897770318","173562496641550940925976249476928653274","243264353142383910866831592716585273446","61839138403698291214190345377819660901","5204271193673227066199916571837439815","84425696297412671313894401031227015073","96970484939616104745505113672745045688","263643438222584107916032900081573111846","163811352222832428303801956234596201713","224359623689862903820083492619332384406","125625819885881891336922229043348482137","10384183336560171527588179207073479907","56819018014729086716340196539133735084","299349024062195675330842123849756095575","38794091492396688681424166562253819204","168494527673943602462473157568185871060","81510222745282593584660148332438539444","60243356284775718268785780637304709276","258642583261528952693931735736729024040","247402425111413101818748097433913574167","223281658391274329372007262964628910642","194129827618695373052061093174515977728","194510057074218781779342996737362658395","222117908075215687255450955439366574685","33349928628793167197706886156367606398","279916932661140212924780030628544845893","117635244807308973342267588072821840576","244335037491758765621650509193922485413","166620016481318962990336106097145137536","112729426791514777508945260281312424781","157327810355681572924139285009152620035","101082189813586966881639513613368817585","252000270005929414880645891546719449375","244939149816718179714724808587330563088","236666203438095061454998411488453256417","308018860868630547635387409643266525018","212265102959060916322634987269016917324"],"threshold":0.9},"id":"CVE-2025-38010-fed197f0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b47158fb42959c417ff2662075c0d46fb783d5d1","target":{"file":"drivers/phy/tegra/xusb-tegra186.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.3.0"},{"fixed":"6.6.92"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.30"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.14.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38010.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/628bec9ed68a2204184fc8230a2609075b08666e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b47158fb42959c417ff2662075c0d46fb783d5d1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ba25131b3c1ceec303839b2462586d7673788197"}]}