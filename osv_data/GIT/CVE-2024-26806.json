{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26806.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "234585486405589631853180150276556880071",
                "195033904988103249669008783590764946803",
                "210907755987913734458440274315645408977",
                "21651156461504422930836582239383218762",
                "191974006527919077099897815372249875896",
                "136003957457960915095679687441520843572",
                "237184794000739013730349976351576608059",
                "271120674338587390101574347295595553801",
                "18581376467515897717670023042765956891",
                "134735582600139118323240569060533305189",
                "222255908351388292162627693278555510143",
                "51557246030335855158596553262095905280"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26806-0aa34616",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@041562ebc4759c9932b59a06527f8753b86da365",
            "target": {
              "file": "drivers/spi/spi-cadence-quadspi.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "157048504958123652182054544748595399971",
              "length": 220.0
            },
            "id": "CVE-2024-26806-545e52df",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@959043afe53ae80633e810416cee6076da6e91c6",
            "target": {
              "file": "drivers/spi/spi-cadence-quadspi.c",
              "function": "cqspi_resume"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "239120843985758137010860406936205763453",
              "length": 185.0
            },
            "id": "CVE-2024-26806-58fc7dcf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@041562ebc4759c9932b59a06527f8753b86da365",
            "target": {
              "file": "drivers/spi/spi-cadence-quadspi.c",
              "function": "cqspi_suspend"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "234585486405589631853180150276556880071",
                "195033904988103249669008783590764946803",
                "210907755987913734458440274315645408977",
                "21651156461504422930836582239383218762",
                "191974006527919077099897815372249875896",
                "136003957457960915095679687441520843572",
                "237184794000739013730349976351576608059",
                "271120674338587390101574347295595553801",
                "18581376467515897717670023042765956891",
                "134735582600139118323240569060533305189",
                "222255908351388292162627693278555510143",
                "51557246030335855158596553262095905280"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26806-760b5484",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@959043afe53ae80633e810416cee6076da6e91c6",
            "target": {
              "file": "drivers/spi/spi-cadence-quadspi.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "239120843985758137010860406936205763453",
              "length": 185.0
            },
            "id": "CVE-2024-26806-7b6827cf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@959043afe53ae80633e810416cee6076da6e91c6",
            "target": {
              "file": "drivers/spi/spi-cadence-quadspi.c",
              "function": "cqspi_suspend"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "157048504958123652182054544748595399971",
              "length": 220.0
            },
            "id": "CVE-2024-26806-9476ea1b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@041562ebc4759c9932b59a06527f8753b86da365",
            "target": {
              "file": "drivers/spi/spi-cadence-quadspi.c",
              "function": "cqspi_resume"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0578a6dbfe7514db7134501cf93acc21cf13e479"
            },
            {
              "fixed": "041562ebc4759c9932b59a06527f8753b86da365"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "0578a6dbfe7514db7134501cf93acc21cf13e479"
            },
            {
              "fixed": "959043afe53ae80633e810416cee6076da6e91c6"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.6",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.2",
        "v6.7.3",
        "v6.7.4",
        "v6.7.5",
        "v6.7.6",
        "v6.7.7",
        "v6.7.8",
        "v6.8-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26806.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.9"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nspi: cadence-qspi: remove system-wide suspend helper calls from runtime PM hooks\n\nThe ->runtime_suspend() and ->runtime_resume() callbacks are not\nexpected to call spi_controller_suspend() and spi_controller_resume().\nRemove calls to those in the cadence-qspi driver.\n\nThose helpers have two roles currently:\n - They stop/start the queue, including dealing with the kworker.\n - They toggle the SPI controller SPI_CONTROLLER_SUSPENDED flag. It\n   requires acquiring ctlr->bus_lock_mutex.\n\nStep one is irrelevant because cadence-qspi is not queued. Step two\nhowever has two implications:\n - A deadlock occurs, because ->runtime_resume() is called in a context\n   where the lock is already taken (in the ->exec_op() callback, where\n   the usage count is incremented).\n - It would disallow all operations once the device is auto-suspended.\n\nHere is a brief call tree highlighting the mutex deadlock:\n\nspi_mem_exec_op()\n        ...\n        spi_mem_access_start()\n                mutex_lock(&ctlr->bus_lock_mutex)\n\n        cqspi_exec_mem_op()\n                pm_runtime_resume_and_get()\n                        cqspi_resume()\n                                spi_controller_resume()\n                                        mutex_lock(&ctlr->bus_lock_mutex)\n                ...\n\n        spi_mem_access_end()\n                mutex_unlock(&ctlr->bus_lock_mutex)\n        ...",
  "id": "CVE-2024-26806",
  "modified": "2025-10-15T08:28:20.065351Z",
  "published": "2024-04-04T08:20:33Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/041562ebc4759c9932b59a06527f8753b86da365"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/959043afe53ae80633e810416cee6076da6e91c6"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "spi: cadence-qspi: remove system-wide suspend helper calls from runtime PM hooks"
}