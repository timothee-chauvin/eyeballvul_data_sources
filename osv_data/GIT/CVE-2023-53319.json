{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53319.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "317622245842953669650798172718015336555",
                "268392010287169625805836571343028253144",
                "280661590731595062550373290782086509702",
                "120903703469296887728685391808536580046"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53319-208c16fc",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@91450dec0445f4d12f960ba68d8d05c3cb2ab5b8",
            "target": {
              "file": "arch/arm64/kvm/pkvm.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "84250052726930803929680056365592770049",
                "58113301660773751389358599712688288431",
                "57576883916931903037821214590751891656",
                "196010077098403522604620179812167051805",
                "201347696870909428180124858197704019466",
                "112081186592121679750103640357774494616",
                "109165939889149852439689833413519471098",
                "58024780288318452557843644292198161260",
                "128477803828669465052563062808915762336"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53319-36647e1b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@91450dec0445f4d12f960ba68d8d05c3cb2ab5b8",
            "target": {
              "file": "arch/arm64/kvm/arm.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "224216908943295250612704049336233937392",
                "260532976497099697240429451791837849772",
                "235690822878591426039016334052994211206",
                "196010077098403522604620179812167051805",
                "201347696870909428180124858197704019466",
                "112081186592121679750103640357774494616",
                "109165939889149852439689833413519471098",
                "58024780288318452557843644292198161260",
                "128477803828669465052563062808915762336"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53319-3ba96b1d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa729bc7c9c8c17a2481358c841ef8ca920485d3",
            "target": {
              "file": "arch/arm64/kvm/arm.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "317622245842953669650798172718015336555",
                "268392010287169625805836571343028253144",
                "280661590731595062550373290782086509702",
                "120903703469296887728685391808536580046"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53319-8c57a048",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa729bc7c9c8c17a2481358c841ef8ca920485d3",
            "target": {
              "file": "arch/arm64/kvm/pkvm.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "271263474474203293655336578310254428402",
              "length": 296.0
            },
            "id": "CVE-2023-53319-90dbaa93",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@91450dec0445f4d12f960ba68d8d05c3cb2ab5b8",
            "target": {
              "file": "arch/arm64/kvm/pkvm.c",
              "function": "finalize_pkvm"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "271263474474203293655336578310254428402",
              "length": 296.0
            },
            "id": "CVE-2023-53319-bf200d80",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa729bc7c9c8c17a2481358c841ef8ca920485d3",
            "target": {
              "file": "arch/arm64/kvm/pkvm.c",
              "function": "finalize_pkvm"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "339239537688176630910034529417130430862",
                "4490706072345803209666803157765170907",
                "314151420892505592189356134954137278934",
                "291795259371353276920221640900910607710"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53319-cc5d21ff",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa729bc7c9c8c17a2481358c841ef8ca920485d3",
            "target": {
              "file": "arch/arm64/include/asm/virt.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "339239537688176630910034529417130430862",
                "4490706072345803209666803157765170907",
                "314151420892505592189356134954137278934",
                "291795259371353276920221640900910607710"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53319-e6ac4adf",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@91450dec0445f4d12f960ba68d8d05c3cb2ab5b8",
            "target": {
              "file": "arch/arm64/include/asm/virt.h"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "87727ba2bb05cc3cb4233231faa7ab4c7eeb6c73"
            },
            {
              "fixed": "91450dec0445f4d12f960ba68d8d05c3cb2ab5b8"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "87727ba2bb05cc3cb4233231faa7ab4c7eeb6c73"
            },
            {
              "fixed": "fa729bc7c9c8c17a2481358c841ef8ca920485d3"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.4.1",
        "v6.4.2",
        "v6.4.3",
        "v6.4.4",
        "v6.4.5",
        "v6.4.6",
        "v6.4.7",
        "v6.5-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53319.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.4.0"
            },
            {
              "fixed": "6.4.8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: arm64: Handle kvm_arm_init failure correctly in finalize_pkvm\n\nCurrently there is no synchronisation between finalize_pkvm() and\nkvm_arm_init() initcalls. The finalize_pkvm() proceeds happily even if\nkvm_arm_init() fails resulting in the following warning on all the CPUs\nand eventually a HYP panic:\n\n  | kvm [1]: IPA Size Limit: 48 bits\n  | kvm [1]: Failed to init hyp memory protection\n  | kvm [1]: error initializing Hyp mode: -22\n  |\n  | <snip>\n  |\n  | WARNING: CPU: 0 PID: 0 at arch/arm64/kvm/pkvm.c:226 _kvm_host_prot_finalize+0x30/0x50\n  | Modules linked in:\n  | CPU: 0 PID: 0 Comm: swapper/0 Not tainted 6.4.0 #237\n  | Hardware name: FVP Base RevC (DT)\n  | pstate: 634020c5 (nZCv daIF +PAN -UAO +TCO +DIT -SSBS BTYPE=--)\n  | pc : _kvm_host_prot_finalize+0x30/0x50\n  | lr : __flush_smp_call_function_queue+0xd8/0x230\n  |\n  | Call trace:\n  |  _kvm_host_prot_finalize+0x3c/0x50\n  |  on_each_cpu_cond_mask+0x3c/0x6c\n  |  pkvm_drop_host_privileges+0x4c/0x78\n  |  finalize_pkvm+0x3c/0x5c\n  |  do_one_initcall+0xcc/0x240\n  |  do_initcall_level+0x8c/0xac\n  |  do_initcalls+0x54/0x94\n  |  do_basic_setup+0x1c/0x28\n  |  kernel_init_freeable+0x100/0x16c\n  |  kernel_init+0x20/0x1a0\n  |  ret_from_fork+0x10/0x20\n  | Failed to finalize Hyp protection: -22\n  |     dtb=fvp-base-revc.dtb\n  | kvm [95]: nVHE hyp BUG at: arch/arm64/kvm/hyp/nvhe/mem_protect.c:540!\n  | kvm [95]: nVHE call trace:\n  | kvm [95]:  [<ffff800081052984>] __kvm_nvhe_hyp_panic+0xac/0xf8\n  | kvm [95]:  [<ffff800081059644>] __kvm_nvhe_handle_host_mem_abort+0x1a0/0x2ac\n  | kvm [95]:  [<ffff80008105511c>] __kvm_nvhe_handle_trap+0x4c/0x160\n  | kvm [95]:  [<ffff8000810540fc>] __kvm_nvhe___skip_pauth_save+0x4/0x4\n  | kvm [95]: ---[ end nVHE call trace ]---\n  | kvm [95]: Hyp Offset: 0xfffe8db00ffa0000\n  | Kernel panic - not syncing: HYP panic:\n  | PS:a34023c9 PC:0000f250710b973c ESR:00000000f2000800\n  | FAR:ffff000800cb00d0 HPFAR:000000000880cb00 PAR:0000000000000000\n  | VCPU:0000000000000000\n  | CPU: 3 PID: 95 Comm: kworker/u16:2 Tainted: G        W          6.4.0 #237\n  | Hardware name: FVP Base RevC (DT)\n  | Workqueue: rpciod rpc_async_schedule\n  | Call trace:\n  |  dump_backtrace+0xec/0x108\n  |  show_stack+0x18/0x2c\n  |  dump_stack_lvl+0x50/0x68\n  |  dump_stack+0x18/0x24\n  |  panic+0x138/0x33c\n  |  nvhe_hyp_panic_handler+0x100/0x184\n  |  new_slab+0x23c/0x54c\n  |  ___slab_alloc+0x3e4/0x770\n  |  kmem_cache_alloc_node+0x1f0/0x278\n  |  __alloc_skb+0xdc/0x294\n  |  tcp_stream_alloc_skb+0x2c/0xf0\n  |  tcp_sendmsg_locked+0x3d0/0xda4\n  |  tcp_sendmsg+0x38/0x5c\n  |  inet_sendmsg+0x44/0x60\n  |  sock_sendmsg+0x1c/0x34\n  |  xprt_sock_sendmsg+0xdc/0x274\n  |  xs_tcp_send_request+0x1ac/0x28c\n  |  xprt_transmit+0xcc/0x300\n  |  call_transmit+0x78/0x90\n  |  __rpc_execute+0x114/0x3d8\n  |  rpc_async_schedule+0x28/0x48\n  |  process_one_work+0x1d8/0x314\n  |  worker_thread+0x248/0x474\n  |  kthread+0xfc/0x184\n  |  ret_from_fork+0x10/0x20\n  | SMP: stopping secondary CPUs\n  | Kernel Offset: 0x57c5cb460000 from 0xffff800080000000\n  | PHYS_OFFSET: 0x80000000\n  | CPU features: 0x00000000,1035b7a3,ccfe773f\n  | Memory Limit: none\n  | ---[ end Kernel panic - not syncing: HYP panic:\n  | PS:a34023c9 PC:0000f250710b973c ESR:00000000f2000800\n  | FAR:ffff000800cb00d0 HPFAR:000000000880cb00 PAR:0000000000000000\n  | VCPU:0000000000000000 ]---\n\nFix it by checking for the successfull initialisation of kvm_arm_init()\nin finalize_pkvm() before proceeding any futher.",
  "id": "CVE-2023-53319",
  "modified": "2025-10-21T16:13:15.190678Z",
  "published": "2025-09-16T16:11:55Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/91450dec0445f4d12f960ba68d8d05c3cb2ab5b8"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/fa729bc7c9c8c17a2481358c841ef8ca920485d3"
    }
  ],
  "related": [
    "SUSE-SU-2025:3751-1"
  ],
  "schema_version": "1.7.3",
  "summary": "KVM: arm64: Handle kvm_arm_init failure correctly in finalize_pkvm"
}