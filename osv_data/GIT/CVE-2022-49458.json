{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49458.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "225677285907465452035066958711865362660",
              "length": 181.0
            },
            "id": "CVE-2022-49458-00c3149a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@577e2a9dfc8fba7938aaf75db63fae7e328cc3cb",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_uninstall"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "225677285907465452035066958711865362660",
              "length": 181.0
            },
            "id": "CVE-2022-49458-06131b64",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b288ec4439c1dad304c1862bf6b0be78d9b1b2b2",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_uninstall"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "286339504373326089283438228685837264578",
                "315501860519391717524289645512850227933",
                "130769497167722303501483167637767765749",
                "26334976955237252883600886152229132915",
                "265212050329145016892580001730774132035",
                "202769145175149206089775683978911926045",
                "326262015987921953958056497973600470554",
                "192153177309247983210696512230279250305",
                "293782843206424444543638948112235140741",
                "21620839158607313509285790655619852606",
                "71755371231440342554995576487950311444"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-0eea0439",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@59023c4fb1ab3de0fa001681650f662c253c7fd7",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "176263774439608854116090194709354343769",
                "257924590586746810856585962877126572604",
                "200230049356053727588828339767504409928",
                "35115101904164684838836516722769318971"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-0f10af8b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b288ec4439c1dad304c1862bf6b0be78d9b1b2b2",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_kms.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "176263774439608854116090194709354343769",
                "257924590586746810856585962877126572604",
                "200230049356053727588828339767504409928",
                "35115101904164684838836516722769318971"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-266b4962",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@59023c4fb1ab3de0fa001681650f662c253c7fd7",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_kms.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "176263774439608854116090194709354343769",
                "257924590586746810856585962877126572604",
                "200230049356053727588828339767504409928",
                "35115101904164684838836516722769318971"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-486ae330",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@beb81c13d020ceb7f8693e65464162e5f249218e",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_kms.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "225677285907465452035066958711865362660",
              "length": 181.0
            },
            "id": "CVE-2022-49458-5dd92435",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@59023c4fb1ab3de0fa001681650f662c253c7fd7",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_uninstall"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "103167809481994775037966511800487503091",
              "length": 346.0
            },
            "id": "CVE-2022-49458-65adf58e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@beb81c13d020ceb7f8693e65464162e5f249218e",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_install"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "225677285907465452035066958711865362660",
              "length": 181.0
            },
            "id": "CVE-2022-49458-83ca1d48",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@beb81c13d020ceb7f8693e65464162e5f249218e",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_uninstall"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "103167809481994775037966511800487503091",
              "length": 346.0
            },
            "id": "CVE-2022-49458-bd146607",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b288ec4439c1dad304c1862bf6b0be78d9b1b2b2",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_install"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "103167809481994775037966511800487503091",
              "length": 346.0
            },
            "id": "CVE-2022-49458-d014bbda",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@577e2a9dfc8fba7938aaf75db63fae7e328cc3cb",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_install"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "103167809481994775037966511800487503091",
              "length": 346.0
            },
            "id": "CVE-2022-49458-d6f8c385",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@59023c4fb1ab3de0fa001681650f662c253c7fd7",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c",
              "function": "msm_irq_install"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "286339504373326089283438228685837264578",
                "315501860519391717524289645512850227933",
                "130769497167722303501483167637767765749",
                "26334976955237252883600886152229132915",
                "265212050329145016892580001730774132035",
                "202769145175149206089775683978911926045",
                "326262015987921953958056497973600470554",
                "192153177309247983210696512230279250305",
                "293782843206424444543638948112235140741",
                "21620839158607313509285790655619852606",
                "71755371231440342554995576487950311444"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-d8054b83",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b288ec4439c1dad304c1862bf6b0be78d9b1b2b2",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "286339504373326089283438228685837264578",
                "315501860519391717524289645512850227933",
                "130769497167722303501483167637767765749",
                "26334976955237252883600886152229132915",
                "265212050329145016892580001730774132035",
                "202769145175149206089775683978911926045",
                "326262015987921953958056497973600470554",
                "192153177309247983210696512230279250305",
                "293782843206424444543638948112235140741",
                "21620839158607313509285790655619852606",
                "71755371231440342554995576487950311444"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-dae2ff92",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@beb81c13d020ceb7f8693e65464162e5f249218e",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "176263774439608854116090194709354343769",
                "257924590586746810856585962877126572604",
                "200230049356053727588828339767504409928",
                "35115101904164684838836516722769318971"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-dc4ce9dd",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@577e2a9dfc8fba7938aaf75db63fae7e328cc3cb",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_kms.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "286339504373326089283438228685837264578",
                "315501860519391717524289645512850227933",
                "130769497167722303501483167637767765749",
                "26334976955237252883600886152229132915",
                "265212050329145016892580001730774132035",
                "202769145175149206089775683978911926045",
                "326262015987921953958056497973600470554",
                "192153177309247983210696512230279250305",
                "293782843206424444543638948112235140741",
                "21620839158607313509285790655619852606",
                "71755371231440342554995576487950311444"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49458-f288d605",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@577e2a9dfc8fba7938aaf75db63fae7e328cc3cb",
            "target": {
              "file": "drivers/gpu/drm/msm/msm_drv.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f026e431cf861197dc03217d1920b38b80b31dd9"
            },
            {
              "fixed": "beb81c13d020ceb7f8693e65464162e5f249218e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f026e431cf861197dc03217d1920b38b80b31dd9"
            },
            {
              "fixed": "b288ec4439c1dad304c1862bf6b0be78d9b1b2b2"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f026e431cf861197dc03217d1920b38b80b31dd9"
            },
            {
              "fixed": "59023c4fb1ab3de0fa001681650f662c253c7fd7"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f026e431cf861197dc03217d1920b38b80b31dd9"
            },
            {
              "fixed": "577e2a9dfc8fba7938aaf75db63fae7e328cc3cb"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.14",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.27",
        "v5.15.28",
        "v5.15.29",
        "v5.15.3",
        "v5.15.30",
        "v5.15.31",
        "v5.15.32",
        "v5.15.33",
        "v5.15.34",
        "v5.15.35",
        "v5.15.36",
        "v5.15.37",
        "v5.15.38",
        "v5.15.39",
        "v5.15.4",
        "v5.15.40",
        "v5.15.41",
        "v5.15.42",
        "v5.15.43",
        "v5.15.44",
        "v5.15.45",
        "v5.15.5",
        "v5.15.6",
        "v5.15.7",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.17.1",
        "v5.17.10",
        "v5.17.11",
        "v5.17.12",
        "v5.17.13",
        "v5.17.2",
        "v5.17.3",
        "v5.17.4",
        "v5.17.5",
        "v5.17.6",
        "v5.17.7",
        "v5.17.8",
        "v5.17.9",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.18.1",
        "v5.18.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49458.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.15.0"
            },
            {
              "fixed": "5.15.46"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.17.14"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "5.18.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/msm: don't free the IRQ if it was not requested\n\nAs msm_drm_uninit() is called from the msm_drm_init() error path,\nadditional care should be necessary as not to call the free_irq() for\nthe IRQ that was not requested before (because an error occured earlier\nthan the request_irq() call).\n\nThis fixed the issue reported with the following backtrace:\n\n[    8.571329] Trying to free already-free IRQ 187\n[    8.571339] WARNING: CPU: 0 PID: 76 at kernel/irq/manage.c:1895 free_irq+0x1e0/0x35c\n[    8.588746] Modules linked in: pmic_glink pdr_interface fastrpc qrtr_smd snd_soc_hdmi_codec msm fsa4480 gpu_sched drm_dp_aux_bus qrtr i2c_qcom_geni crct10dif_ce qcom_stats qcom_q6v5_pas drm_display_helper gpi qcom_pil_info drm_kms_helper qcom_q6v5 qcom_sysmon qcom_common qcom_glink_smem qcom_rng mdt_loader qmi_helpers phy_qcom_qmp ufs_qcom typec qnoc_sm8350 socinfo rmtfs_mem fuse drm ipv6\n[    8.624154] CPU: 0 PID: 76 Comm: kworker/u16:2 Not tainted 5.18.0-rc5-next-20220506-00033-g6cee8cab6089-dirty #419\n[    8.624161] Hardware name: Qualcomm Technologies, Inc. SM8350 HDK (DT)\n[    8.641496] Workqueue: events_unbound deferred_probe_work_func\n[    8.647510] pstate: 604000c5 (nZCv daIF +PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[    8.654681] pc : free_irq+0x1e0/0x35c\n[    8.658454] lr : free_irq+0x1e0/0x35c\n[    8.662228] sp : ffff800008ab3950\n[    8.665642] x29: ffff800008ab3950 x28: 0000000000000000 x27: ffff16350f56a700\n[    8.672994] x26: ffff1635025df080 x25: ffff16350251badc x24: ffff16350251bb90\n[    8.680343] x23: 0000000000000000 x22: 00000000000000bb x21: ffff16350e8f9800\n[    8.687690] x20: ffff16350251ba00 x19: ffff16350cbd5880 x18: ffffffffffffffff\n[    8.695039] x17: 0000000000000000 x16: ffffa2dd12179434 x15: ffffa2dd1431d02d\n[    8.702391] x14: 0000000000000000 x13: ffffa2dd1431d028 x12: 662d79646165726c\n[    8.709740] x11: ffffa2dd13fd2438 x10: 000000000000000a x9 : 00000000000000bb\n[    8.717111] x8 : ffffa2dd13fd23f0 x7 : ffff800008ab3750 x6 : 00000000fffff202\n[    8.724487] x5 : ffff16377e870a18 x4 : 00000000fffff202 x3 : ffff735a6ae1b000\n[    8.731851] x2 : 0000000000000000 x1 : 0000000000000000 x0 : ffff1635015f8000\n[    8.739217] Call trace:\n[    8.741755]  free_irq+0x1e0/0x35c\n[    8.745198]  msm_drm_uninit.isra.0+0x14c/0x294 [msm]\n[    8.750548]  msm_drm_bind+0x28c/0x5d0 [msm]\n[    8.755081]  try_to_bring_up_aggregate_device+0x164/0x1d0\n[    8.760657]  __component_add+0xa0/0x170\n[    8.764626]  component_add+0x14/0x20\n[    8.768337]  dp_display_probe+0x2a4/0x464 [msm]\n[    8.773242]  platform_probe+0x68/0xe0\n[    8.777043]  really_probe.part.0+0x9c/0x28c\n[    8.781368]  __driver_probe_device+0x98/0x144\n[    8.785871]  driver_probe_device+0x40/0x140\n[    8.790191]  __device_attach_driver+0xb4/0x120\n[    8.794788]  bus_for_each_drv+0x78/0xd0\n[    8.798751]  __device_attach+0xdc/0x184\n[    8.802713]  device_initial_probe+0x14/0x20\n[    8.807031]  bus_probe_device+0x9c/0xa4\n[    8.810991]  deferred_probe_work_func+0x88/0xc0\n[    8.815667]  process_one_work+0x1d0/0x320\n[    8.819809]  worker_thread+0x14c/0x444\n[    8.823688]  kthread+0x10c/0x110\n[    8.827036]  ret_from_fork+0x10/0x20\n\nPatchwork: https://patchwork.freedesktop.org/patch/485422/",
  "id": "CVE-2022-49458",
  "modified": "2025-10-14T22:47:32.514542Z",
  "published": "2025-02-26T02:13:06Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/577e2a9dfc8fba7938aaf75db63fae7e328cc3cb"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/59023c4fb1ab3de0fa001681650f662c253c7fd7"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/b288ec4439c1dad304c1862bf6b0be78d9b1b2b2"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/beb81c13d020ceb7f8693e65464162e5f249218e"
    }
  ],
  "related": [
    "SUSE-SU-2025:1176-1",
    "SUSE-SU-2025:1241-1"
  ],
  "schema_version": "1.7.3",
  "summary": "drm/msm: don't free the IRQ if it was not requested"
}