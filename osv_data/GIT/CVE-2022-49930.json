{"schema_version":"1.7.3","id":"CVE-2022-49930","published":"2025-05-01T14:11:07Z","modified":"2025-10-21T11:26:31.231197Z","summary":"RDMA/hns: Fix NULL pointer problem in free_mr_init()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/hns: Fix NULL pointer problem in free_mr_init()\n\nLock grab occurs in a concurrent scenario, resulting in stepping on a NULL\npointer.  It should be init mutex_init() first before use the lock.\n\n  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000\n  Call trace:\n   __mutex_lock.constprop.0+0xd0/0x5c0\n   __mutex_lock_slowpath+0x1c/0x2c\n   mutex_lock+0x44/0x50\n   free_mr_send_cmd_to_hw+0x7c/0x1c0 [hns_roce_hw_v2]\n   hns_roce_v2_dereg_mr+0x30/0x40 [hns_roce_hw_v2]\n   hns_roce_dereg_mr+0x4c/0x130 [hns_roce_hw_v2]\n   ib_dereg_mr_user+0x54/0x124\n   uverbs_free_mr+0x24/0x30\n   destroy_hw_idr_uobject+0x38/0x74\n   uverbs_destroy_uobject+0x48/0x1c4\n   uobj_destroy+0x74/0xcc\n   ib_uverbs_cmd_verbs+0x368/0xbb0\n   ib_uverbs_ioctl+0xec/0x1a4\n   __arm64_sys_ioctl+0xb4/0x100\n   invoke_syscall+0x50/0x120\n   el0_svc_common.constprop.0+0x58/0x190\n   do_el0_svc+0x30/0x90\n   el0_svc+0x2c/0xb4\n   el0t_64_sync_handler+0x1a4/0x1b0\n   el0t_64_sync+0x19c/0x1a0","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"70f92521584f1d1e8268311ee84413307b0fdea8"},{"fixed":"0e23e85d86b78e734dd6654f1b69fbaeb5534c81"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"70f92521584f1d1e8268311ee84413307b0fdea8"},{"fixed":"12bcaf87d8b66d8cd812479c8a6349dcb245375c"}]}],"versions":["v5.17","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.1-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49930.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["257760224938847164519453267222029534716","17733984270169548856383969896512742976","22289868807128139021422613742654068199","299741974247368322907761577800963997588","270047776696144834664223862576230880652"],"threshold":0.9},"id":"CVE-2022-49930-32261e01","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e23e85d86b78e734dd6654f1b69fbaeb5534c81","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c"}},{"deprecated":false,"digest":{"function_hash":"219398649377094483355257832825279226294","length":226},"id":"CVE-2022-49930-482eb4e4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e23e85d86b78e734dd6654f1b69fbaeb5534c81","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"free_mr_init"}},{"deprecated":false,"digest":{"function_hash":"219398649377094483355257832825279226294","length":226},"id":"CVE-2022-49930-8ea6c244","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@12bcaf87d8b66d8cd812479c8a6349dcb245375c","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"free_mr_init"}},{"deprecated":false,"digest":{"line_hashes":["257760224938847164519453267222029534716","17733984270169548856383969896512742976","22289868807128139021422613742654068199","299741974247368322907761577800963997588","270047776696144834664223862576230880652"],"threshold":0.9},"id":"CVE-2022-49930-b6c01250","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@12bcaf87d8b66d8cd812479c8a6349dcb245375c","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.18.0"},{"fixed":"6.0.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49930.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0e23e85d86b78e734dd6654f1b69fbaeb5534c81"},{"type":"WEB","url":"https://git.kernel.org/stable/c/12bcaf87d8b66d8cd812479c8a6349dcb245375c"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}