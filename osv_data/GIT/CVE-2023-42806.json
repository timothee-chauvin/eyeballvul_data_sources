{
  "id": "CVE-2023-42806",
  "details": "Hydra is the layer-two scalability solution for Cardano. Prior to version 0.13.0, not signing and verifying `$\\mathsf{cid}$` allows an attacker (which must be a participant of this head) to use a snapshot from an old head instance with the same participants to close the head or contest the state with it. This can lead to an incorrect distribution of value (= value extraction attack; hard, but possible) or prevent the head to finalize because the value available is not consistent with the closed utxo state (= denial of service; easy). A patch is planned for version 0.13.0. As a workaround, rotate keys between heads so not to re-use keys and not result in the same multi-signature participants.",
  "modified": "2025-01-14T11:59:17.107472Z",
  "published": "2023-09-21T17:15:23Z",
  "related": [
    "GHSA-gr36-mc6v-72qq"
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/input-output-hk/hydra/security/advisories/GHSA-gr36-mc6v-72qq"
    },
    {
      "type": "WEB",
      "url": "https://github.com/input-output-hk/hydra/blob/ec6c7a2ab651462228475d0b34264e9a182c22bb/hydra-node/src/Hydra/HeadLogic.hs#L357"
    },
    {
      "type": "WEB",
      "url": "https://github.com/input-output-hk/hydra/blob/ec6c7a2ab651462228475d0b34264e9a182c22bb/hydra-node/src/Hydra/Snapshot.hs#L50-L54"
    },
    {
      "type": "WEB",
      "url": "https://github.com/input-output-hk/hydra/blob/ec6c7a2ab651462228475d0b34264e9a182c22bb/hydra-plutus/src/Hydra/Contract/Head.hs#L583-L599"
    }
  ],
  "affected": [
    {
      "ranges": [
        {
          "type": "GIT",
          "repo": "https://github.com/input-output-hk/hydra",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "9f1027e0fdff6765f5233f19c4639fdaa3558bfa"
            }
          ]
        }
      ],
      "versions": [
        "0.1.0",
        "0.10.0",
        "0.11.0",
        "0.12.0",
        "0.2.0",
        "0.3.0",
        "0.4.0",
        "0.5.0",
        "0.6.0",
        "0.7.0",
        "0.8.0",
        "0.8.1",
        "0.9.0",
        "plutus-cbor-1.0.0",
        "plutus-merkle-tree-1.0.0"
      ],
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-42806.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H"
    }
  ]
}