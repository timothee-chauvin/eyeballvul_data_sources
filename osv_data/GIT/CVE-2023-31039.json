{"schema_version":"1.7.3","id":"CVE-2023-31039","published":"2023-05-08T09:15:09.637Z","modified":"2025-12-17T05:49:48.880359Z","details":"Security vulnerability in Apache bRPC <1.5.0 on all platforms allows attackers to execute arbitrary code via ServerOptions::pid_file.\nAn attacker that can influence the ServerOptions pid_file parameter with which the bRPC server is started can execute arbitrary code with the permissions of the bRPC process.\n\nSolution:\n1. upgrade to bRPC >= 1.5.0, download link:  https://dist.apache.org/repos/dist/release/brpc/1.5.0/ https://dist.apache.org/repos/dist/release/brpc/1.5.0/ \n2. If you are using an old version of bRPC and hard to upgrade, you can apply this patch:  https://github.com/apache/brpc/pull/2218 https://github.com/apache/brpc/pull/2218","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/apache/brpc","events":[{"introduced":"06a9cd5526bc38040e1a0adbbdb222ea1c84fb65"},{"fixed":"8cc57b0c4544900cf91cb3e87451531ebb02f49a"}]}],"versions":["0.9.5","0.9.6","0.9.6-rc01","0.9.6-rc02","0.9.6-rc03","0.9.7","0.9.7-rc01","0.9.7-rc02","0.9.7-rc03","0.9.8-rc01","1.0.0","1.0.0-rc01","1.0.0-rc02","1.1.0","1.3.0","v0.9.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-31039.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["113223119815103006079442882938257788249","197047643380007642698634854981821810251","126443456836990426104568351371586774820","94023981011465621744173603143537333339","97299279264271241754090730910818281156","154851386772820354811691599084199893864","11825115508327147556853114005747906380","15774188769740441394737251091845847863","15568234137415803825814341972529025983","86211188613911946678087489672938102171","289116761178903481224964909010042310837","92176286368397795037323348006181153834","187919328957912494527785146128704935586","212020285792247846398663863330291242736","130370947365274387808280540294198061661","227186236579854822205497010203917858915","198944111492303735207053939324197074634","170994123086570946120227904005005676989","249516424056323217968893634365133336346","297018045885237104906141326297391490603"],"threshold":0.9},"id":"CVE-2023-31039-67802322","signature_type":"Line","signature_version":"v1","source":"https://github.com/apache/brpc/commit/8cc57b0c4544900cf91cb3e87451531ebb02f49a","target":{"file":"src/brpc/server.cpp"}},{"deprecated":false,"digest":{"function_hash":"175043439735115882979131555496314714499","length":295},"id":"CVE-2023-31039-b317bab0","signature_type":"Function","signature_version":"v1","source":"https://github.com/apache/brpc/commit/8cc57b0c4544900cf91cb3e87451531ebb02f49a","target":{"file":"src/brpc/server.cpp","function":"ExpandPath"}},{"deprecated":false,"digest":{"function_hash":"150646807458817649632601869261475714540","length":1084},"id":"CVE-2023-31039-d443e4cc","signature_type":"Function","signature_version":"v1","source":"https://github.com/apache/brpc/commit/8cc57b0c4544900cf91cb3e87451531ebb02f49a","target":{"file":"src/brpc/server.cpp","function":"Server::PutPidFileIfNeeded"}}]}}],"references":[{"type":"ARTICLE","url":"http://www.openwall.com/lists/oss-security/2023/05/08/1"},{"type":"ARTICLE","url":"https://lists.apache.org/thread/jqpttrqbc38yhckgp67xk399hqxnz7jn"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}