{"schema_version":"1.7.3","id":"CVE-2024-57804","published":"2025-01-11T12:39:50.958Z","modified":"2025-11-20T07:27:22.389221Z","related":["SUSE-SU-2025:0289-1","SUSE-SU-2025:0428-1","SUSE-SU-2025:0499-1","SUSE-SU-2025:0557-1","USN-7379-2","USN-7380-1"],"summary":"scsi: mpi3mr: Fix corrupt config pages PHY state is switched in sysfs","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: mpi3mr: Fix corrupt config pages PHY state is switched in sysfs\n\nThe driver, through the SAS transport, exposes a sysfs interface to\nenable/disable PHYs in a controller/expander setup.  When multiple PHYs\nare disabled and enabled in rapid succession, the persistent and current\nconfig pages related to SAS IO unit/SAS Expander pages could get\ncorrupted.\n\nUse separate memory for each config request.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"32d457d5a2af9bf5ddbe28297eabf1fc93451665"},{"fixed":"869fdc6f0606060301aef648231e186c7c542f5a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"32d457d5a2af9bf5ddbe28297eabf1fc93451665"},{"fixed":"711201a8b8334a397440ac0b859df0054e174bc9"}]}],"versions":["v6.0","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.2","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.13-rc1","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-57804.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"25975667646248024443856996353176632563","length":4322},"id":"CVE-2024-57804-156c3684","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@711201a8b8334a397440ac0b859df0054e174bc9","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_free_mem"}},{"deprecated":false,"digest":{"function_hash":"59437494438704456784025067916625591760","length":241},"id":"CVE-2024-57804-2a3468bc","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@711201a8b8334a397440ac0b859df0054e174bc9","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_free_config_dma_memory"}},{"deprecated":false,"digest":{"line_hashes":["164841472337305809267265709052605244893","291987950687054978204378677223462849353","87112267123476171949631242235616858252","258044556838021806781415153167379493607","4237895527097898286864346520671200074","255474199603439788964021337209502683146","283854007965548335293131869846143394442","57312895175474756726020335794879662825","39695755820911859681230588166642891606","77096495844954573080195442526166823851","278900646110029908559180078147556030491","4066173028978453099822360769710172170"],"threshold":0.9},"id":"CVE-2024-57804-2bed929a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@869fdc6f0606060301aef648231e186c7c542f5a","target":{"file":"drivers/scsi/mpi3mr/mpi3mr.h"}},{"deprecated":false,"digest":{"line_hashes":["164841472337305809267265709052605244893","291987950687054978204378677223462849353","87112267123476171949631242235616858252","258044556838021806781415153167379493607","4237895527097898286864346520671200074","255474199603439788964021337209502683146","283854007965548335293131869846143394442","57312895175474756726020335794879662825","39695755820911859681230588166642891606","77096495844954573080195442526166823851","278900646110029908559180078147556030491","4066173028978453099822360769710172170"],"threshold":0.9},"id":"CVE-2024-57804-4e22dd17","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@711201a8b8334a397440ac0b859df0054e174bc9","target":{"file":"drivers/scsi/mpi3mr/mpi3mr.h"}},{"deprecated":false,"digest":{"line_hashes":["338503502143574845323054325987133453544","21927749044163115667215403503470354317","114521543105912549829087814538248487536","27736603818108141201123823603752891","63561106383566706100997719587840884652","295554470592612174083762468106173476787","284963141833210452529126427387587112890","194816212018824702760322524021606242400","9210322090122176300400533937817531464","150130201083391201204745238742937353535","184879502731077701553683010485557839353","80072292489489826511583138765777477579","77356169394410744806100472841555791447","319443499842438132771112789051808448153","223218800922150733523981497865455734596","160946692023176492742243281352377743196","218188229057220187644728767781457573928","67363044123089914900390318234831153860","104005344238257939580841513020753979324","28999074163965201069724306444662330584","330292846471188928775723306697963966238","125653602935674572072488671864419774114","148222386032627722840860523405773808770","342240573783666671348482846953665155","170200786189113150157958789775330948437","1013446324181648992336746268336871002","144339615837295718590650877765357398531","28759375749779302640639690541799550449","212696114735941290698430530121552012533","139811780400845923574606871316988938402","77560474097195854369614359137312157596","284406734997221058847607692068441006957","107097911149104192517698663563723598753","10834221609267686448299521424562392240","266255144144243143341621916265832363557","310488561044069842248640679284799313978","26221233106054161921945674210269152202","250053040561496766845346653567668416500","290585975801716140553349960777979853916","86524406168433026124436185102451052118","215057661075249841716551418870782535530","11447235739722345240384107676733745150","332597695980351388506802143907118124511","24850729686640654621035015847639521048","218778029451075736421906799128828534499","303262374677884207265939898899922961799","33801092767082517045547814024065411352","261852971258056359146246163442879318459","151219117728770379968480320786685191323","317731400122095256510024143490723304842","41774105919346763230330525567044374464","104915569040630267329399367132085473989","295157884308312966272499979766303069721","71140611840904725119514266529801462819","93343681783259333845447913285530658555","182346182572253939383425758055352880280","283241531487110058087672181435488633571"],"threshold":0.9},"id":"CVE-2024-57804-4fbb7929","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@711201a8b8334a397440ac0b859df0054e174bc9","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c"}},{"deprecated":false,"digest":{"function_hash":"82546076867856030527547392543535994200","length":4341},"id":"CVE-2024-57804-66278b25","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@711201a8b8334a397440ac0b859df0054e174bc9","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_init_ioc"}},{"deprecated":false,"digest":{"function_hash":"238719923836653237886648412177249690460","length":2374},"id":"CVE-2024-57804-6c320e02","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@711201a8b8334a397440ac0b859df0054e174bc9","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_process_cfg_req"}},{"deprecated":false,"digest":{"function_hash":"25975667646248024443856996353176632563","length":4322},"id":"CVE-2024-57804-76aa0a33","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@869fdc6f0606060301aef648231e186c7c542f5a","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_free_mem"}},{"deprecated":false,"digest":{"line_hashes":["338503502143574845323054325987133453544","21927749044163115667215403503470354317","114521543105912549829087814538248487536","27736603818108141201123823603752891","63561106383566706100997719587840884652","295554470592612174083762468106173476787","284963141833210452529126427387587112890","194816212018824702760322524021606242400","9210322090122176300400533937817531464","150130201083391201204745238742937353535","184879502731077701553683010485557839353","80072292489489826511583138765777477579","77356169394410744806100472841555791447","319443499842438132771112789051808448153","223218800922150733523981497865455734596","160946692023176492742243281352377743196","218188229057220187644728767781457573928","67363044123089914900390318234831153860","104005344238257939580841513020753979324","28999074163965201069724306444662330584","330292846471188928775723306697963966238","125653602935674572072488671864419774114","148222386032627722840860523405773808770","342240573783666671348482846953665155","170200786189113150157958789775330948437","1013446324181648992336746268336871002","144339615837295718590650877765357398531","28759375749779302640639690541799550449","212696114735941290698430530121552012533","139811780400845923574606871316988938402","77560474097195854369614359137312157596","284406734997221058847607692068441006957","107097911149104192517698663563723598753","10834221609267686448299521424562392240","266255144144243143341621916265832363557","310488561044069842248640679284799313978","26221233106054161921945674210269152202","250053040561496766845346653567668416500","290585975801716140553349960777979853916","86524406168433026124436185102451052118","215057661075249841716551418870782535530","11447235739722345240384107676733745150","332597695980351388506802143907118124511","24850729686640654621035015847639521048","218778029451075736421906799128828534499","303262374677884207265939898899922961799","33801092767082517045547814024065411352","261852971258056359146246163442879318459","151219117728770379968480320786685191323","317731400122095256510024143490723304842","41774105919346763230330525567044374464","104915569040630267329399367132085473989","295157884308312966272499979766303069721","71140611840904725119514266529801462819","93343681783259333845447913285530658555","182346182572253939383425758055352880280","283241531487110058087672181435488633571"],"threshold":0.9},"id":"CVE-2024-57804-80e6c053","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@869fdc6f0606060301aef648231e186c7c542f5a","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c"}},{"deprecated":false,"digest":{"function_hash":"82546076867856030527547392543535994200","length":4341},"id":"CVE-2024-57804-82581e52","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@869fdc6f0606060301aef648231e186c7c542f5a","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_init_ioc"}},{"deprecated":false,"digest":{"function_hash":"59437494438704456784025067916625591760","length":241},"id":"CVE-2024-57804-8ea41316","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@869fdc6f0606060301aef648231e186c7c542f5a","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_free_config_dma_memory"}},{"deprecated":false,"digest":{"function_hash":"238719923836653237886648412177249690460","length":2374},"id":"CVE-2024-57804-93857eb4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@869fdc6f0606060301aef648231e186c7c542f5a","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_process_cfg_req"}},{"deprecated":false,"digest":{"function_hash":"59182287605330107935070685875998685105","length":409},"id":"CVE-2024-57804-abe73c8c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@711201a8b8334a397440ac0b859df0054e174bc9","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_alloc_config_dma_memory"}},{"deprecated":false,"digest":{"function_hash":"59182287605330107935070685875998685105","length":409},"id":"CVE-2024-57804-f876d0c2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@869fdc6f0606060301aef648231e186c7c542f5a","target":{"file":"drivers/scsi/mpi3mr/mpi3mr_fw.c","function":"mpi3mr_alloc_config_dma_memory"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.1.0"},{"fixed":"6.12.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-57804.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/711201a8b8334a397440ac0b859df0054e174bc9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/869fdc6f0606060301aef648231e186c7c542f5a"}]}