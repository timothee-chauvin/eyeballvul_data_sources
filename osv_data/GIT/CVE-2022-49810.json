{"schema_version":"1.7.3","id":"CVE-2022-49810","published":"2025-05-01T14:09:35Z","modified":"2025-10-21T11:04:06.630800Z","related":["SUSE-SU-2025:01918-1","SUSE-SU-2025:01966-1","SUSE-SU-2025:02173-1","SUSE-SU-2025:02262-1"],"summary":"netfs: Fix missing xas_retry() calls in xarray iteration","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnetfs: Fix missing xas_retry() calls in xarray iteration\n\nnetfslib has a number of places in which it performs iteration of an xarray\nwhilst being under the RCU read lock.  It *should* call xas_retry() as the\nfirst thing inside of the loop and do \"continue\" if it returns true in case\nthe xarray walker passed out a special value indicating that the walk needs\nto be redone from the root[*].\n\nFix this by adding the missing retry checks.\n\n[*] I wonder if this should be done inside xas_find(), xas_next_node() and\n    suchlike, but I'm told that's not an simple change to effect.\n\nThis can cause an oops like that below.  Note the faulting address - this\nis an internal value (|0x2) returned from xarray.\n\nBUG: kernel NULL pointer dereference, address: 0000000000000402\n...\nRIP: 0010:netfs_rreq_unlock+0xef/0x380 [netfs]\n...\nCall Trace:\n netfs_rreq_assess+0xa6/0x240 [netfs]\n netfs_readpage+0x173/0x3b0 [netfs]\n ? init_wait_var_entry+0x50/0x50\n filemap_read_page+0x33/0xf0\n filemap_get_pages+0x2f2/0x3f0\n filemap_read+0xaa/0x320\n ? do_filp_open+0xb2/0x150\n ? rmqueue+0x3be/0xe10\n ceph_read_iter+0x1fe/0x680 [ceph]\n ? new_sync_read+0x115/0x1a0\n new_sync_read+0x115/0x1a0\n vfs_read+0xf3/0x180\n ksys_read+0x5f/0xe0\n do_syscall_64+0x38/0x90\n entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nChanges:\n========\nver #2)\n - Changed an unsigned int to a size_t to reduce the likelihood of an\n   overflow as per Willy's suggestion.\n - Added an additional patch to fix the maths.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3d3c95046742e4eebaa4b891b0b01cbbed94ebbd"},{"fixed":"b2cc07a76f1eb12de3b22caf5fdbf856a7bef16d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3d3c95046742e4eebaa4b891b0b01cbbed94ebbd"},{"fixed":"7e043a80b5dae5c2d2cf84031501de7827fd6c00"}]}],"versions":["v5.12","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.0.8","v6.0.9","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49810.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["32041236763448323049134596760215294735","101360373092268390583134700279932228748","84998093689135306465443532097221899512","140162646945368296730221431287157531125","186659782890191041575137493199793193889","55217904426352896351492941418217551418"],"threshold":0.9},"id":"CVE-2022-49810-2ad27136","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2cc07a76f1eb12de3b22caf5fdbf856a7bef16d","target":{"file":"fs/netfs/buffered_read.c"}},{"deprecated":false,"digest":{"function_hash":"64960086076983741621304677781979921537","length":1701},"id":"CVE-2022-49810-7d8c0e07","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e043a80b5dae5c2d2cf84031501de7827fd6c00","target":{"file":"fs/netfs/buffered_read.c","function":"netfs_rreq_unlock_folios"}},{"deprecated":false,"digest":{"line_hashes":["196706438013368698993778113111946467770","1487931568068748432592337077671317350","1532217284170509331313661188725790774","89221781230092756785509775672626676449"],"threshold":0.9},"id":"CVE-2022-49810-b67a841e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e043a80b5dae5c2d2cf84031501de7827fd6c00","target":{"file":"fs/netfs/io.c"}},{"deprecated":false,"digest":{"function_hash":"64960086076983741621304677781979921537","length":1701},"id":"CVE-2022-49810-d473323d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2cc07a76f1eb12de3b22caf5fdbf856a7bef16d","target":{"file":"fs/netfs/buffered_read.c","function":"netfs_rreq_unlock_folios"}},{"deprecated":false,"digest":{"function_hash":"8484745214304597863304458925264838268","length":514},"id":"CVE-2022-49810-e3ffe5e3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e043a80b5dae5c2d2cf84031501de7827fd6c00","target":{"file":"fs/netfs/io.c","function":"netfs_rreq_unmark_after_write"}},{"deprecated":false,"digest":{"line_hashes":["196706438013368698993778113111946467770","1487931568068748432592337077671317350","1532217284170509331313661188725790774","89221781230092756785509775672626676449"],"threshold":0.9},"id":"CVE-2022-49810-e45896c1","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2cc07a76f1eb12de3b22caf5fdbf856a7bef16d","target":{"file":"fs/netfs/io.c"}},{"deprecated":false,"digest":{"line_hashes":["32041236763448323049134596760215294735","101360373092268390583134700279932228748","84998093689135306465443532097221899512","140162646945368296730221431287157531125","186659782890191041575137493199793193889","55217904426352896351492941418217551418"],"threshold":0.9},"id":"CVE-2022-49810-f0ec414b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7e043a80b5dae5c2d2cf84031501de7827fd6c00","target":{"file":"fs/netfs/buffered_read.c"}},{"deprecated":false,"digest":{"function_hash":"8484745214304597863304458925264838268","length":514},"id":"CVE-2022-49810-f3d1feaa","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2cc07a76f1eb12de3b22caf5fdbf856a7bef16d","target":{"file":"fs/netfs/io.c","function":"netfs_rreq_unmark_after_write"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.13.0"},{"fixed":"6.0.10"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49810.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7e043a80b5dae5c2d2cf84031501de7827fd6c00"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b2cc07a76f1eb12de3b22caf5fdbf856a7bef16d"}]}