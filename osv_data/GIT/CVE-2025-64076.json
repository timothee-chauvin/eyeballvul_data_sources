{"schema_version":"1.7.3","id":"CVE-2025-64076","published":"2025-11-18T18:16:14.263Z","modified":"2025-11-21T06:34:48.495358Z","details":"Multiple vulnerabilities exist in cbor2 through version 5.7.0 in the decode_definite_long_string() function of the C extension decoder (source/decoder.c): (1) Integer Underflow Leading to Out-of-Bounds Read (CWE-191, CWE-125): An incorrect variable reference and missing state reset in the chunk processing loop causes buffer_length to not be reset to zero after UTF-8 character consumption. This results in subsequent chunk_length calculations producing negative values (e.g., chunk_length = 65536 - buffer_length), which are passed as signed integers to the read() method, potentially triggering unlimited read operations and resource exhaustion. (2) Memory Leak via Missing Reference Count Release (CWE-401): The main processing loop fails to release Python object references (Py_DECREF) for chunk objects allocated in each iteration. For CBOR strings longer than 65536 bytes, this causes cumulative memory leaks proportional to the payload size, enabling memory exhaustion attacks through repeated processing of large CBOR payloads. Both vulnerabilities can be exploited remotely without authentication by sending specially-crafted CBOR data containing definite-length text strings with multi-byte UTF-8 characters positioned at 65536-byte chunk boundaries. Successful exploitation results in denial of service through process crashes (CBORDecodeEOF exceptions) or memory exhaustion. The vulnerabilities affect all applications using cbor2's C extension to process untrusted CBOR data, including web APIs, IoT data collectors, and message queue processors. Fixed in commit 851473490281f82d82560b2368284ef33cf6e8f9 pushed with released version 5.7.1.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/agronholm/cbor2","events":[{"introduced":"0"},{"fixed":"851473490281f82d82560b2368284ef33cf6e8f9"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-64076.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["182955352741262233703589951573992415159","35919886763126751953850100087637849031","108806314681881520410567598648245910160","298163347750835650032585773804969820492","237712233472494487704578345455073250217","208029757920017724947360255748363555428","138518303186084842648381399433997610717","212074946647865072190979666019246702069","177007551150152379193689915861964298616"],"threshold":0.9},"id":"CVE-2025-64076-e741826b","signature_type":"Line","signature_version":"v1","source":"https://github.com/agronholm/cbor2/commit/851473490281f82d82560b2368284ef33cf6e8f9","target":{"file":"source/decoder.c"}},{"deprecated":false,"digest":{"function_hash":"322487416329299128553260943586047356831","length":1278},"id":"CVE-2025-64076-fb054cc3","signature_type":"Function","signature_version":"v1","source":"https://github.com/agronholm/cbor2/commit/851473490281f82d82560b2368284ef33cf6e8f9","target":{"file":"source/decoder.c","function":"decode_definite_long_string"}}]}}],"references":[{"type":"REPORT","url":"https://github.com/agronholm/cbor2/issues/264"},{"type":"FIX","url":"https://github.com/agronholm/cbor2/commit/851473490281f82d82560b2368284ef33cf6e8f9"},{"type":"FIX","url":"https://github.com/agronholm/cbor2/pull/265"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}