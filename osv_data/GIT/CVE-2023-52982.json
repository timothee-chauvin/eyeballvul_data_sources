{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52982.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "211297710390392734526287764333806475592",
              "length": 351.0
            },
            "id": "CVE-2023-52982-3cef6c36",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3be069f42a7b79d3149194f21cdf24bf23864cac",
            "target": {
              "file": "fs/fscache/volume.c",
              "function": "fscache_wait_on_volume_collision"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "211297710390392734526287764333806475592",
              "length": 351.0
            },
            "id": "CVE-2023-52982-73b62f5b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8226e37d82f43657da34dd770e2b38f20242ada7",
            "target": {
              "file": "fs/fscache/volume.c",
              "function": "fscache_wait_on_volume_collision"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "76913703887765347771253267812429282919",
              "length": 370.0
            },
            "id": "CVE-2023-52982-78b146f4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3be069f42a7b79d3149194f21cdf24bf23864cac",
            "target": {
              "file": "fs/fscache/volume.c",
              "function": "fscache_wake_pending_volume"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "143563153100414478397506533359771234820",
                "136718081832928532900537153353650729083",
                "62159790751506408541253506137406392406",
                "150754358232075801983693557331380946073",
                "237155740499837763372806543395189957466",
                "254695172629073868659960964374232175298",
                "208745530125551331185427425582355286634",
                "122055357296869711393794540201534512597",
                "267658799259023857920181171122054764351",
                "31115514148684694321622255863894060031",
                "84002520560428061398104040449693801497",
                "216620714546671037569501938442313284529",
                "88563306016736276647578670788688047788",
                "186816206796566299770809139876319236297",
                "23947294268646768881775889667032349430"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52982-794032ac",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8226e37d82f43657da34dd770e2b38f20242ada7",
            "target": {
              "file": "fs/fscache/volume.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "143563153100414478397506533359771234820",
                "136718081832928532900537153353650729083",
                "62159790751506408541253506137406392406",
                "150754358232075801983693557331380946073",
                "237155740499837763372806543395189957466",
                "254695172629073868659960964374232175298",
                "208745530125551331185427425582355286634",
                "122055357296869711393794540201534512597",
                "267658799259023857920181171122054764351",
                "31115514148684694321622255863894060031",
                "84002520560428061398104040449693801497",
                "216620714546671037569501938442313284529",
                "88563306016736276647578670788688047788",
                "186816206796566299770809139876319236297",
                "23947294268646768881775889667032349430"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52982-d0ae0b30",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3be069f42a7b79d3149194f21cdf24bf23864cac",
            "target": {
              "file": "fs/fscache/volume.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "76913703887765347771253267812429282919",
              "length": 370.0
            },
            "id": "CVE-2023-52982-e78f39fe",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8226e37d82f43657da34dd770e2b38f20242ada7",
            "target": {
              "file": "fs/fscache/volume.c",
              "function": "fscache_wake_pending_volume"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "62ab63352350e881ae693a8236b35d7d0516c78b"
            },
            {
              "fixed": "3be069f42a7b79d3149194f21cdf24bf23864cac"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "62ab63352350e881ae693a8236b35d7d0516c78b"
            },
            {
              "fixed": "8226e37d82f43657da34dd770e2b38f20242ada7"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.16",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1",
        "v6.1.10",
        "v6.1.2",
        "v6.1.3",
        "v6.1.4",
        "v6.1.5",
        "v6.1.6",
        "v6.1.7",
        "v6.1.8",
        "v6.1.9",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52982.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.17.0"
            },
            {
              "fixed": "6.1.11"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nfscache: Use wait_on_bit() to wait for the freeing of relinquished volume\n\nThe freeing of relinquished volume will wake up the pending volume\nacquisition by using wake_up_bit(), however it is mismatched with\nwait_var_event() used in fscache_wait_on_volume_collision() and it will\nnever wake up the waiter in the wait-queue because these two functions\noperate on different wait-queues.\n\nAccording to the implementation in fscache_wait_on_volume_collision(),\nif the wake-up of pending acquisition is delayed longer than 20 seconds\n(e.g., due to the delay of on-demand fd closing), the first\nwait_var_event_timeout() will timeout and the following wait_var_event()\nwill hang forever as shown below:\n\n FS-Cache: Potential volume collision new=00000024 old=00000022\n ......\n INFO: task mount:1148 blocked for more than 122 seconds.\n       Not tainted 6.1.0-rc6+ #1\n task:mount           state:D stack:0     pid:1148  ppid:1\n Call Trace:\n  <TASK>\n  __schedule+0x2f6/0xb80\n  schedule+0x67/0xe0\n  fscache_wait_on_volume_collision.cold+0x80/0x82\n  __fscache_acquire_volume+0x40d/0x4e0\n  erofs_fscache_register_volume+0x51/0xe0 [erofs]\n  erofs_fscache_register_fs+0x19c/0x240 [erofs]\n  erofs_fc_fill_super+0x746/0xaf0 [erofs]\n  vfs_get_super+0x7d/0x100\n  get_tree_nodev+0x16/0x20\n  erofs_fc_get_tree+0x20/0x30 [erofs]\n  vfs_get_tree+0x24/0xb0\n  path_mount+0x2fa/0xa90\n  do_mount+0x7c/0xa0\n  __x64_sys_mount+0x8b/0xe0\n  do_syscall_64+0x30/0x60\n  entry_SYSCALL_64_after_hwframe+0x46/0xb0\n\nConsidering that wake_up_bit() is more selective, so fix it by using\nwait_on_bit() instead of wait_var_event() to wait for the freeing of\nrelinquished volume. In addition because waitqueue_active() is used in\nwake_up_bit() and clear_bit() doesn't imply any memory barrier, use\nclear_and_wake_up_bit() to add the missing memory barrier between\ncursor->flags and waitqueue_active().",
  "id": "CVE-2023-52982",
  "modified": "2025-10-15T05:02:31.134056Z",
  "published": "2025-03-27T16:43:20Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/3be069f42a7b79d3149194f21cdf24bf23864cac"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8226e37d82f43657da34dd770e2b38f20242ada7"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "fscache: Use wait_on_bit() to wait for the freeing of relinquished volume"
}