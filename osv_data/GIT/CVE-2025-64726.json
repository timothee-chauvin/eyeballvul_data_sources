{"schema_version":"1.7.3","id":"CVE-2025-64726","published":"2025-11-13T19:55:57Z","modified":"2025-11-14T19:57:48.541659Z","aliases":["GHSA-6c5p-vqrh-h6fp"],"summary":"External Control of System or Configuration Setting and Uncontrolled Search Path Element in sfw","details":"Socket Firewall is an HTTP/HTTPS proxy server that intercepts package manager requests and enforces security policies by blocking dangerous packages. Socket Firewall binary versions (separate from installers) prior to 0.15.5 are vulnerable to arbitrary code execution when run in untrusted project directories. The vulnerability allows an attacker to execute arbitrary code by placing a malicious `.sfw.config` file in a project directory. When a developer runs Socket Firewall commands (e.g., `sfw npm install`) in that directory, the tool loads the `.sfw.config` file and populates environment variables directly into the Node.js process. An attacker can exploit this by setting `NODE_OPTIONS` with a `--require` directive to execute malicious JavaScript code before Socket Firewall's security controls are initialized, effectively bypassing the tool's malicious package detection. The attack vector is indirect and requires a developer to install dependencies for an untrusted project and execute a command within the context of the untrusted project. The vulnerability has been patched in Socket Firewall version 0.15.5. Users should upgrade to version 0.15.5 or later. The fix isolates configuration file values from subprocess environments. Look at `sfw --version` for version information. If users rely on the recommended installation mechanism (e.g. global installation via `npm install -g sfw`) then no workaround is necessary. This wrapper package automatically ensures that users are running the latest version of Socket Firewall. Users who have manually installed the binary and cannot immediately upgrade should avoid running Socket Firewall in untrusted project directories. Before running Socket Firewall in any new project, inspect `.sfw.config` and `.env.local` files for suspicious `NODE_OPTIONS` or other environment variable definitions that reference local files.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/socketdev/firewall-release","events":[{"introduced":"0"},{"fixed":"0025141c157267d700620cf33ec7f5fb03a1e88f"}],"database_specific":{"versions":[{"introduced":"0"},{"fixed":"0.15.5"}]}}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-64726.json"}}],"references":[{"type":"WEB","url":"https://bsky.app/profile/evilpacket.net/post/3m4iylwxtns2t"},{"type":"ADVISORY","url":"https://github.com/SocketDev/firewall-release/security/advisories/GHSA-6c5p-vqrh-h6fp"}],"database_specific":{"cwe_ids":["CWE-15","CWE-427"]},"severity":[{"type":"CVSS_V4","score":"CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:P/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H"}]}