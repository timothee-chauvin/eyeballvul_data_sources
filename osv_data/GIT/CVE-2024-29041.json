{"schema_version":"1.7.3","id":"CVE-2024-29041","published":"2024-03-25T20:20:06.205Z","modified":"2025-12-20T15:39:35.067928Z","aliases":["GHSA-rv95-896h-c2vc"],"related":["CGA-5389-98xc-vr78","CGA-qg2p-wmx3-mx9q","CGA-rjrm-49wc-v48x","CGA-w26h-h47r-f6rx"],"summary":"Express.js Open Redirect in malformed URLs","details":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/expressjs/express","events":[{"introduced":"9375a9afa9d7baa814b454c7a6818a7471aaef00"},{"fixed":"084e36506a18774f85206a65d8da04dc1107fc1b"}],"database_specific":{"versions":[{"introduced":"4.14.0"},{"fixed":"4.19.0"}]}},{"type":"GIT","repo":"https://github.com/expressjs/express","events":[{"introduced":"4052c15c7f10b79fb7c54f3837ffe118f7a99811"},{"fixed":"cd7d79f92a7209b09aa9b065b0643c1bec55ed1d"}],"database_specific":{"versions":[{"introduced":"5.0.0-alpha.1"},{"fixed":"5.0.0-beta.3"}]}}],"versions":["3.18.3","3.18.4","3.18.5","3.18.6","3.19.0","3.19.1","3.19.2","3.20.0","3.20.1","3.20.2","3.20.3","3.21.0","3.21.1","3.21.2","4.10.2","4.10.3","4.10.4","4.10.5","4.10.6","4.10.7","4.10.8","4.11.0","4.11.1","4.11.2","4.12.0","4.12.1","4.12.2","4.12.3","4.12.4","4.13.0","4.13.1","4.13.2","4.13.3","4.13.4","4.14.0","4.14.1","4.15.0","4.15.1","4.15.2","4.15.3","4.15.4","4.15.5","4.16.0","4.16.1","4.16.2","4.16.3","4.16.4","4.17.0","4.17.1","4.17.2","4.17.3","4.18.0","4.18.1","4.18.2","4.18.3","4.19.0","4.19.1","4.19.2","5.0.0-alpha.1","5.0.0-alpha.2","5.0.0-alpha.3","5.0.0-alpha.4","5.0.0-alpha.5","5.0.0-alpha.6","5.0.0-alpha.7","5.0.0-alpha.8","5.0.0-beta.2","v5.0.0-beta.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-29041.json"}}],"references":[{"type":"WEB","url":"https://expressjs.com/en/4x/api.html#res.location"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2024/29xxx/CVE-2024-29041.json"},{"type":"FIX","url":"https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd"},{"type":"FIX","url":"https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94"},{"type":"FIX","url":"https://github.com/expressjs/express/pull/5539"},{"type":"ADVISORY","url":"https://github.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc"},{"type":"REPORT","url":"https://github.com/koajs/koa/issues/1800"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2024-29041"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-1286","CWE-601"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2024/29xxx/CVE-2024-29041.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"}]}