{"schema_version":"1.7.3","id":"CVE-2022-21684","published":"2022-01-13T21:05:11Z","modified":"2025-10-22T18:31:09.764435Z","aliases":["BIT-discourse-2022-21684","GHSA-p63q-jp48-h8xh"],"summary":"User can bypass approval when invited to Discourse","details":"Discourse is an open source discussion platform. Versions prior to 2.7.13 in `stable`, 2.8.0.beta11 in `beta`, and 2.8.0.beta11 in `tests-passed` allow some users to log in to a community before they should be able to do so. A user invited via email to a forum with `must_approve_users` enabled is going to be automatically logged in, bypassing the check that does not allow unapproved users to sign in. They will be able to do everything an approved user can do. If they logout, they cannot log back in. This issue is patched in the `stable` version 2.7.13, `beta` version 2.8.0.beta11, and `tests-passed` version 2.8.0.beta11. One may disable invites as a workaround. Administrators can increase `min_trust_level_to_allow_invite` to reduce the attack surface to more trusted users.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/discourse/discourse","events":[{"introduced":"0"},{"fixed":"3a126c134e706f5a69a212f3556eb5501f161bc0"}]},{"type":"GIT","repo":"https://github.com/discourse/discourse","events":[{"introduced":"0"},{"fixed":"aa546457530e927039f75beb4b3b5a185e83f735"}]}],"versions":["v0.8.0","v0.8.1","v0.8.2","v0.8.3","v0.8.4","v0.8.5","v0.8.6","v0.8.7","v0.8.8","v0.8.9","v0.9.0","v0.9.1","v0.9.2","v0.9.2.5","v0.9.2.6","v0.9.3","v0.9.3.5","v0.9.4","v0.9.5","v0.9.5.1","v0.9.5.2","v0.9.6","v0.9.6.1","v0.9.6.2","v0.9.6.3","v0.9.6.4","v0.9.7","v0.9.7.1","v0.9.7.2","v0.9.7.3","v0.9.7.4","v0.9.7.5","v0.9.7.6","v0.9.7.7","v0.9.7.8","v0.9.7.9","v0.9.8","v0.9.8.1","v0.9.8.10","v0.9.8.11","v0.9.8.2","v0.9.8.3","v0.9.8.4","v0.9.8.5","v0.9.8.6","v0.9.8.7","v0.9.8.8","v0.9.8.9","v0.9.9.1","v0.9.9.10","v0.9.9.11","v0.9.9.12","v0.9.9.13","v0.9.9.14","v0.9.9.15","v0.9.9.16","v0.9.9.17","v0.9.9.18","v0.9.9.2","v0.9.9.3","v0.9.9.4","v0.9.9.5","v0.9.9.6","v0.9.9.7","v0.9.9.8","v0.9.9.9","v1.0.0","v1.0.1","v1.0.2","v1.0.3","v1.0.4","v1.1.0","v1.1.0.beta2","v1.1.0.beta3","v1.1.0.beta4","v1.1.0.beta5","v1.1.0.beta6","v1.1.0.beta6b","v1.1.0.beta7","v1.1.0.beta8","v1.1.1","v1.1.2","v1.1.3","v1.2.0","v1.2.0.beta1","v1.2.0.beta2","v1.2.0.beta3","v1.2.0.beta4","v1.2.0.beta5","v1.2.0.beta6","v1.2.0.beta7","v1.2.0.beta8","v1.2.0.beta9","v1.2.1","v1.2.2","v1.2.3","v1.2.4","v1.3.0","v1.3.0.beta1","v1.3.0.beta10","v1.3.0.beta11","v1.3.0.beta2","v1.3.0.beta3","v1.3.0.beta4","v1.3.0.beta5","v1.3.0.beta6","v1.3.0.beta7","v1.3.0.beta9","v1.3.1","v1.3.2","v1.3.3","v1.3.4","v1.3.5","v1.4.0","v1.4.0.beta1","v1.4.0.beta10","v1.4.0.beta11","v1.4.0.beta12","v1.4.0.beta2","v1.4.0.beta3","v1.4.0.beta4","v1.4.0.beta5","v1.4.0.beta6","v1.4.0.beta7","v1.4.0.beta8","v1.4.0.beta9","v1.4.1","v1.4.2","v1.4.3","v1.4.4","v1.4.5","v1.4.6","v1.4.7","v1.5.0","v1.5.0.beta1","v1.5.0.beta10","v1.5.0.beta11","v1.5.0.beta12","v1.5.0.beta13","v1.5.0.beta13b","v1.5.0.beta14","v1.5.0.beta2","v1.5.0.beta3","v1.5.0.beta4","v1.5.0.beta5","v1.5.0.beta6","v1.5.0.beta7","v1.5.0.beta8","v1.5.0.beta9","v1.5.1","v1.5.2","v1.5.3","v1.5.4","v1.6.0","v1.6.0.beta1","v1.6.0.beta10","v1.6.0.beta11","v1.6.0.beta12","v1.6.0.beta2","v1.6.0.beta3","v1.6.0.beta4","v1.6.0.beta5","v1.6.0.beta6","v1.6.0.beta7","v1.6.0.beta8","v1.6.0.beta9","v1.6.1","v1.6.10","v1.6.2","v1.6.3","v1.6.4","v1.6.5","v1.6.6","v1.6.7","v1.6.8","v1.6.9","v1.7.0","v1.7.0.beta1","v1.7.0.beta10","v1.7.0.beta11","v1.7.0.beta2","v1.7.0.beta3","v1.7.0.beta4","v1.7.0.beta5","v1.7.0.beta6","v1.7.0.beta7","v1.7.0.beta8","v1.7.0.beta9","v1.7.1","v1.7.10","v1.7.2","v1.7.3","v1.7.4","v1.7.5","v1.7.6","v1.7.7","v1.7.8","v1.7.9","v1.8.0","v1.8.0.beta1","v1.8.0.beta10","v1.8.0.beta11","v1.8.0.beta12","v1.8.0.beta13","v1.8.0.beta2","v1.8.0.beta3","v1.8.0.beta4","v1.8.0.beta5","v1.8.0.beta6","v1.8.0.beta7","v1.8.0.beta8","v1.8.0.beta9","v1.8.1","v1.8.10","v1.8.11","v1.8.2","v1.8.3","v1.8.4","v1.8.5","v1.8.6","v1.8.7","v1.8.8","v1.8.9","v1.9.0","v1.9.0.beta1","v1.9.0.beta10","v1.9.0.beta11","v1.9.0.beta12","v1.9.0.beta13","v1.9.0.beta14","v1.9.0.beta15","v1.9.0.beta16","v1.9.0.beta17","v1.9.0.beta2","v1.9.0.beta3","v1.9.0.beta4","v1.9.0.beta5","v1.9.0.beta6","v1.9.0.beta7","v1.9.0.beta8","v1.9.0.beta9","v1.9.1","v1.9.2","v1.9.3","v1.9.4","v1.9.5","v1.9.6","v1.9.7","v2.0.0","v2.0.0.beta1","v2.0.0.beta10","v2.0.0.beta2","v2.0.0.beta3","v2.0.0.beta4","v2.0.0.beta5","v2.0.0.beta6","v2.0.0.beta7","v2.0.0.beta8","v2.0.0.beta9","v2.0.1","v2.0.2","v2.0.3","v2.0.4","v2.0.5","v2.1.0","v2.1.0.beta1","v2.1.0.beta2","v2.1.0.beta3","v2.1.0.beta4","v2.1.0.beta5","v2.1.0.beta6","v2.1.1","v2.1.2","v2.1.3","v2.1.4","v2.1.5","v2.1.6","v2.1.7","v2.1.8","v2.2.0","v2.2.0.beta1","v2.2.0.beta10","v2.2.0.beta2","v2.2.0.beta3","v2.2.0.beta4","v2.2.0.beta5","v2.2.0.beta6","v2.2.0.beta7","v2.2.0.beta8","v2.2.0.beta9","v2.2.1","v2.2.2","v2.2.3","v2.2.4","v2.2.5","v2.2.6","v2.3.0","v2.3.0.beta1","v2.3.0.beta10","v2.3.0.beta11","v2.3.0.beta2","v2.3.0.beta3","v2.3.0.beta4","v2.3.0.beta5","v2.3.0.beta6","v2.3.0.beta7","v2.3.0.beta8","v2.3.0.beta9","v2.3.1","v2.3.10","v2.3.2","v2.3.3","v2.3.4","v2.3.5","v2.3.6","v2.3.7","v2.3.8","v2.3.9","v2.4.0","v2.4.0.beta1","v2.4.0.beta10","v2.4.0.beta11","v2.4.0.beta2","v2.4.0.beta3","v2.4.0.beta4","v2.4.0.beta5","v2.4.0.beta6","v2.4.0.beta7","v2.4.0.beta8","v2.4.0.beta9","v2.4.1","v2.4.2","v2.4.3","v2.4.4","v2.4.5","v2.5.0","v2.5.0.beta1","v2.5.0.beta2","v2.5.0.beta3","v2.5.0.beta4","v2.5.0.beta5","v2.5.0.beta6","v2.5.0.beta7","v2.5.1","v2.5.2","v2.5.3","v2.5.4","v2.5.5","v2.6.0","v2.6.0.beta1","v2.6.0.beta2","v2.6.0.beta3","v2.6.0.beta4","v2.6.0.beta5","v2.6.0.beta6","v2.6.1","v2.6.2","v2.6.3","v2.6.4","v2.6.5","v2.6.6","v2.6.7","v2.7.0","v2.7.0.beta1","v2.7.0.beta2","v2.7.0.beta3","v2.7.0.beta4","v2.7.0.beta5","v2.7.0.beta6","v2.7.0.beta7","v2.7.0.beta8","v2.7.0.beta9","v2.7.1","v2.7.10","v2.7.11","v2.7.12","v2.7.2","v2.7.3","v2.7.4","v2.7.5","v2.7.6","v2.7.7","v2.7.8","v2.7.9","v2.8.0.beta1","v2.8.0.beta10","v2.8.0.beta2","v2.8.0.beta3","v2.8.0.beta4","v2.8.0.beta5","v2.8.0.beta6","v2.8.0.beta7","v2.8.0.beta8","v2.8.0.beta9"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-21684.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/discourse/discourse/security/advisories/GHSA-p63q-jp48-h8xh"},{"type":"FIX","url":"https://github.com/discourse/discourse/commit/584c6a2e8bc705072b09a9c4b55126d6f8ed4ad2"},{"type":"WEB","url":"https://meta.discourse.org/t/invite-redemption-allowed-user-to-access-forum-before-approval/214328"}],"database_specific":{"cwe_ids":["CWE-287"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"}]}