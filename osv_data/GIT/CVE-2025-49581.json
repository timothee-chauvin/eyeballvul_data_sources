{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-49581.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "564b182d7f1ac2f4a377402aa6932c9fcb79f14a"
            },
            {
              "fixed": "0cfc1b3397ce969321409dfc47730c703c330305"
            }
          ],
          "repo": "https://github.com/xwiki/xwiki-commons",
          "type": "GIT"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-49581.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "74516290996425056131264604326798557443",
                "264764856611024996423287162568580142363",
                "20634619052637471606801287152281769041",
                "269477546142289269904151726048475410831"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-49581-1ff68c2a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-requiredrights/xwiki-platform-security-requiredrights-default/src/main/java/org/xwiki/platform/security/requiredrights/internal/analyzer/ObjectPropertyRequiredRightAnalyzer.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "16316179364132549556104651179851582448",
              "length": 449.0
            },
            "id": "CVE-2025-49581-7565c612",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-wikimacro/xwiki-platform-rendering-wikimacro-store/src/main/java/org/xwiki/rendering/wikimacro/internal/DefaultWikiMacroRenderer.java",
              "function": "parseContent"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "314984066272842998871248358690706423147",
                "83301593161767910881704498135729361535",
                "217868980571183783990997159085958903744",
                "245594475191654668846097490248932839363",
                "143413919826369452423848697721640052767",
                "249042888221390864389219893274413079852",
                "228835377374774441164754123238049535995",
                "224718558027001926396106144777612015188",
                "293272822417663948428833333219052866778",
                "230661464193583949854268912794187114483",
                "31439914868724982101048915439428613460",
                "47507858854996723579504516783107588130",
                "159354391423377479238651602173274760929",
                "290368731911459665013003215267278976743",
                "84106327449940738877172704533748048232",
                "338997630063000481574070440177461544789",
                "35586757657722025940748188750049778510",
                "71636166349136266495895572085474730432",
                "221245259518632996358057758138286645114"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-49581-935c6ac6",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-wikimacro/xwiki-platform-rendering-wikimacro-store/src/main/java/org/xwiki/rendering/wikimacro/internal/DefaultWikiMacroRenderer.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "186097388739390989913716482093995845222",
                "149454016184838015264668882493969985323"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-49581-b6dd9aca",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-wikimacro/xwiki-platform-rendering-wikimacro-store/src/test/java/org/xwiki/rendering/wikimacro/internal/DefaultWikiMacroTest.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "86804613274396581376050618931887297740",
              "length": 266.0
            },
            "id": "CVE-2025-49581-ec087c63",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-wikimacro/xwiki-platform-rendering-wikimacro-store/src/main/java/org/xwiki/rendering/wikimacro/internal/DefaultWikiMacroRenderer.java",
              "function": "parseWiki"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "112904755521928495719789831904607643476",
              "length": 564.0
            },
            "id": "CVE-2025-49581-fb5abd4d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de",
            "target": {
              "file": "xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-wikimacro/xwiki-platform-rendering-wikimacro-store/src/main/java/org/xwiki/rendering/wikimacro/internal/DefaultWikiMacroRenderer.java",
              "function": "parseParameterValue"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "c99d501ed41cbee6a3c02ff927714531570789de"
            }
          ],
          "repo": "https://github.com/xwiki/xwiki-platform",
          "type": "GIT"
        }
      ],
      "versions": [
        "xwiki-application-calendar-1.0",
        "xwiki-platform-7.3-milestone-2",
        "xwiki-platform-7.4-milestone-1",
        "xwiki-platform-7.4-milestone-2",
        "xwiki-platform-8.0-milestone-1",
        "xwiki-platform-8.0-milestone-2",
        "xwiki-platform-8.1-milestone-1",
        "xwiki-platform-8.1-milestone-2",
        "xwiki-platform-8.2-milestone-1",
        "xwiki-platform-8.2-milestone-2",
        "xwiki-platform-8.3-milestone-1",
        "xwiki-platform-9.9-rc-2",
        "xwiki-plugin-tag-1.1"
      ]
    }
  ],
  "aliases": [
    "GHSA-9875-cw22-f7cx"
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-250",
      "CWE-270",
      "CWE-94"
    ]
  },
  "details": "XWiki is a generic wiki platform. Any user with edit right on a page (could be the user's profile) can execute code (Groovy, Python, Velocity) with programming right by defining a wiki macro. This allows full access to the whole XWiki installation. The main problem is that if a wiki macro parameter allows wiki syntax, its default value is executed with the rights of the author of the document where it is used. This can be exploited by overriding a macro like the children macro that is used in a page that has programming right like the page XWiki.ChildrenMacro and thus allows arbitrary script macros. This vulnerability has been patched in XWiki 16.4.7, 16.10.3 and 17.0.0 by executing wiki parameters with the rights of the wiki macro's author when the parameter's value is the default value.",
  "id": "CVE-2025-49581",
  "modified": "2025-10-22T18:51:14.927557Z",
  "published": "2025-06-13T16:09:22Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9875-cw22-f7cx"
    },
    {
      "type": "FIX",
      "url": "https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de"
    },
    {
      "type": "WEB",
      "url": "https://jira.xwiki.org/browse/XWIKI-22760"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N",
      "type": "CVSS_V4"
    }
  ],
  "summary": "XWiki allows remote code execution through default value of wiki macro wiki-type parameters"
}