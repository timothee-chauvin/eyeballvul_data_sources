{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48662.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "327907802618551410293056079508823751189",
              "length": 575.0
            },
            "id": "CVE-2022-48662-44055b1f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f799e0568d6c153368b177e0bbbde7dcc4ce7f1d",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c",
              "function": "i915_gem_context_release_work"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "318434159077770832199975871331344849591",
              "length": 731.0
            },
            "id": "CVE-2022-48662-444e8bac",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d119888b09bd567e07c6b93a07f175df88857e02",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c",
              "function": "context_close"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "318434159077770832199975871331344849591",
              "length": 731.0
            },
            "id": "CVE-2022-48662-48150c2a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f799e0568d6c153368b177e0bbbde7dcc4ce7f1d",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c",
              "function": "context_close"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "233985948125687500245012697621896334932",
                "48970055972133113407613084640486376395",
                "263316965088519688058614172822467252935",
                "140661009704716422762445123254218862632",
                "323684911382871264715415234917525170283",
                "68376139880739122744158933646782173213",
                "332313081494285179170663281607872753075",
                "91839128525315177411417501676394644367",
                "37490085063548908142131201805379259486"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48662-939b05a9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d119888b09bd567e07c6b93a07f175df88857e02",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "233985948125687500245012697621896334932",
                "48970055972133113407613084640486376395",
                "263316965088519688058614172822467252935",
                "140661009704716422762445123254218862632",
                "323684911382871264715415234917525170283",
                "68376139880739122744158933646782173213",
                "332313081494285179170663281607872753075",
                "91839128525315177411417501676394644367",
                "37490085063548908142131201805379259486"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48662-998f6289",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f799e0568d6c153368b177e0bbbde7dcc4ce7f1d",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "327907802618551410293056079508823751189",
              "length": 575.0
            },
            "id": "CVE-2022-48662-aadf05a2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d119888b09bd567e07c6b93a07f175df88857e02",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c",
              "function": "i915_gem_context_release_work"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "166225146568527782915388907166197683399",
              "length": 614.0
            },
            "id": "CVE-2022-48662-b5c7fa29",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@713fa3e4591f65f804bdc88e8648e219fabc9ee1",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c",
              "function": "context_close"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "315648511683256306311834702456330677962",
                "48970055972133113407613084640486376395",
                "10768045321169898964829370486011312155",
                "148738552281544741654646792924271136634",
                "189340524899724529812759150969987857629",
                "299165296203364052926688053275297434330",
                "303900559155090475627967551365582587633",
                "116871483669255040743004761671890682127",
                "270013037929022279470258549638207923613"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48662-bfd556ea",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@713fa3e4591f65f804bdc88e8648e219fabc9ee1",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "145325824646254052826031362356385673921",
              "length": 358.0
            },
            "id": "CVE-2022-48662-ce2e95c0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@713fa3e4591f65f804bdc88e8648e219fabc9ee1",
            "target": {
              "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c",
              "function": "i915_gem_context_release"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f8246cf4d9a9025d26c609bb2195e7c0a9ce5c40"
            },
            {
              "fixed": "713fa3e4591f65f804bdc88e8648e219fabc9ee1"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f8246cf4d9a9025d26c609bb2195e7c0a9ce5c40"
            },
            {
              "fixed": "f799e0568d6c153368b177e0bbbde7dcc4ce7f1d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f8246cf4d9a9025d26c609bb2195e7c0a9ce5c40"
            },
            {
              "fixed": "d119888b09bd567e07c6b93a07f175df88857e02"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.10",
        "v5.10-rc4",
        "v5.10-rc5",
        "v5.10-rc6",
        "v5.10-rc7",
        "v5.11",
        "v5.11-rc1",
        "v5.11-rc2",
        "v5.11-rc3",
        "v5.11-rc4",
        "v5.11-rc5",
        "v5.11-rc6",
        "v5.11-rc7",
        "v5.12",
        "v5.12-rc1",
        "v5.12-rc1-dontuse",
        "v5.12-rc2",
        "v5.12-rc3",
        "v5.12-rc4",
        "v5.12-rc5",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.27",
        "v5.15.28",
        "v5.15.29",
        "v5.15.3",
        "v5.15.30",
        "v5.15.31",
        "v5.15.32",
        "v5.15.33",
        "v5.15.34",
        "v5.15.35",
        "v5.15.36",
        "v5.15.37",
        "v5.15.38",
        "v5.15.39",
        "v5.15.4",
        "v5.15.40",
        "v5.15.41",
        "v5.15.42",
        "v5.15.43",
        "v5.15.44",
        "v5.15.45",
        "v5.15.46",
        "v5.15.47",
        "v5.15.48",
        "v5.15.49",
        "v5.15.5",
        "v5.15.50",
        "v5.15.51",
        "v5.15.52",
        "v5.15.53",
        "v5.15.54",
        "v5.15.55",
        "v5.15.56",
        "v5.15.57",
        "v5.15.58",
        "v5.15.59",
        "v5.15.6",
        "v5.15.60",
        "v5.15.61",
        "v5.15.62",
        "v5.15.63",
        "v5.15.64",
        "v5.15.65",
        "v5.15.66",
        "v5.15.67",
        "v5.15.68",
        "v5.15.69",
        "v5.15.7",
        "v5.15.70",
        "v5.15.71",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v5.19.1",
        "v5.19.10",
        "v5.19.11",
        "v5.19.2",
        "v5.19.3",
        "v5.19.4",
        "v5.19.5",
        "v5.19.6",
        "v5.19.7",
        "v5.19.8",
        "v5.19.9",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48662.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.12.0"
            },
            {
              "fixed": "5.15.72"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.19.12"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48662.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f8246cf4d9a9"
            },
            {
              "fixed": "713fa3e4591f"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "f8246cf4d9a9"
            },
            {
              "fixed": "f799e0568d6c"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "f8246cf4d9a9"
            },
            {
              "fixed": "d119888b09bd"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "5.12"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/i915/gem: Really move i915_gem_context.link under ref protection\n\ni915_perf assumes that it can use the i915_gem_context reference to\nprotect its i915->gem.contexts.list iteration. However, this requires\nthat we do not remove the context from the list until after we drop the\nfinal reference and release the struct. If, as currently, we remove the\ncontext from the list during context_close(), the link.next pointer may\nbe poisoned while we are holding the context reference and cause a GPF:\n\n[ 4070.573157] i915 0000:00:02.0: [drm:i915_perf_open_ioctl [i915]] filtering on ctx_id=0x1fffff ctx_id_mask=0x1fffff\n[ 4070.574881] general protection fault, probably for non-canonical address 0xdead000000000100: 0000 [#1] PREEMPT SMP\n[ 4070.574897] CPU: 1 PID: 284392 Comm: amd_performance Tainted: G            E     5.17.9 #180\n[ 4070.574903] Hardware name: Intel Corporation NUC7i5BNK/NUC7i5BNB, BIOS BNKBL357.86A.0052.2017.0918.1346 09/18/2017\n[ 4070.574907] RIP: 0010:oa_configure_all_contexts.isra.0+0x222/0x350 [i915]\n[ 4070.574982] Code: 08 e8 32 6e 10 e1 4d 8b 6d 50 b8 ff ff ff ff 49 83 ed 50 f0 41 0f c1 04 24 83 f8 01 0f 84 e3 00 00 00 85 c0 0f 8e fa 00 00 00 <49> 8b 45 50 48 8d 70 b0 49 8d 45 50 48 39 44 24 10 0f 85 34 fe ff\n[ 4070.574990] RSP: 0018:ffffc90002077b78 EFLAGS: 00010202\n[ 4070.574995] RAX: 0000000000000002 RBX: 0000000000000002 RCX: 0000000000000000\n[ 4070.575000] RDX: 0000000000000001 RSI: ffffc90002077b20 RDI: ffff88810ddc7c68\n[ 4070.575004] RBP: 0000000000000001 R08: ffff888103242648 R09: fffffffffffffffc\n[ 4070.575008] R10: ffffffff82c50bc0 R11: 0000000000025c80 R12: ffff888101bf1860\n[ 4070.575012] R13: dead0000000000b0 R14: ffffc90002077c04 R15: ffff88810be5cabc\n[ 4070.575016] FS:  00007f1ed50c0780(0000) GS:ffff88885ec80000(0000) knlGS:0000000000000000\n[ 4070.575021] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[ 4070.575025] CR2: 00007f1ed5590280 CR3: 000000010ef6f005 CR4: 00000000003706e0\n[ 4070.575029] Call Trace:\n[ 4070.575033]  <TASK>\n[ 4070.575037]  lrc_configure_all_contexts+0x13e/0x150 [i915]\n[ 4070.575103]  gen8_enable_metric_set+0x4d/0x90 [i915]\n[ 4070.575164]  i915_perf_open_ioctl+0xbc0/0x1500 [i915]\n[ 4070.575224]  ? asm_common_interrupt+0x1e/0x40\n[ 4070.575232]  ? i915_oa_init_reg_state+0x110/0x110 [i915]\n[ 4070.575290]  drm_ioctl_kernel+0x85/0x110\n[ 4070.575296]  ? update_load_avg+0x5f/0x5e0\n[ 4070.575302]  drm_ioctl+0x1d3/0x370\n[ 4070.575307]  ? i915_oa_init_reg_state+0x110/0x110 [i915]\n[ 4070.575382]  ? gen8_gt_irq_handler+0x46/0x130 [i915]\n[ 4070.575445]  __x64_sys_ioctl+0x3c4/0x8d0\n[ 4070.575451]  ? __do_softirq+0xaa/0x1d2\n[ 4070.575456]  do_syscall_64+0x35/0x80\n[ 4070.575461]  entry_SYSCALL_64_after_hwframe+0x44/0xae\n[ 4070.575467] RIP: 0033:0x7f1ed5c10397\n[ 4070.575471] Code: 3c 1c e8 1c ff ff ff 85 c0 79 87 49 c7 c4 ff ff ff ff 5b 5d 4c 89 e0 41 5c c3 66 0f 1f 84 00 00 00 00 00 b8 10 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d a9 da 0d 00 f7 d8 64 89 01 48\n[ 4070.575478] RSP: 002b:00007ffd65c8d7a8 EFLAGS: 00000246 ORIG_RAX: 0000000000000010\n[ 4070.575484] RAX: ffffffffffffffda RBX: 0000000000000006 RCX: 00007f1ed5c10397\n[ 4070.575488] RDX: 00007ffd65c8d7c0 RSI: 0000000040106476 RDI: 0000000000000006\n[ 4070.575492] RBP: 00005620972f9c60 R08: 000000000000000a R09: 0000000000000005\n[ 4070.575496] R10: 000000000000000d R11: 0000000000000246 R12: 000000000000000a\n[ 4070.575500] R13: 000000000000000d R14: 0000000000000000 R15: 00007ffd65c8d7c0\n[ 4070.575505]  </TASK>\n[ 4070.575507] Modules linked in: nls_ascii(E) nls_cp437(E) vfat(E) fat(E) i915(E) x86_pkg_temp_thermal(E) intel_powerclamp(E) crct10dif_pclmul(E) crc32_pclmul(E) crc32c_intel(E) aesni_intel(E) crypto_simd(E) intel_gtt(E) cryptd(E) ttm(E) rapl(E) intel_cstate(E) drm_kms_helper(E) cfbfillrect(E) syscopyarea(E) cfbimgblt(E) intel_uncore(E) sysfillrect(E) mei_me(E) sysimgblt(E) i2c_i801(E) fb_sys_fops(E) mei(E) intel_pch_thermal(E) i2c_smbus\n---truncated---",
  "id": "CVE-2022-48662",
  "modified": "2025-10-14T20:09:08.203868Z",
  "published": "2024-04-28T13:01:31Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/713fa3e4591f65f804bdc88e8648e219fabc9ee1"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d119888b09bd567e07c6b93a07f175df88857e02"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f799e0568d6c153368b177e0bbbde7dcc4ce7f1d"
    }
  ],
  "related": [
    "SUSE-SU-2024:1641-1",
    "SUSE-SU-2024:1644-1",
    "SUSE-SU-2024:1647-1",
    "SUSE-SU-2024:1659-1",
    "SUSE-SU-2024:1663-1",
    "SUSE-SU-2024:2008-1",
    "SUSE-SU-2024:2189-1",
    "SUSE-SU-2024:2190-1",
    "SUSE-SU-2024:3318-1",
    "SUSE-SU-2024:3336-1",
    "SUSE-SU-2024:3347-1",
    "SUSE-SU-2024:3348-1",
    "SUSE-SU-2024:3361-1",
    "SUSE-SU-2024:3368-1",
    "SUSE-SU-2024:3375-1",
    "SUSE-SU-2024:3379-1",
    "SUSE-SU-2024:3395-1",
    "SUSE-SU-2024:3399-1",
    "SUSE-SU-2024:3405-1",
    "SUSE-SU-2024:3425-1",
    "SUSE-SU-2024:3623-1",
    "SUSE-SU-2024:3631-1",
    "SUSE-SU-2024:3639-1",
    "SUSE-SU-2024:3679-1",
    "SUSE-SU-2024:3694-1",
    "SUSE-SU-2024:3695-1",
    "SUSE-SU-2024:3696-1",
    "SUSE-SU-2024:3697-1",
    "SUSE-SU-2024:3793-1",
    "SUSE-SU-2024:3815-1",
    "SUSE-SU-2024:3829-1",
    "SUSE-SU-2024:3830-1",
    "SUSE-SU-2024:3837-1",
    "SUSE-SU-2024:3842-1",
    "SUSE-SU-2024:3851-1",
    "SUSE-SU-2024:3852-1",
    "SUSE-SU-2024:3855-1",
    "SUSE-SU-2024:4122-1",
    "SUSE-SU-2024:4123-1",
    "SUSE-SU-2024:4124-1",
    "SUSE-SU-2024:4214-1",
    "SUSE-SU-2024:4216-1",
    "SUSE-SU-2024:4218-1",
    "SUSE-SU-2024:4234-1",
    "SUSE-SU-2024:4235-1",
    "SUSE-SU-2024:4266-1",
    "SUSE-SU-2025:0107-1",
    "SUSE-SU-2025:0109-1",
    "SUSE-SU-2025:0114-1",
    "SUSE-SU-2025:0115-1",
    "SUSE-SU-2025:0150-1",
    "SUSE-SU-2025:0158-1",
    "SUSE-SU-2025:0248-1",
    "SUSE-SU-2025:0251-1",
    "SUSE-SU-2025:0252-1",
    "SUSE-SU-2025:0253-1",
    "SUSE-SU-2025:0261-1",
    "SUSE-SU-2025:0266-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "drm/i915/gem: Really move i915_gem_context.link under ref protection"
}