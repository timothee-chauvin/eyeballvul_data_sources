{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38734.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "3b2dec2603d5b06ad3af71c1164ca0b92df3d2a8"
            },
            {
              "fixed": "070b4af44c4b6e4c35fb1ca7001a6a88fd2d318f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "3b2dec2603d5b06ad3af71c1164ca0b92df3d2a8"
            },
            {
              "fixed": "2e765ba0ee0eae35688b443e97108308a716773e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "3b2dec2603d5b06ad3af71c1164ca0b92df3d2a8"
            },
            {
              "fixed": "85545f1525f9fa9bf44fec77ba011024f15da342"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "3b2dec2603d5b06ad3af71c1164ca0b92df3d2a8"
            },
            {
              "fixed": "d9cef55ed49117bd63695446fb84b4b91815c0b4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v4.17",
        "v4.17-rc5",
        "v4.17-rc6",
        "v4.17-rc7",
        "v4.18",
        "v4.18-rc1",
        "v4.18-rc2",
        "v4.18-rc3",
        "v4.18-rc4",
        "v4.18-rc5",
        "v4.18-rc6",
        "v4.18-rc7",
        "v4.18-rc8",
        "v4.19",
        "v4.19-rc1",
        "v4.19-rc2",
        "v4.19-rc3",
        "v4.19-rc4",
        "v4.19-rc5",
        "v4.19-rc6",
        "v4.19-rc7",
        "v4.19-rc8",
        "v4.20",
        "v4.20-rc1",
        "v4.20-rc2",
        "v4.20-rc3",
        "v4.20-rc4",
        "v4.20-rc5",
        "v4.20-rc6",
        "v4.20-rc7",
        "v5.0",
        "v5.0-rc1",
        "v5.0-rc2",
        "v5.0-rc3",
        "v5.0-rc4",
        "v5.0-rc5",
        "v5.0-rc6",
        "v5.0-rc7",
        "v5.0-rc8",
        "v5.1",
        "v5.1-rc1",
        "v5.1-rc2",
        "v5.1-rc3",
        "v5.1-rc4",
        "v5.1-rc5",
        "v5.1-rc6",
        "v5.1-rc7",
        "v5.10",
        "v5.10-rc1",
        "v5.10-rc2",
        "v5.10-rc3",
        "v5.10-rc4",
        "v5.10-rc5",
        "v5.10-rc6",
        "v5.10-rc7",
        "v5.11",
        "v5.11-rc1",
        "v5.11-rc2",
        "v5.11-rc3",
        "v5.11-rc4",
        "v5.11-rc5",
        "v5.11-rc6",
        "v5.11-rc7",
        "v5.12",
        "v5.12-rc1",
        "v5.12-rc1-dontuse",
        "v5.12-rc2",
        "v5.12-rc3",
        "v5.12-rc4",
        "v5.12-rc5",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v5.2",
        "v5.2-rc1",
        "v5.2-rc2",
        "v5.2-rc3",
        "v5.2-rc4",
        "v5.2-rc5",
        "v5.2-rc6",
        "v5.2-rc7",
        "v5.3",
        "v5.3-rc1",
        "v5.3-rc2",
        "v5.3-rc3",
        "v5.3-rc4",
        "v5.3-rc5",
        "v5.3-rc6",
        "v5.3-rc7",
        "v5.3-rc8",
        "v5.4",
        "v5.4-rc1",
        "v5.4-rc2",
        "v5.4-rc3",
        "v5.4-rc4",
        "v5.4-rc5",
        "v5.4-rc6",
        "v5.4-rc7",
        "v5.4-rc8",
        "v5.5",
        "v5.5-rc1",
        "v5.5-rc2",
        "v5.5-rc3",
        "v5.5-rc4",
        "v5.5-rc5",
        "v5.5-rc6",
        "v5.5-rc7",
        "v5.6",
        "v5.6-rc1",
        "v5.6-rc2",
        "v5.6-rc3",
        "v5.6-rc4",
        "v5.6-rc5",
        "v5.6-rc6",
        "v5.6-rc7",
        "v5.7",
        "v5.7-rc1",
        "v5.7-rc2",
        "v5.7-rc3",
        "v5.7-rc4",
        "v5.7-rc5",
        "v5.7-rc6",
        "v5.7-rc7",
        "v5.8",
        "v5.8-rc1",
        "v5.8-rc2",
        "v5.8-rc3",
        "v5.8-rc4",
        "v5.8-rc5",
        "v5.8-rc6",
        "v5.8-rc7",
        "v5.9",
        "v5.9-rc1",
        "v5.9-rc2",
        "v5.9-rc3",
        "v5.9-rc4",
        "v5.9-rc5",
        "v5.9-rc6",
        "v5.9-rc7",
        "v5.9-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.11",
        "v6.11-rc1",
        "v6.11-rc2",
        "v6.11-rc3",
        "v6.11-rc4",
        "v6.11-rc5",
        "v6.11-rc6",
        "v6.11-rc7",
        "v6.12",
        "v6.12-rc1",
        "v6.12-rc2",
        "v6.12-rc3",
        "v6.12-rc4",
        "v6.12-rc5",
        "v6.12-rc6",
        "v6.12-rc7",
        "v6.12.1",
        "v6.12.10",
        "v6.12.11",
        "v6.12.12",
        "v6.12.13",
        "v6.12.14",
        "v6.12.15",
        "v6.12.16",
        "v6.12.17",
        "v6.12.18",
        "v6.12.19",
        "v6.12.2",
        "v6.12.20",
        "v6.12.21",
        "v6.12.22",
        "v6.12.23",
        "v6.12.24",
        "v6.12.25",
        "v6.12.26",
        "v6.12.27",
        "v6.12.28",
        "v6.12.29",
        "v6.12.3",
        "v6.12.30",
        "v6.12.31",
        "v6.12.32",
        "v6.12.33",
        "v6.12.34",
        "v6.12.35",
        "v6.12.36",
        "v6.12.37",
        "v6.12.38",
        "v6.12.39",
        "v6.12.4",
        "v6.12.40",
        "v6.12.41",
        "v6.12.42",
        "v6.12.43",
        "v6.12.5",
        "v6.12.6",
        "v6.12.7",
        "v6.12.8",
        "v6.12.9",
        "v6.13",
        "v6.13-rc1",
        "v6.13-rc2",
        "v6.13-rc3",
        "v6.13-rc4",
        "v6.13-rc5",
        "v6.13-rc6",
        "v6.13-rc7",
        "v6.14",
        "v6.14-rc1",
        "v6.14-rc2",
        "v6.14-rc3",
        "v6.14-rc4",
        "v6.14-rc5",
        "v6.14-rc6",
        "v6.14-rc7",
        "v6.15",
        "v6.15-rc1",
        "v6.15-rc2",
        "v6.15-rc3",
        "v6.15-rc4",
        "v6.15-rc5",
        "v6.15-rc6",
        "v6.15-rc7",
        "v6.16",
        "v6.16-rc1",
        "v6.16-rc2",
        "v6.16-rc3",
        "v6.16-rc4",
        "v6.16-rc5",
        "v6.16-rc6",
        "v6.16-rc7",
        "v6.16.1",
        "v6.16.2",
        "v6.16.3",
        "v6.17-rc1",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.100",
        "v6.6.101",
        "v6.6.102",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.3",
        "v6.6.30",
        "v6.6.31",
        "v6.6.32",
        "v6.6.33",
        "v6.6.34",
        "v6.6.35",
        "v6.6.36",
        "v6.6.37",
        "v6.6.38",
        "v6.6.39",
        "v6.6.4",
        "v6.6.40",
        "v6.6.41",
        "v6.6.42",
        "v6.6.43",
        "v6.6.44",
        "v6.6.45",
        "v6.6.46",
        "v6.6.47",
        "v6.6.48",
        "v6.6.49",
        "v6.6.5",
        "v6.6.50",
        "v6.6.51",
        "v6.6.52",
        "v6.6.53",
        "v6.6.54",
        "v6.6.55",
        "v6.6.56",
        "v6.6.57",
        "v6.6.58",
        "v6.6.59",
        "v6.6.6",
        "v6.6.60",
        "v6.6.61",
        "v6.6.62",
        "v6.6.63",
        "v6.6.64",
        "v6.6.65",
        "v6.6.66",
        "v6.6.67",
        "v6.6.68",
        "v6.6.69",
        "v6.6.7",
        "v6.6.70",
        "v6.6.71",
        "v6.6.72",
        "v6.6.73",
        "v6.6.74",
        "v6.6.75",
        "v6.6.76",
        "v6.6.77",
        "v6.6.78",
        "v6.6.79",
        "v6.6.8",
        "v6.6.80",
        "v6.6.81",
        "v6.6.82",
        "v6.6.83",
        "v6.6.84",
        "v6.6.85",
        "v6.6.86",
        "v6.6.87",
        "v6.6.88",
        "v6.6.89",
        "v6.6.9",
        "v6.6.90",
        "v6.6.91",
        "v6.6.92",
        "v6.6.93",
        "v6.6.94",
        "v6.6.95",
        "v6.6.96",
        "v6.6.97",
        "v6.6.98",
        "v6.6.99",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38734.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "4.18.0"
            },
            {
              "fixed": "6.6.103"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.12.44"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.13.0"
            },
            {
              "fixed": "6.16.4"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/smc: fix UAF on smcsk after smc_listen_out()\n\nBPF CI testing report a UAF issue:\n\n  [   16.446633] BUG: kernel NULL pointer dereference, address: 000000000000003  0\n  [   16.447134] #PF: supervisor read access in kernel mod  e\n  [   16.447516] #PF: error_code(0x0000) - not-present pag  e\n  [   16.447878] PGD 0 P4D   0\n  [   16.448063] Oops: Oops: 0000 [#1] PREEMPT SMP NOPT  I\n  [   16.448409] CPU: 0 UID: 0 PID: 9 Comm: kworker/0:1 Tainted: G           OE      6.13.0-rc3-g89e8a75fda73-dirty #4  2\n  [   16.449124] Tainted: [O]=OOT_MODULE, [E]=UNSIGNED_MODUL  E\n  [   16.449502] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/201  4\n  [   16.450201] Workqueue: smc_hs_wq smc_listen_wor  k\n  [   16.450531] RIP: 0010:smc_listen_work+0xc02/0x159  0\n  [   16.452158] RSP: 0018:ffffb5ab40053d98 EFLAGS: 0001024  6\n  [   16.452526] RAX: 0000000000000001 RBX: 0000000000000002 RCX: 000000000000030  0\n  [   16.452994] RDX: 0000000000000280 RSI: 00003513840053f0 RDI: 000000000000000  0\n  [   16.453492] RBP: ffffa097808e3800 R08: ffffa09782dba1e0 R09: 000000000000000  5\n  [   16.453987] R10: 0000000000000000 R11: 0000000000000000 R12: ffffa0978274640  0\n  [   16.454497] R13: 0000000000000000 R14: 0000000000000000 R15: ffffa09782d4092  0\n  [   16.454996] FS:  0000000000000000(0000) GS:ffffa097bbc00000(0000) knlGS:000000000000000  0\n  [   16.455557] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003  3\n  [   16.455961] CR2: 0000000000000030 CR3: 0000000102788004 CR4: 0000000000770ef  0\n  [   16.456459] PKRU: 5555555  4\n  [   16.456654] Call Trace  :\n  [   16.456832]  <TASK  >\n  [   16.456989]  ? __die+0x23/0x7  0\n  [   16.457215]  ? page_fault_oops+0x180/0x4c  0\n  [   16.457508]  ? __lock_acquire+0x3e6/0x249  0\n  [   16.457801]  ? exc_page_fault+0x68/0x20  0\n  [   16.458080]  ? asm_exc_page_fault+0x26/0x3  0\n  [   16.458389]  ? smc_listen_work+0xc02/0x159  0\n  [   16.458689]  ? smc_listen_work+0xc02/0x159  0\n  [   16.458987]  ? lock_is_held_type+0x8f/0x10  0\n  [   16.459284]  process_one_work+0x1ea/0x6d  0\n  [   16.459570]  worker_thread+0x1c3/0x38  0\n  [   16.459839]  ? __pfx_worker_thread+0x10/0x1  0\n  [   16.460144]  kthread+0xe0/0x11  0\n  [   16.460372]  ? __pfx_kthread+0x10/0x1  0\n  [   16.460640]  ret_from_fork+0x31/0x5  0\n  [   16.460896]  ? __pfx_kthread+0x10/0x1  0\n  [   16.461166]  ret_from_fork_asm+0x1a/0x3  0\n  [   16.461453]  </TASK  >\n  [   16.461616] Modules linked in: bpf_testmod(OE) [last unloaded: bpf_testmod(OE)  ]\n  [   16.462134] CR2: 000000000000003  0\n  [   16.462380] ---[ end trace 0000000000000000 ]---\n  [   16.462710] RIP: 0010:smc_listen_work+0xc02/0x1590\n\nThe direct cause of this issue is that after smc_listen_out_connected(),\nnewclcsock->sk may be NULL since it will releases the smcsk. Therefore,\nif the application closes the socket immediately after accept,\nnewclcsock->sk can be NULL. A possible execution order could be as\nfollows:\n\nsmc_listen_work                                 | userspace\n-----------------------------------------------------------------\nlock_sock(sk)                                   |\nsmc_listen_out_connected()                      |\n| \\- smc_listen_out                             |\n|    | \\- release_sock                          |\n     | |- sk->sk_data_ready()                   |\n                                                | fd = accept();\n                                                | close(fd);\n                                                |  \\- socket->sk = NULL;\n/* newclcsock->sk is NULL now */\nSMC_STAT_SERV_SUCC_INC(sock_net(newclcsock->sk))\n\nSince smc_listen_out_connected() will not fail, simply swapping the order\nof the code can easily fix this issue.",
  "id": "CVE-2025-38734",
  "modified": "2025-10-22T15:54:36.896511Z",
  "published": "2025-09-05T17:20:34Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/070b4af44c4b6e4c35fb1ca7001a6a88fd2d318f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/2e765ba0ee0eae35688b443e97108308a716773e"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/85545f1525f9fa9bf44fec77ba011024f15da342"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d9cef55ed49117bd63695446fb84b4b91815c0b4"
    }
  ],
  "related": [
    "MGASA-2025-0234",
    "MGASA-2025-0235",
    "SUSE-SU-2025:03615-1",
    "SUSE-SU-2025:03628-1",
    "SUSE-SU-2025:3716-1",
    "SUSE-SU-2025:3751-1",
    "SUSE-SU-2025:3761-1"
  ],
  "schema_version": "1.7.3",
  "summary": "net/smc: fix UAF on smcsk after smc_listen_out()"
}