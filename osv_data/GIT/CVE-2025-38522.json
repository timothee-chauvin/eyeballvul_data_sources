{"schema_version":"1.7.3","id":"CVE-2025-38522","published":"2025-08-16T11:12:11.304Z","modified":"2025-11-20T09:47:35.024477Z","summary":"sched/ext: Prevent update_locked_rq() calls with NULL rq","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nsched/ext: Prevent update_locked_rq() calls with NULL rq\n\nAvoid invoking update_locked_rq() when the runqueue (rq) pointer is NULL\nin the SCX_CALL_OP and SCX_CALL_OP_RET macros.\n\nPreviously, calling update_locked_rq(NULL) with preemption enabled could\ntrigger the following warning:\n\n    BUG: using __this_cpu_write() in preemptible [00000000]\n\nThis happens because __this_cpu_write() is unsafe to use in preemptible\ncontext.\n\nrq is NULL when an ops invoked from an unlocked context. In such cases, we\ndon't need to store any rq, since the value should already be NULL\n(unlocked). Ensure that update_locked_rq() is only called when rq is\nnon-NULL, preventing calling __this_cpu_write() on preemptible context.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"18853ba782bef65fc81ef2b3370382e5b479c5eb"},{"fixed":"237c43037b336e36a49eb9f2daac1c7719ec7f8b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"18853ba782bef65fc81ef2b3370382e5b479c5eb"},{"fixed":"e14fd98c6d66cb76694b12c05768e4f9e8c95664"}]}],"versions":["v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.2","v6.15.3","v6.15.4","v6.15.5","v6.15.6","v6.15.7","v6.16-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38522.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["88110078011983653337294127614687056577","53205273222610381207762480723105700892","197060929178430145608256226778360732451","184996520118569372176686371997238373980","159307198623043730108411247111006981086","143029172834254410639434595458987448132","123729362634209310327937192165519028396","185194387627409047259704734907492364437","119925953173455543911173654331665305314","47371955027356598233880850504538706569","53083272988342988498945076794190975828","250518007057540135526413761676478111913","77417342940501076294276069281906842441","285829238302594129738699385648702361591","52071806606748467470474182216037108333","61548089651209109642906934971086834025"],"threshold":0.9},"id":"CVE-2025-38522-1d4ebc63","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e14fd98c6d66cb76694b12c05768e4f9e8c95664","target":{"file":"kernel/sched/ext.c"}},{"deprecated":false,"digest":{"line_hashes":["88110078011983653337294127614687056577","53205273222610381207762480723105700892","197060929178430145608256226778360732451","333740462853444547278798772982533996230","300160300509859876357657535350612954883","220087748696898596827438317801019355729","123729362634209310327937192165519028396","143866404944289704555728905644165778080","132803306771352396866926333112164927124","177992694759449929032713293089521417513","27295823141227455750535122792624309684","124124835092801427138658915692077520751","133422512193863442804284031182772114411","320727249013347200989977696452497774105","52071806606748467470474182216037108333","61548089651209109642906934971086834025"],"threshold":0.9},"id":"CVE-2025-38522-2b26d651","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@237c43037b336e36a49eb9f2daac1c7719ec7f8b","target":{"file":"kernel/sched/ext.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.15.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38522.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/237c43037b336e36a49eb9f2daac1c7719ec7f8b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e14fd98c6d66cb76694b12c05768e4f9e8c95664"}]}