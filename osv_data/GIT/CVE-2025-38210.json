{"schema_version":"1.7.3","id":"CVE-2025-38210","published":"2025-07-04T13:37:29.663Z","modified":"2025-11-20T09:19:20.141207Z","related":["SUSE-SU-2025:02853-1","SUSE-SU-2025:02923-1","SUSE-SU-2025:02969-1","SUSE-SU-2025:03023-1"],"summary":"configfs-tsm-report: Fix NULL dereference of tsm_ops","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nconfigfs-tsm-report: Fix NULL dereference of tsm_ops\n\nUnlike sysfs, the lifetime of configfs objects is controlled by\nuserspace. There is no mechanism for the kernel to find and delete all\ncreated config-items. Instead, the configfs-tsm-report mechanism has an\nexpectation that tsm_unregister() can happen at any time and cause\nestablished config-item access to start failing.\n\nThat expectation is not fully satisfied. While tsm_report_read(),\ntsm_report_{is,is_bin}_visible(), and tsm_report_make_item() safely fail\nif tsm_ops have been unregistered, tsm_report_privlevel_store()\ntsm_report_provider_show() fail to check for ops registration. Add the\nmissing checks for tsm_ops having been removed.\n\nNow, in supporting the ability for tsm_unregister() to always succeed,\nit leaves the problem of what to do with lingering config-items. The\nexpectation is that the admin that arranges for the ->remove() (unbind)\nof the ${tsm_arch}-guest driver is also responsible for deletion of all\nopen config-items. Until that deletion happens, ->probe() (reload /\nbind) of the ${tsm_arch}-guest driver fails.\n\nThis allows for emergency shutdown / revocation of attestation\ninterfaces, and requires coordinated restart.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"70e6f7e2b98575621019aa40ac616be58ff984e0"},{"fixed":"015f04ac884a454d4d8aaa7b67758f047742b1cf"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"70e6f7e2b98575621019aa40ac616be58ff984e0"},{"fixed":"cefbafcbdef011d6ef9414902311afdfba3c33eb"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"70e6f7e2b98575621019aa40ac616be58ff984e0"},{"fixed":"fba4ceaa242d2bdf4c04b77bda41d32d02d3925d"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.2","v6.15.3","v6.6","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38210.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"193271412004093836254400632992518787622","length":305},"id":"CVE-2025-38210-13bcd5fa","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_register"}},{"deprecated":false,"digest":{"function_hash":"324246507248493696735453026388292556611","length":872},"id":"CVE-2025-38210-1ba33172","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_read"}},{"deprecated":false,"digest":{"function_hash":"93298158481509512662019561286795621547","length":350},"id":"CVE-2025-38210-1d69e7cc","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_make_item"}},{"deprecated":false,"digest":{"line_hashes":["6953366265150418517359861964393470337","303630737842318949684937236847356897555","131357366203439333740038071292658850806","117526919872343737714179046545502626535","6059659014721218483687413545486404376","228174518172281159186377394407777736217","339032090019224904502162023656525427499","323359708493117241115804663397117143363","298396066745033081549311331957327282794","91118475308612766377638102633859095420","49425431188246333255234929872661953451","158935817662127740631324827511185659073","279162770645023145723605802891968327719","284012473116383297446701769201073358835","275163034838691288779051244746685229171","197935634188053248926891604718336804508","80522192799135719388242529015044891527","253771739978433330647818238842725397076","55306798044147917333627957136020984516","121567883202909777916748251332496113246","292916068586125926440036746175443827926","282137476743069883831495031770659544561","55888552320849352263351528253336720560","16825785359720666752637237422324012084","193335079849344033631718683097278143804","311211780334535166282238918325390238370","318478674622777976595799928201127363927","96617444346117518919122221309932845104","143195111756673788733785048744964426380","326808829123141337555151426182316388492","279640678455948344933776598030792318061","322191882474237243216267757698325803338","146283775373421578963034157095549144368","331514871794124491221721586520766451893","199865891787672567792024299488941981598","41046678023217303366578128010823298545","257711955706751329888818434287284767214"],"threshold":0.9},"id":"CVE-2025-38210-29350adc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c"}},{"deprecated":false,"digest":{"function_hash":"324246507248493696735453026388292556611","length":872},"id":"CVE-2025-38210-4785e275","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_read"}},{"deprecated":false,"digest":{"function_hash":"305829370804003066107517596887036683887","length":197},"id":"CVE-2025-38210-4f34b202","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_unregister"}},{"deprecated":false,"digest":{"function_hash":"112233863565115362434365472630036180056","length":441},"id":"CVE-2025-38210-6d5666a2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_privlevel_store"}},{"deprecated":false,"digest":{"function_hash":"112233863565115362434365472630036180056","length":441},"id":"CVE-2025-38210-71670c36","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_privlevel_store"}},{"deprecated":false,"digest":{"function_hash":"289037275788801740426228010258841778295","length":174},"id":"CVE-2025-38210-76b13d56","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_privlevel_floor_show"}},{"deprecated":false,"digest":{"function_hash":"124284456666593648542312439819757428982","length":163},"id":"CVE-2025-38210-85358124","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_provider_show"}},{"deprecated":false,"digest":{"function_hash":"289037275788801740426228010258841778295","length":174},"id":"CVE-2025-38210-98b7e71c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_privlevel_floor_show"}},{"deprecated":false,"digest":{"line_hashes":["6953366265150418517359861964393470337","303630737842318949684937236847356897555","131357366203439333740038071292658850806","117526919872343737714179046545502626535","6059659014721218483687413545486404376","228174518172281159186377394407777736217","339032090019224904502162023656525427499","323359708493117241115804663397117143363","298396066745033081549311331957327282794","91118475308612766377638102633859095420","49425431188246333255234929872661953451","158935817662127740631324827511185659073","279162770645023145723605802891968327719","284012473116383297446701769201073358835","275163034838691288779051244746685229171","197935634188053248926891604718336804508","80522192799135719388242529015044891527","253771739978433330647818238842725397076","55306798044147917333627957136020984516","121567883202909777916748251332496113246","292916068586125926440036746175443827926","282137476743069883831495031770659544561","55888552320849352263351528253336720560","16825785359720666752637237422324012084","193335079849344033631718683097278143804","311211780334535166282238918325390238370","318478674622777976595799928201127363927","96617444346117518919122221309932845104","143195111756673788733785048744964426380","326808829123141337555151426182316388492","279640678455948344933776598030792318061","322191882474237243216267757698325803338","146283775373421578963034157095549144368","331514871794124491221721586520766451893","199865891787672567792024299488941981598","41046678023217303366578128010823298545","257711955706751329888818434287284767214"],"threshold":0.9},"id":"CVE-2025-38210-a90ab632","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c"}},{"deprecated":false,"digest":{"function_hash":"93298158481509512662019561286795621547","length":350},"id":"CVE-2025-38210-f0a75664","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_make_item"}},{"deprecated":false,"digest":{"function_hash":"305829370804003066107517596887036683887","length":197},"id":"CVE-2025-38210-f2a8f71b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_unregister"}},{"deprecated":false,"digest":{"function_hash":"193271412004093836254400632992518787622","length":305},"id":"CVE-2025-38210-f3b93030","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cefbafcbdef011d6ef9414902311afdfba3c33eb","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_register"}},{"deprecated":false,"digest":{"function_hash":"124284456666593648542312439819757428982","length":163},"id":"CVE-2025-38210-ffe7f519","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fba4ceaa242d2bdf4c04b77bda41d32d02d3925d","target":{"file":"drivers/virt/coco/tsm.c","function":"tsm_report_provider_show"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.35"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.15.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38210.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/015f04ac884a454d4d8aaa7b67758f047742b1cf"},{"type":"WEB","url":"https://git.kernel.org/stable/c/cefbafcbdef011d6ef9414902311afdfba3c33eb"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fba4ceaa242d2bdf4c04b77bda41d32d02d3925d"}]}