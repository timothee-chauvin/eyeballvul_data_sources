{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-3138.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "298907278491193048266235669548350475202",
              "length": 323.0
            },
            "id": "CVE-2023-3138-14fe8387",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://gitlab.freedesktop.org/xorg/lib/libx11@304a654a0d57bf0f00d8998185f0360332cfa36c",
            "target": {
              "file": "src/InitExt.c",
              "function": "XESetCopyEventCookie"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "30444909891429425013564211474243969169",
              "length": 286.0
            },
            "id": "CVE-2023-3138-47df209d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://gitlab.freedesktop.org/xorg/lib/libx11@304a654a0d57bf0f00d8998185f0360332cfa36c",
            "target": {
              "file": "src/InitExt.c",
              "function": "XESetEventToWire"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "233540507272046996774600361342152033989",
                "196936685027843017201587721205184059738",
                "288394412508189760627888348399672705118",
                "195118542456944709482212300490868720349",
                "253211894642060104625804785280022370301",
                "201555605637940015785391757466499686756",
                "338986897398082085532410975460257226431",
                "232607848190414069738814603491346015756",
                "131791493693296416811889505280059308691",
                "301184808930699056134250622608827726925",
                "34659827810547045130780133758107858872",
                "88545250556115514474271548007640243189",
                "151654423950334215799837411276497185646",
                "86845664250122727915700362723472744435",
                "325298984730726609706218672110655564461",
                "228114991961659876113745819405202478847",
                "292477591844063266393769994678635920180",
                "216172813302903016412702024297511909017",
                "229400877956709680642739926159644910329",
                "186457253695277743904038329620712268674",
                "333538522318531836778201631262197916399",
                "194015383412837816685118699476043121068",
                "173510133934350389664557126568315157575"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-3138-59143fed",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://gitlab.freedesktop.org/xorg/lib/libx11@304a654a0d57bf0f00d8998185f0360332cfa36c",
            "target": {
              "file": "src/InitExt.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "108595739474844043942560908921816446460",
              "length": 511.0
            },
            "id": "CVE-2023-3138-781a8d6f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://gitlab.freedesktop.org/xorg/lib/libx11@304a654a0d57bf0f00d8998185f0360332cfa36c",
            "target": {
              "file": "src/InitExt.c",
              "function": "XESetWireToError"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "305586493498904098051902028964476548439",
              "length": 286.0
            },
            "id": "CVE-2023-3138-99ecdd34",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://gitlab.freedesktop.org/xorg/lib/libx11@304a654a0d57bf0f00d8998185f0360332cfa36c",
            "target": {
              "file": "src/InitExt.c",
              "function": "XESetWireToEvent"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "19059198550942782566043020364398688522",
              "length": 313.0
            },
            "id": "CVE-2023-3138-a87a6d32",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://gitlab.freedesktop.org/xorg/lib/libx11@304a654a0d57bf0f00d8998185f0360332cfa36c",
            "target": {
              "file": "src/InitExt.c",
              "function": "XESetWireToEventCookie"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "304a654a0d57bf0f00d8998185f0360332cfa36c"
            }
          ],
          "repo": "https://gitlab.freedesktop.org/xorg/lib/libx11",
          "type": "GIT"
        }
      ],
      "versions": [
        "MODULAR_COPY",
        "XACE-SELINUX-MERGE",
        "XORG-6_7_99_1",
        "XORG-6_7_99_2",
        "XORG-6_7_99_902",
        "XORG-6_7_99_903",
        "XORG-6_8_1",
        "XORG-6_8_99_10",
        "XORG-6_8_99_13",
        "XORG-6_8_99_14",
        "XORG-6_8_99_15",
        "XORG-6_8_99_6",
        "XORG-6_8_99_7",
        "XORG-6_8_99_9",
        "XORG-6_8_99_900",
        "XORG-6_8_99_901",
        "XORG-6_8_99_902",
        "XORG-6_8_99_903",
        "XORG-6_99_99_900",
        "XORG-6_99_99_901",
        "XORG-6_99_99_902",
        "XORG-6_99_99_903",
        "XORG-6_99_99_904",
        "XORG-MAIN",
        "libX11-1.0.99.1",
        "libX11-1.0.99.2",
        "libX11-1.1",
        "libX11-1.1-RC1",
        "libX11-1.1-RC2",
        "libX11-1.1.1",
        "libX11-1.1.2",
        "libX11-1.1.3",
        "libX11-1.1.4",
        "libX11-1.1.99.2",
        "libX11-1.2",
        "libX11-1.2.1",
        "libX11-1.2.2",
        "libX11-1.2.99.901",
        "libX11-1.3",
        "libX11-1.3.1",
        "libX11-1.3.2",
        "libX11-1.3.3",
        "libX11-1.3.4",
        "libX11-1.3.99.901",
        "libX11-1.3.99.902",
        "libX11-1.3.99.903",
        "libX11-1.4.0",
        "libX11-1.4.1",
        "libX11-1.4.2",
        "libX11-1.4.3",
        "libX11-1.4.4",
        "libX11-1.4.99.1",
        "libX11-1.4.99.901",
        "libX11-1.4.99.902",
        "libX11-1.5.0",
        "libX11-1.5.99.901",
        "libX11-1.5.99.902",
        "libX11-1.6.0",
        "libX11-1.6.1",
        "libX11-1.6.10",
        "libX11-1.6.11",
        "libX11-1.6.12",
        "libX11-1.6.2",
        "libX11-1.6.3",
        "libX11-1.6.4",
        "libX11-1.6.5",
        "libX11-1.6.6",
        "libX11-1.6.7",
        "libX11-1.6.8",
        "libX11-1.6.9",
        "libX11-1.7.0",
        "libX11-1.7.1",
        "libX11-1.7.2",
        "libX11-1.7.3",
        "libX11-1.7.3.1",
        "libX11-1.7.4",
        "libX11-1.7.5",
        "libX11-1.8",
        "libX11-1.8.1",
        "libX11-1.8.2",
        "libX11-1.8.3",
        "libX11-1.8.4",
        "libX11-1.8.5",
        "libX11-1_0_1",
        "libX11-1_0_2",
        "libX11-1_0_3"
      ]
    }
  ],
  "details": "A vulnerability was found in libX11. The security flaw occurs because the functions in src/InitExt.c in libX11 do not check that the values provided for the Request, Event, or Error IDs are within the bounds of the arrays that those functions write to, using those IDs as array indexes. They trust that they were called with values provided by an Xserver adhering to the bounds specified in the X11 protocol, as all X servers provided by X.Org do. As the protocol only specifies a single byte for these values, an out-of-bounds value provided by a malicious server (or a malicious proxy-in-the-middle) can only overwrite other portions of the Display structure and not write outside the bounds of the Display structure itself, possibly causing the client to crash with this memory corruption.",
  "id": "CVE-2023-3138",
  "modified": "2025-10-16T05:46:48.649383Z",
  "published": "2023-06-28T21:15:10Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://access.redhat.com/security/cve/CVE-2023-3138"
    },
    {
      "type": "ADVISORY",
      "url": "https://security.netapp.com/advisory/ntap-20231208-0008/"
    },
    {
      "type": "FIX",
      "url": "https://lists.x.org/archives/xorg-announce/2023-June/003406.html"
    },
    {
      "type": "FIX",
      "url": "https://lists.x.org/archives/xorg-announce/2023-June/003407.html"
    },
    {
      "type": "FIX",
      "url": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/304a654a0d57bf0f00d8998185f0360332cfa36c"
    }
  ],
  "related": [
    "ALSA-2023:6497",
    "ALSA-2023:7029",
    "MGASA-2023-0206",
    "SUSE-SU-2023:2531-1",
    "SUSE-SU-2023:2614-1",
    "openSUSE-SU-2024:13008-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ]
}