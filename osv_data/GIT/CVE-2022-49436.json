{"schema_version":"1.7.3","id":"CVE-2022-49436","published":"2025-02-26T02:12:52Z","modified":"2025-10-21T10:07:11.696938Z","related":["SUSE-SU-2025:1176-1","SUSE-SU-2025:1241-1"],"summary":"powerpc/papr_scm: Fix leaking nvdimm_events_map elements","details":"In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/papr_scm: Fix leaking nvdimm_events_map elements\n\nRight now 'char *' elements allocated for individual 'stat_id' in\n'papr_scm_priv.nvdimm_events_map[]' during papr_scm_pmu_check_events(), get\nleaked in papr_scm_remove() and papr_scm_pmu_register(),\npapr_scm_pmu_check_events() error paths.\n\nAlso individual 'stat_id' arent NULL terminated 'char *' instead they are fixed\n8-byte sized identifiers. However papr_scm_pmu_register() assumes it to be a\nNULL terminated 'char *' and at other places it assumes it to be a\n'papr_scm_perf_stat.stat_id' sized string which is 8-byes in size.\n\nFix this by allocating the memory for papr_scm_priv.nvdimm_events_map to also\ninclude space for 'stat_id' entries. This is possible since number of available\nevents/stat_ids are known upfront. This saves some memory and one extra level of\nindirection from 'nvdimm_events_map' to 'stat_id'. Also rest of the code\ncan continue to call 'kfree(papr_scm_priv.nvdimm_events_map)' without needing to\niterate over the array and free up individual elements.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4c08d4bbc089a95f3f38389c2b79dbc6ab24f10b"},{"fixed":"b073096df4dec70d0436321b7093bad27ae91f9e"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4c08d4bbc089a95f3f38389c2b79dbc6ab24f10b"},{"fixed":"0e0946e22f3665d27325d389ff45ade6e93f3678"}]}],"versions":["v5.17","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.18.1","v5.18.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49436.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"290099475954081436220772662696273225918","length":1049},"id":"CVE-2022-49436-347f88de","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e0946e22f3665d27325d389ff45ade6e93f3678","target":{"file":"arch/powerpc/platforms/pseries/papr_scm.c","function":"papr_scm_pmu_check_events"}},{"deprecated":false,"digest":{"function_hash":"290099475954081436220772662696273225918","length":1049},"id":"CVE-2022-49436-7021ee48","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b073096df4dec70d0436321b7093bad27ae91f9e","target":{"file":"arch/powerpc/platforms/pseries/papr_scm.c","function":"papr_scm_pmu_check_events"}},{"deprecated":false,"digest":{"line_hashes":["93433378251405099763510942522075570076","30482801334948582352965921148353657758","66528730768740244997303681683305218107","183107854713452364224950187394216634830","219176724883276571659001716722380802904","326918030866387662246517699459522189364","156358117499910923704018968937000421168","46008604533389602754938898730803254881","244672264513825649761192866656234793452","145405174118288211598342517313351910054","336278908508589572617039732526093363105","274697917040156894005207293748983914425","317296619376283009732801097966438624841","72889628261023729957836445500851029154","180695483448061697761342030199287936013","162178420388251617021492466984579606740","160687034739913833466151111928539240942","29320529559883804301388055511991527727","225779169286963245475229796212624259152","201766767650525654390020459277798260085","137311981626603279696123980725320802597","243100891106003871871447441253827200369","211871719041673524685120879213862252028","122683245646962908851657611054005979810","27869467824041950154020412210661952646","302536441353787613688399299842447939681","180723530379962892117984373815828326166","263108631723226589061117941639195485878","251761930803061666901623702478120680806","272475803657060527344492644944821070470","290221555001972995218194970391702514447","167721234953838338151696263194985162525","42656951281928882204523496080582480345","173119128364206554683671047884523109787","243936936636072333033207572592789692999","300597271629276704685404041605983788912","115154028699596906343828824152765643757","185172503650143723335943554494628636255","42235631673737329731338400124346467036","269720960452378791102871004964471628065","214289680814636618795997097661921274497","111309816693127297806608029517990574930","111758981871529905870709889650527694071"],"threshold":0.9},"id":"CVE-2022-49436-7a46bb68","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b073096df4dec70d0436321b7093bad27ae91f9e","target":{"file":"arch/powerpc/platforms/pseries/papr_scm.c"}},{"deprecated":false,"digest":{"function_hash":"197755574704957492678307572202770607118","length":674},"id":"CVE-2022-49436-828d678b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b073096df4dec70d0436321b7093bad27ae91f9e","target":{"file":"arch/powerpc/platforms/pseries/papr_scm.c","function":"papr_scm_pmu_get_value"}},{"deprecated":false,"digest":{"line_hashes":["93433378251405099763510942522075570076","30482801334948582352965921148353657758","66528730768740244997303681683305218107","183107854713452364224950187394216634830","219176724883276571659001716722380802904","326918030866387662246517699459522189364","156358117499910923704018968937000421168","46008604533389602754938898730803254881","244672264513825649761192866656234793452","145405174118288211598342517313351910054","336278908508589572617039732526093363105","274697917040156894005207293748983914425","317296619376283009732801097966438624841","72889628261023729957836445500851029154","180695483448061697761342030199287936013","162178420388251617021492466984579606740","160687034739913833466151111928539240942","29320529559883804301388055511991527727","225779169286963245475229796212624259152","201766767650525654390020459277798260085","137311981626603279696123980725320802597","243100891106003871871447441253827200369","211871719041673524685120879213862252028","122683245646962908851657611054005979810","27869467824041950154020412210661952646","302536441353787613688399299842447939681","180723530379962892117984373815828326166","263108631723226589061117941639195485878","251761930803061666901623702478120680806","272475803657060527344492644944821070470","290221555001972995218194970391702514447","167721234953838338151696263194985162525","42656951281928882204523496080582480345","173119128364206554683671047884523109787","243936936636072333033207572592789692999","300597271629276704685404041605983788912","115154028699596906343828824152765643757","185172503650143723335943554494628636255","42235631673737329731338400124346467036","269720960452378791102871004964471628065","214289680814636618795997097661921274497","111309816693127297806608029517990574930","111758981871529905870709889650527694071"],"threshold":0.9},"id":"CVE-2022-49436-ddf3ec1f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e0946e22f3665d27325d389ff45ade6e93f3678","target":{"file":"arch/powerpc/platforms/pseries/papr_scm.c"}},{"deprecated":false,"digest":{"function_hash":"197755574704957492678307572202770607118","length":674},"id":"CVE-2022-49436-f25ac7ab","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e0946e22f3665d27325d389ff45ade6e93f3678","target":{"file":"arch/powerpc/platforms/pseries/papr_scm.c","function":"papr_scm_pmu_get_value"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.18.0"},{"fixed":"5.18.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49436.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0e0946e22f3665d27325d389ff45ade6e93f3678"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b073096df4dec70d0436321b7093bad27ae91f9e"}]}