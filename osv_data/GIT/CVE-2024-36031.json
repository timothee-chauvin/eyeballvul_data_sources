{"schema_version":"1.7.3","id":"CVE-2024-36031","published":"2024-05-30T15:23:46.831Z","modified":"2025-11-20T05:08:02.762949Z","related":["MGASA-2024-0263","MGASA-2024-0266","SUSE-SU-2024:4314-1","SUSE-SU-2024:4316-1","SUSE-SU-2024:4318-1","SUSE-SU-2024:4387-1"],"summary":"keys: Fix overwrite of key expiration on instantiation","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nkeys: Fix overwrite of key expiration on instantiation\n\nThe expiry time of a key is unconditionally overwritten during\ninstantiation, defaulting to turn it permanent. This causes a problem\nfor DNS resolution as the expiration set by user-space is overwritten to\nTIME64_MAX, disabling further DNS updates. Fix this by restoring the\ncondition that key_set_expiry is only called when the pre-parser sets a\nspecific expiry.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"97be1e865e70e5a0ad0a5b5f5dca5031ca0b53ac"},{"fixed":"ad2011ea787928b2accb5134f1e423b11fe80a8a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"2552b32b0b349df160a509fe49f5f308cb922f2b"},{"fixed":"ed79b93f725cd0da39a265dc23d77add1527b9be"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"791d5409cdb974c31a1bc7a903ea729ddc7d83df"},{"fixed":"e4519a016650e952ad9eb27937f8c447d5a4e06d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"afc360e8a1256acb7579a6f5b6f2c30b85b39301"},{"fixed":"25777f3f4e1f371d16a594925f31e37ce07b6ec7"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"39299bdd2546688d92ed9db4948f6219ca1b9542"},{"fixed":"939a08bcd4334bad4b201e60bd0ae1f278d71d41"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"39299bdd2546688d92ed9db4948f6219ca1b9542"},{"fixed":"cc219cb8afbc40ec100c0de941047bb29373126a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"39299bdd2546688d92ed9db4948f6219ca1b9542"},{"fixed":"9da27fb65a14c18efd4473e2e82b76b53ba60252"}]}],"versions":["v5.10.206","v5.10.207","v5.10.208","v5.10.209","v5.10.210","v5.10.211","v5.10.212","v5.10.213","v5.10.214","v5.10.215","v5.10.216","v5.15.146","v5.15.147","v5.15.148","v5.15.149","v5.15.150","v5.15.151","v5.15.152","v5.15.153","v5.15.154","v5.15.155","v5.15.156","v5.15.157","v5.15.158","v6.1.70","v6.1.71","v6.1.72","v6.1.73","v6.1.74","v6.1.75","v6.1.76","v6.1.77","v6.1.78","v6.1.79","v6.1.80","v6.1.81","v6.1.82","v6.1.83","v6.1.84","v6.1.85","v6.1.86","v6.1.87","v6.1.88","v6.1.89","v6.1.90","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.30","v6.6.9","v6.7","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.8.1","v6.8.2","v6.8.3","v6.8.4","v6.8.5","v6.8.6","v6.8.7","v6.8.8","v6.8.9","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-36031.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["70999738566349864358701528333539681836","12463220382068603052640400060896719903","166097772629778503769949273095446592747","301429821010209408577146139796736170317"],"threshold":0.9},"id":"CVE-2024-36031-26ac5217","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed79b93f725cd0da39a265dc23d77add1527b9be","target":{"file":"security/keys/key.c"}},{"deprecated":false,"digest":{"function_hash":"318303615909168838032499862699215866474","length":901},"id":"CVE-2024-36031-38b943e3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cc219cb8afbc40ec100c0de941047bb29373126a","target":{"file":"security/keys/key.c","function":"__key_instantiate_and_link"}},{"deprecated":false,"digest":{"function_hash":"318303615909168838032499862699215866474","length":901},"id":"CVE-2024-36031-67412879","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@939a08bcd4334bad4b201e60bd0ae1f278d71d41","target":{"file":"security/keys/key.c","function":"__key_instantiate_and_link"}},{"deprecated":false,"digest":{"function_hash":"318303615909168838032499862699215866474","length":901},"id":"CVE-2024-36031-8edbf0a8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed79b93f725cd0da39a265dc23d77add1527b9be","target":{"file":"security/keys/key.c","function":"__key_instantiate_and_link"}},{"deprecated":false,"digest":{"function_hash":"318303615909168838032499862699215866474","length":901},"id":"CVE-2024-36031-8f5dd268","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e4519a016650e952ad9eb27937f8c447d5a4e06d","target":{"file":"security/keys/key.c","function":"__key_instantiate_and_link"}},{"deprecated":false,"digest":{"line_hashes":["70999738566349864358701528333539681836","12463220382068603052640400060896719903","166097772629778503769949273095446592747","301429821010209408577146139796736170317"],"threshold":0.9},"id":"CVE-2024-36031-a68fe180","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e4519a016650e952ad9eb27937f8c447d5a4e06d","target":{"file":"security/keys/key.c"}},{"deprecated":false,"digest":{"line_hashes":["70999738566349864358701528333539681836","12463220382068603052640400060896719903","166097772629778503769949273095446592747","301429821010209408577146139796736170317"],"threshold":0.9},"id":"CVE-2024-36031-cc981de7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cc219cb8afbc40ec100c0de941047bb29373126a","target":{"file":"security/keys/key.c"}},{"deprecated":false,"digest":{"line_hashes":["70999738566349864358701528333539681836","12463220382068603052640400060896719903","166097772629778503769949273095446592747","301429821010209408577146139796736170317"],"threshold":0.9},"id":"CVE-2024-36031-e85ae970","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@939a08bcd4334bad4b201e60bd0ae1f278d71d41","target":{"file":"security/keys/key.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.217"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.11.0"},{"fixed":"5.15.159"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"6.1.91"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.31"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.8.10"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.9.1"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-36031.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/25777f3f4e1f371d16a594925f31e37ce07b6ec7"},{"type":"WEB","url":"https://git.kernel.org/stable/c/939a08bcd4334bad4b201e60bd0ae1f278d71d41"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9da27fb65a14c18efd4473e2e82b76b53ba60252"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ad2011ea787928b2accb5134f1e423b11fe80a8a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/cc219cb8afbc40ec100c0de941047bb29373126a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e4519a016650e952ad9eb27937f8c447d5a4e06d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ed79b93f725cd0da39a265dc23d77add1527b9be"},{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2024/06/msg00019.html"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}