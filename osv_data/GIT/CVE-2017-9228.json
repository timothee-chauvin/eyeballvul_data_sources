{"schema_version":"1.7.3","id":"CVE-2017-9228","published":"2017-05-24T15:29:00.370Z","modified":"2025-12-08T23:46:38.535297Z","related":["MGASA-2017-0246","SUSE-SU-2017:3237-1","SUSE-SU-2017:3277-1","SUSE-SU-2018:0003-1","SUSE-SU-2020:1570-1"],"details":"An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A heap out-of-bounds write occurs in bitset_set_range() during regular expression compilation due to an uninitialized variable from an incorrect state transition. An incorrect state transition in parse_char_class() could create an execution path that leaves a critical local variable uninitialized until it's used as an index, resulting in an out-of-bounds write memory corruption.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/kkos/oniguruma","events":[{"introduced":"0"},{"fixed":"3b63d12038c8d8fc278e81c942fa9bec7c704c8b"}]}],"versions":["v5.9.6","v6.0.0","v6.1.0","v6.1.1","v6.1.2","v6.1.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2017-9228.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["137584815735396322363988031431915161481","333494754384487831514448708681268998912","146133796272021099976876320362250733552","333557439717205834644043090230902438066"],"threshold":0.9},"id":"CVE-2017-9228-76affd58","signature_type":"Line","signature_version":"v1","source":"https://github.com/kkos/oniguruma/commit/3b63d12038c8d8fc278e81c942fa9bec7c704c8b","target":{"file":"src/regparse.c"}},{"deprecated":false,"digest":{"function_hash":"101840422994517572473954624738540707486","length":523},"id":"CVE-2017-9228-f4e5b971","signature_type":"Function","signature_version":"v1","source":"https://github.com/kkos/oniguruma/commit/3b63d12038c8d8fc278e81c942fa9bec7c704c8b","target":{"file":"src/regparse.c","function":"next_state_class"}}]}},{"ranges":[{"type":"GIT","repo":"https://github.com/php/php-src","events":[{"introduced":"fc1df8e7a6886e29a6ed5bef3f674ac61164e847"},{"fixed":"de96a08a90e480f1afb655bcfeac8ac28a14228e"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2017-9228.json"}}],"references":[{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2018:1296"},{"type":"FIX","url":"https://github.com/kkos/oniguruma/commit/3b63d12038c8d8fc278e81c942fa9bec7c704c8b"},{"type":"EVIDENCE","url":"https://github.com/kkos/oniguruma/issues/60"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}