{"schema_version":"1.7.3","id":"CVE-2025-38404","published":"2025-07-25T13:09:25.822Z","modified":"2025-11-20T10:24:24.729031Z","related":["MGASA-2025-0218","MGASA-2025-0219","SUSE-SU-2025:02853-1","SUSE-SU-2025:02923-1","SUSE-SU-2025:02969-1","SUSE-SU-2025:03023-1"],"summary":"usb: typec: displayport: Fix potential deadlock","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nusb: typec: displayport: Fix potential deadlock\n\nThe deadlock can occur due to a recursive lock acquisition of\n`cros_typec_altmode_data::mutex`.\nThe call chain is as follows:\n1. cros_typec_altmode_work() acquires the mutex\n2. typec_altmode_vdm() -> dp_altmode_vdm() ->\n3. typec_altmode_exit() -> cros_typec_altmode_exit()\n4. cros_typec_altmode_exit() attempts to acquire the mutex again\n\nTo prevent this, defer the `typec_altmode_exit()` call by scheduling\nit rather than calling it directly from within the mutex-protected\ncontext.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e0359c66c1beccbe90119a63391678eabda38007"},{"fixed":"749d9076735fb497aae60fbea9fff563f9ea3254"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e3fb6c2c3939b4aad203cacdd613a62ce1fd032c"},{"fixed":"eb08fca56f1f39e4038cb9bac9864464b13b00aa"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"56846793f105cf2b39ecbde4f3ae86342091f6fc"},{"fixed":"7be0d1ea71f52595499da39cea484a895e8ed042"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8e8a69b1f8c59f0505f8a1c0fb77191f27b75011"},{"fixed":"76cf1f33e7319fe74c94ac92f9814094ee8cc84b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8851e40587013db00b71d4aeaae30f5fd59b0eec"},{"fixed":"63cff9f57e86b2dc25d7487ca0118df89a665296"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"10cc2cfd3e5d0e0ec7590c4bee8bcea10e5492c4"},{"fixed":"c782f98eef14197affa8a7b91e6981420f109ea9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8f6a4fa7b663468bb304cb885b93326e025ae005"},{"fixed":"80c25d7916a44715338d4f8924c8e52af50d0b9f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4b38ffb38c91afd4dc387608db26f6fc34ed40b"},{"fixed":"099cf1fbb8afc3771f408109f62bdec66f85160e"}]}],"versions":["v6.1.143","v6.12.36","v6.15","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.5","v6.16-rc1","v6.16-rc2","v6.6.96"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38404.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"162503292608345020787240149224827967420","length":1108},"id":"CVE-2025-38404-6f02f0b7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@749d9076735fb497aae60fbea9fff563f9ea3254","target":{"file":"drivers/usb/typec/altmodes/displayport.c","function":"dp_altmode_vdm"}},{"deprecated":false,"digest":{"line_hashes":["126070902684975736141901911398232526265","266411721620277721657613967204467068373","23766162348037122882160223973398933882","327379909333896071192213803069328031809","164979863325993694831981184654089817960"],"threshold":0.9},"id":"CVE-2025-38404-8f13c2fa","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eb08fca56f1f39e4038cb9bac9864464b13b00aa","target":{"file":"drivers/usb/typec/altmodes/displayport.c"}},{"deprecated":false,"digest":{"function_hash":"63277922202311860766323344747193273188","length":1258},"id":"CVE-2025-38404-93fdbbfc","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@eb08fca56f1f39e4038cb9bac9864464b13b00aa","target":{"file":"drivers/usb/typec/altmodes/displayport.c","function":"dp_altmode_vdm"}},{"deprecated":false,"digest":{"line_hashes":["126070902684975736141901911398232526265","266411721620277721657613967204467068373","23766162348037122882160223973398933882","327379909333896071192213803069328031809","164979863325993694831981184654089817960"],"threshold":0.9},"id":"CVE-2025-38404-d7952a94","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@099cf1fbb8afc3771f408109f62bdec66f85160e","target":{"file":"drivers/usb/typec/altmodes/displayport.c"}},{"deprecated":false,"digest":{"function_hash":"264564921286298649890486160553479854296","length":1409},"id":"CVE-2025-38404-ef32e0e7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@099cf1fbb8afc3771f408109f62bdec66f85160e","target":{"file":"drivers/usb/typec/altmodes/displayport.c","function":"dp_altmode_vdm"}},{"deprecated":false,"digest":{"line_hashes":["126070902684975736141901911398232526265","266411721620277721657613967204467068373","23766162348037122882160223973398933882","327379909333896071192213803069328031809","164979863325993694831981184654089817960"],"threshold":0.9},"id":"CVE-2025-38404-f1a80d18","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@749d9076735fb497aae60fbea9fff563f9ea3254","target":{"file":"drivers/usb/typec/altmodes/displayport.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.1.143"},{"fixed":"6.1.144"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.6.96"},{"fixed":"6.6.97"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.12.36"},{"fixed":"6.12.37"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.15.5"},{"fixed":"6.15.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38404.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/099cf1fbb8afc3771f408109f62bdec66f85160e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/63cff9f57e86b2dc25d7487ca0118df89a665296"},{"type":"WEB","url":"https://git.kernel.org/stable/c/749d9076735fb497aae60fbea9fff563f9ea3254"},{"type":"WEB","url":"https://git.kernel.org/stable/c/76cf1f33e7319fe74c94ac92f9814094ee8cc84b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7be0d1ea71f52595499da39cea484a895e8ed042"},{"type":"WEB","url":"https://git.kernel.org/stable/c/80c25d7916a44715338d4f8924c8e52af50d0b9f"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c782f98eef14197affa8a7b91e6981420f109ea9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/eb08fca56f1f39e4038cb9bac9864464b13b00aa"},{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html"},{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"}]}