{"schema_version":"1.7.3","id":"CVE-2025-66023","published":"2026-01-01T15:11:46.028Z","modified":"2026-01-01T19:56:16.302902Z","aliases":["GHSA-24f7-q5hh-27hf"],"summary":"NanoMQ has Use-After-Free of malformed bridging message","details":"NanoMQ MQTT Broker (NanoMQ) is an all-around Edge Messaging Platform. Versions prior to 0.24.5 have a Heap-Use-After-Free (UAF) vulnerability within the MQTT bridge client component (implemented via the underlying NanoNNG library). The vulnerability is triggered when NanoMQ acts as a bridge connecting to a remote MQTT broker. A malicious remote broker can trigger a crash (Denial of Service) or potential memory corruption by accepting the connection and immediately sending a malformed packet sequence. Version 0.34.5 contains a patch. The patch enforces stricter protocol adherence in the MQTT client SDK embedded in NanoMQ. Specifically, it ensures that CONNACK is always the first packet processed in the line. This prevents the state confusion that led to the Heap-Use-After-Free (UAF) when a malicious server sent a malformed packet sequence immediately after connection establishment. As a workaround, validate the remote broker before bridging.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/nanomq/nanonng","events":[{"introduced":"0"},{"fixed":"275fde204f7a016df84061a04d3589b2187cb31b"}],"database_specific":{"versions":[{"introduced":"0"},{"fixed":"0.24.5"}]}}],"versions":["0.11.5","0.11.8","0.13","0.13.5","0.14.5","0.15.3","0.15.5","0.16.0","0.16.3","0.16.5","0.17.0","0.17.2","0.17.8","0.18.2","0.19.1","0.20.0","0.20.5","0.20.8","0.21","0.21.2","0.21.5","0.21.6","0.21.8","0.21.9","0.22.0","0.22.1","0.22.10","0.22.2","0.22.4","0.22.6","0.22.8","0.23.1","0.23.10","0.23.2","0.23.3","0.23.5","0.23.7","0.23.8","0.23.9","0.24.0","0.24.1","0.24.2","0.24.3","0.7.2","0.8.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-66023.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"56958626050329748148744694782009079053","length":492},"id":"CVE-2025-66023-0db4bda9","signature_type":"Function","signature_version":"v1","source":"https://github.com/nanomq/nanonng/commit/275fde204f7a016df84061a04d3589b2187cb31b","target":{"file":"src/sp/protocol/mqtt/auth_http.c","function":"nmq_auth_http_connect"}},{"deprecated":false,"digest":{"line_hashes":["268744193594522080992789612994293258128","165483405537291653127563453155465090727","11041369829816520293312476607410976249","200821478271691919481984153438780605738","182918512030391085661898188106651969207","155900464470709235180528595405603622432","83744376971184402277615564536661587888","299293793255995443923095284851123065377"],"threshold":0.9},"id":"CVE-2025-66023-100549fe","signature_type":"Line","signature_version":"v1","source":"https://github.com/nanomq/nanonng/commit/275fde204f7a016df84061a04d3589b2187cb31b","target":{"file":"src/sp/protocol/mqtt/mqtt_parser.c"}},{"deprecated":false,"digest":{"function_hash":"77124182106383610417933581188056284634","length":4303},"id":"CVE-2025-66023-1d6e7a94","signature_type":"Function","signature_version":"v1","source":"https://github.com/nanomq/nanonng/commit/275fde204f7a016df84061a04d3589b2187cb31b","target":{"file":"src/sp/protocol/mqtt/nmq_mqtt.c","function":"nano_pipe_start"}},{"deprecated":false,"digest":{"function_hash":"324400666998203739011331393572365511190","length":959},"id":"CVE-2025-66023-345d6db1","signature_type":"Function","signature_version":"v1","source":"https://github.com/nanomq/nanonng/commit/275fde204f7a016df84061a04d3589b2187cb31b","target":{"file":"src/sp/protocol/mqtt/mqtt_parser.c","function":"verify_connect"}},{"deprecated":false,"digest":{"line_hashes":["164364262414377812650440499958546893940","263184712662825869420828817159095455479","311682571783189142684444126853966489232","302117340673154377291795646925030157741"],"threshold":0.9},"id":"CVE-2025-66023-7d81996a","signature_type":"Line","signature_version":"v1","source":"https://github.com/nanomq/nanonng/commit/275fde204f7a016df84061a04d3589b2187cb31b","target":{"file":"src/sp/protocol/mqtt/nmq_mqtt.c"}},{"deprecated":false,"digest":{"line_hashes":["305832552049203021059605737312590760524","87605694297252626267185771004794202008","42304555775663366555327629855562317099","209815075214257963700087979711085484635"],"threshold":0.9},"id":"CVE-2025-66023-a1059424","signature_type":"Line","signature_version":"v1","source":"https://github.com/nanomq/nanonng/commit/275fde204f7a016df84061a04d3589b2187cb31b","target":{"file":"src/sp/protocol/mqtt/auth_http.c"}}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/66xxx/CVE-2025-66023.json"},{"type":"FIX","url":"https://github.com/nanomq/NanoNNG/pull/1365"},{"type":"REPORT","url":"https://github.com/nanomq/nanomq/issues/2145"},{"type":"ADVISORY","url":"https://github.com/nanomq/nanomq/security/advisories/GHSA-24f7-q5hh-27hf"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-66023"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-416"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/66xxx/CVE-2025-66023.json"},"severity":[{"type":"CVSS_V4","score":"CVSS:4.0/AV:N/AC:H/AT:P/PR:H/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H"}]}