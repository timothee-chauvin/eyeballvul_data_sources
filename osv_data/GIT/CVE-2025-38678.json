{"schema_version":"1.7.3","id":"CVE-2025-38678","published":"2025-09-03T13:01:15.799Z","modified":"2025-11-24T20:26:45.434806Z","related":["SUSE-SU-2025:03615-1","SUSE-SU-2025:03628-1","SUSE-SU-2025:3712-1","SUSE-SU-2025:3716-1","SUSE-SU-2025:3717-1","SUSE-SU-2025:3720-1","SUSE-SU-2025:3721-1","SUSE-SU-2025:3725-1","SUSE-SU-2025:3733-1","SUSE-SU-2025:3736-1","SUSE-SU-2025:3740-1","SUSE-SU-2025:3741-1","SUSE-SU-2025:3742-1","SUSE-SU-2025:3748-1","SUSE-SU-2025:3751-1","SUSE-SU-2025:3755-1","SUSE-SU-2025:3761-1","SUSE-SU-2025:3768-1","SUSE-SU-2025:3769-1","SUSE-SU-2025:3770-1","SUSE-SU-2025:3771-1","SUSE-SU-2025:3772-1"],"summary":"netfilter: nf_tables: reject duplicate device on updates","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: reject duplicate device on updates\n\nA chain/flowtable update with duplicated devices in the same batch is\npossible. Unfortunately, netdev event path only removes the first\ndevice that is found, leaving unregistered the hook of the duplicated\ndevice.\n\nCheck if a duplicated device exists in the transaction batch, bail out\nwith EEXIST in such case.\n\nWARNING is hit when unregistering the hook:\n\n [49042.221275] WARNING: CPU: 4 PID: 8425 at net/netfilter/core.c:340 nf_hook_entry_head+0xaa/0x150\n [49042.221375] CPU: 4 UID: 0 PID: 8425 Comm: nft Tainted: G S                  6.16.0+ #170 PREEMPT(full)\n [...]\n [49042.221382] RIP: 0010:nf_hook_entry_head+0xaa/0x150","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"78d9f48f7f44431a25da2b46b3a8812f6ff2b981"},{"fixed":"3f358a66a04513311668ea4b40f5064e253d8386"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"78d9f48f7f44431a25da2b46b3a8812f6ff2b981"},{"fixed":"cf23d531a9d496863aa4c5a0e2f71f0a23f3df3c"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"78d9f48f7f44431a25da2b46b3a8812f6ff2b981"},{"fixed":"d7615bde541f16517d6790412da6ec46fa8a4c1f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"78d9f48f7f44431a25da2b46b3a8812f6ff2b981"},{"fixed":"cf5fb87fcdaaaafec55dcc0dc5a9e15ead343973"}]}],"versions":["v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.7","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.35","v6.12.36","v6.12.37","v6.12.38","v6.12.39","v6.12.4","v6.12.40","v6.12.41","v6.12.42","v6.12.43","v6.12.44","v6.12.45","v6.12.46","v6.12.47","v6.12.48","v6.12.49","v6.12.5","v6.12.50","v6.12.51","v6.12.52","v6.12.53","v6.12.54","v6.12.55","v6.12.56","v6.12.57","v6.12.58","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.100","v6.6.101","v6.6.102","v6.6.103","v6.6.104","v6.6.105","v6.6.106","v6.6.107","v6.6.108","v6.6.109","v6.6.11","v6.6.110","v6.6.111","v6.6.112","v6.6.113","v6.6.114","v6.6.115","v6.6.116","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.85","v6.6.86","v6.6.87","v6.6.88","v6.6.89","v6.6.9","v6.6.90","v6.6.91","v6.6.92","v6.6.93","v6.6.94","v6.6.95","v6.6.96","v6.6.97","v6.6.98","v6.6.99","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38678.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"317062398760430539523968430814761108133","length":3771},"id":"CVE-2025-38678-1a566d20","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f358a66a04513311668ea4b40f5064e253d8386","target":{"file":"net/netfilter/nf_tables_api.c","function":"nf_tables_updchain"}},{"deprecated":false,"digest":{"function_hash":"29736072769185381927581230697594679249","length":3817},"id":"CVE-2025-38678-3c1c336f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf5fb87fcdaaaafec55dcc0dc5a9e15ead343973","target":{"file":"net/netfilter/nf_tables_api.c","function":"nf_tables_updchain"}},{"deprecated":false,"digest":{"line_hashes":["105149237037294953575564407581364069400","191615019125277649128581465385984421391","41450545038459424360790055946285871669","11859587247521452085700534064866611363","41965565413899328493463757641774935205","74037774733597426207261098466186812668","324880034802714112392036135699369992756","198969668243570761688816578580329956915","134227320115491703009375859274840176022","219374066789029936020058018694974750891","178150772353400885886943473454191446119","160493108887732949457528943429552569929","40794529126451241419375509906139131249","16675283211465579181171993465435882469","314354215649805653715101434170071708114","23304818676491046046364393240161738766"],"threshold":0.9},"id":"CVE-2025-38678-4f708306","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d7615bde541f16517d6790412da6ec46fa8a4c1f","target":{"file":"net/netfilter/nf_tables_api.c"}},{"deprecated":false,"digest":{"function_hash":"51500058216244785469037340369579935901","length":1630},"id":"CVE-2025-38678-52836b87","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf5fb87fcdaaaafec55dcc0dc5a9e15ead343973","target":{"file":"net/netfilter/nf_tables_api.c","function":"nft_flowtable_update"}},{"deprecated":false,"digest":{"line_hashes":["121751255099827940485065062487423979154","136806275287610382149938682691865705765","282566340522985079810869996597183475653","311445756751697888038342980996922957753","148007125539321091463595494779247780717","50160271329603573131829233725519764355","76403096515707783506172943525419723841","272400608831338084476463672324136199320","134227320115491703009375859274840176022","219374066789029936020058018694974750891","39266361880146438082338006955810196682","90517794495719244209306383109018506628","15937941289809154524088866081413097056","14946900796670016415223704165565232728","331022977403761320564127709419179855225","59347682585349164293037353190006896369"],"threshold":0.9},"id":"CVE-2025-38678-63b490c4","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf23d531a9d496863aa4c5a0e2f71f0a23f3df3c","target":{"file":"net/netfilter/nf_tables_api.c"}},{"deprecated":false,"digest":{"function_hash":"29736072769185381927581230697594679249","length":3817},"id":"CVE-2025-38678-6d1b513c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d7615bde541f16517d6790412da6ec46fa8a4c1f","target":{"file":"net/netfilter/nf_tables_api.c","function":"nf_tables_updchain"}},{"deprecated":false,"digest":{"line_hashes":["121751255099827940485065062487423979154","136806275287610382149938682691865705765","282566340522985079810869996597183475653","311445756751697888038342980996922957753","148007125539321091463595494779247780717","50160271329603573131829233725519764355","76403096515707783506172943525419723841","272400608831338084476463672324136199320","134227320115491703009375859274840176022","219374066789029936020058018694974750891","39266361880146438082338006955810196682","90517794495719244209306383109018506628","15937941289809154524088866081413097056","14946900796670016415223704165565232728","331022977403761320564127709419179855225","59347682585349164293037353190006896369"],"threshold":0.9},"id":"CVE-2025-38678-95f452a6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f358a66a04513311668ea4b40f5064e253d8386","target":{"file":"net/netfilter/nf_tables_api.c"}},{"deprecated":false,"digest":{"function_hash":"51500058216244785469037340369579935901","length":1630},"id":"CVE-2025-38678-a4811757","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d7615bde541f16517d6790412da6ec46fa8a4c1f","target":{"file":"net/netfilter/nf_tables_api.c","function":"nft_flowtable_update"}},{"deprecated":false,"digest":{"function_hash":"226224202847471372663244540304647470955","length":1563},"id":"CVE-2025-38678-ba43c148","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf23d531a9d496863aa4c5a0e2f71f0a23f3df3c","target":{"file":"net/netfilter/nf_tables_api.c","function":"nft_flowtable_update"}},{"deprecated":false,"digest":{"line_hashes":["105149237037294953575564407581364069400","191615019125277649128581465385984421391","41450545038459424360790055946285871669","11859587247521452085700534064866611363","41965565413899328493463757641774935205","74037774733597426207261098466186812668","324880034802714112392036135699369992756","198969668243570761688816578580329956915","134227320115491703009375859274840176022","219374066789029936020058018694974750891","178150772353400885886943473454191446119","160493108887732949457528943429552569929","40794529126451241419375509906139131249","16675283211465579181171993465435882469","314354215649805653715101434170071708114","23304818676491046046364393240161738766"],"threshold":0.9},"id":"CVE-2025-38678-f011ddf3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf5fb87fcdaaaafec55dcc0dc5a9e15ead343973","target":{"file":"net/netfilter/nf_tables_api.c"}},{"deprecated":false,"digest":{"function_hash":"168340156220359431405112956062707006222","length":3744},"id":"CVE-2025-38678-f2101811","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cf23d531a9d496863aa4c5a0e2f71f0a23f3df3c","target":{"file":"net/netfilter/nf_tables_api.c","function":"nf_tables_updchain"}},{"deprecated":false,"digest":{"function_hash":"226224202847471372663244540304647470955","length":1563},"id":"CVE-2025-38678-f566a2e7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f358a66a04513311668ea4b40f5064e253d8386","target":{"file":"net/netfilter/nf_tables_api.c","function":"nft_flowtable_update"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.8.0"},{"fixed":"6.6.117"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.59"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.16.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38678.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3f358a66a04513311668ea4b40f5064e253d8386"},{"type":"WEB","url":"https://git.kernel.org/stable/c/cf23d531a9d496863aa4c5a0e2f71f0a23f3df3c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/cf5fb87fcdaaaafec55dcc0dc5a9e15ead343973"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d7615bde541f16517d6790412da6ec46fa8a4c1f"}]}