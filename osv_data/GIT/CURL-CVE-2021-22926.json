{"schema_version":"1.7.3","id":"CURL-CVE-2021-22926","published":"2021-07-21T08:00:00Z","modified":"2025-05-15T17:48:29Z","aliases":["CVE-2021-22926"],"summary":"CURLOPT_SSLCERT mix-up with Secure Transport","details":"libcurl-using applications can ask for a specific client certificate to be\nused in a transfer. This is done with the `CURLOPT_SSLCERT` option (`--cert`\nwith the command line tool).\n\nWhen libcurl is built to use the macOS native TLS library Secure Transport, an\napplication can ask for the client certificate by name or with a filename -\nusing the same option. If the name exists as a file, it is used instead of by\nname.\n\nIf the application runs with a current working directory that is writable by\nother users (like `/tmp`), a malicious user can create a filename with the\nsame name as the app wants to use by name, and thereby trick the application\nto use the file based cert instead of the one referred to by name making\nlibcurl send the wrong client certificate in the TLS connection handshake.","affected":[{"ranges":[{"type":"SEMVER","events":[{"introduced":"7.33.0"},{"fixed":"7.78.0"}]},{"type":"GIT","repo":"https://github.com/curl/curl.git","events":[{"introduced":"d2fe616e7e44a106ac976aaeaa441ad7d8a6df11"},{"fixed":"fd9b40bf8dfd43edcbc0d254d613d95a11061c05"}]}],"versions":["7.77.0","7.76.1","7.76.0","7.75.0","7.74.0","7.73.0","7.72.0","7.71.1","7.71.0","7.70.0","7.69.1","7.69.0","7.68.0","7.67.0","7.66.0","7.65.3","7.65.2","7.65.1","7.65.0","7.64.1","7.64.0","7.63.0","7.62.0","7.61.1","7.61.0","7.60.0","7.59.0","7.58.0","7.57.0","7.56.1","7.56.0","7.55.1","7.55.0","7.54.1","7.54.0","7.53.1","7.53.0","7.52.1","7.52.0","7.51.0","7.50.3","7.50.2","7.50.1","7.50.0","7.49.1","7.49.0","7.48.0","7.47.1","7.47.0","7.46.0","7.45.0","7.44.0","7.43.0","7.42.1","7.42.0","7.41.0","7.40.0","7.39.0","7.38.0","7.37.1","7.37.0","7.36.0","7.35.0","7.34.0","7.33.0"],"database_specific":{"source":"https://curl.se/docs/CURL-CVE-2021-22926.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"50760517223061331200928131146422575246","length":12137},"id":"CURL-CVE-2021-22926-292343eb","signature_type":"Function","signature_version":"v1","source":"https://github.com/curl/curl.git/commit/fd9b40bf8dfd43edcbc0d254d613d95a11061c05","target":{"file":"lib/vtls/sectransp.c","function":"sectransp_connect_step1"}},{"deprecated":false,"digest":{"line_hashes":["192283166299572507601265318462471602130","21952855095426886863784777331739398044","160875071017199369629992802339244690277","56870982569501053391299432125089775178","36435177246022672986978296954405104693","238453418670072233906169280792772510487","146081305432022034721177585505246444046","228851482163941776778013998496907722006","16736639511320164785731060843641569230","61876149141665428528954089617930770726","125924822503775260699251428776708007520","42884451666158850921954365876992980326","228949830013381988088326695612983238619","61781359480644259095256195961400172422","320813680591515438972567928056881843986","275179433578983221204493654131863577640","227810247182370533975229555319695416920","144778588590939493483980103684667691879","5272049636403864611525292739302973151","335448473448898450583551056141703431702"],"threshold":0.9},"id":"CURL-CVE-2021-22926-3575e808","signature_type":"Line","signature_version":"v1","source":"https://github.com/curl/curl.git/commit/fd9b40bf8dfd43edcbc0d254d613d95a11061c05","target":{"file":"lib/vtls/sectransp.c"}}]}}],"database_specific":{"CWE":{"desc":"Improper Certificate Validation","id":"CWE-295"},"URL":"https://curl.se/docs/CVE-2021-22926.json","affects":"both","award":{"amount":"1000","currency":"USD"},"issue":"https://hackerone.com/reports/1234760","last_affected":"7.77.0","package":"curl","severity":"Medium","www":"https://curl.se/docs/CVE-2021-22926.html"},"credits":[{"name":"Harry Sintonen","type":"FINDER"},{"name":"Daniel Stenberg","type":"REMEDIATION_DEVELOPER"}]}