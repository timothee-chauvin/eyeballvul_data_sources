{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48976.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "140852861276320900984894617987119181650",
                "89138355823806123731198223427026145667",
                "320603951255612298455382746780566034659",
                "20522853448267872363043677655887384275",
                "176918338819092260877345577235835864379",
                "333163779547073556450763912550309703982",
                "114627425751648977957080063850155860762",
                "217262617278659392172290093487367047757",
                "89669225384264733110742968857993712190",
                "1783173722927407331608459354400359337"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48976-87f4b33d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a220a11fda012fba506b35929672374c2723ae6d",
            "target": {
              "file": "net/netfilter/nf_flow_table_offload.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "140852861276320900984894617987119181650",
                "89138355823806123731198223427026145667",
                "320603951255612298455382746780566034659",
                "20522853448267872363043677655887384275",
                "176918338819092260877345577235835864379",
                "333163779547073556450763912550309703982",
                "114627425751648977957080063850155860762",
                "217262617278659392172290093487367047757",
                "89669225384264733110742968857993712190",
                "1783173722927407331608459354400359337"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48976-fd7683ad",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a81047154e7ce4eb8769d5d21adcbc9693542a79",
            "target": {
              "file": "net/netfilter/nf_flow_table_offload.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "b038177636f83bbf87c2b238706474145dd2cd04"
            },
            {
              "fixed": "a220a11fda012fba506b35929672374c2723ae6d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "b038177636f83bbf87c2b238706474145dd2cd04"
            },
            {
              "fixed": "a81047154e7ce4eb8769d5d21adcbc9693542a79"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "5345d78ae64d5a760c211cd2da995dc71c5b29e4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.15.157",
        "v5.15.158",
        "v5.15.159",
        "v5.15.160",
        "v5.15.161",
        "v5.15.162",
        "v5.15.163",
        "v5.15.164",
        "v5.15.165",
        "v5.15.166",
        "v5.15.167",
        "v5.15.168",
        "v5.15.169",
        "v5.15.170",
        "v5.15.171",
        "v5.15.172",
        "v5.15.173",
        "v5.15.174",
        "v5.15.175",
        "v5.15.176",
        "v5.15.177",
        "v5.15.178",
        "v5.15.179",
        "v5.15.180",
        "v5.15.181",
        "v5.15.182",
        "v5.15.183",
        "v5.15.184",
        "v5.15.185",
        "v5.15.186",
        "v5.15.187",
        "v5.15.188",
        "v5.15.189",
        "v5.15.190",
        "v5.15.191",
        "v5.15.192",
        "v5.15.193",
        "v5.15.194",
        "v5.19",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.0.1",
        "v6.0.10",
        "v6.0.11",
        "v6.0.12",
        "v6.0.2",
        "v6.0.3",
        "v6.0.4",
        "v6.0.5",
        "v6.0.6",
        "v6.0.7",
        "v6.0.8",
        "v6.0.9",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48976.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.0.0"
            },
            {
              "fixed": "6.0.13"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: flowtable_offload: fix using __this_cpu_add in preemptible\n\nflow_offload_queue_work() can be called in workqueue without\nbh disabled, like the call trace showed in my act_ct testing,\ncalling NF_FLOW_TABLE_STAT_INC() there would cause a call\ntrace:\n\n  BUG: using __this_cpu_add() in preemptible [00000000] code: kworker/u4:0/138560\n  caller is flow_offload_queue_work+0xec/0x1b0 [nf_flow_table]\n  Workqueue: act_ct_workqueue tcf_ct_flow_table_cleanup_work [act_ct]\n  Call Trace:\n   <TASK>\n   dump_stack_lvl+0x33/0x46\n   check_preemption_disabled+0xc3/0xf0\n   flow_offload_queue_work+0xec/0x1b0 [nf_flow_table]\n   nf_flow_table_iterate+0x138/0x170 [nf_flow_table]\n   nf_flow_table_free+0x140/0x1a0 [nf_flow_table]\n   tcf_ct_flow_table_cleanup_work+0x2f/0x2b0 [act_ct]\n   process_one_work+0x6a3/0x1030\n   worker_thread+0x8a/0xdf0\n\nThis patch fixes it by using NF_FLOW_TABLE_STAT_INC_ATOMIC()\ninstead in flow_offload_queue_work().\n\nNote that for FLOW_CLS_REPLACE branch in flow_offload_queue_work(),\nit may not be called in preemptible path, but it's good to use\nNF_FLOW_TABLE_STAT_INC_ATOMIC() for all cases in\nflow_offload_queue_work().",
  "id": "CVE-2022-48976",
  "modified": "2025-10-14T21:00:11.048637Z",
  "published": "2024-10-21T20:05:55Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/a220a11fda012fba506b35929672374c2723ae6d"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/a81047154e7ce4eb8769d5d21adcbc9693542a79"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "netfilter: flowtable_offload: fix using __this_cpu_add in preemptible"
}