{"schema_version":"1.7.3","id":"CVE-2024-57839","published":"2025-01-11T14:30:56.149Z","modified":"2025-11-20T07:20:58.130718Z","related":["USN-7379-2","USN-7380-1"],"summary":"Revert \"readahead: properly shorten readahead when falling back to do_page_cache_ra()\"","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nRevert \"readahead: properly shorten readahead when falling back to do_page_cache_ra()\"\n\nThis reverts commit 7c877586da3178974a8a94577b6045a48377ff25.\n\nAnders and Philippe have reported that recent kernels occasionally hang\nwhen used with NFS in readahead code.  The problem has been bisected to\n7c877586da3 (\"readahead: properly shorten readahead when falling back to\ndo_page_cache_ra()\").  The cause of the problem is that ra->size can be\nshrunk by read_pages() call and subsequently we end up calling\ndo_page_cache_ra() with negative (read huge positive) number of pages. \nLet's revert 7c877586da3 for now until we can find a proper way how the\nlogic in read_pages() and page_cache_ra_order() can coexist.  This can\nlead to reduced readahead throughput due to readahead window confusion but\nthat's better than outright hangs.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"7c877586da3178974a8a94577b6045a48377ff25"},{"fixed":"85351e4941a253e4c50fb7048bfc19b60b4ec44b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"7c877586da3178974a8a94577b6045a48377ff25"},{"fixed":"a220d6b95b1ae12c7626283d7609f0a1438e6437"}]}],"versions":["v6.10","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.2","v6.12.3","v6.12.4","v6.13-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-57839.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"198234606380182611657510346382958069083","length":1295},"id":"CVE-2024-57839-57c45d05","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a220d6b95b1ae12c7626283d7609f0a1438e6437","target":{"file":"mm/readahead.c","function":"page_cache_ra_order"}},{"deprecated":false,"digest":{"function_hash":"198234606380182611657510346382958069083","length":1295},"id":"CVE-2024-57839-691aeee0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@85351e4941a253e4c50fb7048bfc19b60b4ec44b","target":{"file":"mm/readahead.c","function":"page_cache_ra_order"}},{"deprecated":false,"digest":{"line_hashes":["158145090315907449916485125421151609937","247627486976311198746769121109845201324","47739825099762897196441000999999408992","109650615006974517861194520492651148459","168005092857656977986898258775358732671","294065462601039655286626633833224720846","152921624023457681207735419945037774471","278267167218475496916706790605668461661","268543709691754535502510380956916457470"],"threshold":0.9},"id":"CVE-2024-57839-73d06620","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@85351e4941a253e4c50fb7048bfc19b60b4ec44b","target":{"file":"mm/readahead.c"}},{"deprecated":false,"digest":{"line_hashes":["158145090315907449916485125421151609937","247627486976311198746769121109845201324","47739825099762897196441000999999408992","109650615006974517861194520492651148459","168005092857656977986898258775358732671","294065462601039655286626633833224720846","152921624023457681207735419945037774471","278267167218475496916706790605668461661","268543709691754535502510380956916457470"],"threshold":0.9},"id":"CVE-2024-57839-7e6d71b1","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a220d6b95b1ae12c7626283d7609f0a1438e6437","target":{"file":"mm/readahead.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.12.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-57839.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/85351e4941a253e4c50fb7048bfc19b60b4ec44b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a220d6b95b1ae12c7626283d7609f0a1438e6437"}]}