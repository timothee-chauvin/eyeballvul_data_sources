{"schema_version":"1.7.3","id":"CVE-2022-48696","published":"2024-05-03T15:09:48.280Z","modified":"2025-11-19T11:51:35.281189Z","summary":"regmap: spi: Reserve space for register address/padding","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nregmap: spi: Reserve space for register address/padding\n\nCurrently the max_raw_read and max_raw_write limits in regmap_spi struct\ndo not take into account the additional size of the transmitted register\naddress and padding.  This may result in exceeding the maximum permitted\nSPI message size, which could cause undefined behaviour, e.g. data\ncorruption.\n\nFix regmap_get_spi_bus() to properly adjust the above mentioned limits\nby reserving space for the register address/padding as set in the regmap\nconfiguration.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f231ff38b7b23197013b437128d196710fe282da"},{"fixed":"15ff1f17847c19174b260bd7dd0de33edcebd45e"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f231ff38b7b23197013b437128d196710fe282da"},{"fixed":"f5723cfc01932c7a8d5c78dbf7e067e537c91439"}]}],"versions":["v5.15","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.19.1","v5.19.2","v5.19.3","v5.19.4","v5.19.5","v5.19.6","v5.19.7","v5.19.8","v6.0-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48696.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["89786450373559170765555596140282556159","166032335324344012699678366074307438617","314950998766389077709093298915932107074","316694608058923570923143836421109518854","217186520193095339780537574757944102160","100198599290620638755979954520213619315","180617422174047847310957890764351001237","105751823777395849012203759665067531148","320444964037305280389181659858725274851","167299330855302389929938857587417743516"],"threshold":0.9},"id":"CVE-2022-48696-0a53c427","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@15ff1f17847c19174b260bd7dd0de33edcebd45e","target":{"file":"drivers/base/regmap/regmap-spi.c"}},{"deprecated":false,"digest":{"function_hash":"263137818584058934185281194183686917502","length":378},"id":"CVE-2022-48696-4cfea3e6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f5723cfc01932c7a8d5c78dbf7e067e537c91439","target":{"file":"drivers/base/regmap/regmap-spi.c","function":"regmap_get_spi_bus"}},{"deprecated":false,"digest":{"function_hash":"263137818584058934185281194183686917502","length":378},"id":"CVE-2022-48696-516cdeed","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@15ff1f17847c19174b260bd7dd0de33edcebd45e","target":{"file":"drivers/base/regmap/regmap-spi.c","function":"regmap_get_spi_bus"}},{"deprecated":false,"digest":{"line_hashes":["89786450373559170765555596140282556159","166032335324344012699678366074307438617","314950998766389077709093298915932107074","316694608058923570923143836421109518854","217186520193095339780537574757944102160","100198599290620638755979954520213619315","180617422174047847310957890764351001237","105751823777395849012203759665067531148","320444964037305280389181659858725274851","167299330855302389929938857587417743516"],"threshold":0.9},"id":"CVE-2022-48696-8e9ee4b7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f5723cfc01932c7a8d5c78dbf7e067e537c91439","target":{"file":"drivers/base/regmap/regmap-spi.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.19.9"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48696.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/15ff1f17847c19174b260bd7dd0de33edcebd45e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f5723cfc01932c7a8d5c78dbf7e067e537c91439"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"}]}