{"schema_version":"1.7.3","id":"CVE-2021-29512","published":"2021-05-14T19:15:07Z","modified":"2025-10-21T06:24:18.088918Z","aliases":["BIT-tensorflow-2021-29512","GHSA-4278-2v5v-65r4","PYSEC-2021-149","PYSEC-2021-440","PYSEC-2021-638"],"related":["GHSA-4278-2v5v-65r4"],"details":"TensorFlow is an end-to-end open source platform for machine learning. If the `splits` argument of `RaggedBincount` does not specify a valid `SparseTensor`(https://www.tensorflow.org/api_docs/python/tf/sparse/SparseTensor), then an attacker can trigger a heap buffer overflow. This will cause a read from outside the bounds of the `splits` tensor buffer in the implementation of the `RaggedBincount` op(https://github.com/tensorflow/tensorflow/blob/8b677d79167799f71c42fd3fa074476e0295413a/tensorflow/core/kernels/bincount_op.cc#L430-L433). Before the `for` loop, `batch_idx` is set to 0. The user controls the `splits` array, making it contain only one element, 0. Thus, the code in the `while` loop would increment `batch_idx` and then try to read `splits(1)`, which is outside of bounds. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2 and TensorFlow 2.3.3, as these are also affected.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/tensorflow/tensorflow","events":[{"introduced":"0"},{"fixed":"eebb96c2830d48597d055d247c0e9aebaea94cd5"}]}],"versions":["0.12.0-rc0","0.12.0-rc1","0.12.1","0.5.0","0.6.0","v0.10.0","v0.10.0rc0","v0.11.0","v0.11.0rc0","v0.11.0rc1","v0.11.0rc2","v0.12.0","v0.7.0","v0.7.1","v0.8.0rc0","v0.9.0","v0.9.0rc0","v1.0.0","v1.0.0-alpha","v1.0.0-rc0","v1.0.0-rc1","v1.0.0-rc2","v1.1.0","v1.1.0-rc0","v1.1.0-rc1","v1.1.0-rc2","v1.12.0","v1.12.0-rc0","v1.12.0-rc1","v1.12.0-rc2","v1.12.1","v1.2.0","v1.2.0-rc0","v1.2.0-rc1","v1.2.0-rc2","v1.3.0-rc0","v1.3.0-rc1","v1.5.0","v1.5.0-rc0","v1.5.0-rc1","v1.6.0","v1.6.0-rc0","v1.6.0-rc1","v1.7.0","v1.7.0-rc0","v1.7.0-rc1","v1.8.0","v1.8.0-rc0","v1.8.0-rc1","v1.9.0","v1.9.0-rc0","v1.9.0-rc1","v1.9.0-rc2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-29512.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["50071248545797929442961525939004416823","313533363499102381398855757400300590347","34732738541755971658578122202906975538"],"threshold":0.9},"id":"CVE-2021-29512-e78c135e","signature_type":"Line","signature_version":"v1","source":"https://github.com/tensorflow/tensorflow/commit/eebb96c2830d48597d055d247c0e9aebaea94cd5","target":{"file":"tensorflow/core/kernels/bincount_op.cc"}}]}}],"references":[{"type":"FIX","url":"https://github.com/tensorflow/tensorflow/commit/eebb96c2830d48597d055d247c0e9aebaea94cd5"},{"type":"FIX","url":"https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4278-2v5v-65r4"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}