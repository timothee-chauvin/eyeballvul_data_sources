{"schema_version":"1.7.3","id":"CVE-2023-52455","published":"2024-02-23T14:46:18Z","modified":"2025-10-21T14:17:21.699484Z","related":["USN-6765-1","USN-6818-2","USN-6819-2"],"summary":"iommu: Don't reserve 0-length IOVA region","details":"In the Linux kernel, the following vulnerability has been resolved:\n\niommu: Don't reserve 0-length IOVA region\n\nWhen the bootloader/firmware doesn't setup the framebuffers, their\naddress and size are 0 in \"iommu-addresses\" property. If IOVA region is\nreserved with 0 length, then it ends up corrupting the IOVA rbtree with\nan entry which has pfn_hi < pfn_lo.\nIf we intend to use display driver in kernel without framebuffer then\nit's causing the display IOMMU mappings to fail as entire valid IOVA\nspace is reserved when address and length are passed as 0.\nAn ideal solution would be firmware removing the \"iommu-addresses\"\nproperty and corresponding \"memory-region\" if display is not present.\nBut the kernel should be able to handle this by checking for size of\nIOVA region and skipping the IOVA reservation if size is 0. Also, add\na warning if firmware is requesting 0-length IOVA region reservation.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a5bf3cfce8cb77d9d24613ab52d520896f83dd48"},{"fixed":"98b8a550da83cc392a14298c4b3eaaf0332ae6ad"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a5bf3cfce8cb77d9d24613ab52d520896f83dd48"},{"fixed":"5e23e283910c9f30248732ae0770bcb0c9438abf"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a5bf3cfce8cb77d9d24613ab52d520896f83dd48"},{"fixed":"bb57f6705960bebeb832142ce9abf43220c3eab1"}]}],"versions":["v6.2","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.2","v6.6.3","v6.6.4","v6.6.5","v6.6.6","v6.6.7","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.7.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52455.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["11422911723715983063687084984174408170","260041912613059797869264919054149295438","126381895853040639734137157742551841919","182289715756828101756102850620699082893"],"threshold":0.9},"id":"CVE-2023-52455-4778fb6f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5e23e283910c9f30248732ae0770bcb0c9438abf","target":{"file":"drivers/iommu/of_iommu.c"}},{"deprecated":false,"digest":{"line_hashes":["11422911723715983063687084984174408170","260041912613059797869264919054149295438","126381895853040639734137157742551841919","182289715756828101756102850620699082893"],"threshold":0.9},"id":"CVE-2023-52455-622638f6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bb57f6705960bebeb832142ce9abf43220c3eab1","target":{"file":"drivers/iommu/of_iommu.c"}},{"deprecated":false,"digest":{"line_hashes":["11422911723715983063687084984174408170","260041912613059797869264919054149295438","126381895853040639734137157742551841919","182289715756828101756102850620699082893"],"threshold":0.9},"id":"CVE-2023-52455-a490cc16","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@98b8a550da83cc392a14298c4b3eaaf0332ae6ad","target":{"file":"drivers/iommu/of_iommu.c"}},{"deprecated":false,"digest":{"function_hash":"308156761060002293492477580207011626455","length":1116},"id":"CVE-2023-52455-b02a969f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bb57f6705960bebeb832142ce9abf43220c3eab1","target":{"file":"drivers/iommu/of_iommu.c","function":"of_iommu_get_resv_regions"}},{"deprecated":false,"digest":{"function_hash":"308156761060002293492477580207011626455","length":1116},"id":"CVE-2023-52455-d342459e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5e23e283910c9f30248732ae0770bcb0c9438abf","target":{"file":"drivers/iommu/of_iommu.c","function":"of_iommu_get_resv_regions"}},{"deprecated":false,"digest":{"function_hash":"308156761060002293492477580207011626455","length":1116},"id":"CVE-2023-52455-e1912044","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@98b8a550da83cc392a14298c4b3eaaf0332ae6ad","target":{"file":"drivers/iommu/of_iommu.c","function":"of_iommu_get_resv_regions"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.3.0"},{"fixed":"6.6.14"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.7.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52455.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/5e23e283910c9f30248732ae0770bcb0c9438abf"},{"type":"WEB","url":"https://git.kernel.org/stable/c/98b8a550da83cc392a14298c4b3eaaf0332ae6ad"},{"type":"WEB","url":"https://git.kernel.org/stable/c/bb57f6705960bebeb832142ce9abf43220c3eab1"}]}