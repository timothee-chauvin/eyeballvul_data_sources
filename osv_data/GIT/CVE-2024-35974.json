{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35974.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "126764970845151482029484623638006998961",
              "length": 1239.0
            },
            "id": "CVE-2024-35974-1c51e894",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@740ffad95ca8033bd6e080ed337655b13b4d38ac",
            "target": {
              "file": "block/blk-core.c",
              "function": "blk_alloc_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "16260782891073719589434608494790514278",
                "256741904419251366445204862144230398731",
                "315857639493178628511885193964043897614",
                "222195688450484973857712535247859222676",
                "251299732093782689849211820390885832138",
                "25927117235970286950090734467688989820",
                "187273932822995962505409879730106739953"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-3567f870",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@858c489d81d659af17a4d11cfaad2afb42e47a76",
            "target": {
              "file": "block/blk-cgroup.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "43969370196622922106649879461077675484",
                "168767820656535493732545948241826803792",
                "333457103013751317048889754074615846163",
                "219821859967856805460901439102148548235",
                "195988428797069184694822941024593587505",
                "201778085072629434621179294199845896456",
                "294592167801941157723537884544258978619",
                "25614656919621467200623184082391290041"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-4cf5d981",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@740ffad95ca8033bd6e080ed337655b13b4d38ac",
            "target": {
              "file": "block/blk-cgroup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "43969370196622922106649879461077675484",
                "168767820656535493732545948241826803792",
                "333457103013751317048889754074615846163",
                "219821859967856805460901439102148548235",
                "195988428797069184694822941024593587505",
                "201778085072629434621179294199845896456",
                "294592167801941157723537884544258978619",
                "25614656919621467200623184082391290041"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-6cf63b77",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@858c489d81d659af17a4d11cfaad2afb42e47a76",
            "target": {
              "file": "block/blk-cgroup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "223747234945151243727631368258223554233",
                "235334855121032670028905892797337394097",
                "202453968232327200615399882372973356137"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-7a0e8754",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@740ffad95ca8033bd6e080ed337655b13b4d38ac",
            "target": {
              "file": "block/blk-core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "16260782891073719589434608494790514278",
                "256741904419251366445204862144230398731",
                "315857639493178628511885193964043897614",
                "222195688450484973857712535247859222676",
                "251299732093782689849211820390885832138",
                "25927117235970286950090734467688989820",
                "187273932822995962505409879730106739953"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-7d27a786",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@740ffad95ca8033bd6e080ed337655b13b4d38ac",
            "target": {
              "file": "block/blk-cgroup.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "223747234945151243727631368258223554233",
                "235334855121032670028905892797337394097",
                "202453968232327200615399882372973356137"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-9a4c4c4e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@858c489d81d659af17a4d11cfaad2afb42e47a76",
            "target": {
              "file": "block/blk-core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "16260782891073719589434608494790514278",
                "256741904419251366445204862144230398731",
                "315857639493178628511885193964043897614",
                "222195688450484973857712535247859222676",
                "251299732093782689849211820390885832138",
                "25927117235970286950090734467688989820",
                "187273932822995962505409879730106739953"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-9d454b81",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8b8ace080319a866f5dfe9da8e665ae51d971c54",
            "target": {
              "file": "block/blk-cgroup.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "49206213139340311938544254957921670616",
              "length": 838.0
            },
            "id": "CVE-2024-35974-aedf4d32",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8b8ace080319a866f5dfe9da8e665ae51d971c54",
            "target": {
              "file": "block/blk-cgroup.c",
              "function": "blkcg_init_disk"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "49206213139340311938544254957921670616",
              "length": 838.0
            },
            "id": "CVE-2024-35974-af2ce290",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@858c489d81d659af17a4d11cfaad2afb42e47a76",
            "target": {
              "file": "block/blk-cgroup.c",
              "function": "blkcg_init_disk"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "49206213139340311938544254957921670616",
              "length": 838.0
            },
            "id": "CVE-2024-35974-bf744748",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@740ffad95ca8033bd6e080ed337655b13b4d38ac",
            "target": {
              "file": "block/blk-cgroup.c",
              "function": "blkcg_init_disk"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "126764970845151482029484623638006998961",
              "length": 1239.0
            },
            "id": "CVE-2024-35974-c0ccd1de",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@858c489d81d659af17a4d11cfaad2afb42e47a76",
            "target": {
              "file": "block/blk-core.c",
              "function": "blk_alloc_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "232434367024172212484859250869982451710",
                "145647504739590385530218582556611988588",
                "142547520740885287668731917547503467335"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-c6b18561",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8b8ace080319a866f5dfe9da8e665ae51d971c54",
            "target": {
              "file": "block/blk-core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "122362775645666786330637689423308016646",
              "length": 1438.0
            },
            "id": "CVE-2024-35974-d3bdac47",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8b8ace080319a866f5dfe9da8e665ae51d971c54",
            "target": {
              "file": "block/blk-core.c",
              "function": "blk_alloc_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "43969370196622922106649879461077675484",
                "168767820656535493732545948241826803792",
                "333457103013751317048889754074615846163",
                "219821859967856805460901439102148548235",
                "195988428797069184694822941024593587505",
                "201778085072629434621179294199845896456",
                "294592167801941157723537884544258978619",
                "25614656919621467200623184082391290041"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35974-e22fc58e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8b8ace080319a866f5dfe9da8e665ae51d971c54",
            "target": {
              "file": "block/blk-cgroup.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "1059699f87eb0b3aa9d574b91a572d534897134a"
            },
            {
              "fixed": "740ffad95ca8033bd6e080ed337655b13b4d38ac"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "1059699f87eb0b3aa9d574b91a572d534897134a"
            },
            {
              "fixed": "858c489d81d659af17a4d11cfaad2afb42e47a76"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "1059699f87eb0b3aa9d574b91a572d534897134a"
            },
            {
              "fixed": "8b8ace080319a866f5dfe9da8e665ae51d971c54"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.17",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4",
        "v6.8.5",
        "v6.8.6",
        "v6.9-rc1",
        "v6.9-rc2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35974.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "6.6.28"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.8.7"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nblock: fix q->blkg_list corruption during disk rebind\n\nMultiple gendisk instances can allocated/added for single request queue\nin case of disk rebind. blkg may still stay in q->blkg_list when calling\nblkcg_init_disk() for rebind, then q->blkg_list becomes corrupted.\n\nFix the list corruption issue by:\n\n- add blkg_init_queue() to initialize q->blkg_list & q->blkcg_mutex only\n- move calling blkg_init_queue() into blk_alloc_queue()\n\nThe list corruption should be started since commit f1c006f1c685 (\"blk-cgroup:\nsynchronize pd_free_fn() from blkg_free_workfn() and blkcg_deactivate_policy()\")\nwhich delays removing blkg from q->blkg_list into blkg_free_workfn().",
  "id": "CVE-2024-35974",
  "modified": "2025-10-15T11:05:01.136851Z",
  "published": "2024-05-20T09:42:01Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/740ffad95ca8033bd6e080ed337655b13b4d38ac"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/858c489d81d659af17a4d11cfaad2afb42e47a76"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8b8ace080319a866f5dfe9da8e665ae51d971c54"
    }
  ],
  "related": [
    "SUSE-SU-2024:2135-1",
    "SUSE-SU-2024:2203-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "summary": "block: fix q->blkg_list corruption during disk rebind"
}