{"schema_version":"1.7.3","id":"CVE-2022-49894","published":"2025-05-01T14:10:37Z","modified":"2025-10-21T11:20:35.798975Z","summary":"cxl/region: Fix region HPA ordering validation","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ncxl/region: Fix region HPA ordering validation\n\nSome regions may not have any address space allocated. Skip them when\nvalidating HPA order otherwise a crash like the following may result:\n\n devm_cxl_add_region: cxl_acpi cxl_acpi.0: decoder3.4: created region9\n BUG: kernel NULL pointer dereference, address: 0000000000000000\n [..]\n RIP: 0010:store_targetN+0x655/0x1740 [cxl_core]\n [..]\n Call Trace:\n  <TASK>\n  kernfs_fop_write_iter+0x144/0x200\n  vfs_write+0x24a/0x4d0\n  ksys_write+0x69/0xf0\n  do_syscall_64+0x3a/0x90\n\nstore_targetN+0x655/0x1740:\nalloc_region_ref at drivers/cxl/core/region.c:676\n(inlined by) cxl_port_attach_region at drivers/cxl/core/region.c:850\n(inlined by) cxl_region_attach at drivers/cxl/core/region.c:1290\n(inlined by) attach_target at drivers/cxl/core/region.c:1410\n(inlined by) store_targetN at drivers/cxl/core/region.c:1453","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"384e624bb211b406db40edc900bb51af8bb267d0"},{"fixed":"12316b9f7c18138ae656050cfd716728e27b7e2f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"384e624bb211b406db40edc900bb51af8bb267d0"},{"fixed":"a90accb358ae33ea982a35595573f7a045993f8b"}]}],"versions":["v5.19","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.1-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49894.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["116096487586774575592447200052644284226","294851709607627824392127745382629423184","202098278793193884605262936899086929317"],"threshold":0.9},"id":"CVE-2022-49894-192f98f1","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@12316b9f7c18138ae656050cfd716728e27b7e2f","target":{"file":"drivers/cxl/core/region.c"}},{"deprecated":false,"digest":{"function_hash":"224658335636933940160965125101092533301","length":966},"id":"CVE-2022-49894-34d6dfa2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a90accb358ae33ea982a35595573f7a045993f8b","target":{"file":"drivers/cxl/core/region.c","function":"alloc_region_ref"}},{"deprecated":false,"digest":{"function_hash":"224658335636933940160965125101092533301","length":966},"id":"CVE-2022-49894-42001ff3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@12316b9f7c18138ae656050cfd716728e27b7e2f","target":{"file":"drivers/cxl/core/region.c","function":"alloc_region_ref"}},{"deprecated":false,"digest":{"line_hashes":["116096487586774575592447200052644284226","294851709607627824392127745382629423184","202098278793193884605262936899086929317"],"threshold":0.9},"id":"CVE-2022-49894-d0924398","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a90accb358ae33ea982a35595573f7a045993f8b","target":{"file":"drivers/cxl/core/region.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.0.0"},{"fixed":"6.0.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49894.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/12316b9f7c18138ae656050cfd716728e27b7e2f"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a90accb358ae33ea982a35595573f7a045993f8b"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}