{
  "id": "CVE-2023-46139",
  "details": "KernelSU is a Kernel based root solution for Android. Starting in version 0.6.1 and prior to version 0.7.0, if a KernelSU installed device is infected with a malware whose app signing block specially constructed, it can take over root privileges on the device. The vulnerable verification logic actually obtains the signature of the last block with an id of `0x7109871a`, while the verification logic during Android installation is to obtain the first one. In addition to the actual signature upgrade that has been fixed (KSU thought it was V2 but was actually V3), there is also the problem of actual signature downgrading (KSU thought it was V2 but was actually V1). Find a condition in the signature verification logic that will cause the signature not to be found error, and KernelSU does not implement the same conditions, so KSU thinks there is a V2 signature, but the APK signature verification actually uses the V1 signature. This issue is fixed in version 0.7.0. As workarounds, keep the KernelSU manager installed and avoid installing unknown apps.",
  "modified": "2025-01-15T04:59:43.368508Z",
  "published": "2023-10-31T00:15:10Z",
  "related": [
    "GHSA-86cp-3prf-pwqq"
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/tiann/KernelSU/security/advisories/GHSA-86cp-3prf-pwqq"
    },
    {
      "type": "FIX",
      "url": "https://github.com/tiann/KernelSU/commit/d24813b2c3738f2f9bd762932141cadd948c354f"
    },
    {
      "type": "WEB",
      "url": "http://aospxref.com/android-14.0.0_r2/xref/frameworks/base/core/java/android/util/apk/ApkSigningBlockUtils.java#770"
    },
    {
      "type": "WEB",
      "url": "http://aospxref.com/android-14.0.0_r2/xref/frameworks/base/core/java/android/util/apk/ApkSigningBlockUtils.java#783"
    },
    {
      "type": "WEB",
      "url": "https://drive.google.com/drive/folders/1XdYCCAhC_mkt1k1IyUiwcgFsuOFvwNRl"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tiann/KernelSU/blob/344c08bb79ba12b692016750cda363f9f3500182/kernel/apk_sign.c#L179C32-L179C32"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tiann/KernelSU/blob/344c08bb79ba12b692016750cda363f9f3500182/kernel/apk_sign.c#L188"
    }
  ],
  "affected": [
    {
      "ranges": [
        {
          "type": "GIT",
          "repo": "https://github.com/tiann/kernelsu",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "d24813b2c3738f2f9bd762932141cadd948c354f"
            },
            {
              "fixed": "d24813b2c3738f2f9bd762932141cadd948c354f"
            }
          ]
        }
      ],
      "versions": [
        "v0.1.3",
        "v0.3.0",
        "v0.3.2",
        "v0.3.3",
        "v0.3.4",
        "v0.3.5",
        "v0.3.6",
        "v0.3.7",
        "v0.3.8",
        "v0.3.9",
        "v0.4.0",
        "v0.4.1",
        "v0.5.0",
        "v0.5.1",
        "v0.5.2",
        "v0.5.3",
        "v0.5.4",
        "v0.5.5",
        "v0.5.6",
        "v0.5.7",
        "v0.6.0",
        "v0.6.1",
        "v0.6.2",
        "v0.6.6",
        "v0.6.7",
        "v0.6.8",
        "v0.6.9"
      ],
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-46139.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L"
    }
  ]
}