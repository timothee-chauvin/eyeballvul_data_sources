{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53478.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "302487731368266615539867243618635764502",
              "length": 142.0
            },
            "id": "CVE-2023-53478-2bd77fc1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9fe183f659a2704255e5d84f6ae308c234a113ec",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "last_cmd_set"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "118620775649178849896158851293545117224",
              "length": 161.0
            },
            "id": "CVE-2023-53478-2fcc423b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8826d9e7bd51e7656f78baa4472e8e2f5e7069f0",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "synth_err"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "92850412129104987015099411331952895599",
                "165005246664070776807098905293713831159",
                "292519939345712027778389465469905739954",
                "91153908318904727760157769751274378078",
                "296235107415488729234313630709947792854",
                "162757171323243692000566060905598272447",
                "267066829945648729621405976437925593147",
                "270918106906758234200124924502183731404",
                "251066093287963977872889819434157884967",
                "338322628857661982535413396047372544662",
                "16425393630842113231620809586384698107",
                "34654258916396493672402370444753184444",
                "46468557650695179945949337350722003911",
                "189269020545247190145903352977732664239",
                "13235486646121902326015609649411330638",
                "330982690795928318702517253294254315438",
                "71870253550897180867119339056821179022",
                "161932610026308848982081845901383092770",
                "331739627609477154755808235366103655553",
                "27972197432190038832884499481326673350",
                "108505066455300003407993175980589249839"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53478-46ce7ec1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8826d9e7bd51e7656f78baa4472e8e2f5e7069f0",
            "target": {
              "file": "kernel/trace/trace_events_synth.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "92850412129104987015099411331952895599",
                "165005246664070776807098905293713831159",
                "292519939345712027778389465469905739954",
                "91153908318904727760157769751274378078",
                "296235107415488729234313630709947792854",
                "162757171323243692000566060905598272447",
                "267066829945648729621405976437925593147",
                "270918106906758234200124924502183731404",
                "251066093287963977872889819434157884967",
                "338322628857661982535413396047372544662",
                "16425393630842113231620809586384698107",
                "34654258916396493672402370444753184444",
                "46468557650695179945949337350722003911",
                "189269020545247190145903352977732664239",
                "13235486646121902326015609649411330638",
                "330982690795928318702517253294254315438",
                "71870253550897180867119339056821179022",
                "161932610026308848982081845901383092770",
                "331739627609477154755808235366103655553",
                "27972197432190038832884499481326673350",
                "108505066455300003407993175980589249839"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53478-767d8e3d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4ccf11c4e8a8e051499d53a12f502196c97a758e",
            "target": {
              "file": "kernel/trace/trace_events_synth.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "118620775649178849896158851293545117224",
              "length": 161.0
            },
            "id": "CVE-2023-53478-8c9478bd",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4ccf11c4e8a8e051499d53a12f502196c97a758e",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "synth_err"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "277187665332593400489367285897918692613",
              "length": 128.0
            },
            "id": "CVE-2023-53478-94e5d46e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8826d9e7bd51e7656f78baa4472e8e2f5e7069f0",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "errpos"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "277187665332593400489367285897918692613",
              "length": 128.0
            },
            "id": "CVE-2023-53478-b044d037",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4ccf11c4e8a8e051499d53a12f502196c97a758e",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "errpos"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "118620775649178849896158851293545117224",
              "length": 161.0
            },
            "id": "CVE-2023-53478-b506221b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9fe183f659a2704255e5d84f6ae308c234a113ec",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "synth_err"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "92850412129104987015099411331952895599",
                "165005246664070776807098905293713831159",
                "292519939345712027778389465469905739954",
                "91153908318904727760157769751274378078",
                "296235107415488729234313630709947792854",
                "162757171323243692000566060905598272447",
                "267066829945648729621405976437925593147",
                "270918106906758234200124924502183731404",
                "251066093287963977872889819434157884967",
                "338322628857661982535413396047372544662",
                "16425393630842113231620809586384698107",
                "34654258916396493672402370444753184444",
                "46468557650695179945949337350722003911",
                "189269020545247190145903352977732664239",
                "13235486646121902326015609649411330638",
                "330982690795928318702517253294254315438",
                "71870253550897180867119339056821179022",
                "161932610026308848982081845901383092770",
                "331739627609477154755808235366103655553",
                "27972197432190038832884499481326673350",
                "108505066455300003407993175980589249839"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53478-d8b4d0f3",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9fe183f659a2704255e5d84f6ae308c234a113ec",
            "target": {
              "file": "kernel/trace/trace_events_synth.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "277187665332593400489367285897918692613",
              "length": 128.0
            },
            "id": "CVE-2023-53478-e2506043",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9fe183f659a2704255e5d84f6ae308c234a113ec",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "errpos"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "302487731368266615539867243618635764502",
              "length": 142.0
            },
            "id": "CVE-2023-53478-ed06a00c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4ccf11c4e8a8e051499d53a12f502196c97a758e",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "last_cmd_set"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "302487731368266615539867243618635764502",
              "length": 142.0
            },
            "id": "CVE-2023-53478-fc5d19b1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8826d9e7bd51e7656f78baa4472e8e2f5e7069f0",
            "target": {
              "file": "kernel/trace/trace_events_synth.c",
              "function": "last_cmd_set"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "27c888da9867725784bad3d6455d6e53b425fa2b"
            },
            {
              "fixed": "9fe183f659a2704255e5d84f6ae308c234a113ec"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "27c888da9867725784bad3d6455d6e53b425fa2b"
            },
            {
              "fixed": "8826d9e7bd51e7656f78baa4472e8e2f5e7069f0"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "27c888da9867725784bad3d6455d6e53b425fa2b"
            },
            {
              "fixed": "4ccf11c4e8a8e051499d53a12f502196c97a758e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.17",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1",
        "v6.1.10",
        "v6.1.11",
        "v6.1.12",
        "v6.1.13",
        "v6.1.14",
        "v6.1.15",
        "v6.1.16",
        "v6.1.17",
        "v6.1.18",
        "v6.1.19",
        "v6.1.2",
        "v6.1.20",
        "v6.1.21",
        "v6.1.22",
        "v6.1.23",
        "v6.1.3",
        "v6.1.4",
        "v6.1.5",
        "v6.1.6",
        "v6.1.7",
        "v6.1.8",
        "v6.1.9",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.2.1",
        "v6.2.10",
        "v6.2.2",
        "v6.2.3",
        "v6.2.4",
        "v6.2.5",
        "v6.2.6",
        "v6.2.7",
        "v6.2.8",
        "v6.2.9",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53478.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "6.1.24"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.2.11"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracing/synthetic: Fix races on freeing last_cmd\n\nCurrently, the \"last_cmd\" variable can be accessed by multiple processes\nasynchronously when multiple users manipulate synthetic_events node\nat the same time, it could lead to use-after-free or double-free.\n\nThis patch add \"lastcmd_mutex\" to prevent \"last_cmd\" from being accessed\nasynchronously.\n\n================================================================\n\nIt's easy to reproduce in the KASAN environment by running the two\nscripts below in different shells.\n\nscript 1:\n        while :\n        do\n                echo -n -e '\\x88' > /sys/kernel/tracing/synthetic_events\n        done\n\nscript 2:\n        while :\n        do\n                echo -n -e '\\xb0' > /sys/kernel/tracing/synthetic_events\n        done\n\n================================================================\ndouble-free scenario:\n\n    process A                       process B\n-------------------               ---------------\n1.kstrdup last_cmd\n                                  2.free last_cmd\n3.free last_cmd(double-free)\n\n================================================================\nuse-after-free scenario:\n\n    process A                       process B\n-------------------               ---------------\n1.kstrdup last_cmd\n                                  2.free last_cmd\n3.tracing_log_err(use-after-free)\n\n================================================================\n\nAppendix 1. KASAN report double-free:\n\nBUG: KASAN: double-free in kfree+0xdc/0x1d4\nFree of addr ***** by task sh/4879\nCall trace:\n        ...\n        kfree+0xdc/0x1d4\n        create_or_delete_synth_event+0x60/0x1e8\n        trace_parse_run_command+0x2bc/0x4b8\n        synth_events_write+0x20/0x30\n        vfs_write+0x200/0x830\n        ...\n\nAllocated by task 4879:\n        ...\n        kstrdup+0x5c/0x98\n        create_or_delete_synth_event+0x6c/0x1e8\n        trace_parse_run_command+0x2bc/0x4b8\n        synth_events_write+0x20/0x30\n        vfs_write+0x200/0x830\n        ...\n\nFreed by task 5464:\n        ...\n        kfree+0xdc/0x1d4\n        create_or_delete_synth_event+0x60/0x1e8\n        trace_parse_run_command+0x2bc/0x4b8\n        synth_events_write+0x20/0x30\n        vfs_write+0x200/0x830\n        ...\n\n================================================================\nAppendix 2. KASAN report use-after-free:\n\nBUG: KASAN: use-after-free in strlen+0x5c/0x7c\nRead of size 1 at addr ***** by task sh/5483\nsh: CPU: 7 PID: 5483 Comm: sh\n        ...\n        __asan_report_load1_noabort+0x34/0x44\n        strlen+0x5c/0x7c\n        tracing_log_err+0x60/0x444\n        create_or_delete_synth_event+0xc4/0x204\n        trace_parse_run_command+0x2bc/0x4b8\n        synth_events_write+0x20/0x30\n        vfs_write+0x200/0x830\n        ...\n\nAllocated by task 5483:\n        ...\n        kstrdup+0x5c/0x98\n        create_or_delete_synth_event+0x80/0x204\n        trace_parse_run_command+0x2bc/0x4b8\n        synth_events_write+0x20/0x30\n        vfs_write+0x200/0x830\n        ...\n\nFreed by task 5480:\n        ...\n        kfree+0xdc/0x1d4\n        create_or_delete_synth_event+0x74/0x204\n        trace_parse_run_command+0x2bc/0x4b8\n        synth_events_write+0x20/0x30\n        vfs_write+0x200/0x830\n        ...",
  "id": "CVE-2023-53478",
  "modified": "2025-10-15T07:17:26.543561Z",
  "published": "2025-10-01T11:42:47Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/4ccf11c4e8a8e051499d53a12f502196c97a758e"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8826d9e7bd51e7656f78baa4472e8e2f5e7069f0"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9fe183f659a2704255e5d84f6ae308c234a113ec"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "tracing/synthetic: Fix races on freeing last_cmd"
}