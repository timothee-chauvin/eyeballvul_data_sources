{"schema_version":"1.7.3","id":"CVE-2022-31131","published":"2022-07-06T17:55:14Z","modified":"2025-11-04T20:02:13.926178Z","aliases":["GHSA-xhv7-5mhv-299j"],"summary":"Ownership check missing when updating or deleting mail attachments in Nextcloud mail","details":"Nextcloud mail is a Mail app for the Nextcloud home server product. Versions of Nextcloud mail prior to 1.12.2 were found to be missing user account ownership checks when performing tasks related to mail attachments. Attachments may have been exposed to incorrect system users. It is recommended that the Nextcloud Mail app is upgraded to 1.12.2. There are no known workarounds for this issue. ### Workarounds No workaround available ### References * [Pull request](https://github.com/nextcloud/mail/pull/6600) * [HackerOne](https://hackerone.com/reports/1579820) ### For more information If you have any questions or comments about this advisory: * Create a post in [nextcloud/security-advisories](https://github.com/nextcloud/security-advisories/discussions) * Customers: Open a support ticket at [support.nextcloud.com](https://support.nextcloud.com)","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/nextcloud/mail","events":[{"introduced":"0"},{"fixed":"cce35dbc01fd1e245b051e16bd02050f1b317549"}]}],"versions":["1.10.0-alpha.7","1.6.2","nighly-20170831","nightly-20161202","nightly-20161208","nightly-20161218","nightly-20170117","nightly-20170612","nightly-20170823","nightly-20170831","nightly-20170906","nightly-20170913","nightly-20171127","nightly-20171212","nightly-20180410","nightly-20200115","nightly-20200423","nightly-20200427","nightly-20200506","nightly-20200513","untagged-bd8a3cab1eb0022ec683","v0.1.0","v0.1.3","v0.10.0","v0.10.0-beta1","v0.10.0-rc1","v0.11.0","v0.11.0-beta1","v0.12.0","v0.12.0-RC1","v0.12.0-RC2","v0.12.0-RC3","v0.12.0-alpha-4","v0.12.0-alpha-5","v0.12.0-alpha1","v0.12.0-alpha2","v0.12.0-alpha3","v0.12.0-beta1","v0.12.0-beta2","v0.12.0-beta3","v0.12.0-beta4","v0.12.0-beta5","v0.13.0","v0.14.0","v0.15.0","v0.15.1","v0.15.2","v0.15.3","v0.15.4","v0.15.5","v0.16.0","v0.17.0","v0.18.0","v0.18.0-RC1","v0.18.1","v0.19.0","v0.19.1","v0.2.0","v0.20.0","v0.20.1","v0.20.2","v0.20.3","v0.21.0","v0.21.1","v0.3.0","v0.4.0","v0.4.1","v0.4.2","v0.4.3","v0.4.4","v0.5.0","v0.5.1","v0.5.2","v0.6.2","v0.7.0","v0.7.1","v0.7.10","v0.7.2","v0.7.3","v0.7.4","v0.7.5","v0.7.6","v0.7.7","v0.7.8","v0.7.9","v0.8.0","v0.8.0-alpha1","v0.8.0-beta1","v0.8.1","v0.8.2","v0.8.2-alpha2","v0.8.2-alpha3","v0.8.3","v0.8.3-alpha1","v0.9.0","v0.9.0-beta1","v0.9.0-beta2","v0.9.0-beta3","v0.9.0-rc1","v1.0.0","v1.1.0","v1.1.1","v1.1.2","v1.10.0-RC.1","v1.10.0-alpha.4","v1.10.0-alpha.6","v1.10.0-alpha.7","v1.11.0","v1.11.0-rc1","v1.12.0","v1.12.0-rc.1","v1.12.0-rc.2","v1.12.0-rc3","v1.12.1","v1.12.1-rc.1","v1.3.0","v1.3.0-RC1","v1.3.0-beta1","v1.3.0-beta2","v1.3.0-beta3","v1.3.1","v1.3.2","v1.3.3","v1.4.0-beta1","v1.4.0-beta2","v1.4.0-rc1","v1.5.0","v1.5.0-alpha3","v1.5.0-beta1","v1.5.0-beta2","v1.5.0-beta3","v1.5.0-rc1","v1.5.0-rc2","v1.6.0","v1.7.0","v1.8.0","v1.9.0","v1.9.0-alpha2","v1.9.0-alpha3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-31131.json"}}],"references":[{"type":"FIX","url":"https://github.com/nextcloud/mail/pull/6600"},{"type":"WEB","url":"https://github.com/nextcloud/mail/pull/6600/commits/6dd2527be8d4f6788b449c8a8f5577628b990605"},{"type":"ADVISORY","url":"https://github.com/nextcloud/security-advisories/security/advisories/GHSA-xhv7-5mhv-299j"}],"database_specific":{"cwe_ids":["CWE-287"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N"}]}