{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-2566.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "229648891667041450029361493606381806304",
                "135872466468465938462320271973817091921",
                "210085637948337441042887757423541642970",
                "86198498164871402896199974580337423354",
                "121449979526773324259872295402571671113",
                "50255533385114424664651841403325448377",
                "32389276260174103705251316886652202128",
                "319058207834156408004807609848915542153",
                "150489999679500154117254249613797223827",
                "280751541028273460609967900500999004211",
                "7058286243398018117911243721609085803",
                "212616978249885233513896020834881085416",
                "309461606343329441956372708679658228926",
                "16390099522419099115180149235540250455"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-2566-64df0c29",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/ffmpeg/ffmpeg/commit/c953baa084607dd1d84c3bfcce3cf6a87c3e6e05",
            "target": {
              "file": "libavformat/mov.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "143989625785103494375096093135229489196",
              "length": 1772.0
            },
            "id": "CVE-2022-2566-ffc21973",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/ffmpeg/ffmpeg/commit/c953baa084607dd1d84c3bfcce3cf6a87c3e6e05",
            "target": {
              "file": "libavformat/mov.c",
              "function": "build_open_gop_key_points"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "c953baa084607dd1d84c3bfcce3cf6a87c3e6e05"
            }
          ],
          "repo": "https://github.com/ffmpeg/ffmpeg",
          "type": "GIT"
        }
      ],
      "versions": [
        "N",
        "n0.11-dev",
        "n0.12-dev",
        "n0.8",
        "n1.1-dev",
        "n1.2-dev",
        "n1.3-dev",
        "n2.0",
        "n2.1-dev",
        "n2.2-dev",
        "n2.3-dev",
        "n2.4-dev",
        "n2.5-dev",
        "n2.6-dev",
        "n2.7-dev",
        "n2.8-dev",
        "n2.9-dev",
        "n3.1-dev",
        "n3.2-dev",
        "n3.3-dev",
        "n3.4-dev",
        "n3.5-dev",
        "n4.1-dev",
        "n4.2-dev",
        "n4.3-dev",
        "n4.4-dev",
        "n4.5-dev",
        "n5.1-dev",
        "n5.2-dev"
      ]
    }
  ],
  "details": "A heap out-of-bounds memory write exists in FFMPEG since version 5.1. The size calculation in `build_open_gop_key_points()` goes through all entries in the loop and adds `sc->ctts_data[i].count` to `sc->sample_offsets_count`. This can lead to an integer overflow resulting in a small allocation with `av_calloc()`. An attacker can cause remote code execution via a malicious mp4 file. We recommend upgrading past commit c953baa084607dd1d84c3bfcce3cf6a87c3e6e05",
  "id": "CVE-2022-2566",
  "modified": "2025-10-10T10:48:29.693565Z",
  "published": "2022-09-23T12:15:10Z",
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/FFmpeg/FFmpeg/commit/c953baa084607dd1d84c3bfcce3cf6a87c3e6e05"
    }
  ],
  "related": [
    "openSUSE-SU-2024:12332-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ]
}