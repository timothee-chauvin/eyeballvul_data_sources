{"schema_version":"1.7.3","id":"CVE-2024-42365","published":"2024-08-08T16:29:07Z","modified":"2025-10-22T18:44:06.077143Z","aliases":["GHSA-c4cg-9275-6w44"],"summary":"Asterisk allows `Write=originate` as sufficient permissions for code execution / `System()` dialplan","details":"Asterisk is an open source private branch exchange (PBX) and telephony toolkit. Prior to asterisk versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk versions 18.9-cert11 and 20.7-cert2, an AMI user with `write=originate` may change all configuration files in the `/etc/asterisk/` directory. This occurs because they are able to curl remote files and write them to disk, but are also able to append to existing files using the `FILE` function inside the `SET` application. This issue may result in privilege escalation, remote code execution and/or blind server-side request forgery with arbitrary protocol. Asterisk versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk versions 18.9-cert11 and 20.7-cert2 contain a fix for this issue.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"0"},{"fixed":"05729a44bcfab54f1fad56caf99c6446318bf61a"}]},{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"de4f63b4824c91a0cd9f3d95f3b7923bec71960c"},{"fixed":"81bfe0a62b4d95d58e543eea09d9d549774c19bd"}]},{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"12da95e53ff42287ad69d6d5922e06c3d62010ac"},{"fixed":"30c7925a0a4aa4829199a70758b97f49b2608e09"}]},{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"0"},{"fixed":"fce1a9b823d2670af8da9d0aed86c585b9f12ea8"}]},{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"de4f63b4824c91a0cd9f3d95f3b7923bec71960c"},{"fixed":"4ca53af6d3313f23a1755298e5de7600b8435ae7"}]}],"versions":["18.17.0","18.17.0-rc1","18.17.1","18.18.0","18.18.0-rc1","18.18.1","18.19.0","18.19.0-rc1","18.19.0-rc2","18.20.0","18.20.0-rc1","18.20.1","18.20.2","18.21.0","18.21.0-rc1","18.21.0-rc2","18.22.0","18.22.0-rc1","18.22.0-rc2","18.23.0","18.23.0-rc1","18.23.1","18.24.0","18.24.0-rc1","18.24.1","18.9.0","18.9.0-rc1","21.0.0","21.0.1","21.0.2","21.1.0","21.1.0-rc1","21.1.0-rc2","21.2.0","21.2.0-rc1","21.2.0-rc2","21.3.0","21.3.0-rc1","21.3.1","21.4.0","21.4.0-rc1","21.4.1","certified-18.9-cert10","certified-18.9-cert4","certified-18.9-cert5","certified-18.9-cert6","certified-18.9-cert7","certified-18.9-cert8","certified-18.9-cert8-rc1","certified-18.9-cert8-rc2","certified-18.9-cert9","certified/18.9-cert1","certified/18.9-cert1-rc1","certified/18.9-cert2","certified/18.9-cert3","certified/18.9-cert4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42365.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/asterisk/asterisk/security/advisories/GHSA-c4cg-9275-6w44"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/42a2f4ccfa2c7062a15063e765916b3332e34cc4"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/7a0090325bfa9d778a39ae5f7d0a98109e4651c8"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/b4063bf756272254b160b6d1bd6e9a3f8e16cc71"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/bbe68db10ab8a80c29db383e4dfe14f6eafaf993"},{"type":"FIX","url":"https://github.com/asterisk/asterisk/commit/faddd99f2b9408b524e5eb8a01589fe1fa282df2"},{"type":"WEB","url":"https://github.com/asterisk/asterisk/blob/14367caaf7241df1eceea7c45c5b261989c2c6db/main/manager.c#L6426"},{"type":"WEB","url":"https://github.com/asterisk/asterisk/blob/7d28165cb1b2d02d66e8693bd3fe23ee72fc55d8/main/manager.c#L6426"}],"database_specific":{"cwe_ids":["CWE-1220","CWE-267"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L"}]}