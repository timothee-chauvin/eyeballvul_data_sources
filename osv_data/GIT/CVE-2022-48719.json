{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48719.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "14592510356404685432555179609838817376",
              "length": 296.0
            },
            "id": "CVE-2022-48719-027e0cdd",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@203a35ebb49cdce377416b0690215d3ce090d364",
            "target": {
              "file": "include/net/neighbour.h",
              "function": "neigh_event_send"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "50473439050994830491421305710768700046",
              "length": 418.0
            },
            "id": "CVE-2022-48719-1ae8387d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a81f6da9cb2d1ef911131a6fd8bd15cb61fc772",
            "target": {
              "file": "net/core/neighbour.c",
              "function": "neigh_managed_work"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "320831048059894992216639932605613629233",
                "205779019334544279914751722371963486424",
                "339302133518472016673093962194188562558",
                "94568863266851291976838541893593084297",
                "321686847665040259574029084680451483196",
                "303018530650878175475429019214038758694",
                "201028028170315787954935685622686840965",
                "309859186697870124029991998912599727741",
                "148214990012350715135199300986544511394",
                "134140660776249384620179645948708845864",
                "189306486682783317064114192790435641631",
                "90740321627431526899099869981241385215",
                "300673586488404829556184040213786229082",
                "15337720743082339991583307916713200228",
                "267210733679427499278668984631404288737",
                "7350412260148668730921616012851977770"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48719-798822d8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@203a35ebb49cdce377416b0690215d3ce090d364",
            "target": {
              "file": "include/net/neighbour.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "109835033564074844352801820591655288276",
              "length": 1926.0
            },
            "id": "CVE-2022-48719-807f1d1b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a81f6da9cb2d1ef911131a6fd8bd15cb61fc772",
            "target": {
              "file": "net/core/neighbour.c",
              "function": "__neigh_event_send"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "14592510356404685432555179609838817376",
              "length": 296.0
            },
            "id": "CVE-2022-48719-8ef14b5d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a81f6da9cb2d1ef911131a6fd8bd15cb61fc772",
            "target": {
              "file": "include/net/neighbour.h",
              "function": "neigh_event_send"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "320831048059894992216639932605613629233",
                "205779019334544279914751722371963486424",
                "339302133518472016673093962194188562558",
                "94568863266851291976838541893593084297",
                "321686847665040259574029084680451483196",
                "303018530650878175475429019214038758694",
                "201028028170315787954935685622686840965",
                "309859186697870124029991998912599727741",
                "148214990012350715135199300986544511394",
                "134140660776249384620179645948708845864",
                "189306486682783317064114192790435641631",
                "90740321627431526899099869981241385215",
                "300673586488404829556184040213786229082",
                "15337720743082339991583307916713200228",
                "267210733679427499278668984631404288737",
                "7350412260148668730921616012851977770"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48719-968a7c53",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a81f6da9cb2d1ef911131a6fd8bd15cb61fc772",
            "target": {
              "file": "include/net/neighbour.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "50473439050994830491421305710768700046",
              "length": 418.0
            },
            "id": "CVE-2022-48719-a7a39910",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@203a35ebb49cdce377416b0690215d3ce090d364",
            "target": {
              "file": "net/core/neighbour.c",
              "function": "neigh_managed_work"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "109835033564074844352801820591655288276",
              "length": 1926.0
            },
            "id": "CVE-2022-48719-a8ab6687",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@203a35ebb49cdce377416b0690215d3ce090d364",
            "target": {
              "file": "net/core/neighbour.c",
              "function": "__neigh_event_send"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "31250349226180638609518880915006223006",
                "128380501507237228997575532503811284845",
                "337987396703450024158402784107067245017",
                "176316127067052349021648784754676109032",
                "75315345710354414683341811228090961144",
                "3036087047721471929548593386972671269",
                "234200467566061071753891654410720084495",
                "272270950631378360732590264839453488850",
                "333146426349906185739619563037502918001",
                "335909613827835795885226559489823666627",
                "253047570078543471719441730259082042112",
                "209380347805761530945834607890244521010",
                "275774122995607131669002813766072217735",
                "84666722795522674854969933034578944128",
                "193548292336762532567735125445844016501",
                "319889851980566865676532706164971295280",
                "213095877096516525433423488935865880237"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48719-eae4ff0d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@203a35ebb49cdce377416b0690215d3ce090d364",
            "target": {
              "file": "net/core/neighbour.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "31250349226180638609518880915006223006",
                "128380501507237228997575532503811284845",
                "337987396703450024158402784107067245017",
                "176316127067052349021648784754676109032",
                "75315345710354414683341811228090961144",
                "3036087047721471929548593386972671269",
                "234200467566061071753891654410720084495",
                "272270950631378360732590264839453488850",
                "333146426349906185739619563037502918001",
                "335909613827835795885226559489823666627",
                "253047570078543471719441730259082042112",
                "209380347805761530945834607890244521010",
                "275774122995607131669002813766072217735",
                "84666722795522674854969933034578944128",
                "193548292336762532567735125445844016501",
                "319889851980566865676532706164971295280",
                "213095877096516525433423488935865880237"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48719-ef22ff7a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a81f6da9cb2d1ef911131a6fd8bd15cb61fc772",
            "target": {
              "file": "net/core/neighbour.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "7482e3841d520a368426ac196720601687e2dc47"
            },
            {
              "fixed": "203a35ebb49cdce377416b0690215d3ce090d364"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "7482e3841d520a368426ac196720601687e2dc47"
            },
            {
              "fixed": "4a81f6da9cb2d1ef911131a6fd8bd15cb61fc772"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.15",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.16.1",
        "v5.16.2",
        "v5.16.3",
        "v5.16.4",
        "v5.16.5",
        "v5.16.6",
        "v5.16.7",
        "v5.17-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48719.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.16.8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet, neigh: Do not trigger immediate probes on NUD_FAILED from neigh_managed_work\n\nsyzkaller was able to trigger a deadlock for NTF_MANAGED entries [0]:\n\n  kworker/0:16/14617 is trying to acquire lock:\n  ffffffff8d4dd370 (&tbl->lock){++-.}-{2:2}, at: ___neigh_create+0x9e1/0x2990 net/core/neighbour.c:652\n  [...]\n  but task is already holding lock:\n  ffffffff8d4dd370 (&tbl->lock){++-.}-{2:2}, at: neigh_managed_work+0x35/0x250 net/core/neighbour.c:1572\n\nThe neighbor entry turned to NUD_FAILED state, where __neigh_event_send()\ntriggered an immediate probe as per commit cd28ca0a3dd1 (\"neigh: reduce\narp latency\") via neigh_probe() given table lock was held.\n\nOne option to fix this situation is to defer the neigh_probe() back to\nthe neigh_timer_handler() similarly as pre cd28ca0a3dd1. For the case\nof NTF_MANAGED, this deferral is acceptable given this only happens on\nactual failure state and regular / expected state is NUD_VALID with the\nentry already present.\n\nThe fix adds a parameter to __neigh_event_send() in order to communicate\nwhether immediate probe is allowed or disallowed. Existing call-sites\nof neigh_event_send() default as-is to immediate probe. However, the\nneigh_managed_work() disables it via use of neigh_event_send_probe().\n\n[0] <TASK>\n  __dump_stack lib/dump_stack.c:88 [inline]\n  dump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106\n  print_deadlock_bug kernel/locking/lockdep.c:2956 [inline]\n  check_deadlock kernel/locking/lockdep.c:2999 [inline]\n  validate_chain kernel/locking/lockdep.c:3788 [inline]\n  __lock_acquire.cold+0x149/0x3ab kernel/locking/lockdep.c:5027\n  lock_acquire kernel/locking/lockdep.c:5639 [inline]\n  lock_acquire+0x1ab/0x510 kernel/locking/lockdep.c:5604\n  __raw_write_lock_bh include/linux/rwlock_api_smp.h:202 [inline]\n  _raw_write_lock_bh+0x2f/0x40 kernel/locking/spinlock.c:334\n  ___neigh_create+0x9e1/0x2990 net/core/neighbour.c:652\n  ip6_finish_output2+0x1070/0x14f0 net/ipv6/ip6_output.c:123\n  __ip6_finish_output net/ipv6/ip6_output.c:191 [inline]\n  __ip6_finish_output+0x61e/0xe90 net/ipv6/ip6_output.c:170\n  ip6_finish_output+0x32/0x200 net/ipv6/ip6_output.c:201\n  NF_HOOK_COND include/linux/netfilter.h:296 [inline]\n  ip6_output+0x1e4/0x530 net/ipv6/ip6_output.c:224\n  dst_output include/net/dst.h:451 [inline]\n  NF_HOOK include/linux/netfilter.h:307 [inline]\n  ndisc_send_skb+0xa99/0x17f0 net/ipv6/ndisc.c:508\n  ndisc_send_ns+0x3a9/0x840 net/ipv6/ndisc.c:650\n  ndisc_solicit+0x2cd/0x4f0 net/ipv6/ndisc.c:742\n  neigh_probe+0xc2/0x110 net/core/neighbour.c:1040\n  __neigh_event_send+0x37d/0x1570 net/core/neighbour.c:1201\n  neigh_event_send include/net/neighbour.h:470 [inline]\n  neigh_managed_work+0x162/0x250 net/core/neighbour.c:1574\n  process_one_work+0x9ac/0x1650 kernel/workqueue.c:2307\n  worker_thread+0x657/0x1110 kernel/workqueue.c:2454\n  kthread+0x2e9/0x3a0 kernel/kthread.c:377\n  ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:295\n  </TASK>",
  "id": "CVE-2022-48719",
  "modified": "2025-10-14T20:22:26.695080Z",
  "published": "2024-06-20T11:13:11Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/203a35ebb49cdce377416b0690215d3ce090d364"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/4a81f6da9cb2d1ef911131a6fd8bd15cb61fc772"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "net, neigh: Do not trigger immediate probes on NUD_FAILED from neigh_managed_work"
}