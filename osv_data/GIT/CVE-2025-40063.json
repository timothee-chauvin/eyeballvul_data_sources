{"schema_version":"1.7.3","id":"CVE-2025-40063","published":"2025-10-28T11:48:34.549Z","modified":"2025-12-01T20:16:52.498886Z","summary":"crypto: comp - Use same definition of context alloc and free ops","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ncrypto: comp - Use same definition of context alloc and free ops\n\nIn commit 42d9f6c77479 (\"crypto: acomp - Move scomp stream allocation\ncode into acomp\"), the crypto_acomp_streams struct was made to rely on\nhaving the alloc_ctx and free_ctx operations defined in the same order\nas the scomp_alg struct. But in that same commit, the alloc_ctx and\nfree_ctx members of scomp_alg may be randomized by structure layout\nrandomization, since they are contained in a pure ops structure\n(containing only function pointers). If the pointers within scomp_alg\nare randomized, but those in crypto_acomp_streams are not, then\nthe order may no longer match. This fixes the problem by removing the\nunion from scomp_alg so that both crypto_acomp_streams and scomp_alg\nwill share the same definition of alloc_ctx and free_ctx, ensuring\nthey will always have the same layout.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"42d9f6c774790d290c175e8775ce9f1366438098"},{"fixed":"779d3b6f2d32c5f1da6163e959abe1e1ffe2945b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"42d9f6c774790d290c175e8775ce9f1366438098"},{"fixed":"f75f66683ded09f7135aef2e763c245a07c8271a"}]}],"versions":["v6.15","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40063.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["121955573867945330801315463990398332735","49745842436932919799678967777512508071","60387263910656541312402975881804556640","59459194106335049558674676764102050437","198038475069197427379501573740322848006"],"threshold":0.9},"id":"CVE-2025-40063-049dc5da","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"crypto/lz4.c"}},{"deprecated":false,"digest":{"line_hashes":["17222379276684843492632874935446404609","78460228688860394354890027887901530397","262222498263644861199194557792013748861","180608405094598528668227831027429193052","8564675415874934196004799831856816307"],"threshold":0.9},"id":"CVE-2025-40063-13f3b982","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"crypto/lz4hc.c"}},{"deprecated":false,"digest":{"line_hashes":["119506108844225391108120899537548670918","338148185049572689679089947224272271846","71296383816350267990345317214493207779","233290412836319067455195685870969382255","334071202293910474729890782773334128254","224598672863139231514331547098413506146","240766227371070544514897557485733685617","115459372477779033659107679169627986979","10658217379191025620291141037714137958","38016100698142467978584031755012460439","316734034439241012594721818501757994007","147257045665246473381057944271383426652","207247916118595467468474833165108610819"],"threshold":0.9},"id":"CVE-2025-40063-30fcc660","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"include/crypto/internal/scompress.h"}},{"deprecated":false,"digest":{"line_hashes":["171460661442934034046463534992327053666","299479624201057439928045204429148072872","25493575137237175807528290765495254370","300562913508372896423896292122424419068","338248470615714240029685988485592400806"],"threshold":0.9},"id":"CVE-2025-40063-3237012a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"drivers/crypto/nx/nx-common-powernv.c"}},{"deprecated":false,"digest":{"line_hashes":["171460661442934034046463534992327053666","299479624201057439928045204429148072872","25493575137237175807528290765495254370","300562913508372896423896292122424419068","338248470615714240029685988485592400806"],"threshold":0.9},"id":"CVE-2025-40063-5370cc02","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"drivers/crypto/nx/nx-common-powernv.c"}},{"deprecated":false,"digest":{"line_hashes":["48876955967219629070109032513040280665","223828052756351958453816072221459171901","270511112956359038013915540405671061552","245436669005682295177247882493051166133","338248470615714240029685988485592400806"],"threshold":0.9},"id":"CVE-2025-40063-5407c97f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"drivers/crypto/nx/nx-common-pseries.c"}},{"deprecated":false,"digest":{"line_hashes":["119506108844225391108120899537548670918","338148185049572689679089947224272271846","71296383816350267990345317214493207779","233290412836319067455195685870969382255","334071202293910474729890782773334128254","224598672863139231514331547098413506146","240766227371070544514897557485733685617","115459372477779033659107679169627986979","10658217379191025620291141037714137958","38016100698142467978584031755012460439","316734034439241012594721818501757994007","147257045665246473381057944271383426652","207247916118595467468474833165108610819"],"threshold":0.9},"id":"CVE-2025-40063-71370e69","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"include/crypto/internal/scompress.h"}},{"deprecated":false,"digest":{"line_hashes":["232163456111379989318462219079433153011","28607886140497286480466145375442186669","61950041664580097020094934603237366841","282390580250882666197826336843500541928","300234699843078240552288767915478957672"],"threshold":0.9},"id":"CVE-2025-40063-754acca3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"crypto/lzo-rle.c"}},{"deprecated":false,"digest":{"line_hashes":["167409250410031693795314428934666817832","246424516109859473272609432607781956617","330353076654961342606295488321853318173","77040447240618282525213134668481412017","334719665444950798263285788981556918018"],"threshold":0.9},"id":"CVE-2025-40063-77894446","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"crypto/lzo.c"}},{"deprecated":false,"digest":{"line_hashes":["232163456111379989318462219079433153011","28607886140497286480466145375442186669","61950041664580097020094934603237366841","282390580250882666197826336843500541928","300234699843078240552288767915478957672"],"threshold":0.9},"id":"CVE-2025-40063-97274a8e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"crypto/lzo-rle.c"}},{"deprecated":false,"digest":{"line_hashes":["167409250410031693795314428934666817832","246424516109859473272609432607781956617","330353076654961342606295488321853318173","77040447240618282525213134668481412017","334719665444950798263285788981556918018"],"threshold":0.9},"id":"CVE-2025-40063-a23c4e69","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"crypto/lzo.c"}},{"deprecated":false,"digest":{"line_hashes":["17222379276684843492632874935446404609","78460228688860394354890027887901530397","262222498263644861199194557792013748861","180608405094598528668227831027429193052","8564675415874934196004799831856816307"],"threshold":0.9},"id":"CVE-2025-40063-aa583b30","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"crypto/lz4hc.c"}},{"deprecated":false,"digest":{"line_hashes":["121955573867945330801315463990398332735","49745842436932919799678967777512508071","60387263910656541312402975881804556640","59459194106335049558674676764102050437","198038475069197427379501573740322848006"],"threshold":0.9},"id":"CVE-2025-40063-c6c8d2f3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"crypto/lz4.c"}},{"deprecated":false,"digest":{"line_hashes":["118307064100156047119443334074894497724","393044366813686230111033714824159076","318769189209851801523672387668249781522","316940617369542054169223006706436665200","47112710734802803132709439393984110198"],"threshold":0.9},"id":"CVE-2025-40063-c80860ca","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@779d3b6f2d32c5f1da6163e959abe1e1ffe2945b","target":{"file":"crypto/842.c"}},{"deprecated":false,"digest":{"line_hashes":["118307064100156047119443334074894497724","393044366813686230111033714824159076","318769189209851801523672387668249781522","316940617369542054169223006706436665200","47112710734802803132709439393984110198"],"threshold":0.9},"id":"CVE-2025-40063-e84e4558","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"crypto/842.c"}},{"deprecated":false,"digest":{"line_hashes":["48876955967219629070109032513040280665","223828052756351958453816072221459171901","270511112956359038013915540405671061552","245436669005682295177247882493051166133","338248470615714240029685988485592400806"],"threshold":0.9},"id":"CVE-2025-40063-eac55960","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f75f66683ded09f7135aef2e763c245a07c8271a","target":{"file":"drivers/crypto/nx/nx-common-pseries.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40063.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/779d3b6f2d32c5f1da6163e959abe1e1ffe2945b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f75f66683ded09f7135aef2e763c245a07c8271a"}]}