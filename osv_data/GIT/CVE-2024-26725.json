{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26725.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "207381765361964359133056278162329678512",
              "length": 74.0
            },
            "id": "CVE-2024-26725-0a35057e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@087739cbd0d0b87b6cec2c0799436ac66e24acc8",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_lock_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "33682808836653477755932462561273632720",
              "length": 680.0
            },
            "id": "CVE-2024-26725-2a416e1f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53c0441dd2c44ee93fddb5473885fd41e4bc2361",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_nl_pin_get_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "295616364308422954082085603319349099901",
                "138749379373138084114988539246267433152",
                "143182059222937475111841517554127371211",
                "3583082000570678207061850245564795521",
                "125895585515897668121832664857337185552",
                "111456158626705001926384376501097918020",
                "334337476854163726624658720115633451947",
                "221632458545775110905440431939800734568",
                "198999624478112060120089131200545043890",
                "180595762847535378279013336724147475394",
                "129866498659131222952677040258078240787",
                "29353458367377953543047025810874365843"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26725-2d2f5474",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@087739cbd0d0b87b6cec2c0799436ac66e24acc8",
            "target": {
              "file": "drivers/dpll/dpll_nl.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "107501161384985815265142996220863606966",
                "98477500771177497292241707735298344788",
                "274777460707961412035867543969610285734",
                "237108858576070968676382523984024673436",
                "144876776727407616096908867409745387603",
                "157315993034214700974304036199234884057",
                "77831497469302606446754779316219881778",
                "165521873871171273062083266959790575720",
                "258792698186923240505472197706222342630",
                "47273311577874089348252968777055214104",
                "237108858576070968676382523984024673436",
                "144876776727407616096908867409745387603",
                "157315993034214700974304036199234884057",
                "77831497469302606446754779316219881778",
                "284339154141768770107353750718171608361",
                "154029522052217053195544707465420836263",
                "207453138400249001218935497434135894399",
                "152513059703992400218330254941609153360",
                "212182619840012812303004523110664532137",
                "122523467741438303729365283930130152595",
                "324791952447178200845295026532128559971",
                "33455955134347765523438786206206625639",
                "100824962341004293032779792001955359844",
                "309816859581338582141233746267048776117",
                "47949373032610964916330015489132801699",
                "47031849156060753003602716678072675362",
                "208442487536742161210146838199683674728"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26725-371838b8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53c0441dd2c44ee93fddb5473885fd41e4bc2361",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "289601021098577983586282788630347424653",
              "length": 649.0
            },
            "id": "CVE-2024-26725-3dd2f500",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53c0441dd2c44ee93fddb5473885fd41e4bc2361",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_nl_device_get_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "207381765361964359133056278162329678512",
              "length": 74.0
            },
            "id": "CVE-2024-26725-6cd6128a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53c0441dd2c44ee93fddb5473885fd41e4bc2361",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_unlock_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "323734429530402477263323196666734430008",
                "267848595209646092683692325367272546607",
                "81514748015122745212757955794648635350",
                "29261101719970298145632307336526094333",
                "134750804601216976465676034809642909558"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26725-9710cccb",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@087739cbd0d0b87b6cec2c0799436ac66e24acc8",
            "target": {
              "file": "drivers/dpll/dpll_nl.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "323734429530402477263323196666734430008",
                "267848595209646092683692325367272546607",
                "81514748015122745212757955794648635350",
                "29261101719970298145632307336526094333",
                "134750804601216976465676034809642909558"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26725-b65ac1dc",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53c0441dd2c44ee93fddb5473885fd41e4bc2361",
            "target": {
              "file": "drivers/dpll/dpll_nl.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "207381765361964359133056278162329678512",
              "length": 74.0
            },
            "id": "CVE-2024-26725-b78a13ce",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@087739cbd0d0b87b6cec2c0799436ac66e24acc8",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_unlock_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "33682808836653477755932462561273632720",
              "length": 680.0
            },
            "id": "CVE-2024-26725-c098a629",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@087739cbd0d0b87b6cec2c0799436ac66e24acc8",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_nl_pin_get_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "107501161384985815265142996220863606966",
                "98477500771177497292241707735298344788",
                "274777460707961412035867543969610285734",
                "237108858576070968676382523984024673436",
                "144876776727407616096908867409745387603",
                "157315993034214700974304036199234884057",
                "77831497469302606446754779316219881778",
                "165521873871171273062083266959790575720",
                "258792698186923240505472197706222342630",
                "47273311577874089348252968777055214104",
                "237108858576070968676382523984024673436",
                "144876776727407616096908867409745387603",
                "157315993034214700974304036199234884057",
                "77831497469302606446754779316219881778",
                "284339154141768770107353750718171608361",
                "154029522052217053195544707465420836263",
                "207453138400249001218935497434135894399",
                "152513059703992400218330254941609153360",
                "212182619840012812303004523110664532137",
                "122523467741438303729365283930130152595",
                "324791952447178200845295026532128559971",
                "33455955134347765523438786206206625639",
                "100824962341004293032779792001955359844",
                "309816859581338582141233746267048776117",
                "47949373032610964916330015489132801699",
                "47031849156060753003602716678072675362",
                "208442487536742161210146838199683674728"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26725-d20e6f1b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@087739cbd0d0b87b6cec2c0799436ac66e24acc8",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "289601021098577983586282788630347424653",
              "length": 649.0
            },
            "id": "CVE-2024-26725-eb36afb5",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@087739cbd0d0b87b6cec2c0799436ac66e24acc8",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_nl_device_get_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "207381765361964359133056278162329678512",
              "length": 74.0
            },
            "id": "CVE-2024-26725-eba469a8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53c0441dd2c44ee93fddb5473885fd41e4bc2361",
            "target": {
              "file": "drivers/dpll/dpll_netlink.c",
              "function": "dpll_lock_dumpit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "295616364308422954082085603319349099901",
                "138749379373138084114988539246267433152",
                "143182059222937475111841517554127371211",
                "3583082000570678207061850245564795521",
                "125895585515897668121832664857337185552",
                "111456158626705001926384376501097918020",
                "334337476854163726624658720115633451947",
                "221632458545775110905440431939800734568",
                "198999624478112060120089131200545043890",
                "180595762847535378279013336724147475394",
                "129866498659131222952677040258078240787",
                "29353458367377953543047025810874365843"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26725-ef21254c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53c0441dd2c44ee93fddb5473885fd41e4bc2361",
            "target": {
              "file": "drivers/dpll/dpll_nl.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "9d71b54b65b1fb6c0d3a6c5c88ba9b915c783fbc"
            },
            {
              "fixed": "087739cbd0d0b87b6cec2c0799436ac66e24acc8"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "9d71b54b65b1fb6c0d3a6c5c88ba9b915c783fbc"
            },
            {
              "fixed": "53c0441dd2c44ee93fddb5473885fd41e4bc2361"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.6",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.2",
        "v6.7.3",
        "v6.7.4",
        "v6.7.5",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26725.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.6"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndpll: fix possible deadlock during netlink dump operation\n\nRecently, I've been hitting following deadlock warning during dpll pin\ndump:\n\n[52804.637962] ======================================================\n[52804.638536] WARNING: possible circular locking dependency detected\n[52804.639111] 6.8.0-rc2jiri+ #1 Not tainted\n[52804.639529] ------------------------------------------------------\n[52804.640104] python3/2984 is trying to acquire lock:\n[52804.640581] ffff88810e642678 (nlk_cb_mutex-GENERIC){+.+.}-{3:3}, at: netlink_dump+0xb3/0x780\n[52804.641417]\n               but task is already holding lock:\n[52804.642010] ffffffff83bde4c8 (dpll_lock){+.+.}-{3:3}, at: dpll_lock_dumpit+0x13/0x20\n[52804.642747]\n               which lock already depends on the new lock.\n\n[52804.643551]\n               the existing dependency chain (in reverse order) is:\n[52804.644259]\n               -> #1 (dpll_lock){+.+.}-{3:3}:\n[52804.644836]        lock_acquire+0x174/0x3e0\n[52804.645271]        __mutex_lock+0x119/0x1150\n[52804.645723]        dpll_lock_dumpit+0x13/0x20\n[52804.646169]        genl_start+0x266/0x320\n[52804.646578]        __netlink_dump_start+0x321/0x450\n[52804.647056]        genl_family_rcv_msg_dumpit+0x155/0x1e0\n[52804.647575]        genl_rcv_msg+0x1ed/0x3b0\n[52804.648001]        netlink_rcv_skb+0xdc/0x210\n[52804.648440]        genl_rcv+0x24/0x40\n[52804.648831]        netlink_unicast+0x2f1/0x490\n[52804.649290]        netlink_sendmsg+0x36d/0x660\n[52804.649742]        __sock_sendmsg+0x73/0xc0\n[52804.650165]        __sys_sendto+0x184/0x210\n[52804.650597]        __x64_sys_sendto+0x72/0x80\n[52804.651045]        do_syscall_64+0x6f/0x140\n[52804.651474]        entry_SYSCALL_64_after_hwframe+0x46/0x4e\n[52804.652001]\n               -> #0 (nlk_cb_mutex-GENERIC){+.+.}-{3:3}:\n[52804.652650]        check_prev_add+0x1ae/0x1280\n[52804.653107]        __lock_acquire+0x1ed3/0x29a0\n[52804.653559]        lock_acquire+0x174/0x3e0\n[52804.653984]        __mutex_lock+0x119/0x1150\n[52804.654423]        netlink_dump+0xb3/0x780\n[52804.654845]        __netlink_dump_start+0x389/0x450\n[52804.655321]        genl_family_rcv_msg_dumpit+0x155/0x1e0\n[52804.655842]        genl_rcv_msg+0x1ed/0x3b0\n[52804.656272]        netlink_rcv_skb+0xdc/0x210\n[52804.656721]        genl_rcv+0x24/0x40\n[52804.657119]        netlink_unicast+0x2f1/0x490\n[52804.657570]        netlink_sendmsg+0x36d/0x660\n[52804.658022]        __sock_sendmsg+0x73/0xc0\n[52804.658450]        __sys_sendto+0x184/0x210\n[52804.658877]        __x64_sys_sendto+0x72/0x80\n[52804.659322]        do_syscall_64+0x6f/0x140\n[52804.659752]        entry_SYSCALL_64_after_hwframe+0x46/0x4e\n[52804.660281]\n               other info that might help us debug this:\n\n[52804.661077]  Possible unsafe locking scenario:\n\n[52804.661671]        CPU0                    CPU1\n[52804.662129]        ----                    ----\n[52804.662577]   lock(dpll_lock);\n[52804.662924]                                lock(nlk_cb_mutex-GENERIC);\n[52804.663538]                                lock(dpll_lock);\n[52804.664073]   lock(nlk_cb_mutex-GENERIC);\n[52804.664490]\n\nThe issue as follows: __netlink_dump_start() calls control->start(cb)\nwith nlk->cb_mutex held. In control->start(cb) the dpll_lock is taken.\nThen nlk->cb_mutex is released and taken again in netlink_dump(), while\ndpll_lock still being held. That leads to ABBA deadlock when another\nCPU races with the same operation.\n\nFix this by moving dpll_lock taking into dumpit() callback which ensures\ncorrect lock taking order.",
  "id": "CVE-2024-26725",
  "modified": "2025-10-15T08:17:01.877397Z",
  "published": "2024-04-03T14:55:24Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/087739cbd0d0b87b6cec2c0799436ac66e24acc8"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/53c0441dd2c44ee93fddb5473885fd41e4bc2361"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "dpll: fix possible deadlock during netlink dump operation"
}