{"schema_version":"1.7.3","id":"CVE-2025-40208","published":"2025-11-12T21:56:36Z","modified":"2025-11-13T03:18:55.373422Z","summary":"media: iris: fix module removal if firmware download failed","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: iris: fix module removal if firmware download failed\n\nFix remove if firmware failed to load:\nqcom-iris aa00000.video-codec: Direct firmware load for qcom/vpu/vpu33_p4.mbn failed with error -2\nqcom-iris aa00000.video-codec: firmware download failed\nqcom-iris aa00000.video-codec: core init failed\n\nthen:\n$ echo aa00000.video-codec > /sys/bus/platform/drivers/qcom-iris/unbind\n\nTriggers:\ngenpd genpd:1:aa00000.video-codec: Runtime PM usage count underflow!\n------------[ cut here ]------------\nvideo_cc_mvs0_clk already disabled\nWARNING: drivers/clk/clk.c:1206 at clk_core_disable+0xa4/0xac, CPU#1: sh/542\n<snip>\npc : clk_core_disable+0xa4/0xac\nlr : clk_core_disable+0xa4/0xac\n<snip>\nCall trace:\n clk_core_disable+0xa4/0xac (P)\n clk_disable+0x30/0x4c\n iris_disable_unprepare_clock+0x20/0x48 [qcom_iris]\n iris_vpu_power_off_hw+0x48/0x58 [qcom_iris]\n iris_vpu33_power_off_hardware+0x44/0x230 [qcom_iris]\n iris_vpu_power_off+0x34/0x84 [qcom_iris]\n iris_core_deinit+0x44/0xc8 [qcom_iris]\n iris_remove+0x20/0x48 [qcom_iris]\n platform_remove+0x20/0x30\n device_remove+0x4c/0x80\n<snip>\n---[ end trace 0000000000000000 ]---\n------------[ cut here ]------------\nvideo_cc_mvs0_clk already unprepared\nWARNING: drivers/clk/clk.c:1065 at clk_core_unprepare+0xf0/0x110, CPU#2: sh/542\n<snip>\npc : clk_core_unprepare+0xf0/0x110\nlr : clk_core_unprepare+0xf0/0x110\n<snip>\nCall trace:\n clk_core_unprepare+0xf0/0x110 (P)\n clk_unprepare+0x2c/0x44\n iris_disable_unprepare_clock+0x28/0x48 [qcom_iris]\n iris_vpu_power_off_hw+0x48/0x58 [qcom_iris]\n iris_vpu33_power_off_hardware+0x44/0x230 [qcom_iris]\n iris_vpu_power_off+0x34/0x84 [qcom_iris]\n iris_core_deinit+0x44/0xc8 [qcom_iris]\n iris_remove+0x20/0x48 [qcom_iris]\n platform_remove+0x20/0x30\n device_remove+0x4c/0x80\n<snip>\n---[ end trace 0000000000000000 ]---\ngenpd genpd:0:aa00000.video-codec: Runtime PM usage count underflow!\n------------[ cut here ]------------\ngcc_video_axi0_clk already disabled\nWARNING: drivers/clk/clk.c:1206 at clk_core_disable+0xa4/0xac, CPU#4: sh/542\n<snip>\npc : clk_core_disable+0xa4/0xac\nlr : clk_core_disable+0xa4/0xac\n<snip>\nCall trace:\n clk_core_disable+0xa4/0xac (P)\n clk_disable+0x30/0x4c\n iris_disable_unprepare_clock+0x20/0x48 [qcom_iris]\n iris_vpu33_power_off_controller+0x17c/0x428 [qcom_iris]\n iris_vpu_power_off+0x48/0x84 [qcom_iris]\n iris_core_deinit+0x44/0xc8 [qcom_iris]\n iris_remove+0x20/0x48 [qcom_iris]\n platform_remove+0x20/0x30\n device_remove+0x4c/0x80\n<snip>\n------------[ cut here ]------------\ngcc_video_axi0_clk already unprepared\nWARNING: drivers/clk/clk.c:1065 at clk_core_unprepare+0xf0/0x110, CPU#4: sh/542\n<snip>\npc : clk_core_unprepare+0xf0/0x110\nlr : clk_core_unprepare+0xf0/0x110\n<snip>\nCall trace:\n clk_core_unprepare+0xf0/0x110 (P)\n clk_unprepare+0x2c/0x44\n iris_disable_unprepare_clock+0x28/0x48 [qcom_iris]\n iris_vpu33_power_off_controller+0x17c/0x428 [qcom_iris]\n iris_vpu_power_off+0x48/0x84 [qcom_iris]\n iris_core_deinit+0x44/0xc8 [qcom_iris]\n iris_remove+0x20/0x48 [qcom_iris]\n platform_remove+0x20/0x30\n device_remove+0x4c/0x80\n<snip>\n---[ end trace 0000000000000000 ]---\n\nSkip deinit if initialization never succeeded.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d7378f84e94e14998b3469dcc0d8ce609d049ccc"},{"fixed":"7a0a77b936ff28f59c271172e81cefebf7b2b7a6"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d7378f84e94e14998b3469dcc0d8ce609d049ccc"},{"fixed":"fde38008fc4f43db8c17869491870df24b501543"}]}],"versions":["v6.14","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.17.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40208.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["314815910866149759409593258809464613390","21934100099696252295828850585973333643","49586617954955634956895542979408332830","265828480797695042658677258524637966954","70314176923910877561758454390508538574","186714700061890688424393542432241673511","89678541855195575600772597220622742631"],"threshold":0.9},"id":"CVE-2025-40208-8f4de19c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7a0a77b936ff28f59c271172e81cefebf7b2b7a6","target":{"file":"drivers/media/platform/qcom/iris/iris_core.c"}},{"deprecated":false,"digest":{"function_hash":"82224234909117811224333584047244319686","length":253},"id":"CVE-2025-40208-b77d5253","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7a0a77b936ff28f59c271172e81cefebf7b2b7a6","target":{"file":"drivers/media/platform/qcom/iris/iris_core.c","function":"iris_core_deinit"}},{"deprecated":false,"digest":{"function_hash":"82224234909117811224333584047244319686","length":253},"id":"CVE-2025-40208-fab5cf24","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fde38008fc4f43db8c17869491870df24b501543","target":{"file":"drivers/media/platform/qcom/iris/iris_core.c","function":"iris_core_deinit"}},{"deprecated":false,"digest":{"line_hashes":["314815910866149759409593258809464613390","21934100099696252295828850585973333643","49586617954955634956895542979408332830","265828480797695042658677258524637966954","70314176923910877561758454390508538574","186714700061890688424393542432241673511","89678541855195575600772597220622742631"],"threshold":0.9},"id":"CVE-2025-40208-fd497853","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fde38008fc4f43db8c17869491870df24b501543","target":{"file":"drivers/media/platform/qcom/iris/iris_core.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.17.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40208.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7a0a77b936ff28f59c271172e81cefebf7b2b7a6"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fde38008fc4f43db8c17869491870df24b501543"}]}