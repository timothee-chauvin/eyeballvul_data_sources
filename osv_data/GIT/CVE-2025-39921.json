{"schema_version":"1.7.3","id":"CVE-2025-39921","published":"2025-10-01T07:55:16.540Z","modified":"2025-11-20T10:21:20.785571Z","summary":"spi: microchip-core-qspi: stop checking viability of op->max_freq in supports_op callback","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nspi: microchip-core-qspi: stop checking viability of op->max_freq in supports_op callback\n\nIn commit 13529647743d9 (\"spi: microchip-core-qspi: Support per spi-mem\noperation frequency switches\") the logic for checking the viability of\nop->max_freq in mchp_coreqspi_setup_clock() was copied into\nmchp_coreqspi_supports_op(). Unfortunately, op->max_freq is not valid\nwhen this function is called during probe but is instead zero.\nAccordingly, baud_rate_val is calculated to be INT_MAX due to division\nby zero, causing probe of the attached memory device to fail.\n\nSeemingly spi-microchip-core-qspi was the only driver that had such a\nmodification made to its supports_op callback when the per_op_freq\ncapability was added, so just remove it to restore prior functionality.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"13529647743d906ed3cf991f1d77727e7ff1fb6f"},{"fixed":"ac8a13f35d5b8996582b3f97b924838a5c570c18"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"13529647743d906ed3cf991f1d77727e7ff1fb6f"},{"fixed":"89e7353f522f5cf70cb48c01ce2dcdcb275b8022"}]}],"versions":["v6.13","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.16.4","v6.16.5","v6.17-rc1","v6.17-rc2","v6.17-rc3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39921.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["16439905898985583429862082085679723305","34083421336805205320958687305982305529","212863078492446362160679484705839298100","188731390509749375794596909621964598969","96439558083747522304571914462609743075","38147467225883928204255631549866311759","237922862039734072804532980221383539646","320516913275253305654447042868647317187","232896288344822291471216060447594343376","11000399164588374167475170341502255344","147376851200487491296916229064981108020","313811660274958699004343305989264815087","127754886578075218404984530358452605288","81740673424116888862637779446636050556","11728029681889732790972008018128389419"],"threshold":0.9},"id":"CVE-2025-39921-15476070","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89e7353f522f5cf70cb48c01ce2dcdcb275b8022","target":{"file":"drivers/spi/spi-microchip-core-qspi.c"}},{"deprecated":false,"digest":{"function_hash":"167424742054409167906201823755262039945","length":635},"id":"CVE-2025-39921-6d290c8c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89e7353f522f5cf70cb48c01ce2dcdcb275b8022","target":{"file":"drivers/spi/spi-microchip-core-qspi.c","function":"mchp_coreqspi_supports_op"}},{"deprecated":false,"digest":{"function_hash":"167424742054409167906201823755262039945","length":635},"id":"CVE-2025-39921-ea130f59","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ac8a13f35d5b8996582b3f97b924838a5c570c18","target":{"file":"drivers/spi/spi-microchip-core-qspi.c","function":"mchp_coreqspi_supports_op"}},{"deprecated":false,"digest":{"line_hashes":["16439905898985583429862082085679723305","34083421336805205320958687305982305529","212863078492446362160679484705839298100","188731390509749375794596909621964598969","96439558083747522304571914462609743075","38147467225883928204255631549866311759","237922862039734072804532980221383539646","320516913275253305654447042868647317187","232896288344822291471216060447594343376","11000399164588374167475170341502255344","147376851200487491296916229064981108020","313811660274958699004343305989264815087","127754886578075218404984530358452605288","81740673424116888862637779446636050556","11728029681889732790972008018128389419"],"threshold":0.9},"id":"CVE-2025-39921-fb016e1f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ac8a13f35d5b8996582b3f97b924838a5c570c18","target":{"file":"drivers/spi/spi-microchip-core-qspi.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.16.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39921.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/89e7353f522f5cf70cb48c01ce2dcdcb275b8022"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ac8a13f35d5b8996582b3f97b924838a5c570c18"}]}