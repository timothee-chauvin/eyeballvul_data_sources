{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49418.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "184578179714171336157058189536305757260",
              "length": 986.0
            },
            "id": "CVE-2022-49418-04a9c5a5",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "_nfs4_proc_fs_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "141032616884427494087841760606559863335",
              "length": 831.0
            },
            "id": "CVE-2022-49418-09ee5466",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "nfs4_get_referral"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "74797141170991281447603219998807840740",
              "length": 1126.0
            },
            "id": "CVE-2022-49418-14dc53f9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "_nfs41_proc_get_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "144818461191316095367694480426054836087",
              "length": 785.0
            },
            "id": "CVE-2022-49418-2cb12d35",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4xdr.c",
              "function": "nfs4_xdr_dec_fs_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "141032616884427494087841760606559863335",
              "length": 831.0
            },
            "id": "CVE-2022-49418-3d6a141a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "nfs4_get_referral"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "279111582415622060753254104150199784693",
              "length": 780.0
            },
            "id": "CVE-2022-49418-42eded5d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4namespace.c",
              "function": "nfs_do_refmount"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "308007414620869925850872771346022437326",
              "length": 1468.0
            },
            "id": "CVE-2022-49418-578d82f0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4state.c",
              "function": "nfs4_try_migration"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "144818461191316095367694480426054836087",
              "length": 785.0
            },
            "id": "CVE-2022-49418-609f6998",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4xdr.c",
              "function": "nfs4_xdr_dec_fs_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "287112740657807023904103101585740147961",
                "92076234177639242339781196219945396758",
                "60849326833119061956698350347707256682",
                "151546765796915665226157161621911670148",
                "300891291228817116859740601490238105864",
                "33329418125520516590592907248880352381",
                "14958037470141591018970767614066341790",
                "272817344153529007207954408208658891171",
                "310819429943320952239319100945506094308",
                "294684481793005074418825898650724703588",
                "284852767568939866208404758986813844484",
                "135048408280236198033297538181704054875",
                "178232548585010373670530362802723727332"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-782e3f6a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4namespace.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "101210455665832683191657956459763141576",
                "259136458363998573972171732364014630639",
                "128040958933438836104204809006261606408",
                "142848482804616427808564520290832168146"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-8017dc27",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "include/linux/nfs_xdr.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "235578307073298090151763670417358315697",
                "297709304754115789574006317487471356993",
                "258866936204005816175651445435903635803",
                "205623923022014821714294467832754965277",
                "228007573809947245533311007651493394611",
                "290483836632124812624078789962525173639",
                "304694327035004036191183015223802465635",
                "118615087621817044448789016706754134171",
                "194827547076281610664993474838464611944",
                "165476405925288820781662296814020459550",
                "324688845438339641293582853106238515101",
                "108711201338959355436890414255209117205"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-82dcec9b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4state.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "118966971773073861072885337866217928671",
              "length": 926.0
            },
            "id": "CVE-2022-49418-86d3c3d3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "_nfs40_proc_get_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "308007414620869925850872771346022437326",
              "length": 1468.0
            },
            "id": "CVE-2022-49418-92fe95ca",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4state.c",
              "function": "nfs4_try_migration"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "184578179714171336157058189536305757260",
              "length": 986.0
            },
            "id": "CVE-2022-49418-97905942",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "_nfs4_proc_fs_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "74797141170991281447603219998807840740",
              "length": 1126.0
            },
            "id": "CVE-2022-49418-adabd332",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "_nfs41_proc_get_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "155634420813075031881242186246612173565",
                "282127141477098464625694973563221965415",
                "70124267545722427983584855206130352615",
                "303384364317445284826951654703909572458",
                "328554684083623668536721531471652594816",
                "282127141477098464625694973563221965415",
                "70124267545722427983584855206130352615",
                "128054070112287213678976536357598389946"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-b737672d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4xdr.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "117084116670229382730122276530126856395",
                "116558634851279488075806567429207837258",
                "42409546474535791233555164774548177818",
                "113390363226342039750858767057890346082",
                "142418103719104465964468462779210366247",
                "188788094268372630875716281400573588284",
                "177121051833827227136927978058133119206",
                "269860824426662788077881101740106401079",
                "72014713235022597437183093040511893077",
                "152895971899377847326386009853028439897",
                "222597467977294951828318741486036591996",
                "34662036231615591993118375770279227970",
                "122242641703624990302520540694945208015",
                "113455626232392526545612901823045177277",
                "324677236320632337974799845998264069625",
                "287257096208327373499904002238273556296",
                "292326431870281833739592269187778524474",
                "130564201155693192556053155030252633747",
                "174934215160269620288049443391256802532",
                "253267550542776111191659593550172932070",
                "243276564824940847908268044159313024746",
                "23931924192152434765948355844781851532",
                "62796242045926843072021755892036893768",
                "162420502245603246404869788119264330487",
                "243276564824940847908268044159313024746",
                "23931924192152434765948355844781851532"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-c67716a8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4proc.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "118966971773073861072885337866217928671",
              "length": 926.0
            },
            "id": "CVE-2022-49418-c7dfe586",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4proc.c",
              "function": "_nfs40_proc_get_locations"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "155634420813075031881242186246612173565",
                "282127141477098464625694973563221965415",
                "70124267545722427983584855206130352615",
                "303384364317445284826951654703909572458",
                "328554684083623668536721531471652594816",
                "282127141477098464625694973563221965415",
                "70124267545722427983584855206130352615",
                "128054070112287213678976536357598389946"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-cb474b14",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4xdr.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "235578307073298090151763670417358315697",
                "297709304754115789574006317487471356993",
                "258866936204005816175651445435903635803",
                "205623923022014821714294467832754965277",
                "228007573809947245533311007651493394611",
                "290483836632124812624078789962525173639",
                "304694327035004036191183015223802465635",
                "118615087621817044448789016706754134171",
                "194827547076281610664993474838464611944",
                "165476405925288820781662296814020459550",
                "324688845438339641293582853106238515101",
                "108711201338959355436890414255209117205"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-ceec66c9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4state.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "287112740657807023904103101585740147961",
                "92076234177639242339781196219945396758",
                "60849326833119061956698350347707256682",
                "151546765796915665226157161621911670148",
                "300891291228817116859740601490238105864",
                "33329418125520516590592907248880352381",
                "14958037470141591018970767614066341790",
                "272817344153529007207954408208658891171",
                "310819429943320952239319100945506094308",
                "294684481793005074418825898650724703588",
                "284852767568939866208404758986813844484",
                "135048408280236198033297538181704054875",
                "178232548585010373670530362802723727332"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-d1fc435d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6015292653d95ba9f72906e2b65e536aa5807d64",
            "target": {
              "file": "fs/nfs/nfs4namespace.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "101210455665832683191657956459763141576",
                "259136458363998573972171732364014630639",
                "128040958933438836104204809006261606408",
                "142848482804616427808564520290832168146"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-e8f93bc1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "include/linux/nfs_xdr.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "279111582415622060753254104150199784693",
              "length": 780.0
            },
            "id": "CVE-2022-49418-ee66e83f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4namespace.c",
              "function": "nfs_do_refmount"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "117084116670229382730122276530126856395",
                "116558634851279488075806567429207837258",
                "42409546474535791233555164774548177818",
                "113390363226342039750858767057890346082",
                "142418103719104465964468462779210366247",
                "188788094268372630875716281400573588284",
                "177121051833827227136927978058133119206",
                "269860824426662788077881101740106401079",
                "72014713235022597437183093040511893077",
                "152895971899377847326386009853028439897",
                "222597467977294951828318741486036591996",
                "34662036231615591993118375770279227970",
                "122242641703624990302520540694945208015",
                "113455626232392526545612901823045177277",
                "324677236320632337974799845998264069625",
                "287257096208327373499904002238273556296",
                "292326431870281833739592269187778524474",
                "130564201155693192556053155030252633747",
                "174934215160269620288049443391256802532",
                "253267550542776111191659593550172932070",
                "243276564824940847908268044159313024746",
                "23931924192152434765948355844781851532",
                "62796242045926843072021755892036893768",
                "162420502245603246404869788119264330487",
                "243276564824940847908268044159313024746",
                "23931924192152434765948355844781851532"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49418-f265d60d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c3ed222745d9ad7b69299b349a64ba533c64a34f",
            "target": {
              "file": "fs/nfs/nfs4proc.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "9558a007dbc383d48e7f5a123d0b5ff656c71068"
            },
            {
              "fixed": "6015292653d95ba9f72906e2b65e536aa5807d64"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "9558a007dbc383d48e7f5a123d0b5ff656c71068"
            },
            {
              "fixed": "c3ed222745d9ad7b69299b349a64ba533c64a34f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.15",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.18.1",
        "v5.18.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49418.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.18.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nNFSv4: Fix free of uninitialized nfs4_label on referral lookup.\n\nSend along the already-allocated fattr along with nfs4_fs_locations, and\ndrop the memcpy of fattr.  We end up growing two more allocations, but this\nfixes up a crash as:\n\nPID: 790    TASK: ffff88811b43c000  CPU: 0   COMMAND: \"ls\"\n #0 [ffffc90000857920] panic at ffffffff81b9bfde\n #1 [ffffc900008579c0] do_trap at ffffffff81023a9b\n #2 [ffffc90000857a10] do_error_trap at ffffffff81023b78\n #3 [ffffc90000857a58] exc_stack_segment at ffffffff81be1f45\n #4 [ffffc90000857a80] asm_exc_stack_segment at ffffffff81c009de\n #5 [ffffc90000857b08] nfs_lookup at ffffffffa0302322 [nfs]\n #6 [ffffc90000857b70] __lookup_slow at ffffffff813a4a5f\n #7 [ffffc90000857c60] walk_component at ffffffff813a86c4\n #8 [ffffc90000857cb8] path_lookupat at ffffffff813a9553\n #9 [ffffc90000857cf0] filename_lookup at ffffffff813ab86b",
  "id": "CVE-2022-49418",
  "modified": "2025-10-21T09:58:44.377663Z",
  "published": "2025-02-26T02:12:43Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6015292653d95ba9f72906e2b65e536aa5807d64"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c3ed222745d9ad7b69299b349a64ba533c64a34f"
    }
  ],
  "related": [
    "SUSE-SU-2025:1027-1",
    "SUSE-SU-2025:1176-1",
    "SUSE-SU-2025:1183-1",
    "SUSE-SU-2025:1241-1"
  ],
  "schema_version": "1.7.3",
  "summary": "NFSv4: Fix free of uninitialized nfs4_label on referral lookup."
}