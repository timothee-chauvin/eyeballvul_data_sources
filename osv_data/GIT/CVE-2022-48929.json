{"schema_version":"1.7.3","id":"CVE-2022-48929","published":"2024-08-22T03:31:22Z","modified":"2025-10-21T08:36:16.806912Z","related":["SUSE-SU-2024:3190-1","SUSE-SU-2024:3209-1","SUSE-SU-2024:3227-1","SUSE-SU-2024:3408-1","SUSE-SU-2024:3483-1"],"summary":"bpf: Fix crash due to out of bounds access into reg2btf_ids.","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix crash due to out of bounds access into reg2btf_ids.\n\nWhen commit e6ac2450d6de (\"bpf: Support bpf program calling kernel function\") added\nkfunc support, it defined reg2btf_ids as a cheap way to translate the verifier\nreg type to the appropriate btf_vmlinux BTF ID, however\ncommit c25b2ae13603 (\"bpf: Replace PTR_TO_XXX_OR_NULL with PTR_TO_XXX | PTR_MAYBE_NULL\")\nmoved the __BPF_REG_TYPE_MAX from the last member of bpf_reg_type enum to after\nthe base register types, and defined other variants using type flag\ncomposition. However, now, the direct usage of reg->type to index into\nreg2btf_ids may no longer fall into __BPF_REG_TYPE_MAX range, and hence lead to\nout of bounds access and kernel crash on dereference of bad pointer.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8d38cde47a7e17b646401fa92d916503caa5375e"},{"fixed":"8c39925e98d498b9531343066ef82ae39e41adae"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"77459bc4d5e2c6f24db845780b4d9d60cf82d06a"},{"fixed":"f0ce1bc9e0235dd7412240be493d7ea65ed9eadc"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"c25b2ae136039ffa820c26138ed4a5e5f3ab3841"},{"fixed":"45ce4b4f9009102cd9f581196d480a59208690c1"}]}],"versions":["v5.16","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.11","v5.17-rc1","v5.17-rc2","v5.17-rc3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48929.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["185735859717445478909909342215418363322","315388050336316607651820517699071819912","211244977719919913790278234222888577978","293119958814196362193739649620201967036","217245959276309487064414807196912612473","112597146718969015299922191745875312170"],"threshold":0.9},"id":"CVE-2022-48929-0f5dd97d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8c39925e98d498b9531343066ef82ae39e41adae","target":{"file":"kernel/bpf/btf.c"}},{"deprecated":false,"digest":{"function_hash":"332157509082863023888858242331497814502","length":3190},"id":"CVE-2022-48929-337d5750","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@45ce4b4f9009102cd9f581196d480a59208690c1","target":{"file":"kernel/bpf/btf.c","function":"btf_check_func_arg_match"}},{"deprecated":false,"digest":{"function_hash":"92513341473729784121443978447738506768","length":2978},"id":"CVE-2022-48929-98ac1719","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8c39925e98d498b9531343066ef82ae39e41adae","target":{"file":"kernel/bpf/btf.c","function":"btf_check_func_arg_match"}},{"deprecated":false,"digest":{"line_hashes":["2098312279920638925621058775474848170","29171577621517709889959052017641904616","13192778087237826027751481543691687042","181323938978567283946822953534466731932","305570803095730273762315165292407664410","254587448695114794644501988218421765594","208613901341212872792924409347614742976","238142163886220055119019254554972492343"],"threshold":0.9},"id":"CVE-2022-48929-d8c8be50","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@45ce4b4f9009102cd9f581196d480a59208690c1","target":{"file":"kernel/bpf/btf.c"}},{"deprecated":false,"digest":{"line_hashes":["120881531066431358252801400411810331967","320549989309562310546525382297587691975","13192778087237826027751481543691687042","181323938978567283946822953534466731932","305570803095730273762315165292407664410","254587448695114794644501988218421765594","208613901341212872792924409347614742976","238142163886220055119019254554972492343"],"threshold":0.9},"id":"CVE-2022-48929-ed0a24c2","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f0ce1bc9e0235dd7412240be493d7ea65ed9eadc","target":{"file":"kernel/bpf/btf.c"}},{"deprecated":false,"digest":{"function_hash":"332157509082863023888858242331497814502","length":3190},"id":"CVE-2022-48929-ff9fcd1f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f0ce1bc9e0235dd7412240be493d7ea65ed9eadc","target":{"file":"kernel/bpf/btf.c","function":"btf_check_func_arg_match"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.16.11"},{"fixed":"5.16.12"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48929.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/45ce4b4f9009102cd9f581196d480a59208690c1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8c39925e98d498b9531343066ef82ae39e41adae"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f0ce1bc9e0235dd7412240be493d7ea65ed9eadc"}]}