{"schema_version":"1.7.3","id":"CVE-2025-38379","published":"2025-07-25T12:53:21.098Z","modified":"2025-11-20T10:01:14.310501Z","related":["MGASA-2025-0218","MGASA-2025-0219"],"summary":"smb: client: fix warning when reconnecting channel","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nsmb: client: fix warning when reconnecting channel\n\nWhen reconnecting a channel in smb2_reconnect_server(), a dummy tcon\nis passed down to smb2_reconnect() with ->query_interface\nuninitialized, so we can't call queue_delayed_work() on it.\n\nFix the following warning by ensuring that we're queueing the delayed\nworker from correct tcon.\n\nWARNING: CPU: 4 PID: 1126 at kernel/workqueue.c:2498 __queue_delayed_work+0x1d2/0x200\nModules linked in: cifs cifs_arc4 nls_ucs2_utils cifs_md4 [last unloaded: cifs]\nCPU: 4 UID: 0 PID: 1126 Comm: kworker/4:0 Not tainted 6.16.0-rc3 #5 PREEMPT(voluntary)\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-4.fc42 04/01/2014\nWorkqueue: cifsiod smb2_reconnect_server [cifs]\nRIP: 0010:__queue_delayed_work+0x1d2/0x200\nCode: 41 5e 41 5f e9 7f ee ff ff 90 0f 0b 90 e9 5d ff ff ff bf 02 00\n00 00 e8 6c f3 07 00 89 c3 eb bd 90 0f 0b 90 e9 57 f> 0b 90 e9 65 fe\nff ff 90 0f 0b 90 e9 72 fe ff ff 90 0f 0b 90 e9\nRSP: 0018:ffffc900014afad8 EFLAGS: 00010003\nRAX: 0000000000000000 RBX: ffff888124d99988 RCX: ffffffff81399cc1\nRDX: dffffc0000000000 RSI: ffff888114326e00 RDI: ffff888124d999f0\nRBP: 000000000000ea60 R08: 0000000000000001 R09: ffffed10249b3331\nR10: ffff888124d9998f R11: 0000000000000004 R12: 0000000000000040\nR13: ffff888114326e00 R14: ffff888124d999d8 R15: ffff888114939020\nFS:  0000000000000000(0000) GS:ffff88829f7fe000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007ffe7a2b4038 CR3: 0000000120a6f000 CR4: 0000000000750ef0\nPKRU: 55555554\nCall Trace:\n <TASK>\n queue_delayed_work_on+0xb4/0xc0\n smb2_reconnect+0xb22/0xf50 [cifs]\n smb2_reconnect_server+0x413/0xd40 [cifs]\n ? __pfx_smb2_reconnect_server+0x10/0x10 [cifs]\n ? local_clock_noinstr+0xd/0xd0\n ? local_clock+0x15/0x30\n ? lock_release+0x29b/0x390\n process_one_work+0x4c5/0xa10\n ? __pfx_process_one_work+0x10/0x10\n ? __list_add_valid_or_report+0x37/0x120\n worker_thread+0x2f1/0x5a0\n ? __kthread_parkme+0xde/0x100\n ? __pfx_worker_thread+0x10/0x10\n kthread+0x1fe/0x380\n ? kthread+0x10f/0x380\n ? __pfx_kthread+0x10/0x10\n ? local_clock_noinstr+0xd/0xd0\n ? ret_from_fork+0x1b/0x1f0\n ? local_clock+0x15/0x30\n ? lock_release+0x29b/0x390\n ? rcu_is_watching+0x20/0x50\n ? __pfx_kthread+0x10/0x10\n ret_from_fork+0x15b/0x1f0\n ? __pfx_kthread+0x10/0x10\n ret_from_fork_asm+0x1a/0x30\n </TASK>\nirq event stamp: 1116206\nhardirqs last  enabled at (1116205): [<ffffffff8143af42>] __up_console_sem+0x52/0x60\nhardirqs last disabled at (1116206): [<ffffffff81399f0e>] queue_delayed_work_on+0x6e/0xc0\nsoftirqs last  enabled at (1116138): [<ffffffffc04562fd>] __smb_send_rqst+0x42d/0x950 [cifs]\nsoftirqs last disabled at (1116136): [<ffffffff823d35e1>] release_sock+0x21/0xf0","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"202d7e838967dda02855cd925db7fd8c52c56af7"},{"fixed":"0cee638d92ac898d73eccc4e4bab70e9fc95946a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"2c34f1e095a12be3674fb79d84d1af7896e49245"},{"fixed":"3f6932ef25378794894c3c1024092ad14da2d330"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4f81ee0af2b8c4089e308f7cb6b5ea5a4efe5b94"},{"fixed":"9d2b629a9dc5c72537645533af1cb11a7d34c4b1"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"42ca547b13a20e7cbb04fbdf8d5f089ac4bb35b7"},{"fixed":"3bbe46716092d8ef6b0df4b956f585c5cd0fc78e"}]}],"versions":["v6.12.35","v6.12.36","v6.15.4","v6.15.5","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.6.95","v6.6.96"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38379.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["328035803555227012247647326938124709951","201615836987193736018133047478001135184","89416255134409363658669211452549770297","186865636845388241785032489514253395384"],"threshold":0.9},"id":"CVE-2025-38379-132b46ce","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cee638d92ac898d73eccc4e4bab70e9fc95946a","target":{"file":"fs/smb/client/cifsglob.h"}},{"deprecated":false,"digest":{"line_hashes":["328035803555227012247647326938124709951","201615836987193736018133047478001135184","89416255134409363658669211452549770297","186865636845388241785032489514253395384"],"threshold":0.9},"id":"CVE-2025-38379-4d1c60c8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f6932ef25378794894c3c1024092ad14da2d330","target":{"file":"fs/smb/client/cifsglob.h"}},{"deprecated":false,"digest":{"function_hash":"295730860981635655305511457305136356870","length":2796},"id":"CVE-2025-38379-511f1f68","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cee638d92ac898d73eccc4e4bab70e9fc95946a","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect_server"}},{"deprecated":false,"digest":{"line_hashes":["328035803555227012247647326938124709951","201615836987193736018133047478001135184","89416255134409363658669211452549770297","186865636845388241785032489514253395384"],"threshold":0.9},"id":"CVE-2025-38379-5972fd83","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9d2b629a9dc5c72537645533af1cb11a7d34c4b1","target":{"file":"fs/smb/client/cifsglob.h"}},{"deprecated":false,"digest":{"line_hashes":["86691492427895622389303631635357585430","204271954154070211475667369331488733131","197712602379987582105924258880515326950","258800644115120246977882728965361972846","231055101379255746741591430505695936293","163302124953027076904136115650418583838","295841055289928067154124043719776128746","702993731166114101950236732834425736","229840294361642692361860248735477574093","137420901987512268923629428572375291903","15704086836506901344921260690768038061"],"threshold":0.9},"id":"CVE-2025-38379-5d37c6f5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9d2b629a9dc5c72537645533af1cb11a7d34c4b1","target":{"file":"fs/smb/client/smb2pdu.c"}},{"deprecated":false,"digest":{"function_hash":"241037564623607744673245270745926536666","length":2828},"id":"CVE-2025-38379-61d7438d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bbe46716092d8ef6b0df4b956f585c5cd0fc78e","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect_server"}},{"deprecated":false,"digest":{"function_hash":"260314395742329564616148342535115846749","length":5108},"id":"CVE-2025-38379-6e587f80","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bbe46716092d8ef6b0df4b956f585c5cd0fc78e","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect"}},{"deprecated":false,"digest":{"line_hashes":["328035803555227012247647326938124709951","201615836987193736018133047478001135184","89416255134409363658669211452549770297","186865636845388241785032489514253395384"],"threshold":0.9},"id":"CVE-2025-38379-79de77a0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bbe46716092d8ef6b0df4b956f585c5cd0fc78e","target":{"file":"fs/smb/client/cifsglob.h"}},{"deprecated":false,"digest":{"line_hashes":["86691492427895622389303631635357585430","204271954154070211475667369331488733131","197712602379987582105924258880515326950","258800644115120246977882728965361972846","231055101379255746741591430505695936293","163302124953027076904136115650418583838","295841055289928067154124043719776128746","702993731166114101950236732834425736","229840294361642692361860248735477574093","137420901987512268923629428572375291903","15704086836506901344921260690768038061"],"threshold":0.9},"id":"CVE-2025-38379-818837f0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f6932ef25378794894c3c1024092ad14da2d330","target":{"file":"fs/smb/client/smb2pdu.c"}},{"deprecated":false,"digest":{"function_hash":"295730860981635655305511457305136356870","length":2796},"id":"CVE-2025-38379-864a8852","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f6932ef25378794894c3c1024092ad14da2d330","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect_server"}},{"deprecated":false,"digest":{"function_hash":"146443644041824499177218905144890103651","length":5207},"id":"CVE-2025-38379-8ff7d4aa","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3f6932ef25378794894c3c1024092ad14da2d330","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect"}},{"deprecated":false,"digest":{"line_hashes":["86691492427895622389303631635357585430","204271954154070211475667369331488733131","197712602379987582105924258880515326950","258800644115120246977882728965361972846","231055101379255746741591430505695936293","163302124953027076904136115650418583838","295841055289928067154124043719776128746","702993731166114101950236732834425736","229840294361642692361860248735477574093","137420901987512268923629428572375291903","15704086836506901344921260690768038061"],"threshold":0.9},"id":"CVE-2025-38379-a54e505b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bbe46716092d8ef6b0df4b956f585c5cd0fc78e","target":{"file":"fs/smb/client/smb2pdu.c"}},{"deprecated":false,"digest":{"function_hash":"260314395742329564616148342535115846749","length":5108},"id":"CVE-2025-38379-a732231b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9d2b629a9dc5c72537645533af1cb11a7d34c4b1","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect"}},{"deprecated":false,"digest":{"function_hash":"146443644041824499177218905144890103651","length":5207},"id":"CVE-2025-38379-af6309cb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cee638d92ac898d73eccc4e4bab70e9fc95946a","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect"}},{"deprecated":false,"digest":{"function_hash":"241037564623607744673245270745926536666","length":2828},"id":"CVE-2025-38379-af7cdf31","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9d2b629a9dc5c72537645533af1cb11a7d34c4b1","target":{"file":"fs/smb/client/smb2pdu.c","function":"smb2_reconnect_server"}},{"deprecated":false,"digest":{"line_hashes":["86691492427895622389303631635357585430","204271954154070211475667369331488733131","197712602379987582105924258880515326950","258800644115120246977882728965361972846","231055101379255746741591430505695936293","163302124953027076904136115650418583838","295841055289928067154124043719776128746","702993731166114101950236732834425736","229840294361642692361860248735477574093","137420901987512268923629428572375291903","15704086836506901344921260690768038061"],"threshold":0.9},"id":"CVE-2025-38379-bd2a4bb5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cee638d92ac898d73eccc4e4bab70e9fc95946a","target":{"file":"fs/smb/client/smb2pdu.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.6.95"},{"fixed":"6.6.97"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.12.35"},{"fixed":"6.12.37"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.15.4"},{"fixed":"6.15.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38379.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0cee638d92ac898d73eccc4e4bab70e9fc95946a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3bbe46716092d8ef6b0df4b956f585c5cd0fc78e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3f6932ef25378794894c3c1024092ad14da2d330"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9d2b629a9dc5c72537645533af1cb11a7d34c4b1"}]}