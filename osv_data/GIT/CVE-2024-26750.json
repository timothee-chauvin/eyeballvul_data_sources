{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26750.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "160046329174344550870200527435804420421",
              "length": 2221.0
            },
            "id": "CVE-2024-26750-19abda56",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6c480d0f131862645d172ca9e25dc152b1a5c3a6",
            "target": {
              "file": "net/unix/garbage.c",
              "function": "unix_gc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "2709454387051568102289345227579402931",
                "187857490901171026607598406664103750674",
                "255726292493306822607251838691377432168",
                "191322418554474902310271150229135627421",
                "265953684674209164212274122987487777665",
                "221087788000768465174080777570461755200",
                "153637711687948706240363915914063647256",
                "169226853705793868052507431526156611869",
                "273956217867385671364041923426101399317",
                "22204116996989459027591160616724587927",
                "116245288906304152958580253030272264813",
                "335221521146134395053830477676097072849",
                "71182600261287144692014169728909648561",
                "55537166782366616088945345367098852261",
                "42475704442965827497984772523247478271",
                "43671212628553724104783275530633687991",
                "173956019944352759002716782077992643905",
                "318241650746992032880325229033739995838"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26750-508b80b5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6c480d0f131862645d172ca9e25dc152b1a5c3a6",
            "target": {
              "file": "net/unix/garbage.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "306924083055203098640999290384980163810",
              "length": 2244.0
            },
            "id": "CVE-2024-26750-5f9c4d61",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e9eac260369d0cf57ea53df95427125725507a0d",
            "target": {
              "file": "net/unix/garbage.c",
              "function": "unix_gc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "306924083055203098640999290384980163810",
              "length": 2244.0
            },
            "id": "CVE-2024-26750-98373a3c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aa82ac51d63328714645c827775d64dbfd9941f3",
            "target": {
              "file": "net/unix/garbage.c",
              "function": "unix_gc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "2709454387051568102289345227579402931",
                "187857490901171026607598406664103750674",
                "255726292493306822607251838691377432168",
                "191322418554474902310271150229135627421",
                "265953684674209164212274122987487777665",
                "221087788000768465174080777570461755200",
                "153637711687948706240363915914063647256",
                "169226853705793868052507431526156611869",
                "273956217867385671364041923426101399317",
                "22204116996989459027591160616724587927",
                "116245288906304152958580253030272264813",
                "335221521146134395053830477676097072849",
                "71182600261287144692014169728909648561",
                "55537166782366616088945345367098852261",
                "42475704442965827497984772523247478271",
                "43671212628553724104783275530633687991",
                "173956019944352759002716782077992643905",
                "318241650746992032880325229033739995838"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26750-9ba36203",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e9eac260369d0cf57ea53df95427125725507a0d",
            "target": {
              "file": "net/unix/garbage.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "2709454387051568102289345227579402931",
                "187857490901171026607598406664103750674",
                "255726292493306822607251838691377432168",
                "191322418554474902310271150229135627421",
                "265953684674209164212274122987487777665",
                "221087788000768465174080777570461755200",
                "153637711687948706240363915914063647256",
                "169226853705793868052507431526156611869",
                "273956217867385671364041923426101399317",
                "22204116996989459027591160616724587927",
                "116245288906304152958580253030272264813",
                "335221521146134395053830477676097072849",
                "71182600261287144692014169728909648561",
                "55537166782366616088945345367098852261",
                "42475704442965827497984772523247478271",
                "43671212628553724104783275530633687991",
                "173956019944352759002716782077992643905",
                "318241650746992032880325229033739995838"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26750-9e869a6d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aa82ac51d63328714645c827775d64dbfd9941f3",
            "target": {
              "file": "net/unix/garbage.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "2709454387051568102289345227579402931",
                "187857490901171026607598406664103750674",
                "255726292493306822607251838691377432168",
                "191322418554474902310271150229135627421",
                "265953684674209164212274122987487777665",
                "221087788000768465174080777570461755200",
                "153637711687948706240363915914063647256",
                "169226853705793868052507431526156611869",
                "273956217867385671364041923426101399317",
                "22204116996989459027591160616724587927",
                "116245288906304152958580253030272264813",
                "335221521146134395053830477676097072849",
                "71182600261287144692014169728909648561",
                "55537166782366616088945345367098852261",
                "42475704442965827497984772523247478271",
                "43671212628553724104783275530633687991",
                "173956019944352759002716782077992643905",
                "318241650746992032880325229033739995838"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26750-b7fc9bc4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@43ba9e331559a30000c862eea313248707afa787",
            "target": {
              "file": "net/unix/garbage.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "306924083055203098640999290384980163810",
              "length": 2244.0
            },
            "id": "CVE-2024-26750-e120dd51",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@43ba9e331559a30000c862eea313248707afa787",
            "target": {
              "file": "net/unix/garbage.c",
              "function": "unix_gc"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "36f7371de977f805750748e80279be7e370df85c"
            },
            {
              "fixed": "6c480d0f131862645d172ca9e25dc152b1a5c3a6"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "2a3d40b4025fcfe51b04924979f1653993b17669"
            },
            {
              "fixed": "c4c795b21dd23d9514ae1c6646c3fb2c78b5be60"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "69e0f04460f4037e01e29f0d9675544f62aafca3"
            },
            {
              "fixed": "e9eac260369d0cf57ea53df95427125725507a0d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "cb8890318dde26fc89c6ea67d6e9070ab50b6e91"
            },
            {
              "fixed": "43ba9e331559a30000c862eea313248707afa787"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "25236c91b5ab4a26a56ba2e79b8060cf4e047839"
            },
            {
              "fixed": "aa82ac51d63328714645c827775d64dbfd9941f3"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.15.149",
        "v5.15.150",
        "v6.8-rc4"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26750.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.15.149"
            },
            {
              "fixed": "5.15.151"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_unix: Drop oob_skb ref before purging queue in GC.\n\nsyzbot reported another task hung in __unix_gc().  [0]\n\nThe current while loop assumes that all of the left candidates\nhave oob_skb and calling kfree_skb(oob_skb) releases the remaining\ncandidates.\n\nHowever, I missed a case that oob_skb has self-referencing fd and\nanother fd and the latter sk is placed before the former in the\ncandidate list.  Then, the while loop never proceeds, resulting\nthe task hung.\n\n__unix_gc() has the same loop just before purging the collected skb,\nso we can call kfree_skb(oob_skb) there and let __skb_queue_purge()\nrelease all inflight sockets.\n\n[0]:\nSending NMI from CPU 0 to CPUs 1:\nNMI backtrace for cpu 1\nCPU: 1 PID: 2784 Comm: kworker/u4:8 Not tainted 6.8.0-rc4-syzkaller-01028-g71b605d32017 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/25/2024\nWorkqueue: events_unbound __unix_gc\nRIP: 0010:__sanitizer_cov_trace_pc+0x0/0x70 kernel/kcov.c:200\nCode: 89 fb e8 23 00 00 00 48 8b 3d 84 f5 1a 0c 48 89 de 5b e9 43 26 57 00 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 <f3> 0f 1e fa 48 8b 04 24 65 48 8b 0d 90 52 70 7e 65 8b 15 91 52 70\nRSP: 0018:ffffc9000a17fa78 EFLAGS: 00000287\nRAX: ffffffff8a0a6108 RBX: ffff88802b6c2640 RCX: ffff88802c0b3b80\nRDX: 0000000000000000 RSI: 0000000000000002 RDI: 0000000000000000\nRBP: ffffc9000a17fbf0 R08: ffffffff89383f1d R09: 1ffff1100ee5ff84\nR10: dffffc0000000000 R11: ffffed100ee5ff85 R12: 1ffff110056d84ee\nR13: ffffc9000a17fae0 R14: 0000000000000000 R15: ffffffff8f47b840\nFS:  0000000000000000(0000) GS:ffff8880b9500000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007ffef5687ff8 CR3: 0000000029b34000 CR4: 00000000003506f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <NMI>\n </NMI>\n <TASK>\n __unix_gc+0xe69/0xf40 net/unix/garbage.c:343\n process_one_work kernel/workqueue.c:2633 [inline]\n process_scheduled_works+0x913/0x1420 kernel/workqueue.c:2706\n worker_thread+0xa5f/0x1000 kernel/workqueue.c:2787\n kthread+0x2ef/0x390 kernel/kthread.c:388\n ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147\n ret_from_fork_asm+0x1b/0x30 arch/x86/entry/entry_64.S:242\n </TASK>",
  "id": "CVE-2024-26750",
  "modified": "2025-10-15T09:15:29.664721Z",
  "published": "2024-04-04T08:20:14Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/43ba9e331559a30000c862eea313248707afa787"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6c480d0f131862645d172ca9e25dc152b1a5c3a6"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/aa82ac51d63328714645c827775d64dbfd9941f3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c4c795b21dd23d9514ae1c6646c3fb2c78b5be60"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e9eac260369d0cf57ea53df95427125725507a0d"
    }
  ],
  "related": [
    "SUSE-SU-2024:2571-1",
    "SUSE-SU-2024:2896-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "summary": "af_unix: Drop oob_skb ref before purging queue in GC."
}