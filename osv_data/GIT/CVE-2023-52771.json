{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52771.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "27866084360420223994990832167478595312",
                "304234508396121521982578995636810707508",
                "281930578530913665189745758577956549790",
                "261176617091734262865221209950454443117",
                "249974647398921172427230238299657405982",
                "97705970677749313767584586193727761907",
                "338228921370927436525642404060657208388",
                "53343122348816420938085811380277089898",
                "129720405761893411927561124565319660673",
                "69734733575379069082150911183628800012",
                "310737095868275489073715672560372160814",
                "86461191110908835633472035061959728342",
                "85207150273993950804667883999115449",
                "276575726630063194793792101161047152324",
                "34873974038715017585965403129024170817",
                "86406583881859429748714194267861934115",
                "16638442311263737652235545975336219865",
                "321634099943002225844829893008315268829",
                "19671357142208922656676595859082613163",
                "174670266453364483267738712622770134970",
                "77432689325235010257557316929241656215",
                "92214585282336001466760974269775629774",
                "316410810710932096512008933053753320181",
                "90383057679987575040295199145748400921",
                "122118875470581589594696859916641769",
                "47158598908457387299034333166316009912",
                "80747932029413762494150424219160494369",
                "13712729792215441840589600123735278024"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52771-1d5b3921",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6b2e428e673b3f55965674a426c40922e91388aa",
            "target": {
              "file": "drivers/cxl/core/port.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45051904909561708072101279295793256937",
              "length": 488.0
            },
            "id": "CVE-2023-52771-36b03395",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37179fcc916bce8c3cc7b36d67ef814cce55142b",
            "target": {
              "file": "drivers/cxl/core/port.c",
              "function": "delete_endpoint"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "219988668420438045547598490349806839388",
              "length": 224.0
            },
            "id": "CVE-2023-52771-3ff30135",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6b2e428e673b3f55965674a426c40922e91388aa",
            "target": {
              "file": "drivers/cxl/core/port.c",
              "function": "cxl_endpoint_autoremove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "219988668420438045547598490349806839388",
              "length": 224.0
            },
            "id": "CVE-2023-52771-50682db2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8d2ad999ca3c64cb08cf6a58d227b9d9e746d708",
            "target": {
              "file": "drivers/cxl/core/port.c",
              "function": "cxl_endpoint_autoremove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45051904909561708072101279295793256937",
              "length": 488.0
            },
            "id": "CVE-2023-52771-6839a159",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6b2e428e673b3f55965674a426c40922e91388aa",
            "target": {
              "file": "drivers/cxl/core/port.c",
              "function": "delete_endpoint"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45051904909561708072101279295793256937",
              "length": 488.0
            },
            "id": "CVE-2023-52771-c2c72c5f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8d2ad999ca3c64cb08cf6a58d227b9d9e746d708",
            "target": {
              "file": "drivers/cxl/core/port.c",
              "function": "delete_endpoint"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "27866084360420223994990832167478595312",
                "304234508396121521982578995636810707508",
                "281930578530913665189745758577956549790",
                "261176617091734262865221209950454443117",
                "249974647398921172427230238299657405982",
                "97705970677749313767584586193727761907",
                "338228921370927436525642404060657208388",
                "53343122348816420938085811380277089898",
                "129720405761893411927561124565319660673",
                "69734733575379069082150911183628800012",
                "310737095868275489073715672560372160814",
                "86461191110908835633472035061959728342",
                "85207150273993950804667883999115449",
                "276575726630063194793792101161047152324",
                "34873974038715017585965403129024170817",
                "86406583881859429748714194267861934115",
                "16638442311263737652235545975336219865",
                "321634099943002225844829893008315268829",
                "19671357142208922656676595859082613163",
                "174670266453364483267738712622770134970",
                "77432689325235010257557316929241656215",
                "92214585282336001466760974269775629774",
                "316410810710932096512008933053753320181",
                "90383057679987575040295199145748400921",
                "122118875470581589594696859916641769",
                "47158598908457387299034333166316009912",
                "80747932029413762494150424219160494369",
                "13712729792215441840589600123735278024"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52771-c7040393",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37179fcc916bce8c3cc7b36d67ef814cce55142b",
            "target": {
              "file": "drivers/cxl/core/port.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "27866084360420223994990832167478595312",
                "304234508396121521982578995636810707508",
                "281930578530913665189745758577956549790",
                "261176617091734262865221209950454443117",
                "249974647398921172427230238299657405982",
                "97705970677749313767584586193727761907",
                "338228921370927436525642404060657208388",
                "53343122348816420938085811380277089898",
                "129720405761893411927561124565319660673",
                "69734733575379069082150911183628800012",
                "310737095868275489073715672560372160814",
                "86461191110908835633472035061959728342",
                "85207150273993950804667883999115449",
                "276575726630063194793792101161047152324",
                "34873974038715017585965403129024170817",
                "86406583881859429748714194267861934115",
                "16638442311263737652235545975336219865",
                "321634099943002225844829893008315268829",
                "19671357142208922656676595859082613163",
                "174670266453364483267738712622770134970",
                "77432689325235010257557316929241656215",
                "92214585282336001466760974269775629774",
                "316410810710932096512008933053753320181",
                "90383057679987575040295199145748400921",
                "122118875470581589594696859916641769",
                "47158598908457387299034333166316009912",
                "80747932029413762494150424219160494369",
                "13712729792215441840589600123735278024"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52771-f3986b54",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8d2ad999ca3c64cb08cf6a58d227b9d9e746d708",
            "target": {
              "file": "drivers/cxl/core/port.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "219988668420438045547598490349806839388",
              "length": 224.0
            },
            "id": "CVE-2023-52771-fe55008f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37179fcc916bce8c3cc7b36d67ef814cce55142b",
            "target": {
              "file": "drivers/cxl/core/port.c",
              "function": "cxl_endpoint_autoremove"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "8dd2bc0f8e02d39bd80851ca787bcbdb7d495e69"
            },
            {
              "fixed": "37179fcc916bce8c3cc7b36d67ef814cce55142b"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "8dd2bc0f8e02d39bd80851ca787bcbdb7d495e69"
            },
            {
              "fixed": "6b2e428e673b3f55965674a426c40922e91388aa"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "8dd2bc0f8e02d39bd80851ca787bcbdb7d495e69"
            },
            {
              "fixed": "8d2ad999ca3c64cb08cf6a58d227b9d9e746d708"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.17",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.5.1",
        "v6.5.10",
        "v6.5.11",
        "v6.5.12",
        "v6.5.2",
        "v6.5.3",
        "v6.5.4",
        "v6.5.5",
        "v6.5.6",
        "v6.5.7",
        "v6.5.8",
        "v6.5.9",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52771.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "6.5.13"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ncxl/port: Fix delete_endpoint() vs parent unregistration race\n\nThe CXL subsystem, at cxl_mem ->probe() time, establishes a lineage of\nports (struct cxl_port objects) between an endpoint and the root of a\nCXL topology. Each port including the endpoint port is attached to the\ncxl_port driver.\n\nGiven that setup, it follows that when either any port in that lineage\ngoes through a cxl_port ->remove() event, or the memdev goes through a\ncxl_mem ->remove() event. The hierarchy below the removed port, or the\nentire hierarchy if the memdev is removed needs to come down.\n\nThe delete_endpoint() callback is careful to check whether it is being\ncalled to tear down the hierarchy, or if it is only being called to\nteardown the memdev because an ancestor port is going through\n->remove().\n\nThat care needs to take the device_lock() of the endpoint's parent.\nWhich requires 2 bugs to be fixed:\n\n1/ A reference on the parent is needed to prevent use-after-free\n   scenarios like this signature:\n\n    BUG: spinlock bad magic on CPU#0, kworker/u56:0/11\n    Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS edk2-20230524-3.fc38 05/24/2023\n    Workqueue: cxl_port detach_memdev [cxl_core]\n    RIP: 0010:spin_bug+0x65/0xa0\n    Call Trace:\n      do_raw_spin_lock+0x69/0xa0\n     __mutex_lock+0x695/0xb80\n     delete_endpoint+0xad/0x150 [cxl_core]\n     devres_release_all+0xb8/0x110\n     device_unbind_cleanup+0xe/0x70\n     device_release_driver_internal+0x1d2/0x210\n     detach_memdev+0x15/0x20 [cxl_core]\n     process_one_work+0x1e3/0x4c0\n     worker_thread+0x1dd/0x3d0\n\n2/ In the case of RCH topologies, the parent device that needs to be\n   locked is not always @port->dev as returned by cxl_mem_find_port(), use\n   endpoint->dev.parent instead.",
  "id": "CVE-2023-52771",
  "modified": "2025-10-21T14:46:10.893221Z",
  "published": "2024-05-21T15:30:53Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/37179fcc916bce8c3cc7b36d67ef814cce55142b"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6b2e428e673b3f55965674a426c40922e91388aa"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8d2ad999ca3c64cb08cf6a58d227b9d9e746d708"
    }
  ],
  "related": [
    "ALSA-2024:5928",
    "SUSE-SU-2024:2135-1",
    "SUSE-SU-2024:2203-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "cxl/port: Fix delete_endpoint() vs parent unregistration race"
}