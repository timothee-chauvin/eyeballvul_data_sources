{
  "id": "CURL-CVE-2020-8231",
  "summary": "wrong connect-only connection",
  "details": "An application that performs multiple requests with libcurl's multi API and\nsets the `CURLOPT_CONNECT_ONLY` option, might in rare circumstances experience\nthat when subsequently using the setup connect-only transfer, libcurl picks\nand uses the wrong connection - and instead picks another one the application\nhas created since then.\n\n`CURLOPT_CONNECT_ONLY` is the option to tell libcurl to not perform an actual\ntransfer, only connect. When that operation is completed, libcurl remembers\nwhich connection it used for that transfer and \"easy handle\". It remembers the\nconnection using a pointer to the internal `connectdata` struct in memory.\n\nIf more transfers are then done with the same multi handle before the\nconnect-only connection is used, leading to the initial connect-only\nconnection to get closed (for example due to idle time-out) while also new\ntransfers (and connections) are setup, such a *new* connection might end up\ngetting the exact same memory address as the now closed connect-only\nconnection.\n\nIf after those operations, the application then wants to use the original\ntransfer's connect-only setup to for example use `curl_easy_send()` to send\nraw data over that connection, libcurl could **erroneously** find an existing\nconnection still being alive at the address it remembered since before even\nthough this is now a new and different connection.\n\nThe application could then accidentally send data over that connection which\nwas not at all intended for that recipient, entirely unknowingly.",
  "aliases": [
    "CVE-2020-8231"
  ],
  "modified": "2024-06-07T13:53:51Z",
  "published": "2020-08-19T08:00:00Z",
  "database_specific": {
    "CWE": {
      "id": "CWE-825",
      "desc": "Expired Pointer Dereference"
    },
    "award": {
      "amount": "500",
      "currency": "USD"
    },
    "URL": "https://curl.se/docs/CVE-2020-8231.json",
    "package": "curl",
    "severity": "Low",
    "issue": "https://hackerone.com/reports/948876",
    "www": "https://curl.se/docs/CVE-2020-8231.html",
    "last_affected": "7.71.1"
  },
  "affected": [
    {
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "7.29.0"
            },
            {
              "fixed": "7.72.0"
            }
          ]
        },
        {
          "type": "GIT",
          "repo": "https://github.com/curl/curl.git",
          "events": [
            {
              "introduced": "c43127414d89ccb9ef6517081f68986d991bcfb3"
            },
            {
              "fixed": "3c9e021f86872baae412a427e807fbfa2f3e8a22"
            }
          ]
        }
      ],
      "versions": [
        "7.71.1",
        "7.71.0",
        "7.70.0",
        "7.69.1",
        "7.69.0",
        "7.68.0",
        "7.67.0",
        "7.66.0",
        "7.65.3",
        "7.65.2",
        "7.65.1",
        "7.65.0",
        "7.64.1",
        "7.64.0",
        "7.63.0",
        "7.62.0",
        "7.61.1",
        "7.61.0",
        "7.60.0",
        "7.59.0",
        "7.58.0",
        "7.57.0",
        "7.56.1",
        "7.56.0",
        "7.55.1",
        "7.55.0",
        "7.54.1",
        "7.54.0",
        "7.53.1",
        "7.53.0",
        "7.52.1",
        "7.52.0",
        "7.51.0",
        "7.50.3",
        "7.50.2",
        "7.50.1",
        "7.50.0",
        "7.49.1",
        "7.49.0",
        "7.48.0",
        "7.47.1",
        "7.47.0",
        "7.46.0",
        "7.45.0",
        "7.44.0",
        "7.43.0",
        "7.42.1",
        "7.42.0",
        "7.41.0",
        "7.40.0",
        "7.39.0",
        "7.38.0",
        "7.37.1",
        "7.37.0",
        "7.36.0",
        "7.35.0",
        "7.34.0",
        "7.33.0",
        "7.32.0",
        "7.31.0",
        "7.30.0",
        "7.29.0"
      ],
      "database_specific": {
        "source": "https://curl.se/docs/CURL-CVE-2020-8231.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "credits": [
    {
      "name": "Marc Aldorasi",
      "type": "FINDER"
    },
    {
      "name": "Daniel Stenberg",
      "type": "REMEDIATION_DEVELOPER"
    }
  ]
}