{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-28866.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "101665994629629610948265502491154087190",
              "length": 250.0
            },
            "id": "CVE-2024-28866-0725288d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/test/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandlerTest.java",
              "function": "shouldRespondWithMessageInHTMLWhenAcceptHeaderIsMissing"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "60815323633200153814310049900027568387",
                "158539047956347661274525219085618335815",
                "162791183916504111048273815914207548477",
                "304342999350935753361603669457562265805"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-28866-07b2a7f9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "base/src/main/java/com/thoughtworks/go/util/SystemEnvironment.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "107113846780369222553362137153293690986",
              "length": 270.0
            },
            "id": "CVE-2024-28866-459ab122",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/main/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandler.java",
              "function": "loadingPage"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "171107038141362675695909051166393584481",
              "length": 222.0
            },
            "id": "CVE-2024-28866-5759128e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/test/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandlerTest.java",
              "function": "shouldRespondWithSimpleMessageIfLoadingHTMLFileCannotBeLoaded"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "116281198770573588702140547068440002358",
                "277429514863009788957110213513647394373",
                "118514630717285443603755659905700013106",
                "34419993736219219958292815581812582075",
                "293599749832482947769581038701422585630",
                "123546570049047043644533941155338911399",
                "152142118659493964304222790895615674945",
                "302600751821469795947873633025971979782",
                "253912268886986466684671443062468205593",
                "155826633699114206998613143775042993861",
                "66584758226885758590670306952634369451",
                "109936685325318580906612440736057701667",
                "139116428269088018381973661727654745364",
                "64714239888803424044551280215212875637",
                "129539506706219333659971203213297521799",
                "49474012944409201012848958175878683855",
                "3363189098417177295724797411080774677",
                "81987138305771758179406715698911358129",
                "82084330987638468459182879711529502616",
                "305296897912346103695015492505293465925",
                "73624284773179795017513115978493062084",
                "223161192150179805528907387391516918191",
                "16519608486758748851096969974908086967",
                "204805061841824751697059357412685609381",
                "124996749375088264503362736013093103750",
                "327381111114710939752162885433254475032",
                "269153348077721884483849866899419687104",
                "61259615811342398956402363553517275516",
                "86199087626052170307524458485531628997",
                "299531049863470441596593584173984386115",
                "136455842582222519356661154937009084131",
                "129671063828639501789576866511878268705",
                "136176062257757818655161297020426973515",
                "283031961706333487319515161436384237425",
                "54985996440069255865884499512652672038",
                "151321415346479611847648259606834874579",
                "242887201010738615382513993360273688814",
                "86836674463918660670949372394989754983",
                "302829209575672093630131830423204044874",
                "224902689365953299346198869916318045566",
                "169779312782418155252835074639538600122",
                "107005762300261593810327073223325461338"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-28866-7b25c9f6",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/test/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandlerTest.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "171913215297125198010093534735162279925",
              "length": 263.0
            },
            "id": "CVE-2024-28866-85c2e725",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/test/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandlerTest.java",
              "function": "shouldRespondWithMessageInHTMLWhenAcceptHeaderContainsHTML"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "274416766978552478433123438974248645365",
              "length": 259.0
            },
            "id": "CVE-2024-28866-941ff184",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/test/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandlerTest.java",
              "function": "shouldRespondWithMessageInHTMLWhenRequestAcceptHeaderIsHTML"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "199784614858266250059763552058533669172",
                "317102314140993673081720438126301877900",
                "142948014472957904711945681988729885838",
                "229092117118868109683153285030057594002",
                "48995990969599379319359888379784149137",
                "289215101383553211055953998726654840639",
                "133716913527433649607320857025315879436",
                "43925576605091662686367940637643900779",
                "198215171545124651208557155983546646854",
                "260944514309962732442293642078060848648",
                "329938339386456641409898811482630461469",
                "49639711664960329925148719648490244860",
                "101983817353154808547387368372276765291",
                "88382451527012196601954844082298052045",
                "33958773581915855462705643040224384505",
                "320900215922780832337977561890409223341",
                "244037347780507751373521706500494577554",
                "90424482152464872799569529362597039509",
                "326129970996925652804701349535737128798",
                "314298289466808059431846603174513885051"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-28866-96b7bf66",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/main/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandler.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "35107630090523582594585492884939801595",
              "length": 166.0
            },
            "id": "CVE-2024-28866-c5646bb9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/test/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandlerTest.java",
              "function": "assertLoadingResponseInHTML"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "323595508485157506357109635190604582763",
              "length": 136.0
            },
            "id": "CVE-2024-28866-cbe3e23c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402",
            "target": {
              "file": "jetty/src/test/java/com/thoughtworks/go/server/GoServerLoadingIndicationHandlerTest.java",
              "function": "loadingPageIsSetTo"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "388d8893ec4cac51d2b76e923cc9b55c7703e402"
            },
            {
              "fixed": "a60529cdf34a96de310bc05e2041f2ac23014707"
            }
          ],
          "repo": "https://github.com/gocd/gocd",
          "type": "GIT"
        }
      ],
      "versions": [
        "14.2.0",
        "14.3.0",
        "14.4.0",
        "15.1.0",
        "15.2.0",
        "15.3.0",
        "15.3.1",
        "16.1.0",
        "16.10.0",
        "16.11.0",
        "16.12.0",
        "16.2.0",
        "16.3.0",
        "16.4.0",
        "16.5.0",
        "16.6.0",
        "16.7.0",
        "16.8.0",
        "16.9.0",
        "17.1.0",
        "17.10.0",
        "17.11.0",
        "17.12.0",
        "17.2.0",
        "17.3.0",
        "17.4.0",
        "17.5.0",
        "17.6.0",
        "17.7.0",
        "17.8.0",
        "17.9.0",
        "18.1.0",
        "18.10.0",
        "18.11.0",
        "18.12.0",
        "18.2.0",
        "18.3.0",
        "18.4.0",
        "18.5.0",
        "18.6.0",
        "18.7.0",
        "18.8.0",
        "18.9.0",
        "19.1.0",
        "19.10.0",
        "19.11.0",
        "19.12.0",
        "19.2.0",
        "19.3.0",
        "19.4.0",
        "19.5.0",
        "19.6.0",
        "19.7.0",
        "19.8.0",
        "19.9.0",
        "20.1.0",
        "20.10.0",
        "20.2.0",
        "20.3.0",
        "20.4.0",
        "20.5.0",
        "20.6.0",
        "20.7.0",
        "20.8.0",
        "20.9.0",
        "21.1.0",
        "21.2.0",
        "21.3.0",
        "21.4.0",
        "22.1.0",
        "22.2.0",
        "22.3.0",
        "23.1.0",
        "23.2.0",
        "23.3.0",
        "23.4.0",
        "23.5.0"
      ]
    }
  ],
  "details": "GoCD is a continuous delivery server. GoCD versions from 19.4.0 to 23.5.0 (inclusive) are potentially vulnerable to a reflected cross-site scripting vulnerability on the loading page displayed while GoCD is starting, via abuse of a `redirect_to` query parameter with inadequate validation.\n\nAttackers could theoretically abuse the query parameter to steal session tokens or other values from the user's browser. In practice exploiting this to perform privileged actions is likely rather difficult to exploit because the target user would need to be triggered to open an attacker-crafted link in the period where the server is starting up (but not completely started), requiring chaining with a separate denial-of-service vulnerability. Additionally, GoCD server restarts invalidate earlier session tokens (i.e GoCD does not support persistent sessions), so a stolen session token would be unusable once the server has completed restart, and executed XSS would be done within a logged-out context.\n\nThe issue is fixed in GoCD 24.1.0. As a workaround, it is technically possible in earlier GoCD versions to override the loading page with an earlier version which is not vulnerable, by starting GoCD with the Java system property override as either `-Dloading.page.resource.path=/loading_pages/default.loading.page.html` (simpler early version of loading page without GoCD introduction) or `-Dloading.page.resource.path=/does_not_exist.html` (to display a simple message with no interactivity).",
  "id": "CVE-2024-28866",
  "modified": "2025-10-10T04:52:29.079660Z",
  "published": "2024-05-14T15:14:46Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/gocd/gocd/releases/tag/24.1.0"
    },
    {
      "type": "ADVISORY",
      "url": "https://github.com/gocd/gocd/security/advisories/GHSA-q882-q6mm-mgvh"
    },
    {
      "type": "ADVISORY",
      "url": "https://www.gocd.org/releases/#24-1-0"
    },
    {
      "type": "FIX",
      "url": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402"
    }
  ],
  "related": [
    "GHSA-q882-q6mm-mgvh"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
      "type": "CVSS_V3"
    }
  ]
}