{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-41085.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "239222672556732926929802963267530333920",
              "length": 1595.0
            },
            "id": "CVE-2024-41085-1ef5868a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/mem.c",
              "function": "cxl_mem_probe"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "309123740332088486046097802553425858820",
                "182413631775720135898389319113129501859",
                "4346425365444604260715026180633971902",
                "128342013462427301512204475500567264144",
                "210432617798344187903220927268320886228",
                "144129660903611565684027532719127686231",
                "115311398132946145927282984122403649863",
                "160304077121955186487143781050757096358",
                "168188421807942650230260942373732270956",
                "176094456351430682053832599116363570014",
                "115232739030941804192056722520187990388",
                "202766974195884564950257705639115726267",
                "286404531495727043387630818403811959829"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-21f3b580",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/mem.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "226253506362491571129162559611772621316",
              "length": 1236.0
            },
            "id": "CVE-2024-41085-3e21bfe9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/core/region.c",
              "function": "cxl_pmem_region_alloc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "58500011797587469053638473516908435524",
                "92522823466643405565266192946759305920",
                "184358585476143861403975915473183992518",
                "248206145418433585638848921433540165169",
                "27818452189264186894824144351718127796",
                "124577264931906903638665888915196676496",
                "222707368431710411438681133200682964486",
                "194207416066738061499266579432700092272",
                "329931221797473408655052028572907359030",
                "10208248443944626433318531280257200412",
                "153935828026020702679265212079289635493",
                "23002797599179316859560156320645529901",
                "329038241805694769135610943830084213299",
                "123346280760940344372299455763664588752",
                "165972352926091240837521045360523430471",
                "107885255498724221625395829046115481672",
                "25550249485158302426258062410802937100"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-48d2e2f2",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/core/pmem.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "240942162548891081914095258883144761574",
              "length": 276.0
            },
            "id": "CVE-2024-41085-4968069c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/core/pmem.c",
              "function": "cxl_find_nvdimm_bridge"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "58500011797587469053638473516908435524",
                "92522823466643405565266192946759305920",
                "184358585476143861403975915473183992518",
                "248206145418433585638848921433540165169",
                "27818452189264186894824144351718127796",
                "124577264931906903638665888915196676496",
                "222707368431710411438681133200682964486",
                "194207416066738061499266579432700092272",
                "329931221797473408655052028572907359030",
                "10208248443944626433318531280257200412",
                "153935828026020702679265212079289635493",
                "23002797599179316859560156320645529901",
                "329038241805694769135610943830084213299",
                "123346280760940344372299455763664588752",
                "165972352926091240837521045360523430471",
                "107885255498724221625395829046115481672",
                "25550249485158302426258062410802937100"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-4a455d05",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/core/pmem.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "261676917608474206071665971849058559690",
                "5867601117907642265330956042567441232",
                "165133301491369443257566705872530558528",
                "1584694379002965733226063405997474544",
                "257367570499306086252759664412718866463"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-54c0b204",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/cxl.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "239222672556732926929802963267530333920",
              "length": 1595.0
            },
            "id": "CVE-2024-41085-5c7f76b3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/mem.c",
              "function": "cxl_mem_probe"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "83692375406226107876825500140906998710",
              "length": 669.0
            },
            "id": "CVE-2024-41085-60839d57",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/core/pmem.c",
              "function": "devm_cxl_add_nvdimm"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "118159601991038901917106815519936138379",
                "47769331761139572837637851682105587866",
                "211002372828770988568884588857634547645",
                "205321511272318588516641945696997629663"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-6b7ad680",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/core/region.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "240942162548891081914095258883144761574",
              "length": 276.0
            },
            "id": "CVE-2024-41085-7a8c73e1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/core/pmem.c",
              "function": "cxl_find_nvdimm_bridge"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "261676917608474206071665971849058559690",
                "5867601117907642265330956042567441232",
                "165133301491369443257566705872530558528",
                "1584694379002965733226063405997474544",
                "257367570499306086252759664412718866463"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-8733e65d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d064e4fbebcf5b18dc10c1f3973487eb163b600",
            "target": {
              "file": "drivers/cxl/cxl.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "118159601991038901917106815519936138379",
                "47769331761139572837637851682105587866",
                "211002372828770988568884588857634547645",
                "205321511272318588516641945696997629663"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-88c7f74d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/core/region.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "226253506362491571129162559611772621316",
              "length": 1236.0
            },
            "id": "CVE-2024-41085-89ee93d1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/core/region.c",
              "function": "cxl_pmem_region_alloc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "309123740332088486046097802553425858820",
                "182413631775720135898389319113129501859",
                "4346425365444604260715026180633971902",
                "128342013462427301512204475500567264144",
                "210432617798344187903220927268320886228",
                "144129660903611565684027532719127686231",
                "115311398132946145927282984122403649863",
                "160304077121955186487143781050757096358",
                "168188421807942650230260942373732270956",
                "176094456351430682053832599116363570014",
                "115232739030941804192056722520187990388",
                "202766974195884564950257705639115726267",
                "286404531495727043387630818403811959829"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41085-bf709938",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/mem.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "83692375406226107876825500140906998710",
              "length": 669.0
            },
            "id": "CVE-2024-41085-fe0e064b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@84ec985944ef34a34a1605b93ce401aa8737af96",
            "target": {
              "file": "drivers/cxl/core/pmem.c",
              "function": "devm_cxl_add_nvdimm"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f17b558d6663101f876a1d9cbbad3de0c8f4ce4d"
            },
            {
              "fixed": "1d064e4fbebcf5b18dc10c1f3973487eb163b600"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f17b558d6663101f876a1d9cbbad3de0c8f4ce4d"
            },
            {
              "fixed": "84ec985944ef34a34a1605b93ce401aa8737af96"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.1",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7",
        "v6.9.1",
        "v6.9.2",
        "v6.9.3",
        "v6.9.4",
        "v6.9.5",
        "v6.9.6",
        "v6.9.7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-41085.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.9.8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ncxl/mem: Fix no cxl_nvd during pmem region auto-assembling\n\nWhen CXL subsystem is auto-assembling a pmem region during cxl\nendpoint port probing, always hit below calltrace.\n\n BUG: kernel NULL pointer dereference, address: 0000000000000078\n #PF: supervisor read access in kernel mode\n #PF: error_code(0x0000) - not-present page\n RIP: 0010:cxl_pmem_region_probe+0x22e/0x360 [cxl_pmem]\n Call Trace:\n  <TASK>\n  ? __die+0x24/0x70\n  ? page_fault_oops+0x82/0x160\n  ? do_user_addr_fault+0x65/0x6b0\n  ? exc_page_fault+0x7d/0x170\n  ? asm_exc_page_fault+0x26/0x30\n  ? cxl_pmem_region_probe+0x22e/0x360 [cxl_pmem]\n  ? cxl_pmem_region_probe+0x1ac/0x360 [cxl_pmem]\n  cxl_bus_probe+0x1b/0x60 [cxl_core]\n  really_probe+0x173/0x410\n  ? __pfx___device_attach_driver+0x10/0x10\n  __driver_probe_device+0x80/0x170\n  driver_probe_device+0x1e/0x90\n  __device_attach_driver+0x90/0x120\n  bus_for_each_drv+0x84/0xe0\n  __device_attach+0xbc/0x1f0\n  bus_probe_device+0x90/0xa0\n  device_add+0x51c/0x710\n  devm_cxl_add_pmem_region+0x1b5/0x380 [cxl_core]\n  cxl_bus_probe+0x1b/0x60 [cxl_core]\n\nThe cxl_nvd of the memdev needs to be available during the pmem region\nprobe. Currently the cxl_nvd is registered after the endpoint port probe.\nThe endpoint probe, in the case of autoassembly of regions, can cause a\npmem region probe requiring the not yet available cxl_nvd. Adjust the\nsequence so this dependency is met.\n\nThis requires adding a port parameter to cxl_find_nvdimm_bridge() that\ncan be used to query the ancestor root port. The endpoint port is not\nyet available, but will share a common ancestor with its parent, so\nstart the query from there instead.",
  "id": "CVE-2024-41085",
  "modified": "2025-10-15T12:38:14.152169Z",
  "published": "2024-07-29T15:48:01Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1d064e4fbebcf5b18dc10c1f3973487eb163b600"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/84ec985944ef34a34a1605b93ce401aa8737af96"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "cxl/mem: Fix no cxl_nvd during pmem region auto-assembling"
}