{"schema_version":"1.7.3","id":"CVE-2025-22003","published":"2025-04-03T07:19:05.403Z","modified":"2025-11-20T08:32:04.499871Z","related":["MGASA-2025-0142","MGASA-2025-0146","SUSE-SU-2025:01707-1","SUSE-SU-2025:01919-1","SUSE-SU-2025:01951-1","SUSE-SU-2025:01964-1","SUSE-SU-2025:01967-1"],"summary":"can: ucan: fix out of bound read in strscpy() source","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ncan: ucan: fix out of bound read in strscpy() source\n\nCommit 7fdaf8966aae (\"can: ucan: use strscpy() to instead of strncpy()\")\nunintentionally introduced a one byte out of bound read on strscpy()'s\nsource argument (which is kind of ironic knowing that strscpy() is meant\nto be a more secure alternative :)).\n\nLet's consider below buffers:\n\n  dest[len + 1]; /* will be NUL terminated */\n  src[len]; /* may not be NUL terminated */\n\nWhen doing:\n\n  strncpy(dest, src, len);\n  dest[len] = '\\0';\n\nstrncpy() will read up to len bytes from src.\n\nOn the other hand:\n\n  strscpy(dest, src, len + 1);\n\nwill read up to len + 1 bytes from src, that is to say, an out of bound\nread of one byte will occur on src if it is not NUL terminated. Note\nthat the src[len] byte is never copied, but strscpy() still needs to\nread it to check whether a truncation occurred or not.\n\nThis exact pattern happened in ucan.\n\nThe root cause is that the source is not NUL terminated. Instead of\ndoing a copy in a local buffer, directly NUL terminate it as soon as\nusb_control_msg() returns. With this, the local firmware_str[] variable\ncan be removed.\n\nOn top of this do a couple refactors:\n\n  - ucan_ctl_payload->raw is only used for the firmware string, so\n    rename it to ucan_ctl_payload->fw_str and change its type from u8 to\n    char.\n\n  - ucan_device_request_in() is only used to retrieve the firmware\n    string, so rename it to ucan_get_fw_str() and refactor it to make it\n    directly handle all the string termination logic.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"7fdaf8966aae476deafe11f9a0067ff588615444"},{"fixed":"cc29775a8a72d7f3b56cc026796ad99bd65804a7"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"7fdaf8966aae476deafe11f9a0067ff588615444"},{"fixed":"8cec9e314d3360fc1d8346297c41a6ee45cb45a9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"7fdaf8966aae476deafe11f9a0067ff588615444"},{"fixed":"a4994161a61bc8fd71d105c579d847cefee99262"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"7fdaf8966aae476deafe11f9a0067ff588615444"},{"fixed":"1d22a122ffb116c3cf78053e812b8b21f8852ee9"}]}],"versions":["v6.1","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.2","v6.13.3","v6.13.4","v6.13.5","v6.13.6","v6.13.7","v6.13.8","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22003.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["104847560329234607700230536489212819369","65889989127422798191913391676385304158","101358758053269044906291413734838098481","53420729855834911463324167282855721936","204769770311798280209422563731008946666","127107393593945497921225325001206607941","155918119164611228783971726086233602134","295001165070763381893322929458337734375","263378390719330203911120131958155812871","289769003847252232280464927802763217659","168827521907702299783241256447184533335","54714213735624656385799519666130611733","217257344751143081076709130007743998477","125943891316023959136707811815813283467","18961382041103672912225059652352842930","245816153292727044312830530626836875900","236708264184017229555652190005367836661","112846569702452830496571288355519382864","70477072628541662161438272425627379706","136034828696651305898003726873279947368","165983978175165617030639389029824909762","281535289048186045676292388449829590326","211089995874254870850467534431116963267","81374151463864762358522156112256216391","322153231361784716897642556964855502601","264833170255507511026328296218611967401","335952250364116200846383602229805362467","275428205551863652007137576581757475214","136550180980906891557296101600899920855","1586351018592913798546899763546323182","99225658599100280684481447183357523144","75988362266959297553278813292011756779","14381139686602244297393466277251142316","42225111874500341698570010023861751677","279349952104769437069356405250252658075","338650604082579399766676544234448894848","278177933794325292798475681534829169685","9923803261165759340872127837833221276"],"threshold":0.9},"id":"CVE-2025-22003-5854a461","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d22a122ffb116c3cf78053e812b8b21f8852ee9","target":{"file":"drivers/net/can/usb/ucan.c"}},{"deprecated":false,"digest":{"function_hash":"287928120358746453883600943481915847400","length":5163},"id":"CVE-2025-22003-5ed18717","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4994161a61bc8fd71d105c579d847cefee99262","target":{"file":"drivers/net/can/usb/ucan.c","function":"ucan_probe"}},{"deprecated":false,"digest":{"function_hash":"287928120358746453883600943481915847400","length":5163},"id":"CVE-2025-22003-a6801943","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d22a122ffb116c3cf78053e812b8b21f8852ee9","target":{"file":"drivers/net/can/usb/ucan.c","function":"ucan_probe"}},{"deprecated":false,"digest":{"function_hash":"270140140094660354019595020795683795598","length":286},"id":"CVE-2025-22003-accb5b4e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4994161a61bc8fd71d105c579d847cefee99262","target":{"file":"drivers/net/can/usb/ucan.c","function":"ucan_device_request_in"}},{"deprecated":false,"digest":{"line_hashes":["104847560329234607700230536489212819369","65889989127422798191913391676385304158","101358758053269044906291413734838098481","53420729855834911463324167282855721936","204769770311798280209422563731008946666","127107393593945497921225325001206607941","155918119164611228783971726086233602134","295001165070763381893322929458337734375","263378390719330203911120131958155812871","289769003847252232280464927802763217659","168827521907702299783241256447184533335","54714213735624656385799519666130611733","217257344751143081076709130007743998477","125943891316023959136707811815813283467","18961382041103672912225059652352842930","245816153292727044312830530626836875900","236708264184017229555652190005367836661","112846569702452830496571288355519382864","70477072628541662161438272425627379706","136034828696651305898003726873279947368","165983978175165617030639389029824909762","281535289048186045676292388449829590326","211089995874254870850467534431116963267","81374151463864762358522156112256216391","322153231361784716897642556964855502601","264833170255507511026328296218611967401","335952250364116200846383602229805362467","275428205551863652007137576581757475214","136550180980906891557296101600899920855","1586351018592913798546899763546323182","99225658599100280684481447183357523144","75988362266959297553278813292011756779","14381139686602244297393466277251142316","42225111874500341698570010023861751677","279349952104769437069356405250252658075","338650604082579399766676544234448894848","278177933794325292798475681534829169685","9923803261165759340872127837833221276"],"threshold":0.9},"id":"CVE-2025-22003-f2360f55","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4994161a61bc8fd71d105c579d847cefee99262","target":{"file":"drivers/net/can/usb/ucan.c"}},{"deprecated":false,"digest":{"function_hash":"270140140094660354019595020795683795598","length":286},"id":"CVE-2025-22003-ff93afc1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d22a122ffb116c3cf78053e812b8b21f8852ee9","target":{"file":"drivers/net/can/usb/ucan.c","function":"ucan_device_request_in"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.85"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.21"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.9"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22003.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1d22a122ffb116c3cf78053e812b8b21f8852ee9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8cec9e314d3360fc1d8346297c41a6ee45cb45a9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a4994161a61bc8fd71d105c579d847cefee99262"},{"type":"WEB","url":"https://git.kernel.org/stable/c/cc29775a8a72d7f3b56cc026796ad99bd65804a7"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}