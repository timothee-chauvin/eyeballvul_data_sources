{"schema_version":"1.7.3","id":"CVE-2022-49479","published":"2025-02-26T02:13:20Z","modified":"2025-10-21T10:13:55.970173Z","related":["SUSE-SU-2025:1176-1","SUSE-SU-2025:1241-1"],"summary":"mt76: fix tx status related use-after-free race on station removal","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmt76: fix tx status related use-after-free race on station removal\n\nThere is a small race window where ongoing tx activity can lead to a skb\ngetting added to the status tracking idr after that idr has already been\ncleaned up, which will keep the wcid linked in the status poll list.\nFix this by only adding status skbs if the wcid pointer is still assigned\nin dev->wcid, which gets cleared early by mt76_sta_pre_rcu_remove","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bd1e3e7b693c17a04e7d2bd9119daa482b7c7720"},{"fixed":"ef7f9f894cfd0b2e471206409a529af4a26ddd55"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bd1e3e7b693c17a04e7d2bd9119daa482b7c7720"},{"fixed":"ddd426d72aca4054045a9bd3b80a4ce1d398f11f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"bd1e3e7b693c17a04e7d2bd9119daa482b7c7720"},{"fixed":"fcfe1b5e162bf473c1d47760962cec8523c00466"}]}],"versions":["v5.15","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.10","v5.17.11","v5.17.12","v5.17.13","v5.17.2","v5.17.3","v5.17.4","v5.17.5","v5.17.6","v5.17.7","v5.17.8","v5.17.9","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.18.1","v5.18.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49479.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["67188124270958412963953567594735161632","22579163774419742940668553992769277988","48011745401226203020868308461169786978","96547489801824953951463574177593410516","187226011258633738781573307293344267795"],"threshold":0.9},"id":"CVE-2022-49479-12f54b59","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ddd426d72aca4054045a9bd3b80a4ce1d398f11f","target":{"file":"drivers/net/wireless/mediatek/mt76/mac80211.c"}},{"deprecated":false,"digest":{"function_hash":"240273982333778755954772667835568742022","length":279},"id":"CVE-2022-49479-1c65c877","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ef7f9f894cfd0b2e471206409a529af4a26ddd55","target":{"file":"drivers/net/wireless/mediatek/mt76/mac80211.c","function":"mt76_sta_pre_rcu_remove"}},{"deprecated":false,"digest":{"line_hashes":["41378666212150184125057306271121506434","217443265290094491238938571682707466123","88046579510145287985375241395868826404","230676877202663927019273352710041827828"],"threshold":0.9},"id":"CVE-2022-49479-37fc509a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcfe1b5e162bf473c1d47760962cec8523c00466","target":{"file":"drivers/net/wireless/mediatek/mt76/tx.c"}},{"deprecated":false,"digest":{"line_hashes":["41378666212150184125057306271121506434","217443265290094491238938571682707466123","88046579510145287985375241395868826404","230676877202663927019273352710041827828"],"threshold":0.9},"id":"CVE-2022-49479-3c5f44f2","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ef7f9f894cfd0b2e471206409a529af4a26ddd55","target":{"file":"drivers/net/wireless/mediatek/mt76/tx.c"}},{"deprecated":false,"digest":{"function_hash":"23427193803630711377925801440995368599","length":832},"id":"CVE-2022-49479-4081b781","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcfe1b5e162bf473c1d47760962cec8523c00466","target":{"file":"drivers/net/wireless/mediatek/mt76/tx.c","function":"mt76_tx_status_skb_add"}},{"deprecated":false,"digest":{"line_hashes":["41378666212150184125057306271121506434","217443265290094491238938571682707466123","88046579510145287985375241395868826404","230676877202663927019273352710041827828"],"threshold":0.9},"id":"CVE-2022-49479-4d4dc5ad","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ddd426d72aca4054045a9bd3b80a4ce1d398f11f","target":{"file":"drivers/net/wireless/mediatek/mt76/tx.c"}},{"deprecated":false,"digest":{"function_hash":"240273982333778755954772667835568742022","length":279},"id":"CVE-2022-49479-7ff1f84f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ddd426d72aca4054045a9bd3b80a4ce1d398f11f","target":{"file":"drivers/net/wireless/mediatek/mt76/mac80211.c","function":"mt76_sta_pre_rcu_remove"}},{"deprecated":false,"digest":{"line_hashes":["67188124270958412963953567594735161632","22579163774419742940668553992769277988","48011745401226203020868308461169786978","96547489801824953951463574177593410516","187226011258633738781573307293344267795"],"threshold":0.9},"id":"CVE-2022-49479-a3872015","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcfe1b5e162bf473c1d47760962cec8523c00466","target":{"file":"drivers/net/wireless/mediatek/mt76/mac80211.c"}},{"deprecated":false,"digest":{"function_hash":"240273982333778755954772667835568742022","length":279},"id":"CVE-2022-49479-a39f5c0a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcfe1b5e162bf473c1d47760962cec8523c00466","target":{"file":"drivers/net/wireless/mediatek/mt76/mac80211.c","function":"mt76_sta_pre_rcu_remove"}},{"deprecated":false,"digest":{"function_hash":"23427193803630711377925801440995368599","length":832},"id":"CVE-2022-49479-c5b828a4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ef7f9f894cfd0b2e471206409a529af4a26ddd55","target":{"file":"drivers/net/wireless/mediatek/mt76/tx.c","function":"mt76_tx_status_skb_add"}},{"deprecated":false,"digest":{"line_hashes":["67188124270958412963953567594735161632","22579163774419742940668553992769277988","48011745401226203020868308461169786978","96547489801824953951463574177593410516","187226011258633738781573307293344267795"],"threshold":0.9},"id":"CVE-2022-49479-c7945e22","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ef7f9f894cfd0b2e471206409a529af4a26ddd55","target":{"file":"drivers/net/wireless/mediatek/mt76/mac80211.c"}},{"deprecated":false,"digest":{"function_hash":"23427193803630711377925801440995368599","length":832},"id":"CVE-2022-49479-cf2da4f3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ddd426d72aca4054045a9bd3b80a4ce1d398f11f","target":{"file":"drivers/net/wireless/mediatek/mt76/tx.c","function":"mt76_tx_status_skb_add"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.17.14"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.18.0"},{"fixed":"5.18.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49479.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ddd426d72aca4054045a9bd3b80a4ce1d398f11f"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ef7f9f894cfd0b2e471206409a529af4a26ddd55"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fcfe1b5e162bf473c1d47760962cec8523c00466"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}