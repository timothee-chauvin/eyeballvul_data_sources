{
  "affected": [
    {
      "database_specific": {
        "source": "https://github.com/psf/advisory-database/blob/main/advisories/python/PSF-2023-12.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "189411318785850568298533576954283130376",
                "211792046633170116419359087188057175268",
                "64397199614536702134583914944910092511",
                "88621379523515045929211927540840271876",
                "240123142396219197878374763112592446413",
                "320889104691819057095717797337483078805",
                "65515302783531606825779168779461923178",
                "307488279758457837705587482108685133220",
                "91803463576764163712498933663670892376",
                "200443514168655596833241232262831404668",
                "130494942091716593398144113029822445450",
                "34151014721715540780753740715808088251"
              ],
              "threshold": 0.9
            },
            "id": "PSF-2023-12-1ca77386",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/python/cpython/commit/9fe7655c6ce0b8e9adc229daf681b6d30e6b1610",
            "target": {
              "file": "Modules/_posixsubprocess.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45995096709570668763512622662490141621",
              "length": 5002.0
            },
            "id": "PSF-2023-12-49279a84",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/python/cpython/commit/9fe7655c6ce0b8e9adc229daf681b6d30e6b1610",
            "target": {
              "file": "Modules/_posixsubprocess.c",
              "function": "subprocess_fork_exec_impl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "189411318785850568298533576954283130376",
                "211792046633170116419359087188057175268",
                "64397199614536702134583914944910092511",
                "88621379523515045929211927540840271876",
                "240123142396219197878374763112592446413",
                "320889104691819057095717797337483078805",
                "65515302783531606825779168779461923178",
                "307488279758457837705587482108685133220",
                "91803463576764163712498933663670892376",
                "200443514168655596833241232262831404668",
                "130494942091716593398144113029822445450",
                "34151014721715540780753740715808088251"
              ],
              "threshold": 0.9
            },
            "id": "PSF-2023-12-85e58e5d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/python/cpython/commit/85bbfa8a4bbdbb61a3a84fbd7cb29a4096ab8a06",
            "target": {
              "file": "Modules/_posixsubprocess.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45995096709570668763512622662490141621",
              "length": 5002.0
            },
            "id": "PSF-2023-12-e4dc8630",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/python/cpython/commit/85bbfa8a4bbdbb61a3a84fbd7cb29a4096ab8a06",
            "target": {
              "file": "Modules/_posixsubprocess.c",
              "function": "subprocess_fork_exec_impl"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "124af17b6e49f0f22fbe646fb57800393235d704"
            },
            {
              "fixed": "9fe7655c6ce0b8e9adc229daf681b6d30e6b1610"
            },
            {
              "fixed": "10e9bb13b8dcaa414645b9bd10718d8f7179e82b"
            },
            {
              "fixed": "85bbfa8a4bbdbb61a3a84fbd7cb29a4096ab8a06"
            }
          ],
          "repo": "https://github.com/python/cpython",
          "type": "GIT"
        }
      ],
      "versions": [
        "v3.12.0",
        "v3.12.0a5",
        "v3.12.0a6",
        "v3.12.0a7",
        "v3.12.0b1",
        "v3.12.0b2",
        "v3.12.0b3",
        "v3.12.0b4",
        "v3.12.0rc1",
        "v3.12.0rc2",
        "v3.12.0rc3",
        "v3.13.0a1",
        "v3.13.0a2"
      ]
    }
  ],
  "aliases": [
    "BIT-libpython-2023-6507",
    "BIT-python-2023-6507",
    "BIT-python-min-2023-6507",
    "CVE-2023-6507",
    "PSF-CVE-2023-6507"
  ],
  "database_specific": {
    "cwe_ids": []
  },
  "details": "An issue was found in CPython 3.12.0 `subprocess` module on POSIX platforms. The issue was fixed in CPython 3.12.1 and does not affect other stable releases.\n\nWhen using the `extra_groups=` parameter with an empty list as a value (ie `extra_groups=[]`) the logic regressed to not call `setgroups(0, NULL)` before calling `exec()`, thus not dropping the original processes' groups before starting the new process. There is no issue when the parameter isn't used or when any value is used besides an empty list.\n\nThis issue only impacts CPython processes run with sufficient privilege to make the `setgroups` system call (typically `root`).\n\n",
  "id": "PSF-2023-12",
  "modified": "2025-10-09T01:01:28.587442Z",
  "published": "2023-12-08T18:20:49.583Z",
  "references": [
    {
      "type": "REPORT",
      "url": "https://github.com/python/cpython/issues/112334"
    },
    {
      "type": "ADVISORY",
      "url": "https://mail.python.org/archives/list/security-announce@python.org/thread/AUL7QFHBLILGISS7U63B47AYSSGJJQZD/"
    },
    {
      "type": "FIX",
      "url": "https://github.com/python/cpython/commit/9fe7655c6ce0b8e9adc229daf681b6d30e6b1610"
    },
    {
      "type": "FIX",
      "url": "https://github.com/python/cpython/commit/10e9bb13b8dcaa414645b9bd10718d8f7179e82b"
    },
    {
      "type": "FIX",
      "url": "https://github.com/python/cpython/commit/85bbfa8a4bbdbb61a3a84fbd7cb29a4096ab8a06"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "Groups not dropped before running subprocess when using empty 'extra_groups' parameter"
}