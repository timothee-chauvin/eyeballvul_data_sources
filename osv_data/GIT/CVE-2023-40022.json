{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-40022.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "173805491189666472246989821194758220784",
                "77494389211812549061820667115001734104"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-40022-20ab1dc3",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/rizinorg/rz-libdemangle/commit/51d016750e704b27ab8ace23c0f72acabca67018",
            "target": {
              "file": "test/test_cxx_gnu_v2.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "226571278237447313192644333707904407825",
                "56254276284438013358134424991968872862",
                "187849294898358650687268395890063097338",
                "275882997484359699344374885738579807230"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-40022-f2285001",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/rizinorg/rz-libdemangle/commit/51d016750e704b27ab8ace23c0f72acabca67018",
            "target": {
              "file": "src/gnu_v2/cplus-dem.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "d9af48b56e47afadd1a77e74c12099efd5e8e19e"
            }
          ],
          "repo": "https://github.com/rizinorg/rizin",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "51d016750e704b27ab8ace23c0f72acabca67018"
            }
          ],
          "repo": "https://github.com/rizinorg/rz-libdemangle",
          "type": "GIT"
        }
      ],
      "versions": [
        "0.1.0",
        "v0.1.0",
        "v0.1.1",
        "v0.1.2",
        "v0.2.0",
        "v0.2.1",
        "v0.3.0",
        "v0.3.1",
        "v0.3.2",
        "v0.3.3",
        "v0.3.4",
        "v0.4.0",
        "v0.4.1",
        "v0.5.0",
        "v0.5.1",
        "v0.5.2",
        "v0.6.0"
      ]
    }
  ],
  "details": "Rizin is a UNIX-like reverse engineering framework and command-line toolset. Versions 0.6.0 and prior are vulnerable to integer overflow in `consume_count` of `src/gnu_v2/cplus-dem.c`. The overflow check is valid logic but, is missing the modulus if the block once compiled. The compiler sees this block as unreachable code since the prior statement is multiplication by 10 and fails to consider overflow assuming the count will always be a multiple of 10. Rizin version 0.6.1 contains a fix for the issue. A temporary workaround would be disabling C++ demangling using the configuration option `bin.demangle=false`.",
  "id": "CVE-2023-40022",
  "modified": "2025-10-10T04:36:42.397634Z",
  "published": "2023-08-24T23:15:09Z",
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/rizinorg/rizin/security/advisories/GHSA-92h6-wwc2-53cq"
    },
    {
      "type": "FIX",
      "url": "https://github.com/rizinorg/rizin/pull/3753"
    },
    {
      "type": "FIX",
      "url": "https://github.com/rizinorg/rz-libdemangle/commit/51d016750e704b27ab8ace23c0f72acabca67018"
    },
    {
      "type": "FIX",
      "url": "https://github.com/rizinorg/rz-libdemangle/pull/54"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rizinorg/rz-libdemangle/blob/main/src/gnu_v2/cplus-dem.c#L419"
    }
  ],
  "related": [
    "GHSA-92h6-wwc2-53cq"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ]
}