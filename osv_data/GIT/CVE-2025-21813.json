{"schema_version":"1.7.3","id":"CVE-2025-21813","published":"2025-02-27T20:04:13.433Z","modified":"2025-11-20T08:10:14.821370Z","related":["USN-7489-2"],"summary":"timers/migration: Fix off-by-one root mis-connection","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ntimers/migration: Fix off-by-one root mis-connection\n\nBefore attaching a new root to the old root, the children counter of the\nnew root is checked to verify that only the upcoming CPU's top group have\nbeen connected to it. However since the recently added commit b729cc1ec21a\n(\"timers/migration: Fix another race between hotplug and idle entry/exit\")\nthis check is not valid anymore because the old root is pre-accounted\nas a child to the new root. Therefore after connecting the upcoming\nCPU's top group to the new root, the children count to be expected must\nbe 2 and not 1 anymore.\n\nThis omission results in the old root to not be connected to the new\nroot. Then eventually the system may run with more than one top level,\nwhich defeats the purpose of a single idle migrator.\n\nAlso the old root is pre-accounted but not connected upon the new root\ncreation. But it can be connected to the new root later on. Therefore\nthe old root may be accounted twice to the new root. The propagation of\nsuch overcommit can end up creating a double final top-level root with a\ngroupmask incorrectly initialized. Although harmless given that the final\ntop level roots will never have a parent to walk up to, this oddity\nopportunistically reported the core issue:\n\n  WARNING: CPU: 8 PID: 0 at kernel/time/timer_migration.c:543 tmigr_requires_handle_remote\n  CPU: 8 UID: 0 PID: 0 Comm: swapper/8\n  RIP: 0010:tmigr_requires_handle_remote\n  Call Trace:\n   <IRQ>\n   ? tmigr_requires_handle_remote\n   ? hrtimer_run_queues\n   update_process_times\n   tick_periodic\n   tick_handle_periodic\n   __sysvec_apic_timer_interrupt\n   sysvec_apic_timer_interrupt\n  </IRQ>\n\nFix the problem by taking the old root into account in the children count\nof the new root so the connection is not omitted.\n\nAlso warn when more than one top level group exists to better detect\nsimilar issues in the future.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"12ead225b7996252a8bc1a49b03aad57c0794880"},{"fixed":"c6dd70e5b465a2b77c7a7c3d868736d302e29aec"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b729cc1ec21a5899b7879ccfbe1786664928d597"},{"fixed":"6f449d8fa1808a7f9ee644866bbc079285dbefdd"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b729cc1ec21a5899b7879ccfbe1786664928d597"},{"fixed":"868c9037df626b3c245ee26a290a03ae1f9f58d3"}]}],"versions":["v6.12.11","v6.12.12","v6.12.13","v6.13","v6.13.1","v6.13.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21813.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["265538228087183162876075666618963035391","256877966927615352605570974519251148203","227353429063129704822729950066591850726","60899948930677229428115632689405650289","252107928997125252879367670183996416978","239145677977374998606273424452349434021","77749678022517264704847366684038604566"],"threshold":0.9},"id":"CVE-2025-21813-1db57b4c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c6dd70e5b465a2b77c7a7c3d868736d302e29aec","target":{"file":"kernel/time/timer_migration.c"}},{"deprecated":false,"digest":{"line_hashes":["265538228087183162876075666618963035391","256877966927615352605570974519251148203","227353429063129704822729950066591850726","60899948930677229428115632689405650289","252107928997125252879367670183996416978","239145677977374998606273424452349434021","77749678022517264704847366684038604566"],"threshold":0.9},"id":"CVE-2025-21813-78b2233c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f449d8fa1808a7f9ee644866bbc079285dbefdd","target":{"file":"kernel/time/timer_migration.c"}},{"deprecated":false,"digest":{"function_hash":"285913949414124095889614207839813214990","length":1425},"id":"CVE-2025-21813-ac279702","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f449d8fa1808a7f9ee644866bbc079285dbefdd","target":{"file":"kernel/time/timer_migration.c","function":"tmigr_setup_groups"}},{"deprecated":false,"digest":{"function_hash":"285913949414124095889614207839813214990","length":1425},"id":"CVE-2025-21813-bca395b7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c6dd70e5b465a2b77c7a7c3d868736d302e29aec","target":{"file":"kernel/time/timer_migration.c","function":"tmigr_setup_groups"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.12.14"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21813.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6f449d8fa1808a7f9ee644866bbc079285dbefdd"},{"type":"WEB","url":"https://git.kernel.org/stable/c/868c9037df626b3c245ee26a290a03ae1f9f58d3"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c6dd70e5b465a2b77c7a7c3d868736d302e29aec"}]}