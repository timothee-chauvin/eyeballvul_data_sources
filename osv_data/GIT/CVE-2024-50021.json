{"schema_version":"1.7.3","id":"CVE-2024-50021","published":"2024-10-21T19:39:27.212Z","modified":"2025-11-20T06:26:10.364198Z","related":["SUSE-SU-2024:3984-1","SUSE-SU-2024:3986-1","SUSE-SU-2024:4318-1","SUSE-SU-2024:4387-1","USN-7276-1","USN-7277-1","openSUSE-SU-2024:14500-1","openSUSE-SU-2025:14705-1"],"summary":"ice: Fix improper handling of refcount in ice_dpll_init_rclk_pins()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nice: Fix improper handling of refcount in ice_dpll_init_rclk_pins()\n\nThis patch addresses a reference count handling issue in the\nice_dpll_init_rclk_pins() function. The function calls ice_dpll_get_pins(),\nwhich increments the reference count of the relevant resources. However,\nif the condition WARN_ON((!vsi || !vsi->netdev)) is met, the function\ncurrently returns an error without properly releasing the resources\nacquired by ice_dpll_get_pins(), leading to a reference count leak.\n\nTo resolve this, the check has been moved to the top of the function. This\nensures that the function verifies the state before any resources are\nacquired, avoiding the need for additional resource management in the\nerror path.\n\nThis bug was identified by an experimental static analysis tool developed\nby our team. The tool specializes in analyzing reference count operations\nand detecting potential issues where resources are not properly managed.\nIn this case, the tool flagged the missing release operation as a\npotential problem, which led to the development of this patch.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d7999f5ea64bb10d2857b8cbfe973be373bac7c9"},{"fixed":"aefecead9d08f4a35ab6f51ba2e408d2cef4e31d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d7999f5ea64bb10d2857b8cbfe973be373bac7c9"},{"fixed":"ccca30a18e36a742e606d5bf0630e75be7711d0a"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.11.3","v6.6","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50021.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"338491513801037590173350457583105653550","length":1051},"id":"CVE-2024-50021-092b4689","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ccca30a18e36a742e606d5bf0630e75be7711d0a","target":{"file":"drivers/net/ethernet/intel/ice/ice_dpll.c","function":"ice_dpll_init_rclk_pins"}},{"deprecated":false,"digest":{"line_hashes":["94771729378863194294138366059807979480","151688994860379156134861701473128410298","269020533356560845299661078364657122087","251612219678525679675626689558001490500","339228153317007318706865338433997183982","235176172177578204587652614012284396072","57030371894010862675544419363223952607","334073903684137122065410149784215459909"],"threshold":0.9},"id":"CVE-2024-50021-5098374e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aefecead9d08f4a35ab6f51ba2e408d2cef4e31d","target":{"file":"drivers/net/ethernet/intel/ice/ice_dpll.c"}},{"deprecated":false,"digest":{"line_hashes":["94771729378863194294138366059807979480","151688994860379156134861701473128410298","269020533356560845299661078364657122087","251612219678525679675626689558001490500","339228153317007318706865338433997183982","235176172177578204587652614012284396072","57030371894010862675544419363223952607","334073903684137122065410149784215459909"],"threshold":0.9},"id":"CVE-2024-50021-afd5e98b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ccca30a18e36a742e606d5bf0630e75be7711d0a","target":{"file":"drivers/net/ethernet/intel/ice/ice_dpll.c"}},{"deprecated":false,"digest":{"function_hash":"338491513801037590173350457583105653550","length":1051},"id":"CVE-2024-50021-f3542ebf","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aefecead9d08f4a35ab6f51ba2e408d2cef4e31d","target":{"file":"drivers/net/ethernet/intel/ice/ice_dpll.c","function":"ice_dpll_init_rclk_pins"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.11.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50021.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/aefecead9d08f4a35ab6f51ba2e408d2cef4e31d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ccca30a18e36a742e606d5bf0630e75be7711d0a"}]}