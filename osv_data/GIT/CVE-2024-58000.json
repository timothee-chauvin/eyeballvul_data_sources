{"schema_version":"1.7.3","id":"CVE-2024-58000","published":"2025-02-27T02:07:19.155Z","modified":"2025-11-20T07:29:12.432214Z","summary":"io_uring: prevent reg-wait speculations","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nio_uring: prevent reg-wait speculations\n\nWith *ENTER_EXT_ARG_REG instead of passing a user pointer with arguments\nfor the waiting loop the user can specify an offset into a pre-mapped\nregion of memory, in which case the\n[offset, offset + sizeof(io_uring_reg_wait)) will be intepreted as the\nargument.\n\nAs we address a kernel array using a user given index, it'd be a subject\nto speculation type of exploits. Use array_index_nospec() to prevent\nthat. Make sure to pass not the full region size but truncate by the\nmaximum offset allowed considering the structure size.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"aa00f67adc2c0d6439f81b5a81ff181377c47a7e"},{"fixed":"2a6de94df7bfa76d9850443547e7b3333f63a16a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"aa00f67adc2c0d6439f81b5a81ff181377c47a7e"},{"fixed":"29b95ac917927ce9f95bf38797e16333ecb489b1"}]}],"versions":["v6.12","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-58000.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"193998813681743464607903768514843420489","length":390},"id":"CVE-2024-58000-0511f39f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29b95ac917927ce9f95bf38797e16333ecb489b1","target":{"file":"io_uring/io_uring.c","function":"io_get_ext_arg_reg"}},{"deprecated":false,"digest":{"line_hashes":["201838546121299030626543979935544113123","93877000303086773504330797241363002302","234939031143982759244708744091887632707"],"threshold":0.9},"id":"CVE-2024-58000-365f19ab","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2a6de94df7bfa76d9850443547e7b3333f63a16a","target":{"file":"io_uring/io_uring.c"}},{"deprecated":false,"digest":{"line_hashes":["201838546121299030626543979935544113123","93877000303086773504330797241363002302","234939031143982759244708744091887632707"],"threshold":0.9},"id":"CVE-2024-58000-703a6664","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29b95ac917927ce9f95bf38797e16333ecb489b1","target":{"file":"io_uring/io_uring.c"}},{"deprecated":false,"digest":{"function_hash":"193998813681743464607903768514843420489","length":390},"id":"CVE-2024-58000-fc662554","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2a6de94df7bfa76d9850443547e7b3333f63a16a","target":{"file":"io_uring/io_uring.c","function":"io_get_ext_arg_reg"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-58000.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/29b95ac917927ce9f95bf38797e16333ecb489b1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2a6de94df7bfa76d9850443547e7b3333f63a16a"}]}