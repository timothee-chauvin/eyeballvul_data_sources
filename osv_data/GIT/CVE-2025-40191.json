{"schema_version":"1.7.3","id":"CVE-2025-40191","published":"2025-11-12T21:56:31.206Z","modified":"2025-11-20T10:38:04.100282Z","summary":"drm/amdkfd: Fix kfd process ref leaking when userptr unmapping","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amdkfd: Fix kfd process ref leaking when userptr unmapping\n\nkfd_lookup_process_by_pid hold the kfd process reference to ensure it\ndoesn't get destroyed while sending the segfault event to user space.\n\nCalling kfd_lookup_process_by_pid as function parameter leaks the kfd\nprocess refcount and miss the NULL pointer check if app process is\nalready destroyed.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"2d274bf7099bc5e95fabaa93f23d0eb2977187ad"},{"fixed":"60f6112fc9b3ba0eae519f10702c0c13bab45742"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"2d274bf7099bc5e95fabaa93f23d0eb2977187ad"},{"fixed":"58e6fc2fb94f0f409447e5d46cf6a417b6397fbc"}]}],"versions":["v6.14","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.17.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40191.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["56434011708276967484295453067110493506","239325623944274255147804296161606547256","148712577500700021364530204382578735209","1788571672289631043362881607473772411","116707076569226569272181422596865532895","64894568579242859045967734687280498806","181297444854901823000974641078102728039","121703279704545106122758088115970669657"],"threshold":0.9},"id":"CVE-2025-40191-273f191f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@58e6fc2fb94f0f409447e5d46cf6a417b6397fbc","target":{"file":"drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gpuvm.c"}},{"deprecated":false,"digest":{"line_hashes":["56434011708276967484295453067110493506","239325623944274255147804296161606547256","148712577500700021364530204382578735209","1788571672289631043362881607473772411","116707076569226569272181422596865532895","64894568579242859045967734687280498806","181297444854901823000974641078102728039","121703279704545106122758088115970669657"],"threshold":0.9},"id":"CVE-2025-40191-70fceec5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60f6112fc9b3ba0eae519f10702c0c13bab45742","target":{"file":"drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gpuvm.c"}},{"deprecated":false,"digest":{"function_hash":"156179879012380119503419194787681064833","length":1608},"id":"CVE-2025-40191-aca9310b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@58e6fc2fb94f0f409447e5d46cf6a417b6397fbc","target":{"file":"drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gpuvm.c","function":"update_invalid_user_pages"}},{"deprecated":false,"digest":{"function_hash":"158727539859540984048187041878609086299","length":1589},"id":"CVE-2025-40191-c6b65fad","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60f6112fc9b3ba0eae519f10702c0c13bab45742","target":{"file":"drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gpuvm.c","function":"update_invalid_user_pages"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.17.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40191.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/58e6fc2fb94f0f409447e5d46cf6a417b6397fbc"},{"type":"WEB","url":"https://git.kernel.org/stable/c/60f6112fc9b3ba0eae519f10702c0c13bab45742"}]}