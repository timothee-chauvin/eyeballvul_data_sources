{"schema_version":"1.7.3","id":"CVE-2025-39816","published":"2025-09-16T13:00:17.026Z","modified":"2025-11-20T10:02:30.658917Z","related":["SUSE-SU-2025:3725-1"],"summary":"io_uring/kbuf: always use READ_ONCE() to read ring provided buffer lengths","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nio_uring/kbuf: always use READ_ONCE() to read ring provided buffer lengths\n\nSince the buffers are mapped from userspace, it is prudent to use\nREAD_ONCE() to read the value into a local variable, and use that for\nany other actions taken. Having a stable read of the buffer length\navoids worrying about it changing after checking, or being read multiple\ntimes.\n\nSimilarly, the buffer may well change in between it being picked and\nbeing committed. Ensure the looping for incremental ring buffer commit\nstops if it hits a zero sized buffer, as no further progress can be made\nat that point.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ae98dbf43d755b4e111fcd086e53939bef3e9a1a"},{"fixed":"695673eb5711ee5eb1769481cf1503714716a7d1"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ae98dbf43d755b4e111fcd086e53939bef3e9a1a"},{"fixed":"390a61d284e1ced088d43928dfcf6f86fffdd780"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ae98dbf43d755b4e111fcd086e53939bef3e9a1a"},{"fixed":"98b6fa62c84f2e129161e976a5b9b3cb4ccd117b"}]}],"versions":["v6.11","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.35","v6.12.36","v6.12.37","v6.12.38","v6.12.39","v6.12.4","v6.12.40","v6.12.41","v6.12.42","v6.12.43","v6.12.44","v6.12.45","v6.12.46","v6.12.47","v6.12.48","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.16.4","v6.17-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39816.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"21339389545531483988026022405957087908","length":1655},"id":"CVE-2025-39816-07259e23","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@390a61d284e1ced088d43928dfcf6f86fffdd780","target":{"file":"io_uring/kbuf.c","function":"io_ring_buffers_peek"}},{"deprecated":false,"digest":{"function_hash":"310898190747708690370462220735604391877","length":354},"id":"CVE-2025-39816-60cbb3b4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@390a61d284e1ced088d43928dfcf6f86fffdd780","target":{"file":"io_uring/kbuf.c","function":"io_kbuf_inc_commit"}},{"deprecated":false,"digest":{"function_hash":"300944220160431391975769831050365800935","length":751},"id":"CVE-2025-39816-894147b1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@390a61d284e1ced088d43928dfcf6f86fffdd780","target":{"file":"io_uring/kbuf.c","function":"io_ring_buffer_select"}},{"deprecated":false,"digest":{"line_hashes":["321587370481441744472121853002303760967","145151380394489160963098913619818225585","218548446971472790681629324902980791403","184727517140157101191619847281324293393","168502292063937185864979506183763837407","176509623007843248864826846108320431059","102647194844656092511668342448212457465","337306304460122461949142410145851988562","282675295539239900294686734784104048045","32996104588155126639594268760862701489","1730851992605643633846852431338814221","129700534078822507598762486947037410536","183535742986253695043139208173233479627","216205931753742400907504567282276043602","121176483182548063299578328313916558162","219080002689890174895299902246311176941","212782811618163923949723293337011222816","228272622234087070950957896668977932782","181752990276739272920416525031310944505","270717606451652660915401336013775757454","174784602345998962769088564955783058058","176013069349800852737239342674378437818","71919882008444234063527500052722145990","161614953700978955574157396281136661749"],"threshold":0.9},"id":"CVE-2025-39816-f5d9ca85","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@390a61d284e1ced088d43928dfcf6f86fffdd780","target":{"file":"io_uring/kbuf.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.12.0"},{"fixed":"6.12.49"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.16.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39816.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/390a61d284e1ced088d43928dfcf6f86fffdd780"},{"type":"WEB","url":"https://git.kernel.org/stable/c/695673eb5711ee5eb1769481cf1503714716a7d1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/98b6fa62c84f2e129161e976a5b9b3cb4ccd117b"}]}