{"schema_version":"1.7.3","id":"CVE-2024-43872","published":"2024-08-21T00:06:24.041Z","modified":"2025-11-20T05:28:50.688778Z","related":["SUSE-SU-2024:3189-1","SUSE-SU-2024:3190-1","SUSE-SU-2024:3194-1","SUSE-SU-2024:3195-1","SUSE-SU-2024:3209-1","SUSE-SU-2024:3251-1","SUSE-SU-2024:3252-1","SUSE-SU-2024:3383-1","SUSE-SU-2024:3483-1"],"summary":"RDMA/hns: Fix soft lockup under heavy CEQE load","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/hns: Fix soft lockup under heavy CEQE load\n\nCEQEs are handled in interrupt handler currently. This may cause the\nCPU core staying in interrupt context too long and lead to soft lockup\nunder heavy load.\n\nHandle CEQEs in BH workqueue and set an upper limit for the number of\nCEQE handled by a single call of work handler.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a5073d6054f75d7c94b3354206eec4b804d2fbd4"},{"fixed":"06580b33c183c9f98e2a2ca96a86137179032c08"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a5073d6054f75d7c94b3354206eec4b804d2fbd4"},{"fixed":"2fdf34038369c0a27811e7b4680662a14ada1d6b"}]}],"versions":["v4.15","v4.15-rc3","v4.15-rc4","v4.15-rc5","v4.15-rc6","v4.15-rc7","v4.15-rc8","v4.15-rc9","v4.16","v4.16-rc1","v4.16-rc2","v4.16-rc3","v4.16-rc4","v4.16-rc5","v4.16-rc6","v4.16-rc7","v4.17","v4.17-rc1","v4.17-rc2","v4.17-rc3","v4.17-rc4","v4.17-rc5","v4.17-rc6","v4.17-rc7","v4.18","v4.18-rc1","v4.18-rc2","v4.18-rc3","v4.18-rc4","v4.18-rc5","v4.18-rc6","v4.18-rc7","v4.18-rc8","v4.19","v4.19-rc1","v4.19-rc2","v4.19-rc3","v4.19-rc4","v4.19-rc5","v4.19-rc6","v4.19-rc7","v4.19-rc8","v4.20","v4.20-rc1","v4.20-rc2","v4.20-rc3","v4.20-rc4","v4.20-rc5","v4.20-rc6","v4.20-rc7","v5.0","v5.0-rc1","v5.0-rc2","v5.0-rc3","v5.0-rc4","v5.0-rc5","v5.0-rc6","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.10.1","v6.10.2","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-43872.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["171923334588951075581658466682403942863","66787056461180991144486841670439731945","335846647018328962401030826184573028421","130052037876996841675097647414126881012"],"threshold":0.9},"id":"CVE-2024-43872-2725048e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06580b33c183c9f98e2a2ca96a86137179032c08","target":{"file":"drivers/infiniband/hw/hns/hns_roce_device.h"}},{"deprecated":false,"digest":{"line_hashes":["149713475744374721983228690221431359338","191097467786977791064159324472598611920","111325511462169830951393337658790630920","174978598816262647891682964927620307720","66434732672354616393044828655229335037","319485302228757600254040094159292085679","324323460880400168105263919625474225436","64161309672431658048693826368146276649","111820336651966914410449953584204250560","126032371898147737429187922041946056007","97105573399222325151790231932550097866","54470630429795963508101530793568754906","266786908778645186340255166819154299501","324870691423121166475305845735194159909","109754506734595509026456865251786656817","275816670723655730010199866286427333037","120766593587148743713552533276388976755","25748998823801694172184927459724691591","33471192289241241857215732410151597442","241062557849528214164126008574347723574","58335825813990942702762028869606227137","163598989511877573653586663003994569944","87671840832460925852461941570951865567","267518171819845034583260809971772270945","85940401439000332834858187734266460670","164825378731447859103466012623963223237","284051410321370344824226024762971529671","35768444595352713445737696178483844214","179126528680345706906213152006632782209","331565326632684239957618993254792113622","335508843116029972733297726257073959896","261689544025198007226931992426317075938","101892641867149663846306365181923340156","247038065432405606673474379237574647397","92422163699652270926428731660533875528","202071690003745949984230773092298183316","193339679042091357748295914864455934800","122349659840959071947431929850443631477","307291069590634248879217387797821699318","176083553866003899635649755637872899869","188176516879088966538754906386522709344","271769275520392213980400743647153778631","73128948756337065482832688218815840777","39163597642451306564287856627507523442","223920572865515695460026420792149874940","140547910687000098598883035168979487102","293294523395484923452506418100407884416","208578061102317434129055534959042632777","235457900994878374250480637131190802657","144367154692286229102269212364627310714","281749015531419415210801491046633478284","58855673079361248272277086499271091103","147055928434861574990602512122877301204","222107560457613537757293135516819711821","268329812375811415523417322993654581632","1911137846868589652383987936152973521","68406156347516387264353778675325045488","144124327949046808339240736599426379140","37366972056986968115966272124086527546","78998249912420017447393973464182405927","44711095139639476437724815966725999083","186343341125532209797946094638596607886"],"threshold":0.9},"id":"CVE-2024-43872-335bb2c9","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fdf34038369c0a27811e7b4680662a14ada1d6b","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c"}},{"deprecated":false,"digest":{"function_hash":"177176389216456333260166722737742576147","length":516},"id":"CVE-2024-43872-525aa958","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06580b33c183c9f98e2a2ca96a86137179032c08","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"__hns_roce_free_irq"}},{"deprecated":false,"digest":{"function_hash":"217392702853686105779876405274195682437","length":1892},"id":"CVE-2024-43872-762eff11","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fdf34038369c0a27811e7b4680662a14ada1d6b","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"__hns_roce_request_irq"}},{"deprecated":false,"digest":{"line_hashes":["171923334588951075581658466682403942863","66787056461180991144486841670439731945","335846647018328962401030826184573028421","130052037876996841675097647414126881012"],"threshold":0.9},"id":"CVE-2024-43872-7957529c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fdf34038369c0a27811e7b4680662a14ada1d6b","target":{"file":"drivers/infiniband/hw/hns/hns_roce_device.h"}},{"deprecated":false,"digest":{"function_hash":"208320788775468929691298689589457292854","length":404},"id":"CVE-2024-43872-825e9ae8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fdf34038369c0a27811e7b4680662a14ada1d6b","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"hns_roce_v2_ceq_int"}},{"deprecated":false,"digest":{"function_hash":"130672910130218745587415402143326856408","length":251},"id":"CVE-2024-43872-87d376d5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06580b33c183c9f98e2a2ca96a86137179032c08","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"hns_roce_v2_msix_interrupt_eq"}},{"deprecated":false,"digest":{"function_hash":"208320788775468929691298689589457292854","length":404},"id":"CVE-2024-43872-8959d447","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06580b33c183c9f98e2a2ca96a86137179032c08","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"hns_roce_v2_ceq_int"}},{"deprecated":false,"digest":{"function_hash":"130672910130218745587415402143326856408","length":251},"id":"CVE-2024-43872-9153ed5a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fdf34038369c0a27811e7b4680662a14ada1d6b","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"hns_roce_v2_msix_interrupt_eq"}},{"deprecated":false,"digest":{"function_hash":"217392702853686105779876405274195682437","length":1892},"id":"CVE-2024-43872-93183bb8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06580b33c183c9f98e2a2ca96a86137179032c08","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"__hns_roce_request_irq"}},{"deprecated":false,"digest":{"line_hashes":["149713475744374721983228690221431359338","191097467786977791064159324472598611920","111325511462169830951393337658790630920","174978598816262647891682964927620307720","66434732672354616393044828655229335037","319485302228757600254040094159292085679","324323460880400168105263919625474225436","64161309672431658048693826368146276649","111820336651966914410449953584204250560","126032371898147737429187922041946056007","97105573399222325151790231932550097866","54470630429795963508101530793568754906","266786908778645186340255166819154299501","324870691423121166475305845735194159909","109754506734595509026456865251786656817","275816670723655730010199866286427333037","120766593587148743713552533276388976755","25748998823801694172184927459724691591","33471192289241241857215732410151597442","241062557849528214164126008574347723574","58335825813990942702762028869606227137","163598989511877573653586663003994569944","87671840832460925852461941570951865567","267518171819845034583260809971772270945","85940401439000332834858187734266460670","164825378731447859103466012623963223237","284051410321370344824226024762971529671","35768444595352713445737696178483844214","179126528680345706906213152006632782209","331565326632684239957618993254792113622","335508843116029972733297726257073959896","261689544025198007226931992426317075938","101892641867149663846306365181923340156","247038065432405606673474379237574647397","92422163699652270926428731660533875528","202071690003745949984230773092298183316","193339679042091357748295914864455934800","122349659840959071947431929850443631477","307291069590634248879217387797821699318","176083553866003899635649755637872899869","188176516879088966538754906386522709344","271769275520392213980400743647153778631","73128948756337065482832688218815840777","39163597642451306564287856627507523442","223920572865515695460026420792149874940","140547910687000098598883035168979487102","293294523395484923452506418100407884416","208578061102317434129055534959042632777","235457900994878374250480637131190802657","144367154692286229102269212364627310714","281749015531419415210801491046633478284","58855673079361248272277086499271091103","147055928434861574990602512122877301204","222107560457613537757293135516819711821","268329812375811415523417322993654581632","1911137846868589652383987936152973521","68406156347516387264353778675325045488","144124327949046808339240736599426379140","37366972056986968115966272124086527546","78998249912420017447393973464182405927","44711095139639476437724815966725999083","186343341125532209797946094638596607886"],"threshold":0.9},"id":"CVE-2024-43872-c4ccbc6f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06580b33c183c9f98e2a2ca96a86137179032c08","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c"}},{"deprecated":false,"digest":{"function_hash":"177176389216456333260166722737742576147","length":516},"id":"CVE-2024-43872-d7f543ef","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2fdf34038369c0a27811e7b4680662a14ada1d6b","target":{"file":"drivers/infiniband/hw/hns/hns_roce_hw_v2.c","function":"__hns_roce_free_irq"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"4.16.0"},{"fixed":"6.10.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-43872.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/06580b33c183c9f98e2a2ca96a86137179032c08"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2fdf34038369c0a27811e7b4680662a14ada1d6b"}]}