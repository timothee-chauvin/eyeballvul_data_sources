{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49393.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "75451461941107212643585864748964870483",
              "length": 1011.0
            },
            "id": "CVE-2022-49393-4ff4606e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c5c07c5958cf0c9af6e76813e6de15d42ee49822",
            "target": {
              "file": "drivers/misc/fastrpc.c",
              "function": "fastrpc_req_mem_unmap_impl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "124301874071160171722974472580155698224",
                "314071982246941427600969801646881780670",
                "11609401917484473389115295149762651782",
                "138262532447963936225618122137376606326",
                "330204254389925444227791083158461305528",
                "279591624997272057006730580687054778260",
                "6306583550865449742363659934760545598",
                "81776970885810390715279332569022678228",
                "147660997758095930685601889291373424490",
                "51343532828331168864121121818236289622",
                "200306029417453380188616680863741003185",
                "155807214268188287067662028263160363617",
                "93575949052951808569071976596877936018"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49393-97646359",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d12905aad462383f4e7a5fdb024d2b7ae2d10cf",
            "target": {
              "file": "drivers/misc/fastrpc.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "124301874071160171722974472580155698224",
                "314071982246941427600969801646881780670",
                "11609401917484473389115295149762651782",
                "138262532447963936225618122137376606326",
                "330204254389925444227791083158461305528",
                "279591624997272057006730580687054778260",
                "6306583550865449742363659934760545598",
                "81776970885810390715279332569022678228",
                "147660997758095930685601889291373424490",
                "51343532828331168864121121818236289622",
                "200306029417453380188616680863741003185",
                "155807214268188287067662028263160363617",
                "93575949052951808569071976596877936018"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49393-a0b53ba1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c5c07c5958cf0c9af6e76813e6de15d42ee49822",
            "target": {
              "file": "drivers/misc/fastrpc.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "75451461941107212643585864748964870483",
              "length": 1011.0
            },
            "id": "CVE-2022-49393-e3a08907",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d12905aad462383f4e7a5fdb024d2b7ae2d10cf",
            "target": {
              "file": "drivers/misc/fastrpc.c",
              "function": "fastrpc_req_mem_unmap_impl"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5c1b97c7d7b736e6439af4f43a65837bc72f56c1"
            },
            {
              "fixed": "2d12905aad462383f4e7a5fdb024d2b7ae2d10cf"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "5c1b97c7d7b736e6439af4f43a65837bc72f56c1"
            },
            {
              "fixed": "c5c07c5958cf0c9af6e76813e6de15d42ee49822"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.17",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.18.1",
        "v5.18.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49393.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "5.18.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmisc: fastrpc: fix list iterator in fastrpc_req_mem_unmap_impl\n\nThis is another instance of incorrect use of list iterator and\nchecking it for NULL.\n\nThe list iterator value 'map' will *always* be set and non-NULL\nby list_for_each_entry(), so it is incorrect to assume that the\niterator value will be NULL if the list is empty (in this case, the\ncheck 'if (!map) {' will always be false and never exit as expected).\n\nTo fix the bug, use a new variable 'iter' as the list iterator,\nwhile use the original variable 'map' as a dedicated pointer to\npoint to the found element.\n\nWithout this patch, Kernel crashes with below trace:\n\nUnable to handle kernel access to user memory outside uaccess routines\n at virtual address 0000ffff7fb03750\n...\nCall trace:\n fastrpc_map_create+0x70/0x290 [fastrpc]\n fastrpc_req_mem_map+0xf0/0x2dc [fastrpc]\n fastrpc_device_ioctl+0x138/0xc60 [fastrpc]\n __arm64_sys_ioctl+0xa8/0xec\n invoke_syscall+0x48/0x114\n el0_svc_common.constprop.0+0xd4/0xfc\n do_el0_svc+0x28/0x90\n el0_svc+0x3c/0x130\n el0t_64_sync_handler+0xa4/0x130\n el0t_64_sync+0x18c/0x190\nCode: 14000016 f94000a5 eb05029f 54000260 (b94018a6)\n---[ end trace 0000000000000000 ]---",
  "id": "CVE-2022-49393",
  "modified": "2025-10-21T09:50:48.257199Z",
  "published": "2025-02-26T02:11:24Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/2d12905aad462383f4e7a5fdb024d2b7ae2d10cf"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c5c07c5958cf0c9af6e76813e6de15d42ee49822"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "misc: fastrpc: fix list iterator in fastrpc_req_mem_unmap_impl"
}