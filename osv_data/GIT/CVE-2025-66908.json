{"schema_version":"1.7.3","id":"CVE-2025-66908","published":"2025-12-19T15:15:56.550Z","modified":"2026-01-04T05:41:39.667887Z","details":"Turms AI-Serving module v0.10.0-SNAPSHOT and earlier contains an improper file type validation vulnerability in the OCR image upload functionality. The OcrController in turms-ai-serving/src/main/java/im/turms/ai/domain/ocr/controller/OcrController.java uses the @FormData(contentType = MediaTypeConst.IMAGE) annotation to restrict uploads to image files, but this constraint is not properly enforced. The system relies solely on client-provided Content-Type headers and file extensions without validating actual file content using magic bytes (file signatures). An attacker can upload arbitrary file types including executables, scripts, HTML, or web shells by setting the Content-Type header to \"image/*\" or using an image file extension. This bypass enables potential server-side code execution, stored XSS, or information disclosure depending on how uploaded files are processed and served.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/turms-im/turms","events":[{"introduced":"0"},{"last_affected":"8e1df48d4b713f7a8c945cbc4dd76e0ecad5c396"}]}],"versions":["v0.10.0-SNAPSHOT"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-66908.json"}}],"references":[{"type":"WEB","url":"https://github.com/turms-im/turms/blob/develop/turms-ai-serving/src/main/java/im/turms/ai/domain/ocr/controller/OcrController.java"},{"type":"EVIDENCE","url":"https://github.com/Xzzz111/public_cve_report/blob/main/CVE-2025-66908_report.md"},{"type":"PACKAGE","url":"https://github.com/turms-im/turms"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"}]}