{"schema_version":"1.7.3","id":"CVE-2023-30628","published":"2023-04-24T21:17:32.896Z","modified":"2025-12-12T14:36:22.308673Z","aliases":["GHSA-cw6r-6ccx-5hwx","PYSEC-2023-273"],"summary":"Kiwi TCMS has command injection vulnerability in changelog.yml CI workflow","details":"Kiwi TCMS is an open source test management system. In kiwitcms/Kiwi v12.2 and prior and kiwitcms/enterprise v12.2 and prior,\nthe `changelog.yml` workflow is vulnerable to command injection attacks because of using an untrusted `github.head_ref` field. The `github.head_ref` value is an attacker-controlled value. Assigning the value to `zzz\";echo${IFS}\"hello\";#` can lead to command injection. Since the permission is not restricted, the attacker has a write-access to the repository. Commit 834c86dfd1b2492ccad7ebbfd6304bfec895fed2 of the kiwitcms/Kiwi repository and commit e39f7e156fdaf6fec09a15ea6f4e8fec8cdbf751 of the kiwitcms/enterprise repository contain a fix for this issue.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/kiwitcms/enterprise","events":[{"introduced":"0"},{"fixed":"e39f7e156fdaf6fec09a15ea6f4e8fec8cdbf751"}]}],"versions":["v10.0-mt","v10.0.1-mt","v10.1-mt","v10.2-mt","v10.3-mt","v10.4-mt","v10.4.1-mt","v10.5-mt","v10.5.1-mt","v11.0-mt","v11.1-mt","v11.2-mt","v11.3-mt","v11.3.1-mt","v11.4-mt","v11.5-mt","v11.5.1-mt","v11.6-mt","v11.7-mt","v12.0-mt","v12.1-mt","v12.2-mt","v5.1-ee-807","v5.2","v5.2-ee-810","v5.2-ee-815","v5.2-ee-816.3","v5.3-ee","v5.3.1-ee","v6.0-ee","v6.1-ee","v6.1.1-ee","v6.10-mt","v6.11-mt","v6.2-ee","v6.2.1-1124","v6.2.1-1127","v6.3","v6.4","v6.5","v6.5.1","v6.6","v6.7","v6.7.0.2-mt","v6.7.0.3-mt","v6.7.0.4-mt","v6.8-mt","v6.8-mt-01","v6.8-mt-02","v6.9-mt","v6.9.0.2-mt-01","v7.0-mt","v7.1-mt","v7.2-mt","v7.3-mt","v8.0-mt","v8.1-mt","v8.2-mt","v8.3-mt","v8.4-mt","v8.5-mt","v8.5.1-mt","v8.5.2-mt","v8.6-mt","v8.7-mt","v8.8-mt","v8.9-mt","v9.0-mt"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-30628.json"}},{"ranges":[{"type":"GIT","repo":"https://github.com/kiwitcms/kiwi","events":[{"introduced":"0"},{"fixed":"834c86dfd1b2492ccad7ebbfd6304bfec895fed2"}]}],"versions":["tcms-api-1.4.0","tcms-api-1.5.0","tcms-api-1.5.1","tcms-api-4.0.0","tcms-api-4.2","tcms-api-5.0","tcms-api-5.1","tcms-api-5.2","tcms-api-5.3","v10.0","v10.1","v10.2","v10.3","v10.4","v10.5","v11.0","v11.1","v11.2","v11.3","v11.4","v11.5","v11.6","v11.7","v12.0","v12.1","v12.2","v3.21.1","v3.21.2","v3.22","v3.23","v3.26","v3.28","v3.30","v3.32","v3.33","v3.37","v3.38","v3.39","v3.41","v3.44","v3.48","v3.49","v3.50","v3.8.17-1","v3.8.18","v3.8.18.21","v4.0.0","v4.1.0","v4.1.1","v4.1.2","v4.1.3","v4.1.4","v4.2","v5.0","v5.1","v5.2","v5.3","v5.3.1","v6.0","v6.0.1","v6.1","v6.1.1","v6.10","v6.11","v6.2","v6.2.1","v6.3","v6.4","v6.5.1","v6.5.2","v6.5.3","v6.6","v6.7","v6.8","v6.9","v7.0","v7.1","v7.2","v7.2.1","v7.3","v8.0","v8.1","v8.2","v8.3","v8.4","v8.5","v8.6","v8.6.1","v8.7","v8.8","v8.9","v9.0","v9.0.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-30628.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/30xxx/CVE-2023-30628.json"},{"type":"WEB","url":"https://github.com/kiwitcms/Kiwi/blob/37bfb87696093ce0393160e2725949185cc0651d/.github/workflows/changelog.yml#L18"},{"type":"FIX","url":"https://github.com/kiwitcms/Kiwi/commit/834c86dfd1b2492ccad7ebbfd6304bfec895fed2"},{"type":"ADVISORY","url":"https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-cw6r-6ccx-5hwx"},{"type":"FIX","url":"https://github.com/kiwitcms/enterprise/commit/e39f7e156fdaf6fec09a15ea6f4e8fec8cdbf751"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2023-30628"},{"type":"WEB","url":"https://securitylab.github.com/research/github-actions-untrusted-input/"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-78"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/30xxx/CVE-2023-30628.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}