{"schema_version":"1.7.3","id":"CVE-2024-52587","published":"2024-11-18T22:03:15Z","modified":"2025-11-04T20:33:11.879936Z","aliases":["GHSA-g85v-wf27-67xc"],"summary":"Harden-Runner has command injection weaknesses in `setup.ts` and `arc-runner.ts`","details":"StepSecurity's Harden-Runner provides network egress filtering and runtime security for GitHub-hosted and self-hosted runners. Versions of step-security/harden-runner prior to v2.10.2 contain multiple command injection weaknesses via environment variables that could potentially be exploited under specific conditions. However, due to the current execution order of pre-steps in GitHub Actions and the placement of harden-runner as the first step in a job, the likelihood of exploitation is low as the Harden-Runner action reads the environment variable during the pre-step stage. There are no known exploits at this time. Version 2.10.2 contains a patch.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/step-security/harden-runner","events":[{"introduced":"0"},{"fixed":"0080882f6c36860b6ba35c610c98ce87d4e2f26f"}]}],"versions":["v0.1.0","v0.1.1","v0.2.0","v0.3.0","v0.4.0","v1","v1.0.0","v1.0.1","v1.0.2","v1.0.3","v1.0.4","v1.1.0","v1.2.0","v1.3.0","v1.4.0","v1.4.1","v1.4.2","v1.4.3","v1.4.4","v1.4.5","v1.5.0","v2.0.0","v2.1.0","v2.10.0","v2.10.1","v2.2.0","v2.2.1","v2.3.0","v2.3.1","v2.4.0","v2.4.1","v2.5.0","v2.5.1","v2.6.0","v2.6.1","v2.7.0","v2.7.1","v2.8.0","v2.8.1","v2.9.0","v2.9.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-52587.json"}}],"references":[{"type":"WEB","url":"https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L40-L44"},{"type":"WEB","url":"https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L53"},{"type":"WEB","url":"https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L57"},{"type":"WEB","url":"https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L61"},{"type":"WEB","url":"https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L169"},{"type":"WEB","url":"https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L229"},{"type":"FIX","url":"https://github.com/step-security/harden-runner/commit/0080882f6c36860b6ba35c610c98ce87d4e2f26f"},{"type":"ADVISORY","url":"https://github.com/step-security/harden-runner/security/advisories/GHSA-g85v-wf27-67xc"}],"database_specific":{"cwe_ids":["CWE-78"]},"severity":[{"type":"CVSS_V4","score":"CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/E:U"}]}