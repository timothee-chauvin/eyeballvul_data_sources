{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35993.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "198152094242655609692343306363062184888",
                "1016365939070314568335721798217034205",
                "157255061302657885469976978861869626221",
                "81034860245105612081365113470645835290",
                "241490418141989655817140342306567126327",
                "202159100492447513302188665392354242302",
                "110157953097940557986472133969975539667",
                "160248207401619660385310140770578992900",
                "241112889432626775826654577345352266022",
                "53793373137724009443086086619310667676",
                "292020607475831478069242854768183616507",
                "53542893560065945792583972710435754057",
                "216544556774048524162138731264753670088",
                "38962379529278661448507646112311518556",
                "287839776538514966420176218733207174440",
                "337075274014857457344627197193322998742",
                "139953703556540418045333020364993162538",
                "322471786963428335222091664138554433223",
                "5472461676114724461830336977469580271",
                "326880099752475756693312122228892773518",
                "76413309683984236481019855455459305430",
                "38830505791188045781864074524722940942",
                "146001587933567774907017744802610952540",
                "336279271509263700042399780281364697619"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-21fe48c9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d99e3140a4d33e26066183ff727d8f02f56bec64",
            "target": {
              "file": "mm/hugetlb.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "198152094242655609692343306363062184888",
                "1016365939070314568335721798217034205",
                "157255061302657885469976978861869626221",
                "81034860245105612081365113470645835290",
                "241490418141989655817140342306567126327",
                "202159100492447513302188665392354242302",
                "110157953097940557986472133969975539667",
                "160248207401619660385310140770578992900",
                "200963314792002762235421067873386158232",
                "264522677504936612629927846055727009259",
                "175426282431546506149143038362615900096",
                "206538042730687476699144280299062921482",
                "133737340290612167363206038861262249692",
                "166542426841496586059505327835835665523",
                "43979230317817041708447605051353097096",
                "29903537555921881166127903674925898381",
                "22042714944155273920365489591589302382",
                "333848455835833314470126046747989782542",
                "5472461676114724461830336977469580271",
                "326880099752475756693312122228892773518",
                "76413309683984236481019855455459305430",
                "38830505791188045781864074524722940942",
                "146001587933567774907017744802610952540",
                "336279271509263700042399780281364697619"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-41bbb09e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2431b5f2650dfc47ce782d1ca7b02d6b3916976f",
            "target": {
              "file": "mm/hugetlb.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "287220753701916462291727197015570275527",
                "68116565558410324869772432201012568571",
                "260585247488859395956608828534544331056",
                "97799386336321340629574663128948278037",
                "55512653589347672971002041620247929924",
                "207200910866528875826876856087670754066",
                "25545119534610911080456716619108397652"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-451bc42b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d99e3140a4d33e26066183ff727d8f02f56bec64",
            "target": {
              "file": "kernel/vmcore_info.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "287220753701916462291727197015570275527",
                "68116565558410324869772432201012568571",
                "260585247488859395956608828534544331056",
                "97799386336321340629574663128948278037",
                "55512653589347672971002041620247929924",
                "207200910866528875826876856087670754066",
                "25545119534610911080456716619108397652"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-47f0a63e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2431b5f2650dfc47ce782d1ca7b02d6b3916976f",
            "target": {
              "file": "kernel/crash_core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "39509585056470899704060985766414251835",
                "71223161206884894872019525126545902269",
                "132921995075161398596011583011556143977"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-48f2df7d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d99e3140a4d33e26066183ff727d8f02f56bec64",
            "target": {
              "file": "include/trace/events/mmflags.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "193522175766070328264162605841827434477",
              "length": 2931.0
            },
            "id": "CVE-2024-35993-4ab9b7a8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2431b5f2650dfc47ce782d1ca7b02d6b3916976f",
            "target": {
              "file": "kernel/crash_core.c",
              "function": "crash_save_vmcoreinfo_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "321637068963705049565970143306033375592",
              "length": 130.0
            },
            "id": "CVE-2024-35993-5192c0a8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2431b5f2650dfc47ce782d1ca7b02d6b3916976f",
            "target": {
              "file": "include/linux/page-flags.h",
              "function": "folio_test_hugetlb"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "211097806157949966309743552060472783024",
              "length": 136.0
            },
            "id": "CVE-2024-35993-5b97845c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d99e3140a4d33e26066183ff727d8f02f56bec64",
            "target": {
              "file": "include/linux/page-flags.h",
              "function": "folio_test_hugetlb"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "331215591548616821736111268767599801041",
              "length": 2979.0
            },
            "id": "CVE-2024-35993-6cd659f3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d99e3140a4d33e26066183ff727d8f02f56bec64",
            "target": {
              "file": "kernel/vmcore_info.c",
              "function": "crash_save_vmcoreinfo_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "122174880119774682930735204882144964679",
              "length": 142.0
            },
            "id": "CVE-2024-35993-7b1c2ec7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2431b5f2650dfc47ce782d1ca7b02d6b3916976f",
            "target": {
              "file": "mm/hugetlb.c",
              "function": "PageHuge"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45884555241427230155388600640092927199",
              "length": 154.0
            },
            "id": "CVE-2024-35993-92f03faa",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d99e3140a4d33e26066183ff727d8f02f56bec64",
            "target": {
              "file": "mm/hugetlb.c",
              "function": "PageHuge"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "88023950982972182345295629620774950953",
                "277765420417022935288592476060771143336",
                "38873121802634695852883556975274970624",
                "45038393753912447699107579127970887324",
                "226070687524221098941102598320527097443",
                "221721003868940173770290544821740146521",
                "222307644261551971165698963381614217875",
                "236611729357863072847931811383571375632",
                "97478532050539503298374605765648295119",
                "206466624687133896792992661500446345458",
                "207448360929640911543148352111456853058",
                "11391724249270349095722245708143241438",
                "289581691612124198562557449679985720107",
                "98158164904388442753617760269406841617",
                "27553905677896348972037447991191121269",
                "260681368404626593092250872051401742113",
                "147314920406665612081758455073405858148",
                "196401435943510464923282637009830656162",
                "273745084143064452216109443937655678555",
                "24809659353736290991850978937666209879",
                "211560909608702857942463785198138177603",
                "17077526506491293128415596514405218496",
                "22470828883206800413824323890367317535",
                "309309871959771028658810107473291830179",
                "192666826586207118344939807855558661097",
                "213995070246116597883232703754931989696",
                "79868892710456598882316168951908183420",
                "95620422926574258895706159016384216684",
                "227515435717122453380200179695324421218",
                "208900225719371050046469134583146368554",
                "324572062724203698709085276853409692898",
                "306372828220535077940447211457268922273",
                "39277822142367919319426578450386084370",
                "151281559437930533498523938734546761431",
                "224963183584597745139738546595772645582"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-a9f7d708",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d99e3140a4d33e26066183ff727d8f02f56bec64",
            "target": {
              "file": "include/linux/page-flags.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "39509585056470899704060985766414251835",
                "71223161206884894872019525126545902269",
                "132921995075161398596011583011556143977"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-ad9a29a1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2431b5f2650dfc47ce782d1ca7b02d6b3916976f",
            "target": {
              "file": "include/trace/events/mmflags.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "88023950982972182345295629620774950953",
                "277765420417022935288592476060771143336",
                "38873121802634695852883556975274970624",
                "45038393753912447699107579127970887324",
                "226070687524221098941102598320527097443",
                "175554045705958456422688607836768492906",
                "51418830987536478233528866129473776049",
                "188917942441790500333859373370750317071",
                "150573100075844427260640617473914170519",
                "79268168194584483250455370196501331629",
                "154126293062855414228354787478294837201",
                "182922034730338700170433314648074556808",
                "314919365237726209553611236264101439624",
                "254493074910150081667072143249382929572",
                "261351679644622265721670215692164891118",
                "260681368404626593092250872051401742113",
                "147314920406665612081758455073405858148",
                "279361041369391010515741686912587608586",
                "213229869640999920025374917090213465593",
                "24809659353736290991850978937666209879",
                "211560909608702857942463785198138177603",
                "17077526506491293128415596514405218496",
                "22470828883206800413824323890367317535",
                "309309871959771028658810107473291830179",
                "192666826586207118344939807855558661097",
                "213995070246116597883232703754931989696",
                "79868892710456598882316168951908183420",
                "95620422926574258895706159016384216684",
                "227515435717122453380200179695324421218",
                "208900225719371050046469134583146368554",
                "164004149720942863692714084618296276483",
                "306372828220535077940447211457268922273",
                "39277822142367919319426578450386084370",
                "23552217135348593335829630660999897599",
                "246968356048414783849301047719957347112"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35993-ef8b96e1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2431b5f2650dfc47ce782d1ca7b02d6b3916976f",
            "target": {
              "file": "include/linux/page-flags.h"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "9c5ccf2db04b8d7c3df363fdd4856c2b79ab2c6a"
            },
            {
              "fixed": "2431b5f2650dfc47ce782d1ca7b02d6b3916976f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "9c5ccf2db04b8d7c3df363fdd4856c2b79ab2c6a"
            },
            {
              "fixed": "9fdcc5b6359dfdaa52a55033bf50e2cedd66eb32"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "9c5ccf2db04b8d7c3df363fdd4856c2b79ab2c6a"
            },
            {
              "fixed": "d99e3140a4d33e26066183ff727d8f02f56bec64"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.5",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4",
        "v6.8.5",
        "v6.8.6",
        "v6.8.7",
        "v6.8.8",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35993.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.30"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.8.9"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: turn folio_test_hugetlb into a PageType\n\nThe current folio_test_hugetlb() can be fooled by a concurrent folio split\ninto returning true for a folio which has never belonged to hugetlbfs. \nThis can't happen if the caller holds a refcount on it, but we have a few\nplaces (memory-failure, compaction, procfs) which do not and should not\ntake a speculative reference.\n\nSince hugetlb pages do not use individual page mapcounts (they are always\nfully mapped and use the entire_mapcount field to record the number of\nmappings), the PageType field is available now that page_mapcount()\nignores the value in this field.\n\nIn compaction and with CONFIG_DEBUG_VM enabled, the current implementation\ncan result in an oops, as reported by Luis. This happens since 9c5ccf2db04b\n(\"mm: remove HUGETLB_PAGE_DTOR\") effectively added some VM_BUG_ON() checks\nin the PageHuge() testing path.\n\n[willy@infradead.org: update vmcoreinfo]",
  "id": "CVE-2024-35993",
  "modified": "2025-10-15T11:08:44.652645Z",
  "published": "2024-05-20T09:47:57Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/2431b5f2650dfc47ce782d1ca7b02d6b3916976f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9fdcc5b6359dfdaa52a55033bf50e2cedd66eb32"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d99e3140a4d33e26066183ff727d8f02f56bec64"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "mm: turn folio_test_hugetlb into a PageType"
}