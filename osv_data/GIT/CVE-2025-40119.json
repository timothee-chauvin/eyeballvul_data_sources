{"schema_version":"1.7.3","id":"CVE-2025-40119","published":"2025-11-12T10:23:18.449Z","modified":"2025-12-01T20:29:56.174866Z","summary":"ext4: fix potential null deref in ext4_mb_init()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix potential null deref in ext4_mb_init()\n\nIn ext4_mb_init(), ext4_mb_avg_fragment_size_destroy() may be called\nwhen sbi->s_mb_avg_fragment_size remains uninitialized (e.g., if groupinfo\nslab cache allocation fails). Since ext4_mb_avg_fragment_size_destroy()\nlacks null pointer checking, this leads to a null pointer dereference.\n\n==================================================================\nEXT4-fs: no memory for groupinfo slab cache\nBUG: kernel NULL pointer dereference, address: 0000000000000000\nPGD 0 P4D 0\nOops: Oops: 0002 [#1] SMP PTI\nCPU:2 UID: 0 PID: 87 Comm:mount Not tainted 6.17.0-rc2 #1134 PREEMPT(none)\nRIP: 0010:_raw_spin_lock_irqsave+0x1b/0x40\nCall Trace:\n <TASK>\n xa_destroy+0x61/0x130\n ext4_mb_init+0x483/0x540\n __ext4_fill_super+0x116d/0x17b0\n ext4_fill_super+0xd3/0x280\n get_tree_bdev_flags+0x132/0x1d0\n vfs_get_tree+0x29/0xd0\n do_new_mount+0x197/0x300\n __x64_sys_mount+0x116/0x150\n do_syscall_64+0x50/0x1c0\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\n==================================================================\n\nTherefore, add necessary null check to ext4_mb_avg_fragment_size_destroy()\nto prevent this issue. The same fix is also applied to\next4_mb_largest_free_orders_destroy().","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f7eaacbb4e54f8a6c6674c16eff54f703ea63d5e"},{"fixed":"00110f3cfc9b34b2dfee2a6c9e55a0ae6df125ae"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f7eaacbb4e54f8a6c6674c16eff54f703ea63d5e"},{"fixed":"3c3fac6bc0a9c00dbe65d8dc0d3a282afe4d3188"}]}],"versions":["v6.16","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40119.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["161253921479319179493844921049553901630","183611157390667799725071867129192646527","243769947728405061629136652542061440147","332411945193268978356335275465270911499","302633540188512659172159070353296608516","188988540263994708692909599621878140922","2270740701251223761026298732623329822","315342513826924773793878663747966787844","221012731433523532388177764242142814262","251489029922131429912338761274960425516","88481602514305643115158128198896470865","136592398815053372114681699258825844204","224456506601537134028463767650879315613"],"threshold":0.9},"id":"CVE-2025-40119-0aafd08c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@00110f3cfc9b34b2dfee2a6c9e55a0ae6df125ae","target":{"file":"fs/ext4/mballoc.c"}},{"deprecated":false,"digest":{"function_hash":"30620514132332186608910880090597701687","length":224},"id":"CVE-2025-40119-47e357e8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3c3fac6bc0a9c00dbe65d8dc0d3a282afe4d3188","target":{"file":"fs/ext4/mballoc.c","function":"ext4_mb_largest_free_orders_destroy"}},{"deprecated":false,"digest":{"function_hash":"298337287017365911043932938388933445136","length":220},"id":"CVE-2025-40119-571138fe","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@00110f3cfc9b34b2dfee2a6c9e55a0ae6df125ae","target":{"file":"fs/ext4/mballoc.c","function":"ext4_mb_avg_fragment_size_destroy"}},{"deprecated":false,"digest":{"function_hash":"298337287017365911043932938388933445136","length":220},"id":"CVE-2025-40119-c9186e16","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3c3fac6bc0a9c00dbe65d8dc0d3a282afe4d3188","target":{"file":"fs/ext4/mballoc.c","function":"ext4_mb_avg_fragment_size_destroy"}},{"deprecated":false,"digest":{"line_hashes":["161253921479319179493844921049553901630","183611157390667799725071867129192646527","243769947728405061629136652542061440147","332411945193268978356335275465270911499","302633540188512659172159070353296608516","188988540263994708692909599621878140922","2270740701251223761026298732623329822","315342513826924773793878663747966787844","221012731433523532388177764242142814262","251489029922131429912338761274960425516","88481602514305643115158128198896470865","136592398815053372114681699258825844204","224456506601537134028463767650879315613"],"threshold":0.9},"id":"CVE-2025-40119-e64881ac","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3c3fac6bc0a9c00dbe65d8dc0d3a282afe4d3188","target":{"file":"fs/ext4/mballoc.c"}},{"deprecated":false,"digest":{"function_hash":"30620514132332186608910880090597701687","length":224},"id":"CVE-2025-40119-e9bb4610","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@00110f3cfc9b34b2dfee2a6c9e55a0ae6df125ae","target":{"file":"fs/ext4/mballoc.c","function":"ext4_mb_largest_free_orders_destroy"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.17.0"},{"fixed":"6.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40119.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/00110f3cfc9b34b2dfee2a6c9e55a0ae6df125ae"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3c3fac6bc0a9c00dbe65d8dc0d3a282afe4d3188"}]}