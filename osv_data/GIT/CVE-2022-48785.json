{"schema_version":"1.7.3","id":"CVE-2022-48785","published":"2024-07-16T11:13:21Z","modified":"2025-10-21T08:11:47.152293Z","related":["SUSE-SU-2024:2894-1","SUSE-SU-2024:2939-1","SUSE-SU-2024:2947-1"],"summary":"ipv6: mcast: use rcu-safe version of ipv6_get_lladdr()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nipv6: mcast: use rcu-safe version of ipv6_get_lladdr()\n\nSome time ago 8965779d2c0e (\"ipv6,mcast: always hold idev->lock before mca_lock\")\nswitched ipv6_get_lladdr() to __ipv6_get_lladdr(), which is rcu-unsafe\nversion. That was OK, because idev->lock was held for these codepaths.\n\nIn 88e2ca308094 (\"mld: convert ifmcaddr6 to RCU\") these external locks were\nremoved, so we probably need to restore the original rcu-safe call.\n\nOtherwise, we occasionally get a machine crashed/stalled with the following\nin dmesg:\n\n[ 3405.966610][T230589] general protection fault, probably for non-canonical address 0xdead00000000008c: 0000 [#1] SMP NOPTI\n[ 3405.982083][T230589] CPU: 44 PID: 230589 Comm: kworker/44:3 Tainted: G           O      5.15.19-cloudflare-2022.2.1 #1\n[ 3405.998061][T230589] Hardware name: SUPA-COOL-SERV\n[ 3406.009552][T230589] Workqueue: mld mld_ifc_work\n[ 3406.017224][T230589] RIP: 0010:__ipv6_get_lladdr+0x34/0x60\n[ 3406.025780][T230589] Code: 57 10 48 83 c7 08 48 89 e5 48 39 d7 74 3e 48 8d 82 38 ff ff ff eb 13 48 8b 90 d0 00 00 00 48 8d 82 38 ff ff ff 48 39 d7 74 22 <66> 83 78 32 20 77 1b 75 e4 89 ca 23 50 2c 75 dd 48 8b 50 08 48 8b\n[ 3406.055748][T230589] RSP: 0018:ffff94e4b3fc3d10 EFLAGS: 00010202\n[ 3406.065617][T230589] RAX: dead00000000005a RBX: ffff94e4b3fc3d30 RCX: 0000000000000040\n[ 3406.077477][T230589] RDX: dead000000000122 RSI: ffff94e4b3fc3d30 RDI: ffff8c3a31431008\n[ 3406.089389][T230589] RBP: ffff94e4b3fc3d10 R08: 0000000000000000 R09: 0000000000000000\n[ 3406.101445][T230589] R10: ffff8c3a31430000 R11: 000000000000000b R12: ffff8c2c37887100\n[ 3406.113553][T230589] R13: ffff8c3a39537000 R14: 00000000000005dc R15: ffff8c3a31431000\n[ 3406.125730][T230589] FS:  0000000000000000(0000) GS:ffff8c3b9fc80000(0000) knlGS:0000000000000000\n[ 3406.138992][T230589] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[ 3406.149895][T230589] CR2: 00007f0dfea1db60 CR3: 000000387b5f2000 CR4: 0000000000350ee0\n[ 3406.162421][T230589] Call Trace:\n[ 3406.170235][T230589]  <TASK>\n[ 3406.177736][T230589]  mld_newpack+0xfe/0x1a0\n[ 3406.186686][T230589]  add_grhead+0x87/0xa0\n[ 3406.195498][T230589]  add_grec+0x485/0x4e0\n[ 3406.204310][T230589]  ? newidle_balance+0x126/0x3f0\n[ 3406.214024][T230589]  mld_ifc_work+0x15d/0x450\n[ 3406.223279][T230589]  process_one_work+0x1e6/0x380\n[ 3406.232982][T230589]  worker_thread+0x50/0x3a0\n[ 3406.242371][T230589]  ? rescuer_thread+0x360/0x360\n[ 3406.252175][T230589]  kthread+0x127/0x150\n[ 3406.261197][T230589]  ? set_kthread_struct+0x40/0x40\n[ 3406.271287][T230589]  ret_from_fork+0x22/0x30\n[ 3406.280812][T230589]  </TASK>\n[ 3406.288937][T230589] Modules linked in: ... [last unloaded: kheaders]\n[ 3406.476714][T230589] ---[ end trace 3525a7655f2f3b9e ]---","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"88e2ca3080947fe22eb520c1f8231e79a105d011"},{"fixed":"3e11ef1903cf6c2fba35594b193a3570854d9e9e"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"88e2ca3080947fe22eb520c1f8231e79a105d011"},{"fixed":"27f567c84f446048670376827e356f9c92033bf9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"88e2ca3080947fe22eb520c1f8231e79a105d011"},{"fixed":"26394fc118d6115390bd5b3a0fb17096271da227"}]}],"versions":["v5.12","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.3","v5.15.4","v5.15.5","v5.15.6","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.1","v5.16.10","v5.16.2","v5.16.3","v5.16.4","v5.16.5","v5.16.6","v5.16.7","v5.16.8","v5.16.9","v5.17-rc1","v5.17-rc2","v5.17-rc3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48785.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"297302465527607157517678668957698727085","length":344},"id":"CVE-2022-48785-1364b26c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@27f567c84f446048670376827e356f9c92033bf9","target":{"file":"net/ipv6/addrconf.c","function":"__ipv6_get_lladdr"}},{"deprecated":false,"digest":{"line_hashes":["40653712254989641594234236244037735207","238007517148589186219207721809937533408","253420495470509044589602489838035824280","273511798866190077439995157987207297699"],"threshold":0.9},"id":"CVE-2022-48785-20d7128e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e11ef1903cf6c2fba35594b193a3570854d9e9e","target":{"file":"net/ipv6/mcast.c"}},{"deprecated":false,"digest":{"function_hash":"92505584319248027045909026370685921871","length":1152},"id":"CVE-2022-48785-362ab8d2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@27f567c84f446048670376827e356f9c92033bf9","target":{"file":"net/ipv6/mcast.c","function":"mld_newpack"}},{"deprecated":false,"digest":{"line_hashes":["258117306401324633991060989842757972169","134832973798457406624375574544345472407","299297097347730558157844384149272942217","169742984028108258654556588069681950401","291484938288010993338059038116738678005"],"threshold":0.9},"id":"CVE-2022-48785-42f1b2c5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26394fc118d6115390bd5b3a0fb17096271da227","target":{"file":"include/net/addrconf.h"}},{"deprecated":false,"digest":{"line_hashes":["18992354224684932018235014467441935886","82698098157465074822774396694608384255","231614383394803367035360936642503827350","258085497144734691184437504685581564939","306075777558137300662298318470624004778"],"threshold":0.9},"id":"CVE-2022-48785-45ab5885","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26394fc118d6115390bd5b3a0fb17096271da227","target":{"file":"net/ipv6/addrconf.c"}},{"deprecated":false,"digest":{"function_hash":"297302465527607157517678668957698727085","length":344},"id":"CVE-2022-48785-47242d55","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e11ef1903cf6c2fba35594b193a3570854d9e9e","target":{"file":"net/ipv6/addrconf.c","function":"__ipv6_get_lladdr"}},{"deprecated":false,"digest":{"function_hash":"92505584319248027045909026370685921871","length":1152},"id":"CVE-2022-48785-551f9537","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26394fc118d6115390bd5b3a0fb17096271da227","target":{"file":"net/ipv6/mcast.c","function":"mld_newpack"}},{"deprecated":false,"digest":{"line_hashes":["40653712254989641594234236244037735207","238007517148589186219207721809937533408","253420495470509044589602489838035824280","273511798866190077439995157987207297699"],"threshold":0.9},"id":"CVE-2022-48785-5e71af15","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@27f567c84f446048670376827e356f9c92033bf9","target":{"file":"net/ipv6/mcast.c"}},{"deprecated":false,"digest":{"function_hash":"92505584319248027045909026370685921871","length":1152},"id":"CVE-2022-48785-760f935b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e11ef1903cf6c2fba35594b193a3570854d9e9e","target":{"file":"net/ipv6/mcast.c","function":"mld_newpack"}},{"deprecated":false,"digest":{"line_hashes":["40653712254989641594234236244037735207","238007517148589186219207721809937533408","253420495470509044589602489838035824280","273511798866190077439995157987207297699"],"threshold":0.9},"id":"CVE-2022-48785-7620211b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26394fc118d6115390bd5b3a0fb17096271da227","target":{"file":"net/ipv6/mcast.c"}},{"deprecated":false,"digest":{"line_hashes":["258117306401324633991060989842757972169","134832973798457406624375574544345472407","299297097347730558157844384149272942217","169742984028108258654556588069681950401","291484938288010993338059038116738678005"],"threshold":0.9},"id":"CVE-2022-48785-8c488b4a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@27f567c84f446048670376827e356f9c92033bf9","target":{"file":"include/net/addrconf.h"}},{"deprecated":false,"digest":{"function_hash":"297302465527607157517678668957698727085","length":344},"id":"CVE-2022-48785-8e7a9f2c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26394fc118d6115390bd5b3a0fb17096271da227","target":{"file":"net/ipv6/addrconf.c","function":"__ipv6_get_lladdr"}},{"deprecated":false,"digest":{"line_hashes":["18992354224684932018235014467441935886","82698098157465074822774396694608384255","231614383394803367035360936642503827350","258085497144734691184437504685581564939","306075777558137300662298318470624004778"],"threshold":0.9},"id":"CVE-2022-48785-b211eff7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@27f567c84f446048670376827e356f9c92033bf9","target":{"file":"net/ipv6/addrconf.c"}},{"deprecated":false,"digest":{"line_hashes":["258117306401324633991060989842757972169","134832973798457406624375574544345472407","299297097347730558157844384149272942217","169742984028108258654556588069681950401","291484938288010993338059038116738678005"],"threshold":0.9},"id":"CVE-2022-48785-e1591033","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e11ef1903cf6c2fba35594b193a3570854d9e9e","target":{"file":"include/net/addrconf.h"}},{"deprecated":false,"digest":{"line_hashes":["18992354224684932018235014467441935886","82698098157465074822774396694608384255","231614383394803367035360936642503827350","258085497144734691184437504685581564939","306075777558137300662298318470624004778"],"threshold":0.9},"id":"CVE-2022-48785-f1ba1bee","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e11ef1903cf6c2fba35594b193a3570854d9e9e","target":{"file":"net/ipv6/addrconf.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.13.0"},{"fixed":"5.15.25"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.16.11"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48785.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/26394fc118d6115390bd5b3a0fb17096271da227"},{"type":"WEB","url":"https://git.kernel.org/stable/c/27f567c84f446048670376827e356f9c92033bf9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3e11ef1903cf6c2fba35594b193a3570854d9e9e"}]}