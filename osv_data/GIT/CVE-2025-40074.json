{"schema_version":"1.7.3","id":"CVE-2025-40074","published":"2025-10-28T11:48:41Z","modified":"2025-10-28T20:10:07.924747Z","summary":"ipv4: start using dst_dev_rcu()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nipv4: start using dst_dev_rcu()\n\nChange icmpv4_xrlim_allow(), ip_defrag() to prevent possible UAF.\n\nChange ipmr_prepare_xmit(), ipmr_queue_fwd_xmit(), ip_mr_output(),\nipv4_neigh_lookup() to use lockdep enabled dst_dev_rcu().","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4a6ce2b6f2ecabbddcfe47e7cf61dd0f00b10e36"},{"fixed":"923e0734c386984d45de508528a7a7ad91d791cc"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4a6ce2b6f2ecabbddcfe47e7cf61dd0f00b10e36"},{"fixed":"6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8"}]}],"versions":["v4.12","v4.12-rc6","v4.12-rc7","v4.13","v4.13-rc1","v4.13-rc2","v4.13-rc3","v4.13-rc4","v4.13-rc5","v4.13-rc6","v4.13-rc7","v4.14","v4.14-rc1","v4.14-rc2","v4.14-rc3","v4.14-rc4","v4.14-rc5","v4.14-rc6","v4.14-rc7","v4.14-rc8","v4.15","v4.15-rc1","v4.15-rc2","v4.15-rc3","v4.15-rc4","v4.15-rc5","v4.15-rc6","v4.15-rc7","v4.15-rc8","v4.15-rc9","v4.16","v4.16-rc1","v4.16-rc2","v4.16-rc3","v4.16-rc4","v4.16-rc5","v4.16-rc6","v4.16-rc7","v4.17","v4.17-rc1","v4.17-rc2","v4.17-rc3","v4.17-rc4","v4.17-rc5","v4.17-rc6","v4.17-rc7","v4.18","v4.18-rc1","v4.18-rc2","v4.18-rc3","v4.18-rc4","v4.18-rc5","v4.18-rc6","v4.18-rc7","v4.18-rc8","v4.19","v4.19-rc1","v4.19-rc2","v4.19-rc3","v4.19-rc4","v4.19-rc5","v4.19-rc6","v4.19-rc7","v4.19-rc8","v4.20","v4.20-rc1","v4.20-rc2","v4.20-rc3","v4.20-rc4","v4.20-rc5","v4.20-rc6","v4.20-rc7","v5.0","v5.0-rc1","v5.0-rc2","v5.0-rc3","v5.0-rc4","v5.0-rc5","v5.0-rc6","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40074.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"293047609731872152375773370426865188597","length":635},"id":"CVE-2025-40074-05133453","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/route.c","function":"ipv4_neigh_lookup"}},{"deprecated":false,"digest":{"function_hash":"63135781565227297495016455909534007132","length":1707},"id":"CVE-2025-40074-2305ec78","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/ipmr.c","function":"ipmr_prepare_xmit"}},{"deprecated":false,"digest":{"function_hash":"293047609731872152375773370426865188597","length":635},"id":"CVE-2025-40074-27f6c104","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/route.c","function":"ipv4_neigh_lookup"}},{"deprecated":false,"digest":{"function_hash":"150343280191485835985419410998219104538","length":597},"id":"CVE-2025-40074-31b0608a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/icmp.c","function":"icmpv4_xrlim_allow"}},{"deprecated":false,"digest":{"function_hash":"327551891501519946828114132751015380866","length":1003},"id":"CVE-2025-40074-394ae726","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/ipmr.c","function":"ip_mr_output"}},{"deprecated":false,"digest":{"function_hash":"133290759687348564604653042454526060972","length":491},"id":"CVE-2025-40074-39755ab5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/ipmr.c","function":"ipmr_queue_fwd_xmit"}},{"deprecated":false,"digest":{"line_hashes":["136191794520280547048497772522736770569","133078879102123486469254637874823876451","210478852321243214371531175615740274767","114643926436351761014435951324325838782","74795445666229841536089252105747959827","303512511971855220754887302513652784148","95675804348248019630518870432813311321","208964147252057377174715370059244922825","47914728392671775445979861722000151703","142317461743991100529602473291620311458","159696960363347501854479671919623168752","1797458657430776025694221719289943563","155402397560882147745124765444984839648"],"threshold":0.9},"id":"CVE-2025-40074-3afd85e9","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/icmp.c"}},{"deprecated":false,"digest":{"function_hash":"278405861611021113945339791210783065469","length":602},"id":"CVE-2025-40074-4b9c9a40","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/ip_fragment.c","function":"ip_defrag"}},{"deprecated":false,"digest":{"function_hash":"150343280191485835985419410998219104538","length":597},"id":"CVE-2025-40074-604a8c2d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/icmp.c","function":"icmpv4_xrlim_allow"}},{"deprecated":false,"digest":{"line_hashes":["181053349713287916405201764206834818031","156737656808977214804203598497651674937","58388725988052324357212608279899656758","166616574873993600991385769906595077550","105273298527625580275434009518540634817","57134312256635963814471437808260588295","19765977209399262317587648351670721467","138629178606874536988854069016934682484"],"threshold":0.9},"id":"CVE-2025-40074-65c95fa9","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/ip_fragment.c"}},{"deprecated":false,"digest":{"function_hash":"327551891501519946828114132751015380866","length":1003},"id":"CVE-2025-40074-765838c0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/ipmr.c","function":"ip_mr_output"}},{"deprecated":false,"digest":{"line_hashes":["116570322856778405998444301001957919617","332174024645673459917619787149878378026","131139637900014761643418762891049684619","47907915295373660372851313131684548357","284411728164294672162394436343145365493","51400119073611075021979839534736922602","144937970390880534449760686688340668112","61670146517105761757258768702041424837","157688285206826676031137895577940449994","92193784569197386369212672580947195666","187475538953533157456493339609615764091","320842374988421641383090197092429218907"],"threshold":0.9},"id":"CVE-2025-40074-77be1b76","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/ipmr.c"}},{"deprecated":false,"digest":{"function_hash":"63135781565227297495016455909534007132","length":1707},"id":"CVE-2025-40074-8c6eb917","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/ipmr.c","function":"ipmr_prepare_xmit"}},{"deprecated":false,"digest":{"line_hashes":["29783624720638310095385320214065224552","264081805283091112636484158971184688767","229441842990551505306135191067802536202","9582203643400717005421529944332754348","284077190607410760775042845141275261494","124557809278589407613140082523539839669"],"threshold":0.9},"id":"CVE-2025-40074-8ceccf6d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/route.c"}},{"deprecated":false,"digest":{"line_hashes":["116570322856778405998444301001957919617","332174024645673459917619787149878378026","131139637900014761643418762891049684619","47907915295373660372851313131684548357","284411728164294672162394436343145365493","51400119073611075021979839534736922602","144937970390880534449760686688340668112","61670146517105761757258768702041424837","157688285206826676031137895577940449994","92193784569197386369212672580947195666","187475538953533157456493339609615764091","320842374988421641383090197092429218907"],"threshold":0.9},"id":"CVE-2025-40074-9e633ec7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/ipmr.c"}},{"deprecated":false,"digest":{"line_hashes":["29783624720638310095385320214065224552","264081805283091112636484158971184688767","229441842990551505306135191067802536202","9582203643400717005421529944332754348","284077190607410760775042845141275261494","124557809278589407613140082523539839669"],"threshold":0.9},"id":"CVE-2025-40074-a0a508cf","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/route.c"}},{"deprecated":false,"digest":{"line_hashes":["136191794520280547048497772522736770569","133078879102123486469254637874823876451","210478852321243214371531175615740274767","114643926436351761014435951324325838782","74795445666229841536089252105747959827","303512511971855220754887302513652784148","95675804348248019630518870432813311321","208964147252057377174715370059244922825","47914728392671775445979861722000151703","142317461743991100529602473291620311458","159696960363347501854479671919623168752","1797458657430776025694221719289943563","155402397560882147745124765444984839648"],"threshold":0.9},"id":"CVE-2025-40074-d6b91525","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/icmp.c"}},{"deprecated":false,"digest":{"function_hash":"133290759687348564604653042454526060972","length":491},"id":"CVE-2025-40074-da52e458","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/ipmr.c","function":"ipmr_queue_fwd_xmit"}},{"deprecated":false,"digest":{"line_hashes":["181053349713287916405201764206834818031","156737656808977214804203598497651674937","58388725988052324357212608279899656758","166616574873993600991385769906595077550","105273298527625580275434009518540634817","57134312256635963814471437808260588295","19765977209399262317587648351670721467","138629178606874536988854069016934682484"],"threshold":0.9},"id":"CVE-2025-40074-ea7c5764","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923e0734c386984d45de508528a7a7ad91d791cc","target":{"file":"net/ipv4/ip_fragment.c"}},{"deprecated":false,"digest":{"function_hash":"278405861611021113945339791210783065469","length":602},"id":"CVE-2025-40074-f74b7423","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8","target":{"file":"net/ipv4/ip_fragment.c","function":"ip_defrag"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"4.13.0"},{"fixed":"6.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40074.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6ad8de3cefdb6ffa6708b21c567df0dbf82c43a8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/923e0734c386984d45de508528a7a7ad91d791cc"}]}