{"schema_version":"1.7.3","id":"CVE-2025-37955","published":"2025-05-20T16:01:49.209Z","modified":"2025-11-20T08:51:15.681646Z","summary":"virtio-net: free xsk_buffs on error in virtnet_xsk_pool_enable()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nvirtio-net: free xsk_buffs on error in virtnet_xsk_pool_enable()\n\nThe selftests added to our CI by Bui Quang Minh recently reveals\nthat there is a mem leak on the error path of virtnet_xsk_pool_enable():\n\nunreferenced object 0xffff88800a68a000 (size 2048):\n  comm \"xdp_helper\", pid 318, jiffies 4294692778\n  hex dump (first 32 bytes):\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace (crc 0):\n    __kvmalloc_node_noprof+0x402/0x570\n    virtnet_xsk_pool_enable+0x293/0x6a0 (drivers/net/virtio_net.c:5882)\n    xp_assign_dev+0x369/0x670 (net/xdp/xsk_buff_pool.c:226)\n    xsk_bind+0x6a5/0x1ae0\n    __sys_bind+0x15e/0x230\n    __x64_sys_bind+0x72/0xb0\n    do_syscall_64+0xc1/0x1d0\n    entry_SYSCALL_64_after_hwframe+0x77/0x7f","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e9f3962441c0a4d6f16c656e6c8aa02a3ccdd568"},{"fixed":"94a6f6c204abb2b2dcd2ce287536cc924469cfb5"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e9f3962441c0a4d6f16c656e6c8aa02a3ccdd568"},{"fixed":"ba6917810bb4a5a32661fa941717399052b3f0d9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e9f3962441c0a4d6f16c656e6c8aa02a3ccdd568"},{"fixed":"4397684a292a71fbc1e815c3e283f7490ddce5ae"}]}],"versions":["v6.10","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.14.6","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37955.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"175951740585179156222123644037591197116","length":1271},"id":"CVE-2025-37955-3b897eed","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@94a6f6c204abb2b2dcd2ce287536cc924469cfb5","target":{"file":"drivers/net/virtio_net.c","function":"virtnet_xsk_pool_enable"}},{"deprecated":false,"digest":{"function_hash":"175951740585179156222123644037591197116","length":1271},"id":"CVE-2025-37955-5725d140","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ba6917810bb4a5a32661fa941717399052b3f0d9","target":{"file":"drivers/net/virtio_net.c","function":"virtnet_xsk_pool_enable"}},{"deprecated":false,"digest":{"line_hashes":["237956896497720729356540317402720404739","14356089121188471069627755386654797956","81583664761367519410273160162976985079","173203002506719432983924477583812039289","85726532828680209226560660812807851945","202329435013395350685293217162366427347","39598400724285760669305799527660973755","286042007830713474207599139655236568960","88595931535497170893340759796090011086"],"threshold":0.9},"id":"CVE-2025-37955-821a3404","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ba6917810bb4a5a32661fa941717399052b3f0d9","target":{"file":"drivers/net/virtio_net.c"}},{"deprecated":false,"digest":{"line_hashes":["237956896497720729356540317402720404739","14356089121188471069627755386654797956","81583664761367519410273160162976985079","173203002506719432983924477583812039289","85726532828680209226560660812807851945","202329435013395350685293217162366427347","39598400724285760669305799527660973755","286042007830713474207599139655236568960","88595931535497170893340759796090011086"],"threshold":0.9},"id":"CVE-2025-37955-87115989","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@94a6f6c204abb2b2dcd2ce287536cc924469cfb5","target":{"file":"drivers/net/virtio_net.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.12.29"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.14.7"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37955.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4397684a292a71fbc1e815c3e283f7490ddce5ae"},{"type":"WEB","url":"https://git.kernel.org/stable/c/94a6f6c204abb2b2dcd2ce287536cc924469cfb5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ba6917810bb4a5a32661fa941717399052b3f0d9"}]}