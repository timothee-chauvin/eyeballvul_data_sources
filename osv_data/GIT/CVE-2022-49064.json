{"schema_version":"1.7.3","id":"CVE-2022-49064","published":"2025-02-26T01:54:33Z","modified":"2025-10-21T08:42:33.429096Z","related":["SUSE-SU-2025:1176-1","SUSE-SU-2025:1241-1"],"summary":"cachefiles: unmark inode in use in error path","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ncachefiles: unmark inode in use in error path\n\nUnmark inode in use if error encountered. If the in-use flag leakage\noccurs in cachefiles_open_file(), Cachefiles will complain \"Inode\nalready in use\" when later another cookie with the same index key is\nlooked up.\n\nIf the in-use flag leakage occurs in cachefiles_create_tmpfile(), though\nthe \"Inode already in use\" warning won't be triggered, fix the leakage\nanyway.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1f08c925e7a38002bde509e66f6f891468848511"},{"fixed":"b2055abafd3d4ee0376fb3eed5cae866316995a1"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1f08c925e7a38002bde509e66f6f891468848511"},{"fixed":"ea5dc046127e857a7873ae55fd57c866e9e86fb2"}]}],"versions":["v5.16","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.2","v5.17.3","v5.18-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49064.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["13466669914061077526370294691378522438","25578665251789182351387924158103106280","262809873660599247741351125985530719532","186764270704839437187985248592952529421","269190463212495077418613283388735144485","136803205244070720851799673248678730339","242576668919762182221492958493423066426","183516114421200574895130979407709388223","124173716419671670051567109371246376797","303359639836637054113626291686464673745","328180158090475878527525957404840076777","71808193180098305291921161867937088422","122667157913796324437460860124015292720","48697396266686090423271165555646931096","138489865891238362639660593861299337434","214044417663561024256379136251301536465","316310967521647536724681009778481921738","99457120863600728304515943168328581708","147096446859312145842437295536378265694","225708563077762043856630600131809980826","152754331232408248305837772143087720722","228939404328249554345300043650349740712","270856173526981917274524226143206931794","21477978755203489284770735767828108610","7843231888076253491272792720914137028","56371124220794666946599672563933210146","237622260283020649194765617961838014237","189637853474739770976217545376253969906","120340658381698134973232621062561338311","244050365979467270017996473511337824853","226238223171168186512382897739162518770","261681091956505884786391714301590368150","45495921715380276248695893423831506316","255180121799447747173867609062609477327","320073377129546439875085844608849214598"],"threshold":0.9},"id":"CVE-2022-49064-077ef8a0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2055abafd3d4ee0376fb3eed5cae866316995a1","target":{"file":"fs/cachefiles/namei.c"}},{"deprecated":false,"digest":{"function_hash":"300212078631967630426186793229717295836","length":416},"id":"CVE-2022-49064-09043282","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ea5dc046127e857a7873ae55fd57c866e9e86fb2","target":{"file":"fs/cachefiles/namei.c","function":"cachefiles_unmark_inode_in_use"}},{"deprecated":false,"digest":{"function_hash":"148355954833684291461184519802411730126","length":1809},"id":"CVE-2022-49064-2155feb6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ea5dc046127e857a7873ae55fd57c866e9e86fb2","target":{"file":"fs/cachefiles/namei.c","function":"cachefiles_create_tmpfile"}},{"deprecated":false,"digest":{"line_hashes":["13466669914061077526370294691378522438","25578665251789182351387924158103106280","262809873660599247741351125985530719532","186764270704839437187985248592952529421","269190463212495077418613283388735144485","136803205244070720851799673248678730339","242576668919762182221492958493423066426","183516114421200574895130979407709388223","124173716419671670051567109371246376797","303359639836637054113626291686464673745","328180158090475878527525957404840076777","71808193180098305291921161867937088422","122667157913796324437460860124015292720","48697396266686090423271165555646931096","138489865891238362639660593861299337434","214044417663561024256379136251301536465","316310967521647536724681009778481921738","99457120863600728304515943168328581708","147096446859312145842437295536378265694","225708563077762043856630600131809980826","152754331232408248305837772143087720722","228939404328249554345300043650349740712","270856173526981917274524226143206931794","21477978755203489284770735767828108610","7843231888076253491272792720914137028","56371124220794666946599672563933210146","237622260283020649194765617961838014237","189637853474739770976217545376253969906","120340658381698134973232621062561338311","244050365979467270017996473511337824853","226238223171168186512382897739162518770","261681091956505884786391714301590368150","45495921715380276248695893423831506316","255180121799447747173867609062609477327","320073377129546439875085844608849214598"],"threshold":0.9},"id":"CVE-2022-49064-373d3cba","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ea5dc046127e857a7873ae55fd57c866e9e86fb2","target":{"file":"fs/cachefiles/namei.c"}},{"deprecated":false,"digest":{"function_hash":"14678590541649325394511435621724109797","length":1122},"id":"CVE-2022-49064-4448670d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2055abafd3d4ee0376fb3eed5cae866316995a1","target":{"file":"fs/cachefiles/namei.c","function":"cachefiles_open_file"}},{"deprecated":false,"digest":{"function_hash":"148355954833684291461184519802411730126","length":1809},"id":"CVE-2022-49064-5b05e8cf","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2055abafd3d4ee0376fb3eed5cae866316995a1","target":{"file":"fs/cachefiles/namei.c","function":"cachefiles_create_tmpfile"}},{"deprecated":false,"digest":{"function_hash":"300212078631967630426186793229717295836","length":416},"id":"CVE-2022-49064-c9c6be62","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2055abafd3d4ee0376fb3eed5cae866316995a1","target":{"file":"fs/cachefiles/namei.c","function":"cachefiles_unmark_inode_in_use"}},{"deprecated":false,"digest":{"function_hash":"14678590541649325394511435621724109797","length":1122},"id":"CVE-2022-49064-ffbf6691","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ea5dc046127e857a7873ae55fd57c866e9e86fb2","target":{"file":"fs/cachefiles/namei.c","function":"cachefiles_open_file"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49064.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b2055abafd3d4ee0376fb3eed5cae866316995a1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ea5dc046127e857a7873ae55fd57c866e9e86fb2"}]}