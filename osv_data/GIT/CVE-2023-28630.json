{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-28630.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "167951867847190564322644989357531490424",
              "length": 1171.0
            },
            "id": "CVE-2023-28630-15c1ade9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d",
            "target": {
              "file": "db-support/db-support-mysql/src/main/java/com/thoughtworks/go/server/database/mysql/MySQLBackupProcessor.java",
              "function": "createProcessExecutor"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "288250793134923679374088748673138469200",
                "243955152948601491916573706650799179169"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-28630-193def91",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d",
            "target": {
              "file": "db-support/db-support-base/src/main/java/com/thoughtworks/go/server/database/BackupProcessor.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "82549853341861421439160946601602816449",
                "119467343478084852636266722362960731404",
                "54596755888895041381218988333151603161",
                "33099018336279890510296946837717054322",
                "264871374316457616813350950933859114649",
                "27864750343291318194888661980877545848",
                "104095666220026388415512305251602085465",
                "281070554957252364989182106894462371149",
                "14264693886733708085563017540821572463",
                "273421028253665797553319719207924662907",
                "242365753399532241179165667611794729653",
                "134961367445677164294090290388074394670",
                "172627556055599027878757708053420213943",
                "91397908662498220250116665610935028936",
                "144626102797083418870809385988608885572",
                "22216128328978209399924556876923834105",
                "105940443446338268157362920400164728255",
                "261132808760032934853998730547125445069",
                "174467221707928887443937334690819033447",
                "272776512100311764614441352711359532288",
                "34537088493354545922901871621784307272",
                "191395130538591027624728852714105988955",
                "211398877444720702380723437683443921225",
                "228491121747861423608464105131564550804",
                "153847667756751532422440864565342276824",
                "240402262473487274234727667599253296778",
                "78900450177068259640103026563260607640",
                "100777722809047409571369466296929624527",
                "289105377501297226385063153403906151960",
                "259198116713745264033861813179654268318",
                "287701173922310521692790665106808321321",
                "214151912039997230190733402760039863905",
                "110017165296424729170542506737826678945",
                "212944194233467875100025940370023861752"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-28630-1a187bff",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d",
            "target": {
              "file": "db-support/db-support-postgresql/src/main/java/com/thoughtworks/go/server/database/pg/PostgresqlBackupProcessor.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "18918931916934691484562642677850405167",
                "253531377785304687541184971096163381008",
                "165722201815020342238437592342508807525",
                "33099018336279890510296946837717054322",
                "264871374316457616813350950933859114649",
                "108072884551155256262662855228255783063",
                "158025946951791982627731786474925751836",
                "148933794899867422452423261927266438073",
                "172385447860652233897200318514874282623",
                "261445978125437163282836304891232077728",
                "126069052260377644244329614163251012218",
                "132965353700294337110757228348457950857",
                "176212080137026809782398239088563448945",
                "115987570890248442809573153354212284948",
                "322225891495707187548229943979267819392",
                "239598021492425960675546323643958698102",
                "4143792995377266180603378959822507097",
                "96383167515817612880369602188026815604",
                "42862937290460387928772456003280048257",
                "71169744091430285286518705974452330072",
                "96847268746053984349030945259475794852",
                "28075491793075708671222439288908921183",
                "151152265650392725499381030863439289627",
                "78618290555459922968107598625482320807",
                "79538978428293030181650231731647637967",
                "236096716269595125699118881485919416197",
                "3221440721048647349260409963862302433",
                "225726250954665233121859795641633276865",
                "185040258838954208086215831184321244752",
                "252583351572896444334973220730057090612",
                "100101292143656874824632385565905899453",
                "302224327950389892405512976295111876562",
                "31857597929020917988677200271884998388",
                "297574556817948351128285760293418522472",
                "25074834384823248607253761728375100916",
                "332992675877204810078756226472524723205",
                "27000113109560971158286226047380545039",
                "53745367204874414857559944137967762896"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-28630-380c753a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d",
            "target": {
              "file": "db-support/db-support-mysql/src/main/java/com/thoughtworks/go/server/database/mysql/MySQLBackupProcessor.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "4353543569379818201748034226863795641",
              "length": 648.0
            },
            "id": "CVE-2023-28630-5d2a5b15",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d",
            "target": {
              "file": "db-support/db-support-mysql/src/main/java/com/thoughtworks/go/server/database/mysql/MySQLBackupProcessor.java",
              "function": "backup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "317213935920195565238488505322014864311",
              "length": 1190.0
            },
            "id": "CVE-2023-28630-5e44b982",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d",
            "target": {
              "file": "db-support/db-support-postgresql/src/main/java/com/thoughtworks/go/server/database/pg/PostgresqlBackupProcessor.java",
              "function": "createProcessExecutor"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45307827052789370215249917019113528815",
              "length": 602.0
            },
            "id": "CVE-2023-28630-fb40edca",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d",
            "target": {
              "file": "db-support/db-support-postgresql/src/main/java/com/thoughtworks/go/server/database/pg/PostgresqlBackupProcessor.java",
              "function": "backup"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "21e78c998e1eb35d8d489c1d3e3e9813dc18233a"
            },
            {
              "fixed": "6545481e7b36817dd6033bf614585a8db242070d"
            }
          ],
          "repo": "https://github.com/gocd/gocd",
          "type": "GIT"
        }
      ],
      "versions": [
        "14.2.0",
        "14.3.0",
        "14.4.0",
        "15.1.0",
        "15.2.0",
        "15.3.0",
        "15.3.1",
        "16.1.0",
        "16.10.0",
        "16.11.0",
        "16.12.0",
        "16.2.0",
        "16.3.0",
        "16.4.0",
        "16.5.0",
        "16.6.0",
        "16.7.0",
        "16.8.0",
        "16.9.0",
        "17.1.0",
        "17.10.0",
        "17.11.0",
        "17.12.0",
        "17.2.0",
        "17.3.0",
        "17.4.0",
        "17.5.0",
        "17.6.0",
        "17.7.0",
        "17.8.0",
        "17.9.0",
        "18.1.0",
        "18.10.0",
        "18.11.0",
        "18.12.0",
        "18.2.0",
        "18.3.0",
        "18.4.0",
        "18.5.0",
        "18.6.0",
        "18.7.0",
        "18.8.0",
        "18.9.0",
        "19.1.0",
        "19.10.0",
        "19.11.0",
        "19.12.0",
        "19.2.0",
        "19.3.0",
        "19.4.0",
        "19.5.0",
        "19.6.0",
        "19.7.0",
        "19.8.0",
        "19.9.0",
        "20.1.0",
        "20.10.0",
        "20.2.0",
        "20.3.0",
        "20.4.0",
        "20.5.0",
        "20.6.0",
        "20.7.0",
        "20.8.0",
        "20.9.0",
        "21.1.0",
        "21.2.0",
        "21.3.0",
        "21.4.0",
        "22.1.0",
        "22.2.0",
        "22.3.0"
      ]
    }
  ],
  "details": "GoCD is an open source continuous delivery server. In GoCD versions from 20.5.0 and below 23.1.0, if the server environment is not correctly configured by administrators to provide access to the relevant PostgreSQL or MySQL backup tools, the credentials for database access may be unintentionally leaked to admin alerts on the GoCD user interface. The vulnerability is triggered only if the GoCD server host is misconfigured to have backups enabled, but does not have access to the `pg_dump` or `mysqldump` utility tools to backup the configured database type (PostgreSQL or MySQL respectively). In such cases, failure to launch the expected backup utility reports the shell environment used to attempt to launch in the server admin alert, which includes the plaintext database password supplied to the configured tool. This vulnerability does not affect backups of the default on-disk H2 database that GoCD is configured to use. This issue has been addressed and fixed in GoCD 23.1.0. Users are advised to upgrade. Users unable to upgrade may disable backups, or administrators should ensure that the required `pg_dump` (PostgreSQL) or `mysqldump` (MySQL) binaries are available on the GoCD server when backups are triggered.",
  "id": "CVE-2023-28630",
  "modified": "2025-10-10T04:30:22.838871Z",
  "published": "2023-03-27T21:15:12Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/gocd/gocd/releases/tag/23.1.0"
    },
    {
      "type": "FIX",
      "url": "https://github.com/gocd/gocd/security/advisories/GHSA-p95w-gh78-qjmv"
    },
    {
      "type": "ADVISORY",
      "url": "https://www.gocd.org/releases/#23-1-0"
    },
    {
      "type": "FIX",
      "url": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d"
    }
  ],
  "related": [
    "GHSA-p95w-gh78-qjmv"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N",
      "type": "CVSS_V3"
    }
  ]
}