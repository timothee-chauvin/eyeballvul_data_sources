{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-41036.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "121528748747257802841383093255233351800",
                "274122952976474678466294816718659788494",
                "287077358098444005063630093505997878020",
                "167594570871283806135404766623597034967",
                "2294159153519082392081528791195359887",
                "309796951520577012792942608622033721082",
                "49355298871187593213645102567618706955"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-124b15f5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@80ece00137300d74642f2038c8fe5440deaf9f05",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_spi.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "121528748747257802841383093255233351800",
                "274122952976474678466294816718659788494",
                "287077358098444005063630093505997878020",
                "167594570871283806135404766623597034967",
                "2294159153519082392081528791195359887",
                "309796951520577012792942608622033721082",
                "49355298871187593213645102567618706955"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-2679cfa5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@10fec0cd0e8f56ff06c46bb24254c7d8f8f2bbf0",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_spi.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "188869732248380924574721892930849475214",
                "306190755992434059448834362569751777073",
                "79545077807693329505955869907686068513",
                "208337211914327761713742011462245810956",
                "290636645326293182149206353498330457533",
                "230023977550960656101311195465170623048",
                "146630135613010387882543143198488190018",
                "297432847077421945201344847344070431729",
                "42707614624048690874175979259599285530",
                "35038191996427494386032107281378051454",
                "318905965874889401889025771066713275599",
                "224501181239234407815798737824242960966",
                "249934825823162903804084912552357126316",
                "184620047178966969986108071952579530298",
                "162567809870131174871087032933109442492",
                "88003257986900384227705100651392710652",
                "236704866823829694949017030036952753771"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-3746c860",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@80ece00137300d74642f2038c8fe5440deaf9f05",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_common.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "188869732248380924574721892930849475214",
                "306190755992434059448834362569751777073",
                "79545077807693329505955869907686068513",
                "208337211914327761713742011462245810956",
                "290636645326293182149206353498330457533",
                "230023977550960656101311195465170623048",
                "146630135613010387882543143198488190018",
                "297432847077421945201344847344070431729",
                "42707614624048690874175979259599285530",
                "35038191996427494386032107281378051454",
                "318905965874889401889025771066713275599",
                "224501181239234407815798737824242960966",
                "249934825823162903804084912552357126316",
                "184620047178966969986108071952579530298",
                "162567809870131174871087032933109442492",
                "88003257986900384227705100651392710652",
                "236704866823829694949017030036952753771"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-9cb758c8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a0c69c492f4a8fad52f0a97565241c926160c9a4",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_common.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "121528748747257802841383093255233351800",
                "274122952976474678466294816718659788494",
                "287077358098444005063630093505997878020",
                "167594570871283806135404766623597034967",
                "2294159153519082392081528791195359887",
                "309796951520577012792942608622033721082",
                "49355298871187593213645102567618706955"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-a31d9154",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0913ec336a6c0c4a2b296bd9f74f8e41c4c83c8c",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_spi.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "188869732248380924574721892930849475214",
                "306190755992434059448834362569751777073",
                "79545077807693329505955869907686068513",
                "208337211914327761713742011462245810956",
                "290636645326293182149206353498330457533",
                "230023977550960656101311195465170623048",
                "146630135613010387882543143198488190018",
                "297432847077421945201344847344070431729",
                "42707614624048690874175979259599285530",
                "35038191996427494386032107281378051454",
                "318905965874889401889025771066713275599",
                "224501181239234407815798737824242960966",
                "249934825823162903804084912552357126316",
                "184620047178966969986108071952579530298",
                "162567809870131174871087032933109442492",
                "88003257986900384227705100651392710652",
                "236704866823829694949017030036952753771"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-bc2af37a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0913ec336a6c0c4a2b296bd9f74f8e41c4c83c8c",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_common.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "188869732248380924574721892930849475214",
                "306190755992434059448834362569751777073",
                "79545077807693329505955869907686068513",
                "208337211914327761713742011462245810956",
                "290636645326293182149206353498330457533",
                "230023977550960656101311195465170623048",
                "146630135613010387882543143198488190018",
                "297432847077421945201344847344070431729",
                "42707614624048690874175979259599285530",
                "35038191996427494386032107281378051454",
                "318905965874889401889025771066713275599",
                "224501181239234407815798737824242960966",
                "249934825823162903804084912552357126316",
                "184620047178966969986108071952579530298",
                "162567809870131174871087032933109442492",
                "88003257986900384227705100651392710652",
                "236704866823829694949017030036952753771"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-ef082ff3",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@10fec0cd0e8f56ff06c46bb24254c7d8f8f2bbf0",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_common.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "121528748747257802841383093255233351800",
                "274122952976474678466294816718659788494",
                "287077358098444005063630093505997878020",
                "167594570871283806135404766623597034967",
                "2294159153519082392081528791195359887",
                "309796951520577012792942608622033721082",
                "49355298871187593213645102567618706955"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-41036-ff527530",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a0c69c492f4a8fad52f0a97565241c926160c9a4",
            "target": {
              "file": "drivers/net/ethernet/micrel/ks8851_spi.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "1092525155eaad5c69ca9f3b6f3e7895a9424d66"
            },
            {
              "fixed": "a0c69c492f4a8fad52f0a97565241c926160c9a4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "30302b41ffdcd194bef27fb3b1a9f2ca53dedb27"
            },
            {
              "fixed": "80ece00137300d74642f2038c8fe5440deaf9f05"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "3dc5d44545453de1de9c53cc529cc960a85933da"
            },
            {
              "fixed": "10fec0cd0e8f56ff06c46bb24254c7d8f8f2bbf0"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "3dc5d44545453de1de9c53cc529cc960a85933da"
            },
            {
              "fixed": "0913ec336a6c0c4a2b296bd9f74f8e41c4c83c8c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "786788bb1396ed5ea27e39c4933f59f4e52004e4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "7c25c5d7274631b655f0f9098a16241fcd5db57b"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.10.206",
        "v5.10.207",
        "v5.10.208",
        "v5.10.209",
        "v5.10.210",
        "v5.10.211",
        "v5.10.212",
        "v5.10.213",
        "v5.10.214",
        "v5.10.215",
        "v5.10.216",
        "v5.10.217",
        "v5.10.218",
        "v5.10.219",
        "v5.10.220",
        "v5.10.221",
        "v5.10.222",
        "v5.10.223",
        "v5.10.224",
        "v5.10.225",
        "v5.10.226",
        "v5.10.227",
        "v5.10.228",
        "v5.10.229",
        "v5.10.230",
        "v5.10.231",
        "v5.10.232",
        "v5.10.233",
        "v5.10.234",
        "v5.10.235",
        "v5.10.236",
        "v5.10.237",
        "v5.10.238",
        "v5.10.239",
        "v5.10.240",
        "v5.10.241",
        "v5.10.242",
        "v5.10.243",
        "v5.10.244",
        "v5.10.245",
        "v5.15.146",
        "v5.15.147",
        "v5.15.148",
        "v5.15.149",
        "v5.15.150",
        "v5.15.151",
        "v5.15.152",
        "v5.15.153",
        "v5.15.154",
        "v5.15.155",
        "v5.15.156",
        "v5.15.157",
        "v5.15.158",
        "v5.15.159",
        "v5.15.160",
        "v5.15.161",
        "v5.15.162",
        "v5.15.163",
        "v5.15.164",
        "v5.15.165",
        "v5.15.166",
        "v5.15.167",
        "v5.15.168",
        "v5.15.169",
        "v5.15.170",
        "v5.15.171",
        "v5.15.172",
        "v5.15.173",
        "v5.15.174",
        "v5.15.175",
        "v5.15.176",
        "v5.15.177",
        "v5.15.178",
        "v5.15.179",
        "v5.15.180",
        "v5.15.181",
        "v5.15.182",
        "v5.15.183",
        "v5.15.184",
        "v5.15.185",
        "v5.15.186",
        "v5.15.187",
        "v5.15.188",
        "v5.15.189",
        "v5.15.190",
        "v5.15.191",
        "v5.15.192",
        "v5.15.193",
        "v5.15.194",
        "v6.1.70",
        "v6.1.71",
        "v6.1.72",
        "v6.1.73",
        "v6.1.74",
        "v6.1.75",
        "v6.1.76",
        "v6.1.77",
        "v6.1.78",
        "v6.1.79",
        "v6.1.80",
        "v6.1.81",
        "v6.1.82",
        "v6.1.83",
        "v6.1.84",
        "v6.1.85",
        "v6.1.86",
        "v6.1.87",
        "v6.1.88",
        "v6.1.89",
        "v6.1.90",
        "v6.1.91",
        "v6.1.92",
        "v6.1.93",
        "v6.1.94",
        "v6.1.95",
        "v6.1.96",
        "v6.1.97",
        "v6.1.98",
        "v6.1.99",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.30",
        "v6.6.31",
        "v6.6.32",
        "v6.6.33",
        "v6.6.34",
        "v6.6.35",
        "v6.6.36",
        "v6.6.37",
        "v6.6.38",
        "v6.6.39",
        "v6.6.40",
        "v6.6.9",
        "v6.7",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7",
        "v6.9.1",
        "v6.9.2",
        "v6.9.3",
        "v6.9.4",
        "v6.9.5",
        "v6.9.6",
        "v6.9.7",
        "v6.9.8",
        "v6.9.9"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-41036.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.1.100"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.6.41"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.9.10"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: ks8851: Fix deadlock with the SPI chip variant\n\nWhen SMP is enabled and spinlocks are actually functional then there is\na deadlock with the 'statelock' spinlock between ks8851_start_xmit_spi\nand ks8851_irq:\n\n    watchdog: BUG: soft lockup - CPU#0 stuck for 27s!\n    call trace:\n      queued_spin_lock_slowpath+0x100/0x284\n      do_raw_spin_lock+0x34/0x44\n      ks8851_start_xmit_spi+0x30/0xb8\n      ks8851_start_xmit+0x14/0x20\n      netdev_start_xmit+0x40/0x6c\n      dev_hard_start_xmit+0x6c/0xbc\n      sch_direct_xmit+0xa4/0x22c\n      __qdisc_run+0x138/0x3fc\n      qdisc_run+0x24/0x3c\n      net_tx_action+0xf8/0x130\n      handle_softirqs+0x1ac/0x1f0\n      __do_softirq+0x14/0x20\n      ____do_softirq+0x10/0x1c\n      call_on_irq_stack+0x3c/0x58\n      do_softirq_own_stack+0x1c/0x28\n      __irq_exit_rcu+0x54/0x9c\n      irq_exit_rcu+0x10/0x1c\n      el1_interrupt+0x38/0x50\n      el1h_64_irq_handler+0x18/0x24\n      el1h_64_irq+0x64/0x68\n      __netif_schedule+0x6c/0x80\n      netif_tx_wake_queue+0x38/0x48\n      ks8851_irq+0xb8/0x2c8\n      irq_thread_fn+0x2c/0x74\n      irq_thread+0x10c/0x1b0\n      kthread+0xc8/0xd8\n      ret_from_fork+0x10/0x20\n\nThis issue has not been identified earlier because tests were done on\na device with SMP disabled and so spinlocks were actually NOPs.\n\nNow use spin_(un)lock_bh for TX queue related locking to avoid execution\nof softirq work synchronously that would lead to a deadlock.",
  "id": "CVE-2024-41036",
  "modified": "2025-10-15T13:04:07.378394Z",
  "published": "2024-07-29T14:31:50Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0913ec336a6c0c4a2b296bd9f74f8e41c4c83c8c"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/10fec0cd0e8f56ff06c46bb24254c7d8f8f2bbf0"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/80ece00137300d74642f2038c8fe5440deaf9f05"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/a0c69c492f4a8fad52f0a97565241c926160c9a4"
    }
  ],
  "related": [
    "MGASA-2024-0277",
    "MGASA-2024-0278",
    "SUSE-SU-2024:3190-1",
    "SUSE-SU-2024:3194-1",
    "SUSE-SU-2024:3195-1",
    "SUSE-SU-2024:3209-1",
    "SUSE-SU-2024:3383-1",
    "SUSE-SU-2024:3483-1"
  ],
  "schema_version": "1.7.3",
  "summary": "net: ks8851: Fix deadlock with the SPI chip variant"
}