{"schema_version":"1.7.3","id":"CVE-2024-58078","published":"2025-03-06T16:13:41.909Z","modified":"2025-11-20T07:59:08.689851Z","related":["SUSE-SU-2025:01919-1","SUSE-SU-2025:1177-1","SUSE-SU-2025:1178-1","SUSE-SU-2025:1180-1","USN-7521-2"],"summary":"misc: misc_minor_alloc to use ida for all dynamic/misc dynamic minors","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmisc: misc_minor_alloc to use ida for all dynamic/misc dynamic minors\n\nmisc_minor_alloc was allocating id using ida for minor only in case of\nMISC_DYNAMIC_MINOR but misc_minor_free was always freeing ids\nusing ida_free causing a mismatch and following warn:\n> > WARNING: CPU: 0 PID: 159 at lib/idr.c:525 ida_free+0x3e0/0x41f\n> > ida_free called for id=127 which is not allocated.\n> > <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n...\n> > [<60941eb4>] ida_free+0x3e0/0x41f\n> > [<605ac993>] misc_minor_free+0x3e/0xbc\n> > [<605acb82>] misc_deregister+0x171/0x1b3\n\nmisc_minor_alloc is changed to allocate id from ida for all minors\nfalling in the range of dynamic/ misc dynamic minors","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ab760791c0cfbb1d7a668f46a135264f56c8f018"},{"fixed":"3df72111c39f7e4c5029c9ff720b56ec2e05b764"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ab760791c0cfbb1d7a668f46a135264f56c8f018"},{"fixed":"8b4120b3e060e137eaa8dc76a1c40401088336e5"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ab760791c0cfbb1d7a668f46a135264f56c8f018"},{"fixed":"6635332d246d7db89b90e145f2bf937406cecaf0"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ab760791c0cfbb1d7a668f46a135264f56c8f018"},{"fixed":"6d04d2b554b14ae6c428a9c60b6c85f1e5c89f68"}]}],"versions":["v6.1","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.2","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.2","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-58078.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"311634504670627175228033961235067600480","length":876},"id":"CVE-2024-58078-11e41154","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6635332d246d7db89b90e145f2bf937406cecaf0","target":{"file":"drivers/char/misc.c","function":"misc_register"}},{"deprecated":false,"digest":{"function_hash":"108636501989916745870036432946444010392","length":284},"id":"CVE-2024-58078-2841d255","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d04d2b554b14ae6c428a9c60b6c85f1e5c89f68","target":{"file":"drivers/char/misc.c","function":"misc_minor_alloc"}},{"deprecated":false,"digest":{"function_hash":"311634504670627175228033961235067600480","length":876},"id":"CVE-2024-58078-34ea053c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d04d2b554b14ae6c428a9c60b6c85f1e5c89f68","target":{"file":"drivers/char/misc.c","function":"misc_register"}},{"deprecated":false,"digest":{"line_hashes":["296978826749767890322602469918397308675","313137187862320916826836540357912576848","93435737956473617670247513848384170471","263583553064763264586453774501668336137","170446137967078472963670958143154033899","110110130637123716709962439582015302786","128437309797474465799810475572422196943","213145927292397412145528250117419764852","278816635588017986742412159469212077682","19004813528588814873363527641090216003","212649504060448589767937163525375326913","34770262391197059308980079222703115433","289461699311792617864355238198789693206","336766508223567283415158206157861032747","148230225733784988641970340522669193519","134071995556919772329639975360009120832","58613352648546286170416425275903762373","318767418506861761629193978411043562249","267964059275348509610090830929394544581","249333125945872791348221048200261357223","214499871444232527081113934948433991263","70553298829730235196764526836137880392","248294312455338563935648905488391537683","288925809436217254340873469096775120138"],"threshold":0.9},"id":"CVE-2024-58078-6858f7bf","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6635332d246d7db89b90e145f2bf937406cecaf0","target":{"file":"drivers/char/misc.c"}},{"deprecated":false,"digest":{"function_hash":"108636501989916745870036432946444010392","length":284},"id":"CVE-2024-58078-919969cb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6635332d246d7db89b90e145f2bf937406cecaf0","target":{"file":"drivers/char/misc.c","function":"misc_minor_alloc"}},{"deprecated":false,"digest":{"line_hashes":["296978826749767890322602469918397308675","313137187862320916826836540357912576848","93435737956473617670247513848384170471","263583553064763264586453774501668336137","170446137967078472963670958143154033899","110110130637123716709962439582015302786","128437309797474465799810475572422196943","213145927292397412145528250117419764852","278816635588017986742412159469212077682","19004813528588814873363527641090216003","212649504060448589767937163525375326913","34770262391197059308980079222703115433","289461699311792617864355238198789693206","336766508223567283415158206157861032747","148230225733784988641970340522669193519","134071995556919772329639975360009120832","58613352648546286170416425275903762373","318767418506861761629193978411043562249","267964059275348509610090830929394544581","249333125945872791348221048200261357223","214499871444232527081113934948433991263","70553298829730235196764526836137880392","248294312455338563935648905488391537683","288925809436217254340873469096775120138"],"threshold":0.9},"id":"CVE-2024-58078-e60bdf08","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d04d2b554b14ae6c428a9c60b6c85f1e5c89f68","target":{"file":"drivers/char/misc.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.78"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.14"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-58078.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3df72111c39f7e4c5029c9ff720b56ec2e05b764"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6635332d246d7db89b90e145f2bf937406cecaf0"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6d04d2b554b14ae6c428a9c60b6c85f1e5c89f68"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8b4120b3e060e137eaa8dc76a1c40401088336e5"}]}