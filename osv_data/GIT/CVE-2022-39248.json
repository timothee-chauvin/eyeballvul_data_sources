{"schema_version":"1.7.3","id":"CVE-2022-39248","published":"2022-09-28T20:05:12Z","modified":"2025-11-19T11:10:22.053973Z","aliases":["GHSA-fpgf-pjjv-2qgm"],"summary":"matrix-android-sdk2 vulnerable to Olm/Megolm protocol confusion","details":"matrix-android-sdk2 is the Matrix SDK for Android. Prior to version 1.5.1, an attacker cooperating with a malicious homeserver can construct messages that legitimately appear to have come from another person, without any indication such as a grey shield. Additionally, a sophisticated attacker cooperating with a malicious homeserver could employ this vulnerability to perform a targeted attack in order to send fake to-device messages appearing to originate from another user. This can allow, for example, to inject the key backup secret during a self-verification, to make a targeted device start using a malicious key backup spoofed by the homeserver. matrix-android-sdk2 would then additionally sign such a key backup with its device key, spilling trust over to other devices trusting the matrix-android-sdk2 device. These attacks are possible due to a protocol confusion vulnerability that accepts to-device messages encrypted with Megolm instead of Olm. matrix-android-sdk2 version 1.5.1 has been modified to only accept Olm-encrypted to-device messages and to stop signing backups on a successful decryption. Out of caution, several other checks have been audited or added. This attack requires coordination between a malicious home server and an attacker, so those who trust their home servers do not need a workaround.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/matrix-org/matrix-android-sdk2","events":[{"introduced":"0"},{"fixed":"e1b2844afce399811162b1015c0d4740e6d9de9a"}],"database_specific":{"versions":[{"introduced":"0"},{"fixed":"1.5.1"}]}}],"versions":["v0.0.1","v1.0.10","v1.0.11","v1.0.12","v1.0.13","v1.0.16","v1.0.5","v1.0.6","v1.0.7","v1.0.9","v1.1.1","v1.1.4","v1.1.5","v1.1.8","v1.1.9","v1.2.0","v1.2.0-RC1","v1.2.0-RC2","v1.2.0-RC3","v1.2.1","v1.2.2","v1.3.0","v1.3.10","v1.3.13","v1.3.14","v1.3.18","v1.3.2","v1.3.4","v1.3.7","v1.3.8","v1.3.9","v1.4.11","v1.4.13","v1.4.14","v1.4.16","v1.4.2","v1.4.25","v1.4.27","v1.4.32","v1.4.34","v1.4.36","v1.4.4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-39248.json"}}],"references":[{"type":"FIX","url":"https://github.com/matrix-org/matrix-android-sdk2/commit/77df720a238d17308deab83ecaa37f7a4740a17e"},{"type":"WEB","url":"https://github.com/matrix-org/matrix-android-sdk2/releases/tag/v1.5.1"},{"type":"ADVISORY","url":"https://github.com/matrix-org/matrix-android-sdk2/security/advisories/GHSA-fpgf-pjjv-2qgm"},{"type":"ARTICLE","url":"https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients"}],"database_specific":{"cwe_ids":["CWE-287","CWE-322"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N"}]}