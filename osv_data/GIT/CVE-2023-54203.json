{"schema_version":"1.7.3","id":"CVE-2023-54203","published":"2025-12-30T12:09:07.538Z","modified":"2025-12-30T20:53:43.326117Z","summary":"ksmbd: fix slab-out-of-bounds in init_smb2_rsp_hdr","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nksmbd: fix slab-out-of-bounds in init_smb2_rsp_hdr\n\nWhen smb1 mount fails, KASAN detect slab-out-of-bounds in\ninit_smb2_rsp_hdr like the following one.\nFor smb1 negotiate(56bytes) , init_smb2_rsp_hdr() for smb2 is called.\nThe issue occurs while handling smb1 negotiate as smb2 server operations.\nAdd smb server operations for smb1 (get_cmd_val, init_rsp_hdr,\nallocate_rsp_buf, check_user_session) to handle smb1 negotiate so that\nsmb2 server operation does not handle it.\n\n[  411.400423] CIFS: VFS: Use of the less secure dialect vers=1.0 is\nnot recommended unless required for access to very old servers\n[  411.400452] CIFS: Attempting to mount \\\\192.168.45.139\\homes\n[  411.479312] ksmbd: init_smb2_rsp_hdr : 492\n[  411.479323] ==================================================================\n[  411.479327] BUG: KASAN: slab-out-of-bounds in\ninit_smb2_rsp_hdr+0x1e2/0x1f4 [ksmbd]\n[  411.479369] Read of size 16 at addr ffff888488ed0734 by task kworker/14:1/199\n\n[  411.479379] CPU: 14 PID: 199 Comm: kworker/14:1 Tainted: G\n OE      6.1.21 #3\n[  411.479386] Hardware name: ASUSTeK COMPUTER INC. Z10PA-D8\nSeries/Z10PA-D8 Series, BIOS 3801 08/23/2019\n[  411.479390] Workqueue: ksmbd-io handle_ksmbd_work [ksmbd]\n[  411.479425] Call Trace:\n[  411.479428]  <TASK>\n[  411.479432]  dump_stack_lvl+0x49/0x63\n[  411.479444]  print_report+0x171/0x4a8\n[  411.479452]  ? kasan_complete_mode_report_info+0x3c/0x200\n[  411.479463]  ? init_smb2_rsp_hdr+0x1e2/0x1f4 [ksmbd]\n[  411.479497]  kasan_report+0xb4/0x130\n[  411.479503]  ? init_smb2_rsp_hdr+0x1e2/0x1f4 [ksmbd]\n[  411.479537]  kasan_check_range+0x149/0x1e0\n[  411.479543]  memcpy+0x24/0x70\n[  411.479550]  init_smb2_rsp_hdr+0x1e2/0x1f4 [ksmbd]\n[  411.479585]  handle_ksmbd_work+0x109/0x760 [ksmbd]\n[  411.479616]  ? _raw_spin_unlock_irqrestore+0x50/0x50\n[  411.479624]  ? smb3_encrypt_resp+0x340/0x340 [ksmbd]\n[  411.479656]  process_one_work+0x49c/0x790\n[  411.479667]  worker_thread+0x2b1/0x6e0\n[  411.479674]  ? process_one_work+0x790/0x790\n[  411.479680]  kthread+0x177/0x1b0\n[  411.479686]  ? kthread_complete_and_exit+0x30/0x30\n[  411.479692]  ret_from_fork+0x22/0x30\n[  411.479702]  </TASK>","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"51a8534c0f35c0401e45f1055f914729cad98bf9"},{"fixed":"921536046bd165efeb07beef5630aff35cd6a489"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0b3ec5671ac06829ccebdaeec05acedfec327f42"},{"fixed":"a8334a0c535d0f0b4d64926c8fe0922ed98f7d43"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"cc32cd98a0aee4cc3eb611cbce11795b1aaa738a"},{"fixed":"99a51c673b1d2d0b5a972353401b77612d9cc713"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"39b291b86b5988bf8753c3874d5c773399d09b96"},{"fixed":"dc8289f912387c3bcfbc5d2db29c8947fa207c11"}]}],"versions":["v5.15.105","v5.15.106","v5.15.107","v5.15.108","v5.15.109","v5.15.110","v5.15.111","v5.15.112","v5.15.113","v5.15.114","v5.15.115","v5.15.116","v5.15.117","v5.15.118","v5.15.119","v5.15.120","v5.15.121","v5.15.122","v5.15.123","v5.15.124","v5.15.125","v5.15.126","v5.15.127","v5.15.128","v5.15.129","v5.15.130","v5.15.131","v5.15.132","v5.15.133","v5.15.134","v5.15.135","v5.15.136","v5.15.137","v5.15.138","v5.15.139","v5.15.140","v5.15.141","v5.15.142","v5.15.143","v5.15.144","v6.1.22","v6.1.23","v6.2.10","v6.2.9"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-54203.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.15.105"},{"fixed":"5.15.145"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.1.22"},{"fixed":"6.1.24"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.9"},{"fixed":"6.2.11"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-54203.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/921536046bd165efeb07beef5630aff35cd6a489"},{"type":"WEB","url":"https://git.kernel.org/stable/c/99a51c673b1d2d0b5a972353401b77612d9cc713"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a8334a0c535d0f0b4d64926c8fe0922ed98f7d43"},{"type":"WEB","url":"https://git.kernel.org/stable/c/dc8289f912387c3bcfbc5d2db29c8947fa207c11"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/54xxx/CVE-2023-54203.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2023-54203"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/54xxx/CVE-2023-54203.json"}}