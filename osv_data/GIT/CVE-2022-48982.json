{"schema_version":"1.7.3","id":"CVE-2022-48982","published":"2024-10-21T20:05:59Z","modified":"2025-10-21T07:45:20.212518Z","related":["SUSE-SU-2024:4315-1","SUSE-SU-2024:4364-1","SUSE-SU-2024:4376-1"],"summary":"Bluetooth: Fix crash when replugging CSR fake controllers","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: Fix crash when replugging CSR fake controllers\n\nIt seems fake CSR 5.0 clones can cause the suspend notifier to be\nregistered twice causing the following kernel panic:\n\n[   71.986122] Call Trace:\n[   71.986124]  <TASK>\n[   71.986125]  blocking_notifier_chain_register+0x33/0x60\n[   71.986130]  hci_register_dev+0x316/0x3d0 [bluetooth 99b5497ea3d09708fa1366c1dc03288bf3cca8da]\n[   71.986154]  btusb_probe+0x979/0xd85 [btusb e1e0605a4f4c01984a4b9c8ac58c3666ae287477]\n[   71.986159]  ? __pm_runtime_set_status+0x1a9/0x300\n[   71.986162]  ? ktime_get_mono_fast_ns+0x3e/0x90\n[   71.986167]  usb_probe_interface+0xe3/0x2b0\n[   71.986171]  really_probe+0xdb/0x380\n[   71.986174]  ? pm_runtime_barrier+0x54/0x90\n[   71.986177]  __driver_probe_device+0x78/0x170\n[   71.986180]  driver_probe_device+0x1f/0x90\n[   71.986183]  __device_attach_driver+0x89/0x110\n[   71.986186]  ? driver_allows_async_probing+0x70/0x70\n[   71.986189]  bus_for_each_drv+0x8c/0xe0\n[   71.986192]  __device_attach+0xb2/0x1e0\n[   71.986195]  bus_probe_device+0x92/0xb0\n[   71.986198]  device_add+0x422/0x9a0\n[   71.986201]  ? sysfs_merge_group+0xd4/0x110\n[   71.986205]  usb_set_configuration+0x57a/0x820\n[   71.986208]  usb_generic_driver_probe+0x4f/0x70\n[   71.986211]  usb_probe_device+0x3a/0x110\n[   71.986213]  really_probe+0xdb/0x380\n[   71.986216]  ? pm_runtime_barrier+0x54/0x90\n[   71.986219]  __driver_probe_device+0x78/0x170\n[   71.986221]  driver_probe_device+0x1f/0x90\n[   71.986224]  __device_attach_driver+0x89/0x110\n[   71.986227]  ? driver_allows_async_probing+0x70/0x70\n[   71.986230]  bus_for_each_drv+0x8c/0xe0\n[   71.986232]  __device_attach+0xb2/0x1e0\n[   71.986235]  bus_probe_device+0x92/0xb0\n[   71.986237]  device_add+0x422/0x9a0\n[   71.986239]  ? _dev_info+0x7d/0x98\n[   71.986242]  ? blake2s_update+0x4c/0xc0\n[   71.986246]  usb_new_device.cold+0x148/0x36d\n[   71.986250]  hub_event+0xa8a/0x1910\n[   71.986255]  process_one_work+0x1c4/0x380\n[   71.986259]  worker_thread+0x51/0x390\n[   71.986262]  ? rescuer_thread+0x3b0/0x3b0\n[   71.986264]  kthread+0xdb/0x110\n[   71.986266]  ? kthread_complete_and_exit+0x20/0x20\n[   71.986268]  ret_from_fork+0x1f/0x30\n[   71.986273]  </TASK>\n[   71.986274] ---[ end trace 0000000000000000 ]---\n[   71.986284] btusb: probe of 2-1.6:1.0 failed with error -17","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"359ee4f834f5b4f8096f7edc0c20ef37d1fca861"},{"fixed":"dc8fa6570deadb70c3fb74d7cd8ce38849feaed0"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"359ee4f834f5b4f8096f7edc0c20ef37d1fca861"},{"fixed":"b5ca338751ad4783ec8d37b5d99c3e37b7813e59"}]}],"versions":["v5.19","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.10","v6.0.11","v6.0.12","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.0.8","v6.0.9","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48982.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"244843326638984629349160590677701239920","length":186},"id":"CVE-2022-48982-2034d34a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dc8fa6570deadb70c3fb74d7cd8ce38849feaed0","target":{"file":"net/bluetooth/hci_core.c","function":"hci_unregister_suspend_notifier"}},{"deprecated":false,"digest":{"function_hash":"67757454436288988416326564877907287939","length":257},"id":"CVE-2022-48982-9fa7497f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dc8fa6570deadb70c3fb74d7cd8ce38849feaed0","target":{"file":"net/bluetooth/hci_core.c","function":"hci_register_suspend_notifier"}},{"deprecated":false,"digest":{"line_hashes":["259369361378095300460975664182006653379","137631259276783842100393295402385487382","10585528368485041305317711435726910190","327063581649730136998985121167110509670","27971544739595913215230996468489284896","232343767286407853044179501487167703386","23293724515375960670781766943482972482","121693895629193521507982002513989133587","294975344646879374541757157789871745607"],"threshold":0.9},"id":"CVE-2022-48982-a80ef290","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dc8fa6570deadb70c3fb74d7cd8ce38849feaed0","target":{"file":"net/bluetooth/hci_core.c"}},{"deprecated":false,"digest":{"function_hash":"244843326638984629349160590677701239920","length":186},"id":"CVE-2022-48982-dd4eb40e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b5ca338751ad4783ec8d37b5d99c3e37b7813e59","target":{"file":"net/bluetooth/hci_core.c","function":"hci_unregister_suspend_notifier"}},{"deprecated":false,"digest":{"line_hashes":["259369361378095300460975664182006653379","137631259276783842100393295402385487382","10585528368485041305317711435726910190","327063581649730136998985121167110509670","27971544739595913215230996468489284896","232343767286407853044179501487167703386","23293724515375960670781766943482972482","121693895629193521507982002513989133587","294975344646879374541757157789871745607"],"threshold":0.9},"id":"CVE-2022-48982-e547b15f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b5ca338751ad4783ec8d37b5d99c3e37b7813e59","target":{"file":"net/bluetooth/hci_core.c"}},{"deprecated":false,"digest":{"function_hash":"67757454436288988416326564877907287939","length":257},"id":"CVE-2022-48982-f9099a7c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b5ca338751ad4783ec8d37b5d99c3e37b7813e59","target":{"file":"net/bluetooth/hci_core.c","function":"hci_register_suspend_notifier"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.0.0"},{"fixed":"6.0.13"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48982.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b5ca338751ad4783ec8d37b5d99c3e37b7813e59"},{"type":"WEB","url":"https://git.kernel.org/stable/c/dc8fa6570deadb70c3fb74d7cd8ce38849feaed0"}]}