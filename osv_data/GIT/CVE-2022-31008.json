{"schema_version":"1.7.3","id":"CVE-2022-31008","published":"2022-10-06T00:00:00Z","modified":"2025-10-22T18:29:11.866523Z","aliases":["BIT-rabbitmq-2022-31008","GHSA-v9gv-xp36-jgj8"],"related":["SUSE-FU-2024:2078-1","SUSE-SU-2022:4378-1"],"summary":"Predictable credential obfuscation seed value used in rabbitmq-server","details":"RabbitMQ is a multi-protocol messaging and streaming broker. In affected versions the shovel and federation plugins perform URI obfuscation in their worker (link) state. The encryption key used to encrypt the URI was seeded with a predictable secret. This means that in case of certain exceptions related to Shovel and Federation plugins, reasonably easily deobfuscatable data could appear in the node log. Patched versions correctly use a cluster-wide secret for that purpose. This issue has been addressed and Patched versions: `3.10.2`, `3.9.18`, `3.8.32` are available. Users unable to upgrade should disable the Shovel and Federation plugins.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/rabbitmq/rabbitmq-server","events":[{"introduced":"0"},{"fixed":"32d866916accab5bc8638ea592ff9eb1dba04d69"}]},{"type":"GIT","repo":"https://github.com/rabbitmq/rabbitmq-server","events":[{"introduced":"e09fb7d8a8e3700d023945a4a4345340e9fe32f1"},{"fixed":"8cefec0f6e8afc597839f17e2681f3b726d64691"}]},{"type":"GIT","repo":"https://github.com/rabbitmq/rabbitmq-server","events":[{"introduced":"d17924a1b809f4b93e93ca47bee8875eb745201a"},{"fixed":"c6c3789330ddcb40c463599bed8d6c053e4b254f"}]}],"versions":["6547461e6c2e","Aman-06-09-08","Aman-06-09-08_2","base-for-tanzu-rabbitmq-2020.12-additions","rabbitmq_v1_4_0","rabbitmq_v1_5_0","rabbitmq_v1_5_1","rabbitmq_v1_5_2","rabbitmq_v1_5_3","rabbitmq_v1_5_4","rabbitmq_v1_5_5","rabbitmq_v1_6_0","rabbitmq_v1_7_0","rabbitmq_v1_7_1","rabbitmq_v1_7_2","rabbitmq_v1_8_0","rabbitmq_v1_8_1","rabbitmq_v2.6.0","rabbitmq_v2_0_0","rabbitmq_v2_1_0","rabbitmq_v2_1_1","rabbitmq_v2_2_0","rabbitmq_v2_3_0","rabbitmq_v2_3_1","rabbitmq_v2_4_0","rabbitmq_v2_4_1","rabbitmq_v2_5_0","rabbitmq_v2_5_1","rabbitmq_v2_6_0","rabbitmq_v2_6_1","rabbitmq_v2_7_0","rabbitmq_v2_7_1","rabbitmq_v2_8_0","rabbitmq_v2_8_1","rabbitmq_v2_8_2","rabbitmq_v3_0_0","rabbitmq_v3_0_1","rabbitmq_v3_0_2","rabbitmq_v3_0_3","rabbitmq_v3_0_4","rabbitmq_v3_1_0","rabbitmq_v3_1_1","rabbitmq_v3_1_2","rabbitmq_v3_1_3","rabbitmq_v3_1_4","rabbitmq_v3_1_5","rabbitmq_v3_2_0","rabbitmq_v3_2_1","rabbitmq_v3_2_2","rabbitmq_v3_2_3","rabbitmq_v3_2_4","rabbitmq_v3_3_0","rabbitmq_v3_3_1","rabbitmq_v3_3_2","rabbitmq_v3_3_3","rabbitmq_v3_3_4","rabbitmq_v3_3_5","rabbitmq_v3_4_0","rabbitmq_v3_4_1","rabbitmq_v3_4_2","rabbitmq_v3_4_3","rabbitmq_v3_4_4","rabbitmq_v3_5_0","rabbitmq_v3_5_1","rabbitmq_v3_5_2","rabbitmq_v3_5_3","rabbitmq_v3_5_4","rabbitmq_v3_5_4_rc1","rabbitmq_v3_5_4_rc2","rabbitmq_v3_5_5","rabbitmq_v3_5_5_rc1","rabbitmq_v3_5_5_rc2","rabbitmq_v3_5_6","rabbitmq_v3_5_7","rabbitmq_v3_5_7_rc1","rabbitmq_v3_5_7_rc2","rabbitmq_v3_6_0","rabbitmq_v3_6_0_milestone1","rabbitmq_v3_6_0_milestone2","rabbitmq_v3_6_0_milestone3","rabbitmq_v3_6_0_rc1","rabbitmq_v3_6_0_rc2","rabbitmq_v3_6_0_rc3","rabbitmq_v3_6_1","rabbitmq_v3_6_10","rabbitmq_v3_6_10_milestone1","rabbitmq_v3_6_10_milestone2","rabbitmq_v3_6_10_milestone3","rabbitmq_v3_6_10_milestone4","rabbitmq_v3_6_10_rc1","rabbitmq_v3_6_10_rc2","rabbitmq_v3_6_11","rabbitmq_v3_6_11_milestone1","rabbitmq_v3_6_11_milestone2","rabbitmq_v3_6_11_milestone3","rabbitmq_v3_6_11_milestone4","rabbitmq_v3_6_11_milestone5","rabbitmq_v3_6_11_rc1","rabbitmq_v3_6_11_rc2","rabbitmq_v3_6_11_rc3","rabbitmq_v3_6_12","rabbitmq_v3_6_12_rc1","rabbitmq_v3_6_12_rc2","rabbitmq_v3_6_12_rc3","rabbitmq_v3_6_13","rabbitmq_v3_6_13_milestone1","rabbitmq_v3_6_13_rc1","rabbitmq_v3_6_13_rc2","rabbitmq_v3_6_14","rabbitmq_v3_6_1_rc1","rabbitmq_v3_6_1_rc2","rabbitmq_v3_6_2","rabbitmq_v3_6_2_milestone1","rabbitmq_v3_6_2_milestone2","rabbitmq_v3_6_2_milestone3","rabbitmq_v3_6_2_milestone4","rabbitmq_v3_6_2_milestone5","rabbitmq_v3_6_2_rc1","rabbitmq_v3_6_2_rc2","rabbitmq_v3_6_2_rc3","rabbitmq_v3_6_2_rc4","rabbitmq_v3_6_3","rabbitmq_v3_6_3_milestone1","rabbitmq_v3_6_3_milestone2","rabbitmq_v3_6_3_rc1","rabbitmq_v3_6_3_rc2","rabbitmq_v3_6_3_rc3","rabbitmq_v3_6_4","rabbitmq_v3_6_4_milestone1","rabbitmq_v3_6_4_milestone2","rabbitmq_v3_6_4_rc1","rabbitmq_v3_6_5","rabbitmq_v3_6_5_milestone1","rabbitmq_v3_6_5_milestone2","rabbitmq_v3_6_6","rabbitmq_v3_6_6_milestone1","rabbitmq_v3_6_6_milestone2","rabbitmq_v3_6_6_milestone3","rabbitmq_v3_6_6_milestone4","rabbitmq_v3_6_6_milestone5","rabbitmq_v3_6_6_rc1","rabbitmq_v3_6_6_rc2","rabbitmq_v3_6_7","rabbitmq_v3_6_7_milestone1","rabbitmq_v3_6_7_milestone2","rabbitmq_v3_6_7_milestone3","rabbitmq_v3_6_7_milestone4","rabbitmq_v3_6_7_milestone5","rabbitmq_v3_6_7_milestone6","rabbitmq_v3_6_7_rc1","rabbitmq_v3_6_7_rc2","rabbitmq_v3_6_7_rc3","rabbitmq_v3_6_8","rabbitmq_v3_6_9","rabbitmq_v3_7_0_milestone1","rabbitmq_v3_7_0_milestone10","rabbitmq_v3_7_0_milestone11","rabbitmq_v3_7_0_milestone12","rabbitmq_v3_7_0_milestone13","rabbitmq_v3_7_0_milestone14","rabbitmq_v3_7_0_milestone15","rabbitmq_v3_7_0_milestone16","rabbitmq_v3_7_0_milestone17","rabbitmq_v3_7_0_milestone18","rabbitmq_v3_7_0_milestone2","rabbitmq_v3_7_0_milestone3","rabbitmq_v3_7_0_milestone4","rabbitmq_v3_7_0_milestone5","rabbitmq_v3_7_0_milestone6","rabbitmq_v3_7_0_milestone7","rabbitmq_v3_7_0_milestone8","rabbitmq_v3_7_0_milestone9","v3.10.0","v3.10.1","v3.7.0","v3.7.0-beta.19","v3.7.0-beta.20","v3.7.0-rc.1","v3.7.0-rc.2","v3.7.1","v3.7.1-beta.1","v3.7.2","v3.7.3","v3.7.3-rc.1","v3.7.3-rc.2","v3.7.4","v3.7.4-rc.1","v3.7.4-rc.2","v3.7.4-rc.3","v3.7.4-rc.4","v3.8.0","v3.8.0-beta.1","v3.8.0-beta.2","v3.8.0-beta.3","v3.8.0-beta.4","v3.8.0-beta.5","v3.8.0-beta.6","v3.8.0-beta.7","v3.8.0-rc.1","v3.8.0-rc.2","v3.8.0-rc.3","v3.8.1","v3.8.1-beta.1","v3.8.1-beta.2","v3.8.1-rc.1","v3.8.10-beta.1","v3.8.10-rc.1","v3.8.10-rc.5","v3.8.10-rc.6","v3.8.11","v3.8.12","v3.8.12-beta.1","v3.8.12-rc.1","v3.8.12-rc.2","v3.8.12-rc.3","v3.8.13","v3.8.13-beta.1","v3.8.14","v3.8.15","v3.8.15-rc.2","v3.8.15-rc.3","v3.8.16","v3.8.17","v3.8.17-rc.1","v3.8.17-rc.2","v3.8.18","v3.8.18-beta.1","v3.8.18-rc.1","v3.8.19","v3.8.19-rc.1","v3.8.2","v3.8.2-rc.1","v3.8.20","v3.8.21","v3.8.22","v3.8.23","v3.8.24","v3.8.25","v3.8.26","v3.8.27","v3.8.28","v3.8.29","v3.8.3","v3.8.3-beta.1","v3.8.3-beta.2","v3.8.3-beta.3","v3.8.3-rc.1","v3.8.3-rc.2","v3.8.30","v3.8.31","v3.8.4","v3.8.4-beta.1","v3.8.4-rc.1","v3.8.4-rc.2","v3.8.4-rc.3","v3.8.5","v3.8.5-rc.1","v3.8.5-rc.2","v3.8.6","v3.8.6-beta.1","v3.8.6-rc.1","v3.8.6-rc.2","v3.8.7","v3.8.8","v3.8.9","v3.9.0","v3.9.1","v3.9.10","v3.9.11","v3.9.12","v3.9.13","v3.9.14","v3.9.15","v3.9.16","v3.9.17","v3.9.2","v3.9.3","v3.9.4","v3.9.5","v3.9.6","v3.9.7","v3.9.8","v3.9.9"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-31008.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8"},{"type":"FIX","url":"https://github.com/rabbitmq/rabbitmq-server/pull/4841"}],"database_specific":{"cwe_ids":["CWE-330"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"}]}