{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-47724.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "238518174529881808706938940402311905137",
                "27127118023867451412584034396939415447",
                "280426739617210406598244912185790144040",
                "259885139206599831158204510500081065964"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-47724-394cb515",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/core.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "180759864338477321852553974849584074459",
                "19246043171420066408829336782439481346",
                "167209254248876520944994156093385262271",
                "320156480474593185600277059434804283201",
                "247502321353597245349867077925208008220",
                "295338996192000637336880259221090223117",
                "147575686731092861560034715781026262831",
                "56211142863561081194014132362929990788",
                "123922558679745784098646885248737812579",
                "35331925647306817749746376459035634295",
                "267438539952654494107466174428683643573"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-47724-3c708cc9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/mac.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "254384963623518230635706153047805842030",
                "244794986934739048063635326134171371482",
                "328079222305288272802569859270111257708",
                "311340441389726355705158886296223796007"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-47724-60410214",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/wmi.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "180759864338477321852553974849584074459",
                "19246043171420066408829336782439481346",
                "167209254248876520944994156093385262271",
                "320156480474593185600277059434804283201",
                "247502321353597245349867077925208008220",
                "295338996192000637336880259221090223117",
                "147575686731092861560034715781026262831",
                "56211142863561081194014132362929990788",
                "123922558679745784098646885248737812579",
                "35331925647306817749746376459035634295",
                "267438539952654494107466174428683643573"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-47724-622561db",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dbd51da69dda1137723b8f66460bf99a9dac8dd2",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/mac.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "254384963623518230635706153047805842030",
                "244794986934739048063635326134171371482",
                "328079222305288272802569859270111257708",
                "311340441389726355705158886296223796007"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-47724-6741654b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dbd51da69dda1137723b8f66460bf99a9dac8dd2",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/wmi.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "276494000819661131006425524796248953132",
              "length": 1889.0
            },
            "id": "CVE-2024-47724-6a00bcb1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dbd51da69dda1137723b8f66460bf99a9dac8dd2",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/mac.c",
              "function": "ath11k_mac_op_remove_interface"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "238519321956852121564988965560724840925",
              "length": 476.0
            },
            "id": "CVE-2024-47724-83dd526f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dbd51da69dda1137723b8f66460bf99a9dac8dd2",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/wmi.c",
              "function": "ath11k_bcn_tx_status_event"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "238518174529881808706938940402311905137",
                "27127118023867451412584034396939415447",
                "280426739617210406598244912185790144040",
                "259885139206599831158204510500081065964"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-47724-93da6885",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dbd51da69dda1137723b8f66460bf99a9dac8dd2",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/core.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "227379363803885392479879739651965715672",
              "length": 6993.0
            },
            "id": "CVE-2024-47724-95455378",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/mac.c",
              "function": "ath11k_mac_op_add_interface"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "276494000819661131006425524796248953132",
              "length": 1889.0
            },
            "id": "CVE-2024-47724-9f22ace3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/mac.c",
              "function": "ath11k_mac_op_remove_interface"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "227379363803885392479879739651965715672",
              "length": 6993.0
            },
            "id": "CVE-2024-47724-a2df4bc4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@dbd51da69dda1137723b8f66460bf99a9dac8dd2",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/mac.c",
              "function": "ath11k_mac_op_add_interface"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "238519321956852121564988965560724840925",
              "length": 476.0
            },
            "id": "CVE-2024-47724-b00de577",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3",
            "target": {
              "file": "drivers/net/wireless/ath/ath11k/wmi.c",
              "function": "ath11k_bcn_tx_status_event"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "3a415daa3e8ba65f1cc976c172a5ab69bdc17e69"
            },
            {
              "fixed": "dbd51da69dda1137723b8f66460bf99a9dac8dd2"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "3a415daa3e8ba65f1cc976c172a5ab69bdc17e69"
            },
            {
              "fixed": "6db232905e094e64abff1f18249905d068285e09"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "3a415daa3e8ba65f1cc976c172a5ab69bdc17e69"
            },
            {
              "fixed": "177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.10.1",
        "v6.10.10",
        "v6.10.11",
        "v6.10.12",
        "v6.10.2",
        "v6.10.3",
        "v6.10.4",
        "v6.10.5",
        "v6.10.6",
        "v6.10.7",
        "v6.10.8",
        "v6.10.9",
        "v6.11",
        "v6.11-rc1",
        "v6.11-rc2",
        "v6.11-rc3",
        "v6.11-rc4",
        "v6.11-rc5",
        "v6.11-rc6",
        "v6.11-rc7",
        "v6.11.1",
        "v6.8",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-47724.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.10.0"
            },
            {
              "fixed": "6.10.13"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.11.0"
            },
            {
              "fixed": "6.11.2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: ath11k: use work queue to process beacon tx event\n\nCommit 3a415daa3e8b (\"wifi: ath11k: add P2P IE in beacon template\")\nfrom Feb 28, 2024 (linux-next), leads to the following Smatch static\nchecker warning:\n\ndrivers/net/wireless/ath/ath11k/wmi.c:1742 ath11k_wmi_p2p_go_bcn_ie()\nwarn: sleeping in atomic context\n\nThe reason is that ath11k_bcn_tx_status_event() will directly call might\nsleep function ath11k_wmi_cmd_send() during RCU read-side critical\nsections. The call trace is like:\n\nath11k_bcn_tx_status_event()\n-> rcu_read_lock()\n-> ath11k_mac_bcn_tx_event()\n\t-> ath11k_mac_setup_bcn_tmpl()\n\t\u2026\u2026\n\t\t-> ath11k_wmi_bcn_tmpl()\n\t\t\t-> ath11k_wmi_cmd_send()\n-> rcu_read_unlock()\n\nCommit 886433a98425 (\"ath11k: add support for BSS color change\") added the\nath11k_mac_bcn_tx_event(), commit 01e782c89108 (\"ath11k: fix warning\nof RCU usage for ath11k_mac_get_arvif_by_vdev_id()\") added the RCU lock\nto avoid warning but also introduced this BUG.\n\nUse work queue to avoid directly calling ath11k_mac_bcn_tx_event()\nduring RCU critical sections. No need to worry about the deletion of vif\nbecause cancel_work_sync() will drop the work if it doesn't start or\nblock vif deletion until the running work is done.\n\nTested-on: WCN6855 hw2.0 PCI WLAN.HSP.1.1-03125-QCAHSPSWPL_V1_V2_SILICONZ_LITE-3.6510.30",
  "id": "CVE-2024-47724",
  "modified": "2025-10-15T15:48:23.010761Z",
  "published": "2024-10-21T12:13:58Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/177b49dbf9c1d8f9f25a22ffafa416fc2c8aa6a3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6db232905e094e64abff1f18249905d068285e09"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/dbd51da69dda1137723b8f66460bf99a9dac8dd2"
    }
  ],
  "related": [
    "USN-7276-1",
    "USN-7277-1",
    "openSUSE-SU-2024:14500-1",
    "openSUSE-SU-2025:14705-1"
  ],
  "schema_version": "1.7.3",
  "summary": "wifi: ath11k: use work queue to process beacon tx event"
}