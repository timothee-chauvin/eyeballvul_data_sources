{"schema_version":"1.7.3","id":"CVE-2024-52595","published":"2024-11-19T21:27:08.871Z","modified":"2025-11-20T12:31:06.395645Z","aliases":["GHSA-5jfw-gq64-q45f","PYSEC-2024-160"],"summary":"HTML Cleaner allows crafted scripts in special contexts like svg or math to pass through","details":"lxml_html_clean is a project for HTML cleaning functionalities copied from `lxml.html.clean`. Prior to version 0.4.0, the HTML Parser in lxml does not properly handle context-switching for special HTML tags such as `<svg>`, `<math>` and `<noscript>`. This behavior deviates from how web browsers parse and interpret such tags. Specifically, content in CSS comments is ignored by lxml_html_clean but may be interpreted differently by web browsers, enabling malicious scripts to bypass the cleaning process. This vulnerability could lead to Cross-Site Scripting (XSS) attacks, compromising the security of users relying on lxml_html_clean in default configuration for sanitizing untrusted HTML content. Users employing the HTML cleaner in a security-sensitive context should upgrade to lxml 0.4.0, which addresses this issue. As a temporary mitigation, users can configure lxml_html_clean with the following settings to prevent the exploitation of this vulnerability. Via `remove_tags`, one may specify tags to remove - their content is moved to their parents' tags. Via `kill_tags`, one may specify tags to be removed completely. Via `allow_tags`, one may restrict the set of permissible tags, excluding context-switching tags like `<svg>`, `<math>` and `<noscript>`.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/fedora-python/lxml_html_clean","events":[{"introduced":"0"},{"fixed":"a0744252196ea31dfa0edeb92e3bd45d048a7beb"}]}],"versions":["0.1.0","0.1.1","0.2.0","0.2.1","0.2.2","0.3.0","0.3.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-52595.json"}}],"references":[{"type":"FIX","url":"https://github.com/fedora-python/lxml_html_clean/commit/c5d816f86eb3707d72a8ecf5f3823e0daa1b3808"},{"type":"FIX","url":"https://github.com/fedora-python/lxml_html_clean/pull/19"},{"type":"ADVISORY","url":"https://github.com/fedora-python/lxml_html_clean/security/advisories/GHSA-5jfw-gq64-q45f"}],"database_specific":{"cwe_ids":["CWE-184","CWE-79","CWE-83"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:H"}]}