{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42139.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "159776856824442430909701466966319176761",
              "length": 678.0
            },
            "id": "CVE-2024-42139-0a8201b9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3",
            "target": {
              "file": "drivers/net/ethernet/intel/ice/ice_ptp.c",
              "function": "ice_ptp_release"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "206817301910527467672372825106909544224",
              "length": 1040.0
            },
            "id": "CVE-2024-42139-212aa61a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3",
            "target": {
              "file": "drivers/net/ethernet/intel/ice/ice_ptp.c",
              "function": "ice_ptp_cfg_extts"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "93662261141235397336793541586627527916",
                "143746606248389815907896440484821913099",
                "227205638245055755080474081083200637697",
                "331765790435096639906621654003211726655",
                "125037350613902008099214263679266805724",
                "202675071927409304278234347347067630748",
                "162359471615237439675228142674381924551",
                "292522741906834480604283567780864918982",
                "320023238950923180429309996405230835333",
                "1926865571354293243347591740344886599",
                "250070693914136485643586674291790117457",
                "34661039429516208594126916697617736743",
                "298645381293187936931050854469185261012",
                "323372937228815752146317877022765669068",
                "43137666186350621984230018053474004451",
                "256539913098069758219341404889863545557",
                "301049623962339050234834293688628179647",
                "243750951383807657108335182613796347900",
                "278994674637097479281547410517829269588",
                "51749243573621160528020585207829887919",
                "329361453726943806279796741349633834130",
                "2766113796463668355579789275158811054",
                "141915697087849571273884045161698995550",
                "32900732269176612968837448892920107209",
                "65225957214250767337246990325920004568",
                "42369571779461002010320756930691167953",
                "74784966166261542755427118876078612231",
                "172389419499238058232676957194247036364",
                "176742103634819358482032290877105064899",
                "179202311341841321343615184925092043877",
                "304778486135816990935988449798148747654",
                "15722905398280158828847109786980982245",
                "213759187411371929672742461264487716673",
                "184336956489225349976135987638222877493",
                "76451609680627241024673646058136950705",
                "295081220007313073311180742866923689323",
                "73359703398369551763160973118879195051",
                "9474613387069655037998878977570103066",
                "340280650307698969102340351939314046617",
                "275490084072311572479799345594882551477",
                "289687577064152327957827099522515998065",
                "273771489784504315768201953322414000128",
                "26875190460405147877555831401574632018",
                "121498726187828701926643140501074646945",
                "42369571779461002010320756930691167953",
                "191256005407857990171694727832399767645",
                "224030212022148195755914456856108221615",
                "42842195735786767541917059322694744108",
                "67958896919524438493355140941469875849",
                "185311754972268696992588603736576942205",
                "334880366330874582161440440309585271024",
                "321264524543858205615949273508886621615",
                "268020188292855957613767513910625111977",
                "139374645221115229097647101735694401917",
                "142746116490292071361141300531418498445",
                "319565016293186180146507777078450950336",
                "274326546212675142560745137591421156279",
                "106583478166238042080157540980288936762",
                "39861205547133291977959887296419005845",
                "121498726187828701926643140501074646945",
                "42257732145173852458789853855016874283",
                "68288378312211186198431741491413357872",
                "192335931861190741396192653239590988404",
                "257142674841678879308397302762479776652",
                "70686795178114644830496301269824676134",
                "73448738237323529185452962794498304209"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42139-54728a2c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3",
            "target": {
              "file": "drivers/net/ethernet/intel/ice/ice_ptp.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "240755913753774409319064325490724439432",
              "length": 1400.0
            },
            "id": "CVE-2024-42139-74ed9f42",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3",
            "target": {
              "file": "drivers/net/ethernet/intel/ice/ice_ptp.c",
              "function": "ice_ptp_gpio_enable_e810"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "219724341972421044816668430658770012447",
              "length": 533.0
            },
            "id": "CVE-2024-42139-99ee3207",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3",
            "target": {
              "file": "drivers/net/ethernet/intel/ice/ice_ptp.c",
              "function": "ice_ptp_gpio_enable_e823"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "218868239741000671787116067008597963798",
              "length": 756.0
            },
            "id": "CVE-2024-42139-ee384e35",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3",
            "target": {
              "file": "drivers/net/ethernet/intel/ice/ice_ptp.c",
              "function": "ice_ptp_rebuild_owner"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "56366966706651798516111543726121346727",
                "95978739530172997643671057366950604175",
                "75053876889747797050443416086046505208",
                "2052565695984570182518349299011896240",
                "127829641643957374404708139435676155365",
                "284386575818657466713026100026419184920",
                "27211682442330546631494153498771941636",
                "81055867814331641196995340667735615176",
                "252810509512268487315607663022346754238",
                "205530567354162475639484307454914383640"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42139-f308cd7e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3",
            "target": {
              "file": "drivers/net/ethernet/intel/ice/ice_ptp.h"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "172db5f91d5f7b91670c68a7547798b0b5374158"
            },
            {
              "fixed": "9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "172db5f91d5f7b91670c68a7547798b0b5374158"
            },
            {
              "fixed": "00d3b4f54582d4e4a02cda5886bb336eeab268cc"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.13",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7",
        "v6.9.1",
        "v6.9.2",
        "v6.9.3",
        "v6.9.4",
        "v6.9.5",
        "v6.9.6",
        "v6.9.7",
        "v6.9.8"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42139.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.14.0"
            },
            {
              "fixed": "6.9.9"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nice: Fix improper extts handling\n\nExtts events are disabled and enabled by the application ts2phc.\nHowever, in case where the driver is removed when the application is\nrunning, a specific extts event remains enabled and can cause a kernel\ncrash.\nAs a side effect, when the driver is reloaded and application is started\nagain, remaining extts event for the channel from a previous run will\nkeep firing and the message \"extts on unexpected channel\" might be\nprinted to the user.\n\nTo avoid that, extts events shall be disabled when PTP is released.",
  "id": "CVE-2024-42139",
  "modified": "2025-10-15T13:18:07.143629Z",
  "published": "2024-07-30T07:46:33Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/00d3b4f54582d4e4a02cda5886bb336eeab268cc"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9f69b31ae9e25dec27ad31fbc64dd99af16ee3d3"
    }
  ],
  "related": [
    "SUSE-SU-2024:3190-1",
    "SUSE-SU-2024:3194-1",
    "SUSE-SU-2024:3195-1",
    "SUSE-SU-2024:3209-1",
    "SUSE-SU-2024:3383-1",
    "SUSE-SU-2024:3483-1"
  ],
  "schema_version": "1.7.3",
  "summary": "ice: Fix improper extts handling"
}