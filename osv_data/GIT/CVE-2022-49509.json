{"schema_version":"1.7.3","id":"CVE-2022-49509","published":"2025-02-26T02:13:40Z","modified":"2025-10-21T10:30:15.535877Z","related":["SUSE-SU-2025:1027-1","SUSE-SU-2025:1176-1","SUSE-SU-2025:1183-1","SUSE-SU-2025:1241-1"],"summary":"media: i2c: max9286: fix kernel oops when removing module","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: i2c: max9286: fix kernel oops when removing module\n\nWhen removing the max9286 module we get a kernel oops:\n\nUnable to handle kernel paging request at virtual address 000000aa00000094\nMem abort info:\n  ESR = 0x96000004\n  EC = 0x25: DABT (current EL), IL = 32 bits\n  SET = 0, FnV = 0\n  EA = 0, S1PTW = 0\n  FSC = 0x04: level 0 translation fault\nData abort info:\n  ISV = 0, ISS = 0x00000004\n  CM = 0, WnR = 0\nuser pgtable: 4k pages, 48-bit VAs, pgdp=0000000880d85000\n[000000aa00000094] pgd=0000000000000000, p4d=0000000000000000\nInternal error: Oops: 96000004 [#1] PREEMPT SMP\nModules linked in: fsl_jr_uio caam_jr rng_core libdes caamkeyblob_desc caamhash_desc caamalg_desc crypto_engine max9271 authenc crct10dif_ce mxc_jpeg_encdec\nCPU: 2 PID: 713 Comm: rmmod Tainted: G         C        5.15.5-00057-gaebcd29c8ed7-dirty #5\nHardware name: Freescale i.MX8QXP MEK (DT)\npstate: 80000005 (Nzcv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\npc : i2c_mux_del_adapters+0x24/0xf0\nlr : max9286_remove+0x28/0xd0 [max9286]\nsp : ffff800013a9bbf0\nx29: ffff800013a9bbf0 x28: ffff00080b6da940 x27: 0000000000000000\nx26: 0000000000000000 x25: 0000000000000000 x24: 0000000000000000\nx23: ffff000801a5b970 x22: ffff0008048b0890 x21: ffff800009297000\nx20: ffff0008048b0f70 x19: 000000aa00000064 x18: 0000000000000000\nx17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000\nx14: 0000000000000014 x13: 0000000000000000 x12: ffff000802da49e8\nx11: ffff000802051918 x10: ffff000802da4920 x9 : ffff000800030098\nx8 : 0101010101010101 x7 : 7f7f7f7f7f7f7f7f x6 : fefefeff6364626d\nx5 : 8080808000000000 x4 : 0000000000000000 x3 : 0000000000000000\nx2 : ffffffffffffffff x1 : ffff00080b6da940 x0 : 0000000000000000\nCall trace:\n i2c_mux_del_adapters+0x24/0xf0\n max9286_remove+0x28/0xd0 [max9286]\n i2c_device_remove+0x40/0x110\n __device_release_driver+0x188/0x234\n driver_detach+0xc4/0x150\n bus_remove_driver+0x60/0xe0\n driver_unregister+0x34/0x64\n i2c_del_driver+0x58/0xa0\n max9286_i2c_driver_exit+0x1c/0x490 [max9286]\n __arm64_sys_delete_module+0x194/0x260\n invoke_syscall+0x48/0x114\n el0_svc_common.constprop.0+0xd4/0xfc\n do_el0_svc+0x2c/0x94\n el0_svc+0x28/0x80\n el0t_64_sync_handler+0xa8/0x130\n el0t_64_sync+0x1a0/0x1a4\n\nThe Oops happens because the I2C client data does not point to\nmax9286_priv anymore but to v4l2_subdev. The change happened in\nmax9286_init() which calls v4l2_i2c_subdev_init() later on...\n\nBesides fixing the max9286_remove() function, remove the call to\ni2c_set_clientdata() in max9286_probe(), to avoid confusion, and make\nthe necessary changes to max9286_init() so that it doesn't have to use\ni2c_get_clientdata() in order to fetch the pointer to priv.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"66d8c9d2422da21ed41f75c03ba0685987b65fe0"},{"fixed":"a4ec75df70575cdf33d9638c7844e729bfe6ce24"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"66d8c9d2422da21ed41f75c03ba0685987b65fe0"},{"fixed":"579c77595dbbdfe4f2edf335899f86ac51eca4e9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"66d8c9d2422da21ed41f75c03ba0685987b65fe0"},{"fixed":"9dd783274c89c21a038d967b52a858a297e767f8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"66d8c9d2422da21ed41f75c03ba0685987b65fe0"},{"fixed":"365ab7ebc24eebb42b9e020aeb440d51af8960cd"}]}],"versions":["v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.34","v5.15.35","v5.15.36","v5.15.37","v5.15.38","v5.15.39","v5.15.4","v5.15.40","v5.15.41","v5.15.42","v5.15.43","v5.15.44","v5.15.45","v5.15.5","v5.15.6","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.10","v5.17.11","v5.17.12","v5.17.13","v5.17.2","v5.17.3","v5.17.4","v5.17.5","v5.17.6","v5.17.7","v5.17.8","v5.17.9","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.18.1","v5.18.2","v5.8","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49509.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"278699208600562508163590063929696331662","length":889},"id":"CVE-2022-49509-268ce56c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4ec75df70575cdf33d9638c7844e729bfe6ce24","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_probe"}},{"deprecated":false,"digest":{"function_hash":"278699208600562508163590063929696331662","length":889},"id":"CVE-2022-49509-394bed09","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@365ab7ebc24eebb42b9e020aeb440d51af8960cd","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_probe"}},{"deprecated":false,"digest":{"function_hash":"239261637449979057638924187868778116774","length":217},"id":"CVE-2022-49509-45aed6d3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4ec75df70575cdf33d9638c7844e729bfe6ce24","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_remove"}},{"deprecated":false,"digest":{"line_hashes":["207429077306992647741085639544412987206","62688511827392644279195096918079008839","248130066576337904272225120940292630118","45511096672706617175982735626440720241","7756490630254004970259248853946620304","38920379590402277865519446454288983499","187874392626742982724097224053222782521","207227251140843976903474176813013717251","330561024792608540707303711983883148236","53047426232968772999870404543443039747","58454175349888489433625305962982134011","287050954701183671859333441793415736354","317809382187512591697075339263445851256","6374957932868318297087941294814407220","140571618936949612474900551687739010775","240350209379853661466580866812757239719","135386420888139524683588415294977768569","89181870468972982513202427158213180970","105290108799326292728478982091195411989","147845331230087740674633000697120553317","147759321383284272903245794840821120279","247683238021791225288387541360002029220","136120106534843520576522660094039170872","80109970636826085795181011825850389733","175765988874113187769199963314154941904","147429028194187358698450356279539398788","245461741697600542383722739853243542581","82436466647137432103680873844259740930","155890527196842087927753650757281881050","25917662012958021004729362656057675913","117204285521367295055556317875609749307","40182219857132126125121705626839094000","233760323014622112311606992064383591922","48018893509071969690933186191926439245","306718329943114068047100763751234677671","336123360081825596865569383623587370140","204116634515009609612600933477446763755"],"threshold":0.9},"id":"CVE-2022-49509-4797c021","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@579c77595dbbdfe4f2edf335899f86ac51eca4e9","target":{"file":"drivers/media/i2c/max9286.c"}},{"deprecated":false,"digest":{"function_hash":"278699208600562508163590063929696331662","length":889},"id":"CVE-2022-49509-52483e76","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9dd783274c89c21a038d967b52a858a297e767f8","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_probe"}},{"deprecated":false,"digest":{"function_hash":"38866096004479036852731253222269628695","length":680},"id":"CVE-2022-49509-6fb01bee","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@365ab7ebc24eebb42b9e020aeb440d51af8960cd","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_init"}},{"deprecated":false,"digest":{"function_hash":"239261637449979057638924187868778116774","length":217},"id":"CVE-2022-49509-75fdcc0a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@579c77595dbbdfe4f2edf335899f86ac51eca4e9","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_remove"}},{"deprecated":false,"digest":{"function_hash":"38866096004479036852731253222269628695","length":680},"id":"CVE-2022-49509-839f126b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@579c77595dbbdfe4f2edf335899f86ac51eca4e9","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_init"}},{"deprecated":false,"digest":{"line_hashes":["207429077306992647741085639544412987206","62688511827392644279195096918079008839","248130066576337904272225120940292630118","45511096672706617175982735626440720241","7756490630254004970259248853946620304","38920379590402277865519446454288983499","187874392626742982724097224053222782521","207227251140843976903474176813013717251","330561024792608540707303711983883148236","53047426232968772999870404543443039747","58454175349888489433625305962982134011","287050954701183671859333441793415736354","317809382187512591697075339263445851256","6374957932868318297087941294814407220","140571618936949612474900551687739010775","240350209379853661466580866812757239719","135386420888139524683588415294977768569","89181870468972982513202427158213180970","105290108799326292728478982091195411989","147845331230087740674633000697120553317","147759321383284272903245794840821120279","247683238021791225288387541360002029220","136120106534843520576522660094039170872","80109970636826085795181011825850389733","175765988874113187769199963314154941904","147429028194187358698450356279539398788","245461741697600542383722739853243542581","82436466647137432103680873844259740930","155890527196842087927753650757281881050","25917662012958021004729362656057675913","117204285521367295055556317875609749307","40182219857132126125121705626839094000","233760323014622112311606992064383591922","48018893509071969690933186191926439245","306718329943114068047100763751234677671","336123360081825596865569383623587370140","204116634515009609612600933477446763755"],"threshold":0.9},"id":"CVE-2022-49509-9fd4b3fa","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9dd783274c89c21a038d967b52a858a297e767f8","target":{"file":"drivers/media/i2c/max9286.c"}},{"deprecated":false,"digest":{"function_hash":"38866096004479036852731253222269628695","length":680},"id":"CVE-2022-49509-a2923c04","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9dd783274c89c21a038d967b52a858a297e767f8","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_init"}},{"deprecated":false,"digest":{"function_hash":"239261637449979057638924187868778116774","length":217},"id":"CVE-2022-49509-a2bf6a05","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@365ab7ebc24eebb42b9e020aeb440d51af8960cd","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_remove"}},{"deprecated":false,"digest":{"function_hash":"38866096004479036852731253222269628695","length":680},"id":"CVE-2022-49509-b49af82b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4ec75df70575cdf33d9638c7844e729bfe6ce24","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_init"}},{"deprecated":false,"digest":{"function_hash":"278699208600562508163590063929696331662","length":889},"id":"CVE-2022-49509-c70116da","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@579c77595dbbdfe4f2edf335899f86ac51eca4e9","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_probe"}},{"deprecated":false,"digest":{"line_hashes":["207429077306992647741085639544412987206","62688511827392644279195096918079008839","248130066576337904272225120940292630118","45511096672706617175982735626440720241","7756490630254004970259248853946620304","38920379590402277865519446454288983499","187874392626742982724097224053222782521","207227251140843976903474176813013717251","330561024792608540707303711983883148236","53047426232968772999870404543443039747","58454175349888489433625305962982134011","287050954701183671859333441793415736354","317809382187512591697075339263445851256","6374957932868318297087941294814407220","140571618936949612474900551687739010775","240350209379853661466580866812757239719","135386420888139524683588415294977768569","89181870468972982513202427158213180970","105290108799326292728478982091195411989","147845331230087740674633000697120553317","147759321383284272903245794840821120279","247683238021791225288387541360002029220","136120106534843520576522660094039170872","80109970636826085795181011825850389733","175765988874113187769199963314154941904","147429028194187358698450356279539398788","245461741697600542383722739853243542581","82436466647137432103680873844259740930","155890527196842087927753650757281881050","25917662012958021004729362656057675913","117204285521367295055556317875609749307","40182219857132126125121705626839094000","233760323014622112311606992064383591922","48018893509071969690933186191926439245","306718329943114068047100763751234677671","336123360081825596865569383623587370140","204116634515009609612600933477446763755"],"threshold":0.9},"id":"CVE-2022-49509-eb2a5045","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@365ab7ebc24eebb42b9e020aeb440d51af8960cd","target":{"file":"drivers/media/i2c/max9286.c"}},{"deprecated":false,"digest":{"line_hashes":["207429077306992647741085639544412987206","62688511827392644279195096918079008839","248130066576337904272225120940292630118","45511096672706617175982735626440720241","7756490630254004970259248853946620304","38920379590402277865519446454288983499","187874392626742982724097224053222782521","207227251140843976903474176813013717251","330561024792608540707303711983883148236","53047426232968772999870404543443039747","58454175349888489433625305962982134011","287050954701183671859333441793415736354","317809382187512591697075339263445851256","6374957932868318297087941294814407220","140571618936949612474900551687739010775","240350209379853661466580866812757239719","135386420888139524683588415294977768569","89181870468972982513202427158213180970","105290108799326292728478982091195411989","147845331230087740674633000697120553317","147759321383284272903245794840821120279","247683238021791225288387541360002029220","136120106534843520576522660094039170872","80109970636826085795181011825850389733","175765988874113187769199963314154941904","147429028194187358698450356279539398788","245461741697600542383722739853243542581","82436466647137432103680873844259740930","155890527196842087927753650757281881050","25917662012958021004729362656057675913","117204285521367295055556317875609749307","40182219857132126125121705626839094000","233760323014622112311606992064383591922","48018893509071969690933186191926439245","306718329943114068047100763751234677671","336123360081825596865569383623587370140","204116634515009609612600933477446763755"],"threshold":0.9},"id":"CVE-2022-49509-f0b39adc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4ec75df70575cdf33d9638c7844e729bfe6ce24","target":{"file":"drivers/media/i2c/max9286.c"}},{"deprecated":false,"digest":{"function_hash":"239261637449979057638924187868778116774","length":217},"id":"CVE-2022-49509-f734faa9","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9dd783274c89c21a038d967b52a858a297e767f8","target":{"file":"drivers/media/i2c/max9286.c","function":"max9286_remove"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.9.0"},{"fixed":"5.15.46"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.17.14"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.18.0"},{"fixed":"5.18.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49509.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/365ab7ebc24eebb42b9e020aeb440d51af8960cd"},{"type":"WEB","url":"https://git.kernel.org/stable/c/579c77595dbbdfe4f2edf335899f86ac51eca4e9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9dd783274c89c21a038d967b52a858a297e767f8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a4ec75df70575cdf33d9638c7844e729bfe6ce24"}]}