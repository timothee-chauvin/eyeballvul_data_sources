{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34241.json"
      },
      "package": {
        "ecosystem": "Alpine:v3.15",
        "name": "cups",
        "purl": "pkg:apk/alpine/cups?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.3.3-r8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "1.4.1-r0",
        "1.4.2-r0",
        "1.4.2-r1",
        "1.4.2-r2",
        "1.4.3-r0",
        "1.4.3-r1",
        "1.4.3-r2",
        "1.4.3-r3",
        "1.4.4-r0",
        "1.4.4-r1",
        "1.4.5-r0",
        "1.4.6-r0",
        "1.4.7-r0",
        "1.4.8-r0",
        "1.5.0-r0",
        "1.5.0-r1",
        "1.5.0-r2",
        "1.5.2-r0",
        "1.5.2-r1",
        "1.5.2-r2",
        "1.5.2-r3",
        "1.5.3-r0",
        "1.5.4-r0",
        "1.5.4-r1",
        "1.6.1-r0",
        "1.6.1-r1",
        "1.6.2-r0",
        "1.6.2-r1",
        "1.6.3-r0",
        "1.6.4-r0",
        "1.7.0-r0",
        "1.7.0-r1",
        "1.7.1-r0",
        "1.7.2-r0",
        "1.7.3-r0",
        "1.7.3-r1",
        "1.7.4-r0",
        "1.7.5-r0",
        "2.0.0-r0",
        "2.0.1-r0",
        "2.0.2-r0",
        "2.0.2-r1",
        "2.0.2-r2",
        "2.0.3-r0",
        "2.0.4-r0",
        "2.1.0-r0",
        "2.1.1-r0",
        "2.1.2-r0",
        "2.1.3-r0",
        "2.1.3-r1",
        "2.1.4-r0",
        "2.2.1-r0",
        "2.2.1-r1",
        "2.2.10-r0",
        "2.2.11-r0",
        "2.2.12-r0",
        "2.2.12-r1",
        "2.2.12-r2",
        "2.2.2-r0",
        "2.2.2-r1",
        "2.2.2-r2",
        "2.2.3-r0",
        "2.2.3-r1",
        "2.2.4-r0",
        "2.2.5-r0",
        "2.2.5-r1",
        "2.2.6-r0",
        "2.2.9-r0",
        "2.3.3-r0",
        "2.3.3-r1",
        "2.3.3-r2",
        "2.3.3-r3",
        "2.3.3-r4",
        "2.3.3-r5",
        "2.3.3-r6",
        "2.3.3-r7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34241.json"
      },
      "package": {
        "ecosystem": "Alpine:v3.16",
        "name": "cups",
        "purl": "pkg:apk/alpine/cups?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.4.2-r2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "1.4.1-r0",
        "1.4.2-r0",
        "1.4.2-r1",
        "1.4.2-r2",
        "1.4.3-r0",
        "1.4.3-r1",
        "1.4.3-r2",
        "1.4.3-r3",
        "1.4.4-r0",
        "1.4.4-r1",
        "1.4.5-r0",
        "1.4.6-r0",
        "1.4.7-r0",
        "1.4.8-r0",
        "1.5.0-r0",
        "1.5.0-r1",
        "1.5.0-r2",
        "1.5.2-r0",
        "1.5.2-r1",
        "1.5.2-r2",
        "1.5.2-r3",
        "1.5.3-r0",
        "1.5.4-r0",
        "1.5.4-r1",
        "1.6.1-r0",
        "1.6.1-r1",
        "1.6.2-r0",
        "1.6.2-r1",
        "1.6.3-r0",
        "1.6.4-r0",
        "1.7.0-r0",
        "1.7.0-r1",
        "1.7.1-r0",
        "1.7.2-r0",
        "1.7.3-r0",
        "1.7.3-r1",
        "1.7.4-r0",
        "1.7.5-r0",
        "2.0.0-r0",
        "2.0.1-r0",
        "2.0.2-r0",
        "2.0.2-r1",
        "2.0.2-r2",
        "2.0.3-r0",
        "2.0.4-r0",
        "2.1.0-r0",
        "2.1.1-r0",
        "2.1.2-r0",
        "2.1.3-r0",
        "2.1.3-r1",
        "2.1.4-r0",
        "2.2.1-r0",
        "2.2.1-r1",
        "2.2.10-r0",
        "2.2.11-r0",
        "2.2.12-r0",
        "2.2.12-r1",
        "2.2.12-r2",
        "2.2.2-r0",
        "2.2.2-r1",
        "2.2.2-r2",
        "2.2.3-r0",
        "2.2.3-r1",
        "2.2.4-r0",
        "2.2.5-r0",
        "2.2.5-r1",
        "2.2.6-r0",
        "2.2.9-r0",
        "2.3.3-r0",
        "2.3.3-r1",
        "2.3.3-r2",
        "2.3.3-r3",
        "2.3.3-r4",
        "2.4.0-r0",
        "2.4.1-r0",
        "2.4.1-r1",
        "2.4.2-r0",
        "2.4.2-r1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34241.json"
      },
      "package": {
        "ecosystem": "Alpine:v3.17",
        "name": "cups",
        "purl": "pkg:apk/alpine/cups?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.4.2-r3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "1.4.1-r0",
        "1.4.2-r0",
        "1.4.2-r1",
        "1.4.2-r2",
        "1.4.3-r0",
        "1.4.3-r1",
        "1.4.3-r2",
        "1.4.3-r3",
        "1.4.4-r0",
        "1.4.4-r1",
        "1.4.5-r0",
        "1.4.6-r0",
        "1.4.7-r0",
        "1.4.8-r0",
        "1.5.0-r0",
        "1.5.0-r1",
        "1.5.0-r2",
        "1.5.2-r0",
        "1.5.2-r1",
        "1.5.2-r2",
        "1.5.2-r3",
        "1.5.3-r0",
        "1.5.4-r0",
        "1.5.4-r1",
        "1.6.1-r0",
        "1.6.1-r1",
        "1.6.2-r0",
        "1.6.2-r1",
        "1.6.3-r0",
        "1.6.4-r0",
        "1.7.0-r0",
        "1.7.0-r1",
        "1.7.1-r0",
        "1.7.2-r0",
        "1.7.3-r0",
        "1.7.3-r1",
        "1.7.4-r0",
        "1.7.5-r0",
        "2.0.0-r0",
        "2.0.1-r0",
        "2.0.2-r0",
        "2.0.2-r1",
        "2.0.2-r2",
        "2.0.3-r0",
        "2.0.4-r0",
        "2.1.0-r0",
        "2.1.1-r0",
        "2.1.2-r0",
        "2.1.3-r0",
        "2.1.3-r1",
        "2.1.4-r0",
        "2.2.1-r0",
        "2.2.1-r1",
        "2.2.10-r0",
        "2.2.11-r0",
        "2.2.12-r0",
        "2.2.12-r1",
        "2.2.12-r2",
        "2.2.2-r0",
        "2.2.2-r1",
        "2.2.2-r2",
        "2.2.3-r0",
        "2.2.3-r1",
        "2.2.4-r0",
        "2.2.5-r0",
        "2.2.5-r1",
        "2.2.6-r0",
        "2.2.9-r0",
        "2.3.3-r0",
        "2.3.3-r1",
        "2.3.3-r2",
        "2.3.3-r3",
        "2.3.3-r4",
        "2.4.0-r0",
        "2.4.1-r0",
        "2.4.1-r1",
        "2.4.2-r0",
        "2.4.2-r1",
        "2.4.2-r2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34241.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:11",
        "name": "cups",
        "purl": "pkg:deb/debian/cups?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.3.3op2-3+deb11u3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "2.3.3op2-3+deb11u1",
        "2.3.3op2-3+deb11u2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34241.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "cups",
        "purl": "pkg:deb/debian/cups?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.4.2-3+deb12u1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "2.4.2-3"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34241.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "cups",
        "purl": "pkg:deb/debian/cups?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.4.2-5"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34241.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "9809947a959e18409dcf562a3466ef246cb90cb2"
            },
            {
              "fixed": "9d614a4b3184205294c55355a1d2eb54d4532ccd"
            }
          ],
          "repo": "https://github.com/openprinting/cups",
          "type": "GIT"
        }
      ],
      "versions": [
        "v2.2.0",
        "v2.2.1",
        "v2.2.2",
        "v2.2.3",
        "v2.2.4",
        "v2.2.5",
        "v2.2.6",
        "v2.2b1",
        "v2.2b2",
        "v2.2rc1",
        "v2.3.0",
        "v2.3.1",
        "v2.3.3",
        "v2.3.3op1",
        "v2.3.3op2",
        "v2.3b1",
        "v2.3b2",
        "v2.3b3",
        "v2.3b4",
        "v2.3b5",
        "v2.3b6",
        "v2.3b7",
        "v2.3b8",
        "v2.3rc1",
        "v2.4.0",
        "v2.4.1",
        "v2.4.2",
        "v2.4.3",
        "v2.4.4",
        "v2.4.5",
        "v2.4b1",
        "v2.4rc1"
      ]
    }
  ],
  "details": "OpenPrinting CUPS is a standards-based, open source printing system for Linux and other Unix-like operating systems. Starting in version 2.0.0 and prior to version 2.4.6, CUPS logs data of free memory to the logging service AFTER the connection has been closed, when it should have logged the data right before. This is a use-after-free bug that impacts the entire cupsd process.\n\nThe exact cause of this issue is the function `httpClose(con->http)` being called in `scheduler/client.c`. The problem is that httpClose always, provided its argument is not null, frees the pointer at the end of the call, only for cupsdLogClient to pass the pointer to httpGetHostname. This issue happens in function `cupsdAcceptClient` if LogLevel is warn or higher and in two scenarios: there is a double-lookup for the IP Address (HostNameLookups Double is set in `cupsd.conf`) which fails to resolve, or if CUPS is compiled with TCP wrappers and the connection is refused by rules from `/etc/hosts.allow` and `/etc/hosts.deny`.\n\nVersion 2.4.6 has a patch for this issue.",
  "id": "CVE-2023-34241",
  "modified": "2025-07-29T10:55:45.448024Z",
  "published": "2023-06-22T23:15:09Z",
  "references": [
    {
      "type": "ARTICLE",
      "url": "http://www.openwall.com/lists/oss-security/2023/06/23/10"
    },
    {
      "type": "ARTICLE",
      "url": "http://www.openwall.com/lists/oss-security/2023/06/26/1"
    },
    {
      "type": "FIX",
      "url": "https://github.com/OpenPrinting/cups/security/advisories/GHSA-qjgh-5hcq-5f25"
    },
    {
      "type": "ARTICLE",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TBIYKDS3UG3W4Z7YOHTR2AWFNBRYPNYY/"
    },
    {
      "type": "ADVISORY",
      "url": "https://support.apple.com/kb/HT213843"
    },
    {
      "type": "ADVISORY",
      "url": "https://support.apple.com/kb/HT213844"
    },
    {
      "type": "ADVISORY",
      "url": "https://support.apple.com/kb/HT213845"
    },
    {
      "type": "ARTICLE",
      "url": "https://lists.debian.org/debian-lts-announce/2023/06/msg00038.html"
    },
    {
      "type": "ARTICLE",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7I7DWGYGEMBNLZF5UQBMF3SONR37YUBN/"
    },
    {
      "type": "FIX",
      "url": "https://github.com/OpenPrinting/cups/commit/9809947a959e18409dcf562a3466ef246cb90cb2"
    },
    {
      "type": "WEB",
      "url": "https://github.com/OpenPrinting/cups/releases/tag/v2.4.6"
    },
    {
      "type": "ADVISORY",
      "url": "https://security.alpinelinux.org/vuln/CVE-2023-34241"
    },
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2023-34241"
    }
  ],
  "related": [
    "ALSA-2023:6596",
    "ALSA-2023:7165",
    "GHSA-qjgh-5hcq-5f25",
    "MGASA-2023-0223",
    "SUSE-SU-2023:2616-1",
    "SUSE-SU-2023:3706-1",
    "openSUSE-SU-2024:13017-1"
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
      "type": "CVSS_V3"
    }
  ]
}