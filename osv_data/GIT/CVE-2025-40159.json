{"schema_version":"1.7.3","id":"CVE-2025-40159","published":"2025-11-12T10:24:36Z","modified":"2025-11-12T20:30:50.597661Z","summary":"xsk: Harden userspace-supplied xdp_desc validation","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nxsk: Harden userspace-supplied xdp_desc validation\n\nTurned out certain clearly invalid values passed in xdp_desc from\nuserspace can pass xp_{,un}aligned_validate_desc() and then lead\nto UBs or just invalid frames to be queued for xmit.\n\ndesc->len close to ``U32_MAX`` with a non-zero pool->tx_metadata_len\ncan cause positive integer overflow and wraparound, the same way low\nenough desc->addr with a non-zero pool->tx_metadata_len can cause\nnegative integer overflow. Both scenarios can then pass the\nvalidation successfully.\nThis doesn't happen with valid XSk applications, but can be used\nto perform attacks.\n\nAlways promote desc->len to ``u64`` first to exclude positive\noverflows of it. Use explicit check_{add,sub}_overflow() when\nvalidating desc->addr (which is ``u64`` already).\n\nbloat-o-meter reports a little growth of the code size:\n\nadd/remove: 0/0 grow/shrink: 2/1 up/down: 60/-16 (44)\nFunction                                     old     new   delta\nxskq_cons_peek_desc                          299     330     +31\nxsk_tx_peek_release_desc_batch               973    1002     +29\nxsk_generic_xmit                            3148    3132     -16\n\nbut hopefully this doesn't hurt the performance much.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"341ac980eab90ac1f6c22ee9f9da83ed9604d899"},{"fixed":"1463cd066f32efd56ddfd3ac4e3524200f362980"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"341ac980eab90ac1f6c22ee9f9da83ed9604d899"},{"fixed":"5b5fffa7c81e55d8c8edf05ad40d811ec7047e21"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"341ac980eab90ac1f6c22ee9f9da83ed9604d899"},{"fixed":"07ca98f906a403637fc5e513a872a50ef1247f3b"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.35","v6.12.36","v6.12.37","v6.12.38","v6.12.39","v6.12.4","v6.12.40","v6.12.41","v6.12.42","v6.12.43","v6.12.44","v6.12.45","v6.12.46","v6.12.47","v6.12.48","v6.12.49","v6.12.5","v6.12.50","v6.12.51","v6.12.52","v6.12.53","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.17.3","v6.7","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40159.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"97236080460057930699291011306576033932","length":427},"id":"CVE-2025-40159-1100e49e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1463cd066f32efd56ddfd3ac4e3524200f362980","target":{"file":"net/xdp/xsk_queue.h","function":"xp_aligned_validate_desc"}},{"deprecated":false,"digest":{"line_hashes":["254306573526797895676208670000925266931","25879280811682874877960801082007612174","210278829039375660968456112042885934267","291016300341066805917862199124728406681","200731482689005314184370494946622451800","310903534969646374098302861784594953467","282880551103845935135076455211311052918","187173022615184567766821213613583352744","44690245594713743366636772205672902694","192197079142209249918800943086354830737","121147827953351230810439143285565477963","135800287938242292437150335313299019809","328707269021123121659820485111880541633","76708238981472904961312368293455448695","143572916212089729105318324171848708642","329055314076215834304617937984306565322","201710768619783846435406325244704145884","237426775673766077562513479443285309162","239626063821691608810004856372171493432","221619384341817062607279613793021403839","20474615903214263612061189613347629596","180121554967676553564460216061878422888","138894622285609468813167754015194222387","138338410268695067438503708697863852502","72432552578205995919923606425629685430","232023692629139940344785282836919434358","121147827953351230810439143285565477963","135800287938242292437150335313299019809","170155472640191447063006904740264877059"],"threshold":0.9},"id":"CVE-2025-40159-32ac1e73","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@07ca98f906a403637fc5e513a872a50ef1247f3b","target":{"file":"net/xdp/xsk_queue.h"}},{"deprecated":false,"digest":{"function_hash":"276136949007517757545135746748113960357","length":454},"id":"CVE-2025-40159-416a5cb6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5b5fffa7c81e55d8c8edf05ad40d811ec7047e21","target":{"file":"net/xdp/xsk_queue.h","function":"xp_unaligned_validate_desc"}},{"deprecated":false,"digest":{"function_hash":"276136949007517757545135746748113960357","length":454},"id":"CVE-2025-40159-7c120e18","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1463cd066f32efd56ddfd3ac4e3524200f362980","target":{"file":"net/xdp/xsk_queue.h","function":"xp_unaligned_validate_desc"}},{"deprecated":false,"digest":{"line_hashes":["254306573526797895676208670000925266931","25879280811682874877960801082007612174","210278829039375660968456112042885934267","291016300341066805917862199124728406681","200731482689005314184370494946622451800","310903534969646374098302861784594953467","282880551103845935135076455211311052918","187173022615184567766821213613583352744","44690245594713743366636772205672902694","192197079142209249918800943086354830737","121147827953351230810439143285565477963","135800287938242292437150335313299019809","328707269021123121659820485111880541633","76708238981472904961312368293455448695","143572916212089729105318324171848708642","329055314076215834304617937984306565322","201710768619783846435406325244704145884","237426775673766077562513479443285309162","239626063821691608810004856372171493432","221619384341817062607279613793021403839","20474615903214263612061189613347629596","180121554967676553564460216061878422888","138894622285609468813167754015194222387","138338410268695067438503708697863852502","72432552578205995919923606425629685430","232023692629139940344785282836919434358","121147827953351230810439143285565477963","135800287938242292437150335313299019809","170155472640191447063006904740264877059"],"threshold":0.9},"id":"CVE-2025-40159-8b63172b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5b5fffa7c81e55d8c8edf05ad40d811ec7047e21","target":{"file":"net/xdp/xsk_queue.h"}},{"deprecated":false,"digest":{"line_hashes":["254306573526797895676208670000925266931","25879280811682874877960801082007612174","210278829039375660968456112042885934267","291016300341066805917862199124728406681","200731482689005314184370494946622451800","310903534969646374098302861784594953467","282880551103845935135076455211311052918","187173022615184567766821213613583352744","44690245594713743366636772205672902694","192197079142209249918800943086354830737","121147827953351230810439143285565477963","135800287938242292437150335313299019809","328707269021123121659820485111880541633","76708238981472904961312368293455448695","143572916212089729105318324171848708642","329055314076215834304617937984306565322","201710768619783846435406325244704145884","237426775673766077562513479443285309162","239626063821691608810004856372171493432","221619384341817062607279613793021403839","20474615903214263612061189613347629596","180121554967676553564460216061878422888","138894622285609468813167754015194222387","138338410268695067438503708697863852502","72432552578205995919923606425629685430","232023692629139940344785282836919434358","121147827953351230810439143285565477963","135800287938242292437150335313299019809","170155472640191447063006904740264877059"],"threshold":0.9},"id":"CVE-2025-40159-ac268785","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1463cd066f32efd56ddfd3ac4e3524200f362980","target":{"file":"net/xdp/xsk_queue.h"}},{"deprecated":false,"digest":{"function_hash":"276136949007517757545135746748113960357","length":454},"id":"CVE-2025-40159-b12d3791","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@07ca98f906a403637fc5e513a872a50ef1247f3b","target":{"file":"net/xdp/xsk_queue.h","function":"xp_unaligned_validate_desc"}},{"deprecated":false,"digest":{"function_hash":"97236080460057930699291011306576033932","length":427},"id":"CVE-2025-40159-c24b4a6c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@07ca98f906a403637fc5e513a872a50ef1247f3b","target":{"file":"net/xdp/xsk_queue.h","function":"xp_aligned_validate_desc"}},{"deprecated":false,"digest":{"function_hash":"97236080460057930699291011306576033932","length":427},"id":"CVE-2025-40159-e6353f52","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5b5fffa7c81e55d8c8edf05ad40d811ec7047e21","target":{"file":"net/xdp/xsk_queue.h","function":"xp_aligned_validate_desc"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.12.54"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.17.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40159.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/07ca98f906a403637fc5e513a872a50ef1247f3b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1463cd066f32efd56ddfd3ac4e3524200f362980"},{"type":"WEB","url":"https://git.kernel.org/stable/c/5b5fffa7c81e55d8c8edf05ad40d811ec7047e21"}]}