{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-46784.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "13124783738520294387122075587809643820",
                "115923823867099938906874782973523574430",
                "94176114589957359507199599998518424517",
                "274977082621377609007893331183207467320",
                "326944887767546635409112326187408158172",
                "118077218092707899369457502259780153675",
                "11392715957146171133002480955151239589",
                "7108144494288769788643433600508289851",
                "278401408903419339614801883875193482385",
                "47086078884500772332109304663274528726",
                "36165590790211092546602452715140633540",
                "53803634117329376348140893914487513779",
                "183035891221340922906773914299954095518",
                "118908349958174827908154118196211494386",
                "235275655941132743778404614242185853759",
                "220983909332043003756985711762302731444",
                "112222650624639445787427921868800471679",
                "89423354348451111212535870400351634844",
                "336662990902233906387508948558700282683",
                "328832038316255072814770803101543308756",
                "55825358428117252454084605287656145833",
                "149977315569630693896859072671474703338",
                "2315706031118605201305542734097259052",
                "225598083073185892585468507028871217304",
                "138690528796318419605791197095472481070",
                "54513255579585281735845742677858834286",
                "212630606258933052783305110649659332444",
                "236471352302375339582580763156851290577",
                "160418389388999701011085631663522801219",
                "186688387659168918349349690253835939353",
                "321674346053248937144733360996720008958",
                "279515024970642496220045255435546109735",
                "134661006999943121819109183904413382713",
                "272613848798631255941155953538687507184",
                "324925446403978098896557902088368020970",
                "211923122287006986501699460157115882733",
                "252935344932650398932598264365479772113",
                "18942574542254674337861279334464865503",
                "263481830612776662136037837089945978086",
                "20747230505122173644350036526025366471",
                "61864829436994029161631352164722157372",
                "237998407588399780749174474398610322803",
                "68828881545218290373243218612939408260",
                "246040594449409312085890662639579358390",
                "107468142861186422461970779314782411204",
                "256778840515540688320006783323055282741",
                "199346876999600431421789942830439075459",
                "73342966507704218519621655118571868221",
                "100607674149811170452632539539335330018",
                "186328700864024663402034150772433027557",
                "324642670792422475476757576736623726327",
                "25523392985587464676366915932477319550",
                "169690349476604574206764447281033598655",
                "85258812759861249394735681405200249394",
                "273543527631926404307276941390174506420",
                "179717529279834891293921147312566150839",
                "213898650025930163164189634983313239715",
                "4120415116524143482957962496157887464",
                "145757150609783541797461748033783530200",
                "151567726560542897992320688062573159607",
                "158331498850698070496950386538212857530",
                "113005471972511323907382955523516626074",
                "337625326255853171311861208317302421355"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2021-46784-01810d80",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/squid-cache/squid/commit/5e2ea2b13bd98f53e29964ca26bb0d602a8a12b9",
            "target": {
              "file": "src/gopher.cc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "63899508942904651983784718535806986154",
              "length": 6595.0
            },
            "id": "CVE-2021-46784-75296bdc",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/squid-cache/squid/commit/5e2ea2b13bd98f53e29964ca26bb0d602a8a12b9",
            "target": {
              "file": "src/gopher.cc",
              "function": "gopherToHTML"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5e2ea2b13bd98f53e29964ca26bb0d602a8a12b9"
            }
          ],
          "repo": "https://github.com/squid-cache/squid",
          "type": "GIT"
        }
      ],
      "versions": [
        "4.15-20210522-snapshot",
        "4.15-20210523-snapshot",
        "4.15-20210524-snapshot",
        "4.15-20210525-snapshot",
        "4.15-20210527-snapshot",
        "5.0.6-20210522-snapshot",
        "5.0.6-20210523-snapshot",
        "5.0.6-20210524-snapshot",
        "5.0.6-20210525-snapshot",
        "5.0.6-20210527-snapshot",
        "6.0.0-20210522-master-snapshot",
        "6.0.0-20210523-master-snapshot",
        "6.0.0-20210524-master-snapshot",
        "6.0.0-20210525-master-snapshot",
        "6.0.0-20210527-master-snapshot",
        "BASIC_TPROXY4",
        "BumpSslServerFirst.take01",
        "BumpSslServerFirst.take02",
        "BumpSslServerFirst.take03",
        "BumpSslServerFirst.take04",
        "BumpSslServerFirst.take05",
        "BumpSslServerFirst.take06",
        "BumpSslServerFirst.take07",
        "BumpSslServerFirst.take08",
        "BumpSslServerFirst.take09",
        "BumpSslServerFirst.take10",
        "HISTORIC_RELEASES",
        "M-staged-PR161",
        "M-staged-PR164",
        "M-staged-PR170",
        "M-staged-PR176",
        "M-staged-PR179",
        "M-staged-PR181",
        "M-staged-PR182",
        "M-staged-PR186",
        "M-staged-PR189",
        "M-staged-PR193",
        "M-staged-PR195",
        "M-staged-PR196",
        "M-staged-PR198",
        "M-staged-PR199",
        "M-staged-PR200",
        "M-staged-PR202",
        "M-staged-PR206",
        "M-staged-PR208",
        "M-staged-PR209",
        "M-staged-PR210",
        "M-staged-PR218",
        "M-staged-PR220",
        "M-staged-PR221",
        "M-staged-PR225",
        "M-staged-PR227",
        "M-staged-PR229",
        "M-staged-PR230",
        "M-staged-PR235",
        "M-staged-PR237",
        "M-staged-PR238",
        "M-staged-PR239",
        "M-staged-PR241",
        "M-staged-PR242",
        "M-staged-PR252",
        "M-staged-PR255",
        "M-staged-PR258",
        "M-staged-PR264",
        "M-staged-PR266",
        "M-staged-PR267",
        "M-staged-PR268",
        "M-staged-PR274",
        "M-staged-PR276",
        "M-staged-PR293",
        "M-staged-PR294",
        "M-staged-PR295",
        "M-staged-PR299",
        "M-staged-PR306",
        "M-staged-PR314",
        "M-staged-PR319",
        "M-staged-PR342",
        "M-staged-PR345",
        "M-staged-PR348",
        "M-staged-PR351",
        "M-staged-PR359",
        "M-staged-PR364",
        "M-staged-PR365",
        "M-staged-PR366",
        "M-staged-PR370",
        "M-staged-PR372",
        "M-staged-PR373",
        "M-staged-PR375",
        "M-staged-PR376",
        "SQUID_3_0_PRE1",
        "SQUID_3_0_PRE2",
        "SQUID_3_0_PRE3",
        "SQUID_3_0_PRE4",
        "SQUID_3_0_PRE5",
        "SQUID_3_0_PRE6",
        "SQUID_3_0_PRE7",
        "SQUID_3_0_RC1",
        "SQUID_3_5_27",
        "SQUID_4_0_1",
        "SQUID_4_0_10",
        "SQUID_4_0_11",
        "SQUID_4_0_12",
        "SQUID_4_0_13",
        "SQUID_4_0_14",
        "SQUID_4_0_15",
        "SQUID_4_0_16",
        "SQUID_4_0_2",
        "SQUID_4_0_3",
        "SQUID_4_0_4",
        "SQUID_4_0_5",
        "SQUID_4_0_6",
        "SQUID_4_0_7",
        "SQUID_4_0_8",
        "SQUID_4_0_9",
        "for-libecap-v0p1",
        "merge-candidate-3-v1",
        "merge-candidate-3-v2",
        "sourceformat-review-1",
        "take00",
        "take01",
        "take02",
        "take03",
        "take04",
        "take06",
        "take07",
        "take08",
        "take09",
        "take1",
        "take2"
      ]
    }
  ],
  "details": "In Squid 3.x through 3.5.28, 4.x through 4.17, and 5.x before 5.6, due to improper buffer management, a Denial of Service can occur when processing long Gopher server responses.",
  "id": "CVE-2021-46784",
  "modified": "2025-10-10T03:40:41.176858Z",
  "published": "2022-07-17T22:15:08Z",
  "references": [
    {
      "type": "FIX",
      "url": "http://www.squid-cache.org/Versions/v5/changesets/SQUID-2021_7.patch"
    },
    {
      "type": "FIX",
      "url": "https://github.com/squid-cache/squid/commit/5e2ea2b13bd98f53e29964ca26bb0d602a8a12b9"
    },
    {
      "type": "FIX",
      "url": "https://github.com/squid-cache/squid/security/advisories/GHSA-f5cp-6rh3-284w"
    },
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2021-46784"
    },
    {
      "type": "ADVISORY",
      "url": "https://security.netapp.com/advisory/ntap-20221223-0007/"
    },
    {
      "type": "WEB",
      "url": "http://www.openwall.com/lists/oss-security/2023/10/13/1"
    },
    {
      "type": "WEB",
      "url": "http://www.openwall.com/lists/oss-security/2023/10/13/10"
    },
    {
      "type": "WEB",
      "url": "http://www.openwall.com/lists/oss-security/2023/10/21/1"
    },
    {
      "type": "WEB",
      "url": "http://www.squid-cache.org/Versions/v4/changesets/SQUID-2021_7.patch"
    }
  ],
  "related": [
    "ALSA-2022:5526",
    "ALSA-2022:5527",
    "GHSA-f5cp-6rh3-284w",
    "MGASA-2022-0249",
    "RLSA-2022:5526",
    "SUSE-SU-2022:2359-1",
    "SUSE-SU-2022:2367-1",
    "SUSE-SU-2022:2392-1",
    "SUSE-SU-2022:2553-1",
    "openSUSE-SU-2024:12157-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ]
}