{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27021.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "1016522927406947217449707108588301977",
                "144769405281629179645606014393863878349",
                "30672006646163027901281922146890319540",
                "284124112446939777217770278092231757848",
                "231572718748193241065511142056459740107"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27021-126c5ebf",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53d986f39acd8ea11c9e460732bfa5add66360d9",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "216282336019314905017521266100597980942",
              "length": 318.0
            },
            "id": "CVE-2024-27021-1fe18615",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@19fa4f2a85d777a8052e869c1b892a2f7556569d",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_main.c",
              "function": "rtl_remove_one"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "216282336019314905017521266100597980942",
              "length": 318.0
            },
            "id": "CVE-2024-27021-34ac01c0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53d986f39acd8ea11c9e460732bfa5add66360d9",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_main.c",
              "function": "rtl_remove_one"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "201246003448516933889876943438570960797",
              "length": 4776.0
            },
            "id": "CVE-2024-27021-383801f8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53d986f39acd8ea11c9e460732bfa5add66360d9",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_main.c",
              "function": "rtl_init_one"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "59353066350489594903269869465059285058",
              "length": 280.0
            },
            "id": "CVE-2024-27021-5937b220",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@19fa4f2a85d777a8052e869c1b892a2f7556569d",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_leds.c",
              "function": "rtl8168_init_leds"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "79050498548880871135263711454408407783",
                "285814592278779642021779852458596893436",
                "33658069963632367601934785553092693430",
                "152412189805330886343563744096865730527",
                "232493800201805983813875643533816317022",
                "189988195852660952995245825194091927200",
                "93553527461930291610477658154205987440",
                "95794234913525440279414805852913883850",
                "150010065831112307032005476242529703231",
                "49834412862299204073385886271671753014",
                "145269528262034821516332689923669206560",
                "308804994603855784711410005083235032141",
                "291675622228318528216763108771952812987"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27021-67f64b19",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53d986f39acd8ea11c9e460732bfa5add66360d9",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_leds.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "15377414136580175813889160722494941113",
              "length": 280.0
            },
            "id": "CVE-2024-27021-7f5d2f1d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@19fa4f2a85d777a8052e869c1b892a2f7556569d",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_leds.c",
              "function": "rtl8125_init_leds"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "59353066350489594903269869465059285058",
              "length": 280.0
            },
            "id": "CVE-2024-27021-83d61d2b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53d986f39acd8ea11c9e460732bfa5add66360d9",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_leds.c",
              "function": "rtl8168_init_leds"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "47502963223668890464034011411506404771",
              "length": 4682.0
            },
            "id": "CVE-2024-27021-9a535b82",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@19fa4f2a85d777a8052e869c1b892a2f7556569d",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_main.c",
              "function": "rtl_init_one"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "79050498548880871135263711454408407783",
                "285814592278779642021779852458596893436",
                "33658069963632367601934785553092693430",
                "152412189805330886343563744096865730527",
                "232493800201805983813875643533816317022",
                "189988195852660952995245825194091927200",
                "93553527461930291610477658154205987440",
                "95794234913525440279414805852913883850",
                "150010065831112307032005476242529703231",
                "49834412862299204073385886271671753014",
                "145269528262034821516332689923669206560",
                "308804994603855784711410005083235032141",
                "291675622228318528216763108771952812987",
                "67680512383113592438786093569722396923",
                "89930342304694709579144514139376840300",
                "318567072907729635834164036746078233741",
                "321964218480877760428163811593541432640",
                "23808691268039840549635277724438514155",
                "228345430748954773401125560875578766196",
                "274292911718046258120528999362944818851",
                "186304730480201616969870435716782829169",
                "93553527461930291610477658154205987440",
                "334553700505771303950104640908682886175",
                "244328884620365094699990199669262660171",
                "105473244734545613271011393004747591910",
                "10646328067711564049186411467129165359",
                "303792386870613871237042265008636653868",
                "77678010927164616699561969906450160057"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27021-9d744bbc",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@19fa4f2a85d777a8052e869c1b892a2f7556569d",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_leds.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "39264332066856154209244313116760609573",
                "27752549864942567545433799173574097421",
                "150000914563685979081692673012640715149",
                "205009833620984921567185846657864885619",
                "246604428486747038594303082160209457716",
                "127659872621807960626111042602980405956",
                "230939220055597701652121141900196199574",
                "275886394579826505725421966327289699265",
                "99303862265013658326341737554875569497",
                "224381304308253822857438374035623846288"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27021-beb394db",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53d986f39acd8ea11c9e460732bfa5add66360d9",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_main.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "190467663617164926770878235346520807912",
                "144769405281629179645606014393863878349",
                "30672006646163027901281922146890319540",
                "284124112446939777217770278092231757848",
                "231572718748193241065511142056459740107",
                "340031735433010439799077307475858567165",
                "18720077317228599637511757239454889558",
                "32258090599057724757776965028694494508"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27021-c60c0110",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@19fa4f2a85d777a8052e869c1b892a2f7556569d",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "203705530251070597936135417731527188736",
                "27752549864942567545433799173574097421",
                "150000914563685979081692673012640715149",
                "205009833620984921567185846657864885619",
                "246604428486747038594303082160209457716",
                "127659872621807960626111042602980405956",
                "50197897902364082405442805330527019890",
                "46096190579255159490129337540304179893",
                "338962529517680505197917598464832374159",
                "97934850637272135922111544216384195408",
                "259324185246298499966961569751535699338",
                "256527961055139732650973417450966032657"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27021-e9162960",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@19fa4f2a85d777a8052e869c1b892a2f7556569d",
            "target": {
              "file": "drivers/net/ethernet/realtek/r8169_main.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "18764b883e157e28126b54e7d4ba9dd487d5bf54"
            },
            {
              "fixed": "53d986f39acd8ea11c9e460732bfa5add66360d9"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "18764b883e157e28126b54e7d4ba9dd487d5bf54"
            },
            {
              "fixed": "19fa4f2a85d777a8052e869c1b892a2f7556569d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.7",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4",
        "v6.8.5",
        "v6.8.6",
        "v6.8.7",
        "v6.9-rc1",
        "v6.9-rc2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27021.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.8.0"
            },
            {
              "fixed": "6.8.8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nr8169: fix LED-related deadlock on module removal\n\nBinding devm_led_classdev_register() to the netdev is problematic\nbecause on module removal we get a RTNL-related deadlock. Fix this\nby avoiding the device-managed LED functions.\n\nNote: We can safely call led_classdev_unregister() for a LED even\nif registering it failed, because led_classdev_unregister() detects\nthis and is a no-op in this case.",
  "id": "CVE-2024-27021",
  "modified": "2025-10-21T19:41:08.260624Z",
  "published": "2024-05-01T05:30:21Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/19fa4f2a85d777a8052e869c1b892a2f7556569d"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/53d986f39acd8ea11c9e460732bfa5add66360d9"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "r8169: fix LED-related deadlock on module removal"
}