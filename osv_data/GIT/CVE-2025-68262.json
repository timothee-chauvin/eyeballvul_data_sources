{"schema_version":"1.7.3","id":"CVE-2025-68262","published":"2025-12-16T14:45:04.198Z","modified":"2025-12-16T20:15:27.527655Z","summary":"crypto: zstd - fix double-free in per-CPU stream cleanup","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ncrypto: zstd - fix double-free in per-CPU stream cleanup\n\nThe crypto/zstd module has a double-free bug that occurs when multiple\ntfms are allocated and freed.\n\nThe issue happens because zstd_streams (per-CPU contexts) are freed in\nzstd_exit() during every tfm destruction, rather than being managed at\nthe module level.  When multiple tfms exist, each tfm exit attempts to\nfree the same shared per-CPU streams, resulting in a double-free.\n\nThis leads to a stack trace similar to:\n\n  BUG: Bad page state in process kworker/u16:1  pfn:106fd93\n  page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x106fd93\n  flags: 0x17ffffc0000000(node=0|zone=2|lastcpupid=0x1fffff)\n  page_type: 0xffffffff()\n  raw: 0017ffffc0000000 dead000000000100 dead000000000122 0000000000000000\n  raw: 0000000000000000 0000000000000000 00000000ffffffff 0000000000000000\n  page dumped because: nonzero entire_mapcount\n  Modules linked in: ...\n  CPU: 3 UID: 0 PID: 2506 Comm: kworker/u16:1 Kdump: loaded Tainted: G    B\n  Hardware name: ...\n  Workqueue: btrfs-delalloc btrfs_work_helper\n  Call Trace:\n   <TASK>\n   dump_stack_lvl+0x5d/0x80\n   bad_page+0x71/0xd0\n   free_unref_page_prepare+0x24e/0x490\n   free_unref_page+0x60/0x170\n   crypto_acomp_free_streams+0x5d/0xc0\n   crypto_acomp_exit_tfm+0x23/0x50\n   crypto_destroy_tfm+0x60/0xc0\n   ...\n\nChange the lifecycle management of zstd_streams to free the streams only\nonce during module cleanup.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f5ad93ffb54119a8dc5e18f070624d4ead586969"},{"fixed":"dc0f4509b0ed5d82bef78e058db0ac4df04d0695"},{"fixed":"e983feaa79de1e46c9087fb9f02fedb0e5397ce6"},{"fixed":"48bc9da3c97c15f1ea24934bcb3b736acd30163d"}]}],"versions":["v6.16","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.10","v6.17.11","v6.17.2","v6.17.3","v6.17.4","v6.17.5","v6.17.6","v6.17.7","v6.17.8","v6.17.9","v6.18","v6.18-rc1","v6.18-rc2","v6.18-rc3","v6.18-rc4","v6.18-rc5","v6.18-rc6","v6.18-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-68262.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.17.0"},{"fixed":"6.17.12"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.18.0"},{"fixed":"6.18.1"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-68262.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/48bc9da3c97c15f1ea24934bcb3b736acd30163d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/dc0f4509b0ed5d82bef78e058db0ac4df04d0695"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e983feaa79de1e46c9087fb9f02fedb0e5397ce6"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/68xxx/CVE-2025-68262.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-68262"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/68xxx/CVE-2025-68262.json"}}