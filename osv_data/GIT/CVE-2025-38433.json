{"schema_version":"1.7.3","id":"CVE-2025-38433","published":"2025-07-25T14:32:07.122Z","modified":"2025-11-20T09:26:36.986178Z","summary":"riscv: fix runtime constant support for nommu kernels","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nriscv: fix runtime constant support for nommu kernels\n\nthe `__runtime_fixup_32` function does not handle the case where `val` is\nzero correctly (as might occur when patching a nommu kernel and referring\nto a physical address below the 4GiB boundary whose upper 32 bits are all\nzero) because nothing in the existing logic prevents the code from taking\nthe `else` branch of both nop-checks and emitting two `nop` instructions.\n\nThis leaves random garbage in the register that is supposed to receive the\nupper 32 bits of the pointer instead of zero that when combined with the\nvalue for the lower 32 bits yields an invalid pointer and causes a kernel\npanic when that pointer is eventually accessed.\n\nThe author clearly considered the fact that if the `lui` is converted into\na `nop` that the second instruction needs to be adjusted to become an `li`\ninstead of an `addi`, hence introducing the `addi_insn_mask` variable, but\ndidn't follow that logic through fully to the case where the `else` branch\nexecutes. To fix it just adjust the logic to ensure that the second `else`\nbranch is not taken if the first instruction will be patched to a `nop`.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a44fb5722199de8338d991db5ad3d509192179bb"},{"fixed":"0a24b00dcde83934a3cc13e4c6b775522903496b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a44fb5722199de8338d991db5ad3d509192179bb"},{"fixed":"8d90d9872edae7e78c3a12b98e239bfaa66f3639"}]}],"versions":["v6.14","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.2","v6.15.3","v6.15.4","v6.16-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38433.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"319900845926111934181777629258555411671","length":837},"id":"CVE-2025-38433-78e8da4a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0a24b00dcde83934a3cc13e4c6b775522903496b","target":{"file":"arch/riscv/include/asm/runtime-const.h","function":"__runtime_fixup_32"}},{"deprecated":false,"digest":{"line_hashes":["91990263457716313417206044166180230756","85903527901707320538772382809814021422","149066343724482752450433059586134162856","265487731014881486196781300890545450917"],"threshold":0.9},"id":"CVE-2025-38433-859a15bd","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0a24b00dcde83934a3cc13e4c6b775522903496b","target":{"file":"arch/riscv/include/asm/runtime-const.h"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.15.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38433.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0a24b00dcde83934a3cc13e4c6b775522903496b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8d90d9872edae7e78c3a12b98e239bfaa66f3639"}]}