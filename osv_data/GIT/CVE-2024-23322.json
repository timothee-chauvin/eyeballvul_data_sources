{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-23322.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "228270073838530491695487961077322894581",
                "61088390952560571399318368946228711246",
                "85012649853783538397515480809868282642",
                "18868181262311821527743019773468169146"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-23322-1c5f22ca",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/843f9e6a123ed47ce139b421c14e7126f2ac685e",
            "target": {
              "file": "source/common/router/router.cc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "186506934802386101693882528347442499524",
                "36098432078275374973240606718929334254",
                "139548986029921242567597945456309657280",
                "48531809800251678756431119390857557587",
                "27072720606875193548215322613576415666",
                "88658193679491350865502424393091920409",
                "36743648382083424572231535183485347644",
                "183420972641223939065882817243448039903"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-23322-598c341b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/843f9e6a123ed47ce139b421c14e7126f2ac685e",
            "target": {
              "file": "source/common/router/upstream_request.cc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "148786826013716339692147952620164609773",
              "length": 267.0
            },
            "id": "CVE-2024-23322-b9d0efa6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/843f9e6a123ed47ce139b421c14e7126f2ac685e",
            "target": {
              "file": "source/common/router/upstream_request.cc",
              "function": "UpstreamRequest::onPerTryIdleTimeout"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "295452394784285953143553417929840714084"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-23322-c22a1a06",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/843f9e6a123ed47ce139b421c14e7126f2ac685e",
            "target": {
              "file": "test/integration/http_timeout_integration_test.cc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "248297398052012443715227041806387533779",
              "length": 1006.0
            },
            "id": "CVE-2024-23322-d201f0af",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/843f9e6a123ed47ce139b421c14e7126f2ac685e",
            "target": {
              "file": "source/common/router/router.cc",
              "function": "Filter::onSoftPerTryTimeout"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "139082454428610377712668153787784358760",
              "length": 450.0
            },
            "id": "CVE-2024-23322-fb233cb1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/843f9e6a123ed47ce139b421c14e7126f2ac685e",
            "target": {
              "file": "source/common/router/upstream_request.cc",
              "function": "UpstreamRequest::onPerTryTimeout"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "843f9e6a123ed47ce139b421c14e7126f2ac685e"
            }
          ],
          "repo": "https://github.com/envoyproxy/envoy",
          "type": "GIT"
        }
      ],
      "versions": [
        "v1.0.0",
        "v1.1.0",
        "v1.10.0",
        "v1.11.0",
        "v1.12.0",
        "v1.13.0",
        "v1.14.0",
        "v1.15.0",
        "v1.16.0",
        "v1.17.0",
        "v1.18.0",
        "v1.18.1",
        "v1.18.2",
        "v1.19.0",
        "v1.2.0",
        "v1.20.0",
        "v1.21.0",
        "v1.22.0",
        "v1.23.0",
        "v1.24.0",
        "v1.25.0",
        "v1.26.0",
        "v1.27.0",
        "v1.28.0",
        "v1.29.0",
        "v1.3.0",
        "v1.4.0",
        "v1.5.0",
        "v1.6.0",
        "v1.7.0",
        "v1.8.0",
        "v1.9.0"
      ]
    }
  ],
  "aliases": [
    "BIT-envoy-2024-23322"
  ],
  "details": "Envoy is a high-performance edge/middle/service proxy. Envoy will crash when certain timeouts happen within the same interval. The crash occurs when the following are true: 1. hedge_on_per_try_timeout is enabled, 2. per_try_idle_timeout is enabled (it can only be done in configuration), 3. per-try-timeout is enabled, either through headers or configuration and its value is equal, or within the backoff interval of the per_try_idle_timeout. This issue has been addressed in released 1.29.1, 1.28.1, 1.27.3, and 1.26.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
  "id": "CVE-2024-23322",
  "modified": "2025-10-10T04:49:38.708098Z",
  "published": "2024-02-09T23:15:08Z",
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/envoyproxy/envoy/commit/843f9e6a123ed47ce139b421c14e7126f2ac685e"
    },
    {
      "type": "ADVISORY",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-6p83-mfmh-qv38"
    }
  ],
  "related": [
    "GHSA-6p83-mfmh-qv38"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ]
}