{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39984.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "e6d5dbdd20aa6a86974af51deb9414cd2e7794cb"
            },
            {
              "fixed": "953200d56fc23eebf80a5ad9eed6e2e8a3065093"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "e6d5dbdd20aa6a86974af51deb9414cd2e7794cb"
            },
            {
              "fixed": "1697577e1669b0321d02cd848384a5d33e284296"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "e6d5dbdd20aa6a86974af51deb9414cd2e7794cb"
            },
            {
              "fixed": "1091860a16a86ccdd77c09f2b21a5f634f5ab9ec"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.11",
        "v6.11-rc1",
        "v6.11-rc2",
        "v6.11-rc3",
        "v6.11-rc4",
        "v6.11-rc5",
        "v6.11-rc6",
        "v6.11-rc7",
        "v6.12",
        "v6.12-rc1",
        "v6.12-rc2",
        "v6.12-rc3",
        "v6.12-rc4",
        "v6.12-rc5",
        "v6.12-rc6",
        "v6.12-rc7",
        "v6.12.1",
        "v6.12.10",
        "v6.12.11",
        "v6.12.12",
        "v6.12.13",
        "v6.12.14",
        "v6.12.15",
        "v6.12.16",
        "v6.12.17",
        "v6.12.18",
        "v6.12.19",
        "v6.12.2",
        "v6.12.20",
        "v6.12.21",
        "v6.12.22",
        "v6.12.23",
        "v6.12.24",
        "v6.12.25",
        "v6.12.26",
        "v6.12.27",
        "v6.12.28",
        "v6.12.29",
        "v6.12.3",
        "v6.12.30",
        "v6.12.31",
        "v6.12.32",
        "v6.12.33",
        "v6.12.34",
        "v6.12.35",
        "v6.12.36",
        "v6.12.37",
        "v6.12.38",
        "v6.12.39",
        "v6.12.4",
        "v6.12.40",
        "v6.12.41",
        "v6.12.42",
        "v6.12.43",
        "v6.12.44",
        "v6.12.45",
        "v6.12.46",
        "v6.12.47",
        "v6.12.48",
        "v6.12.49",
        "v6.12.5",
        "v6.12.6",
        "v6.12.7",
        "v6.12.8",
        "v6.12.9",
        "v6.13",
        "v6.13-rc1",
        "v6.13-rc2",
        "v6.13-rc3",
        "v6.13-rc4",
        "v6.13-rc5",
        "v6.13-rc6",
        "v6.13-rc7",
        "v6.14",
        "v6.14-rc1",
        "v6.14-rc2",
        "v6.14-rc3",
        "v6.14-rc4",
        "v6.14-rc5",
        "v6.14-rc6",
        "v6.14-rc7",
        "v6.15",
        "v6.15-rc1",
        "v6.15-rc2",
        "v6.15-rc3",
        "v6.15-rc4",
        "v6.15-rc5",
        "v6.15-rc6",
        "v6.15-rc7",
        "v6.16",
        "v6.16-rc1",
        "v6.16-rc2",
        "v6.16-rc3",
        "v6.16-rc4",
        "v6.16-rc5",
        "v6.16-rc6",
        "v6.16-rc7",
        "v6.16.1",
        "v6.16.2",
        "v6.16.3",
        "v6.16.4",
        "v6.16.5",
        "v6.16.6",
        "v6.16.7",
        "v6.16.8",
        "v6.16.9",
        "v6.17-rc1",
        "v6.17-rc2",
        "v6.17-rc3",
        "v6.17-rc4",
        "v6.17-rc5",
        "v6.17-rc6",
        "v6.8",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39984.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.9.0"
            },
            {
              "fixed": "6.12.50"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.13.0"
            },
            {
              "fixed": "6.16.10"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: tun: Update napi->skb after XDP process\n\nThe syzbot report a UAF issue:\n\n  BUG: KASAN: slab-use-after-free in skb_reset_mac_header include/linux/skbuff.h:3150 [inline]\n  BUG: KASAN: slab-use-after-free in napi_frags_skb net/core/gro.c:723 [inline]\n  BUG: KASAN: slab-use-after-free in napi_gro_frags+0x6e/0x1030 net/core/gro.c:758\n  Read of size 8 at addr ffff88802ef22c18 by task syz.0.17/6079\n  CPU: 0 UID: 0 PID: 6079 Comm: syz.0.17 Not tainted syzkaller #0 PREEMPT(full)\n  Call Trace:\n   <TASK>\n   dump_stack_lvl+0x189/0x250 lib/dump_stack.c:120\n   print_address_description mm/kasan/report.c:378 [inline]\n   print_report+0xca/0x240 mm/kasan/report.c:482\n   kasan_report+0x118/0x150 mm/kasan/report.c:595\n   skb_reset_mac_header include/linux/skbuff.h:3150 [inline]\n   napi_frags_skb net/core/gro.c:723 [inline]\n   napi_gro_frags+0x6e/0x1030 net/core/gro.c:758\n   tun_get_user+0x28cb/0x3e20 drivers/net/tun.c:1920\n   tun_chr_write_iter+0x113/0x200 drivers/net/tun.c:1996\n   new_sync_write fs/read_write.c:593 [inline]\n   vfs_write+0x5c9/0xb30 fs/read_write.c:686\n   ksys_write+0x145/0x250 fs/read_write.c:738\n   do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n   do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c:94\n   entry_SYSCALL_64_after_hwframe+0x77/0x7f\n   </TASK>\n\n  Allocated by task 6079:\n   kasan_save_stack mm/kasan/common.c:47 [inline]\n   kasan_save_track+0x3e/0x80 mm/kasan/common.c:68\n   unpoison_slab_object mm/kasan/common.c:330 [inline]\n   __kasan_mempool_unpoison_object+0xa0/0x170 mm/kasan/common.c:558\n   kasan_mempool_unpoison_object include/linux/kasan.h:388 [inline]\n   napi_skb_cache_get+0x37b/0x6d0 net/core/skbuff.c:295\n   __alloc_skb+0x11e/0x2d0 net/core/skbuff.c:657\n   napi_alloc_skb+0x84/0x7d0 net/core/skbuff.c:811\n   napi_get_frags+0x69/0x140 net/core/gro.c:673\n   tun_napi_alloc_frags drivers/net/tun.c:1404 [inline]\n   tun_get_user+0x77c/0x3e20 drivers/net/tun.c:1784\n   tun_chr_write_iter+0x113/0x200 drivers/net/tun.c:1996\n   new_sync_write fs/read_write.c:593 [inline]\n   vfs_write+0x5c9/0xb30 fs/read_write.c:686\n   ksys_write+0x145/0x250 fs/read_write.c:738\n   do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n   do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c:94\n   entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\n  Freed by task 6079:\n   kasan_save_stack mm/kasan/common.c:47 [inline]\n   kasan_save_track+0x3e/0x80 mm/kasan/common.c:68\n   kasan_save_free_info+0x46/0x50 mm/kasan/generic.c:576\n   poison_slab_object mm/kasan/common.c:243 [inline]\n   __kasan_slab_free+0x5b/0x80 mm/kasan/common.c:275\n   kasan_slab_free include/linux/kasan.h:233 [inline]\n   slab_free_hook mm/slub.c:2422 [inline]\n   slab_free mm/slub.c:4695 [inline]\n   kmem_cache_free+0x18f/0x400 mm/slub.c:4797\n   skb_pp_cow_data+0xdd8/0x13e0 net/core/skbuff.c:969\n   netif_skb_check_for_xdp net/core/dev.c:5390 [inline]\n   netif_receive_generic_xdp net/core/dev.c:5431 [inline]\n   do_xdp_generic+0x699/0x11a0 net/core/dev.c:5499\n   tun_get_user+0x2523/0x3e20 drivers/net/tun.c:1872\n   tun_chr_write_iter+0x113/0x200 drivers/net/tun.c:1996\n   new_sync_write fs/read_write.c:593 [inline]\n   vfs_write+0x5c9/0xb30 fs/read_write.c:686\n   ksys_write+0x145/0x250 fs/read_write.c:738\n   do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n   do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c:94\n   entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nAfter commit e6d5dbdd20aa (\"xdp: add multi-buff support for xdp running in\ngeneric mode\"), the original skb may be freed in skb_pp_cow_data() when\nXDP program was attached, which was allocated in tun_napi_alloc_frags().\nHowever, the napi->skb still point to the original skb, update it after\nXDP process.",
  "id": "CVE-2025-39984",
  "modified": "2025-10-22T17:07:36.059616Z",
  "published": "2025-10-15T07:56:03Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1091860a16a86ccdd77c09f2b21a5f634f5ab9ec"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1697577e1669b0321d02cd848384a5d33e284296"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/953200d56fc23eebf80a5ad9eed6e2e8a3065093"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "net: tun: Update napi->skb after XDP process"
}