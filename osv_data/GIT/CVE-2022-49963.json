{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49963.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "168978494000133682396264691324267541963",
              "length": 3438.0
            },
            "id": "CVE-2022-49963-03550ebf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@97434cb55bd884bd268626ec41489f79b261b2d4",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_migrate.c",
              "function": "intel_context_migrate_copy"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "254969981997025168273607662840933668544",
                "212965377769637954583958938808905974843",
                "216244811504031688702092657284840512841",
                "308118165301300287577274373314949369648",
                "277141319872363041703011236085045483988",
                "50122048683798198783043724754914787349",
                "265690887981070295458398249871054407419",
                "139871864525289379354931970864492735659",
                "195040530211439980846958101736208993990",
                "110121074595876938037070718790607348789",
                "339927243114492485845072180581060273800",
                "140020170029874550951842631866381696424",
                "130689775645031695927752981027843504969",
                "77222264389463687103520301417235055140",
                "94581025484668377090887690142041339071",
                "292127902775831277019885696371380211168",
                "195844462084047246960762549150767185916",
                "114554527773760604155752108004727692130",
                "75917601202189246340415838404478029",
                "166881427240722743824315500821169152529",
                "66874767794196125266664476186801818585",
                "233146014808151201615285036387316812560",
                "335026635414990221916583931973468587180",
                "171895891281977855213222028725759874293",
                "276417554501024874080659704748038582421",
                "275471110100085377008267804654279554703",
                "121971742231923432888521190917848852161",
                "277104083898658806356232504263231842627",
                "267086752860244597465496812798647856031",
                "293534632593794498448074556818718875475",
                "248131059349643382638293730679963186940",
                "286941540485391949532384290134634528138",
                "180936008772917411975743478762053054709",
                "79339431738730339345535181673662145972",
                "27296480226082070462172399280738983990",
                "332660442243868257636248802901584421824",
                "211272513893479228188398058592543822391"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49963-4b0ea4fb",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@97434cb55bd884bd268626ec41489f79b261b2d4",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_migrate.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "168978494000133682396264691324267541963",
              "length": 3438.0
            },
            "id": "CVE-2022-49963-5d87677c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8d905254162965c8e6be697d82c7dbf5d08f574d",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_migrate.c",
              "function": "intel_context_migrate_copy"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "254969981997025168273607662840933668544",
                "212965377769637954583958938808905974843",
                "216244811504031688702092657284840512841",
                "308118165301300287577274373314949369648",
                "277141319872363041703011236085045483988",
                "50122048683798198783043724754914787349",
                "265690887981070295458398249871054407419",
                "139871864525289379354931970864492735659",
                "195040530211439980846958101736208993990",
                "110121074595876938037070718790607348789",
                "339927243114492485845072180581060273800",
                "140020170029874550951842631866381696424",
                "130689775645031695927752981027843504969",
                "77222264389463687103520301417235055140",
                "94581025484668377090887690142041339071",
                "292127902775831277019885696371380211168",
                "195844462084047246960762549150767185916",
                "114554527773760604155752108004727692130",
                "75917601202189246340415838404478029",
                "166881427240722743824315500821169152529",
                "66874767794196125266664476186801818585",
                "233146014808151201615285036387316812560",
                "335026635414990221916583931973468587180",
                "171895891281977855213222028725759874293",
                "276417554501024874080659704748038582421",
                "275471110100085377008267804654279554703",
                "121971742231923432888521190917848852161",
                "277104083898658806356232504263231842627",
                "267086752860244597465496812798647856031",
                "293534632593794498448074556818718875475",
                "248131059349643382638293730679963186940",
                "286941540485391949532384290134634528138",
                "180936008772917411975743478762053054709",
                "79339431738730339345535181673662145972",
                "27296480226082070462172399280738983990",
                "332660442243868257636248802901584421824",
                "211272513893479228188398058592543822391"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49963-74101033",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8d905254162965c8e6be697d82c7dbf5d08f574d",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_migrate.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "244667837910224657290143035638704928760",
              "length": 213.0
            },
            "id": "CVE-2022-49963-cae03649",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8d905254162965c8e6be697d82c7dbf5d08f574d",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_migrate.c",
              "function": "calculate_chunk_sz"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "244667837910224657290143035638704928760",
              "length": 213.0
            },
            "id": "CVE-2022-49963-d0847478",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@97434cb55bd884bd268626ec41489f79b261b2d4",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_migrate.c",
              "function": "calculate_chunk_sz"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "da0595ae91da837929a00470ab40546090e5b9ae"
            },
            {
              "fixed": "97434cb55bd884bd268626ec41489f79b261b2d4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "da0595ae91da837929a00470ab40546090e5b9ae"
            },
            {
              "fixed": "8d905254162965c8e6be697d82c7dbf5d08f574d"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.18",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v5.19.1",
        "v5.19.2",
        "v5.19.3",
        "v5.19.4",
        "v5.19.5",
        "v5.19.6",
        "v5.19.7",
        "v6.0-rc1",
        "v6.0-rc2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49963.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.19.0"
            },
            {
              "fixed": "5.19.8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/i915/ttm: fix CCS handling\n\nCrucible + recent Mesa seems to sometimes hit:\n\nGEM_BUG_ON(num_ccs_blks > NUM_CCS_BLKS_PER_XFER)\n\nAnd it looks like we can also trigger this with gem_lmem_swapping, if we\nmodify the test to use slightly larger object sizes.\n\nLooking closer it looks like we have the following issues in\nmigrate_copy():\n\n  - We are using plain integer in various places, which we can easily\n    overflow with a large object.\n\n  - We pass the entire object size (when the src is lmem) into\n    emit_pte() and then try to copy it, which doesn't work, since we\n    only have a few fixed sized windows in which to map the pages and\n    perform the copy. With an object > 8M we therefore aren't properly\n    copying the pages. And then with an object > 64M we trigger the\n    GEM_BUG_ON(num_ccs_blks > NUM_CCS_BLKS_PER_XFER).\n\nSo it looks like our copy handling for any object > 8M (which is our\nCHUNK_SZ) is currently broken on DG2.\n\nTestcase: igt@gem_lmem_swapping\n(cherry picked from commit 8676145eb2f53a9940ff70910caf0125bd8a4bc2)",
  "id": "CVE-2022-49963",
  "modified": "2025-10-15T00:35:52.624914Z",
  "published": "2025-06-18T11:00:24Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8d905254162965c8e6be697d82c7dbf5d08f574d"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/97434cb55bd884bd268626ec41489f79b261b2d4"
    }
  ],
  "related": [
    "SUSE-SU-2025:02264-1"
  ],
  "schema_version": "1.7.3",
  "summary": "drm/i915/ttm: fix CCS handling"
}