{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53342.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "125415619443699152488507661827950504893",
              "length": 196.0
            },
            "id": "CVE-2023-53342-051f2bc2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2aa71b4b294ee2c3041d085404cea914be9b3225",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "__prestera_fi_is_direct"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "42610866673326095883632236358152574814",
                "79639366740433378632710974809048211444",
                "107477347889864542679549786744116292525",
                "152938413656296693546382936951462769537",
                "67912754809689894765785693735007177530",
                "32878123670783123358671673462433930036",
                "275606721860341648391515111565015799839",
                "236016685423043292424968068328471563415",
                "14877907781490274517762319299092125212",
                "233700715023670787577014875298615246071",
                "18469318301198901951403637208844426513",
                "100526109812024344805652124735774860693",
                "16408464353539745513958087447340970920",
                "203444531753970493294875915718615538898",
                "109387485092797421075686453347559218167",
                "327369783117050570368006844865878538007",
                "6079524354734659277943023475475639073",
                "44362755643874194103498737635519104876",
                "227927371330825867582168510827302424776",
                "6317047935708945274285816527350224322"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53342-1f4cdbb8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8373dca3c1f8a203cecebe3421dbe890c4f08e16",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "51088341431445469088969835188196186997",
              "length": 632.0
            },
            "id": "CVE-2023-53342-205aa9b5",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2aa71b4b294ee2c3041d085404cea914be9b3225",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "prestera_kern_fib_info_nhc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "125415619443699152488507661827950504893",
              "length": 196.0
            },
            "id": "CVE-2023-53342-32d1e693",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3e5f3b7f25d7b90f3b76d98a946fec6e5f79216",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "__prestera_fi_is_direct"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "330176847720114907586813226152581695315",
              "length": 296.0
            },
            "id": "CVE-2023-53342-445b7ca2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8373dca3c1f8a203cecebe3421dbe890c4f08e16",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "__prestera_util_kern_n_is_reachable_v4"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "330176847720114907586813226152581695315",
              "length": 296.0
            },
            "id": "CVE-2023-53342-4c83fa8e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2aa71b4b294ee2c3041d085404cea914be9b3225",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "__prestera_util_kern_n_is_reachable_v4"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "330176847720114907586813226152581695315",
              "length": 296.0
            },
            "id": "CVE-2023-53342-5591957f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3e5f3b7f25d7b90f3b76d98a946fec6e5f79216",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "__prestera_util_kern_n_is_reachable_v4"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "42610866673326095883632236358152574814",
                "79639366740433378632710974809048211444",
                "107477347889864542679549786744116292525",
                "152938413656296693546382936951462769537",
                "67912754809689894765785693735007177530",
                "32878123670783123358671673462433930036",
                "275606721860341648391515111565015799839",
                "236016685423043292424968068328471563415",
                "14877907781490274517762319299092125212",
                "233700715023670787577014875298615246071",
                "18469318301198901951403637208844426513",
                "100526109812024344805652124735774860693",
                "16408464353539745513958087447340970920",
                "203444531753970493294875915718615538898",
                "109387485092797421075686453347559218167",
                "327369783117050570368006844865878538007",
                "6079524354734659277943023475475639073",
                "44362755643874194103498737635519104876",
                "227927371330825867582168510827302424776",
                "6317047935708945274285816527350224322"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53342-76141043",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2aa71b4b294ee2c3041d085404cea914be9b3225",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "125415619443699152488507661827950504893",
              "length": 196.0
            },
            "id": "CVE-2023-53342-821c4549",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8373dca3c1f8a203cecebe3421dbe890c4f08e16",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "__prestera_fi_is_direct"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "51088341431445469088969835188196186997",
              "length": 632.0
            },
            "id": "CVE-2023-53342-8a8914e9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8373dca3c1f8a203cecebe3421dbe890c4f08e16",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "prestera_kern_fib_info_nhc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "42610866673326095883632236358152574814",
                "79639366740433378632710974809048211444",
                "107477347889864542679549786744116292525",
                "152938413656296693546382936951462769537",
                "67912754809689894765785693735007177530",
                "32878123670783123358671673462433930036",
                "275606721860341648391515111565015799839",
                "236016685423043292424968068328471563415",
                "14877907781490274517762319299092125212",
                "233700715023670787577014875298615246071",
                "18469318301198901951403637208844426513",
                "100526109812024344805652124735774860693",
                "16408464353539745513958087447340970920",
                "203444531753970493294875915718615538898",
                "109387485092797421075686453347559218167",
                "327369783117050570368006844865878538007",
                "6079524354734659277943023475475639073",
                "44362755643874194103498737635519104876",
                "227927371330825867582168510827302424776",
                "6317047935708945274285816527350224322"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53342-b70ea3ac",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3e5f3b7f25d7b90f3b76d98a946fec6e5f79216",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "51088341431445469088969835188196186997",
              "length": 632.0
            },
            "id": "CVE-2023-53342-e1e26670",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3e5f3b7f25d7b90f3b76d98a946fec6e5f79216",
            "target": {
              "file": "drivers/net/ethernet/marvell/prestera/prestera_router.c",
              "function": "prestera_kern_fib_info_nhc"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "396b80cb5cc8006a488ea25ef84fae245dc1b43c"
            },
            {
              "fixed": "a3e5f3b7f25d7b90f3b76d98a946fec6e5f79216"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "396b80cb5cc8006a488ea25ef84fae245dc1b43c"
            },
            {
              "fixed": "8373dca3c1f8a203cecebe3421dbe890c4f08e16"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "396b80cb5cc8006a488ea25ef84fae245dc1b43c"
            },
            {
              "fixed": "2aa71b4b294ee2c3041d085404cea914be9b3225"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.0",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1",
        "v6.1.10",
        "v6.1.11",
        "v6.1.12",
        "v6.1.13",
        "v6.1.14",
        "v6.1.15",
        "v6.1.16",
        "v6.1.17",
        "v6.1.18",
        "v6.1.19",
        "v6.1.2",
        "v6.1.20",
        "v6.1.21",
        "v6.1.22",
        "v6.1.23",
        "v6.1.24",
        "v6.1.25",
        "v6.1.26",
        "v6.1.27",
        "v6.1.28",
        "v6.1.29",
        "v6.1.3",
        "v6.1.30",
        "v6.1.31",
        "v6.1.32",
        "v6.1.33",
        "v6.1.34",
        "v6.1.35",
        "v6.1.36",
        "v6.1.37",
        "v6.1.38",
        "v6.1.39",
        "v6.1.4",
        "v6.1.40",
        "v6.1.41",
        "v6.1.42",
        "v6.1.43",
        "v6.1.44",
        "v6.1.45",
        "v6.1.5",
        "v6.1.6",
        "v6.1.7",
        "v6.1.8",
        "v6.1.9",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.4.1",
        "v6.4.10",
        "v6.4.2",
        "v6.4.3",
        "v6.4.4",
        "v6.4.5",
        "v6.4.6",
        "v6.4.7",
        "v6.4.8",
        "v6.4.9",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53342.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.1.0"
            },
            {
              "fixed": "6.1.46"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.4.11"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: marvell: prestera: fix handling IPv4 routes with nhid\n\nFix handling IPv4 routes referencing a nexthop via its id by replacing\ncalls to fib_info_nh() with fib_info_nhc().\n\nTrying to add an IPv4 route referencing a nextop via nhid:\n\n    $ ip link set up swp5\n    $ ip a a 10.0.0.1/24 dev swp5\n    $ ip nexthop add dev swp5 id 20 via 10.0.0.2\n    $ ip route add 10.0.1.0/24 nhid 20\n\ntriggers warnings when trying to handle the route:\n\n[  528.805763] ------------[ cut here ]------------\n[  528.810437] WARNING: CPU: 3 PID: 53 at include/net/nexthop.h:468 __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.820434] Modules linked in: prestera_pci act_gact act_police sch_ingress cls_u32 cls_flower prestera arm64_delta_tn48m_dn_led(O) arm64_delta_tn48m_dn_cpld(O) [last unloaded: prestera_pci]\n[  528.837485] CPU: 3 PID: 53 Comm: kworker/u8:3 Tainted: G           O       6.4.5 #1\n[  528.845178] Hardware name: delta,tn48m-dn (DT)\n[  528.849641] Workqueue: prestera_ordered __prestera_router_fib_event_work [prestera]\n[  528.857352] pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[  528.864347] pc : __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.870135] lr : prestera_k_arb_fib_evt+0xb20/0xd50 [prestera]\n[  528.876007] sp : ffff80000b20bc90\n[  528.879336] x29: ffff80000b20bc90 x28: 0000000000000000 x27: ffff0001374d3a48\n[  528.886510] x26: ffff000105604000 x25: ffff000134af8a28 x24: ffff0001374d3800\n[  528.893683] x23: ffff000101c89148 x22: ffff000101c89000 x21: ffff000101c89200\n[  528.900855] x20: ffff00013641fda0 x19: ffff800009d01088 x18: 0000000000000059\n[  528.908027] x17: 0000000000000277 x16: 0000000000000000 x15: 0000000000000000\n[  528.915198] x14: 0000000000000003 x13: 00000000000fe400 x12: 0000000000000000\n[  528.922371] x11: 0000000000000002 x10: 0000000000000aa0 x9 : ffff8000013d2020\n[  528.929543] x8 : 0000000000000018 x7 : 000000007b1703f8 x6 : 000000001ca72f86\n[  528.936715] x5 : 0000000033399ea7 x4 : 0000000000000000 x3 : ffff0001374d3acc\n[  528.943886] x2 : 0000000000000000 x1 : ffff00010200de00 x0 : ffff000134ae3f80\n[  528.951058] Call trace:\n[  528.953516]  __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.958952]  __prestera_router_fib_event_work+0x100/0x158 [prestera]\n[  528.965348]  process_one_work+0x208/0x488\n[  528.969387]  worker_thread+0x4c/0x430\n[  528.973068]  kthread+0x120/0x138\n[  528.976313]  ret_from_fork+0x10/0x20\n[  528.979909] ---[ end trace 0000000000000000 ]---\n[  528.984998] ------------[ cut here ]------------\n[  528.989645] WARNING: CPU: 3 PID: 53 at include/net/nexthop.h:468 __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.999628] Modules linked in: prestera_pci act_gact act_police sch_ingress cls_u32 cls_flower prestera arm64_delta_tn48m_dn_led(O) arm64_delta_tn48m_dn_cpld(O) [last unloaded: prestera_pci]\n[  529.016676] CPU: 3 PID: 53 Comm: kworker/u8:3 Tainted: G        W  O       6.4.5 #1\n[  529.024368] Hardware name: delta,tn48m-dn (DT)\n[  529.028830] Workqueue: prestera_ordered __prestera_router_fib_event_work [prestera]\n[  529.036539] pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[  529.043533] pc : __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  529.049318] lr : __prestera_k_arb_fc_apply+0x280/0x2f8 [prestera]\n[  529.055452] sp : ffff80000b20bc60\n[  529.058781] x29: ffff80000b20bc60 x28: 0000000000000000 x27: ffff0001374d3a48\n[  529.065953] x26: ffff000105604000 x25: ffff000134af8a28 x24: ffff0001374d3800\n[  529.073126] x23: ffff000101c89148 x22: ffff000101c89148 x21: ffff00013641fda0\n[  529.080299] x20: ffff000101c89000 x19: ffff000101c89020 x18: 0000000000000059\n[  529.087471] x17: 0000000000000277 x16: 0000000000000000 x15: 0000000000000000\n[  529.094642] x14: 0000000000000003 x13: 00000000000fe400 x12: 0000000000000000\n[  529.101814] x11: 0000000000000002 x10: 0000000000000aa0 x9 : ffff8000013cee80\n[  529.108985] x8 : 0000000000000018 x7 : 000000007b1703f8 x6 \n---truncated---",
  "id": "CVE-2023-53342",
  "modified": "2025-10-21T14:26:40.342347Z",
  "published": "2025-09-17T14:56:35Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/2aa71b4b294ee2c3041d085404cea914be9b3225"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8373dca3c1f8a203cecebe3421dbe890c4f08e16"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/a3e5f3b7f25d7b90f3b76d98a946fec6e5f79216"
    }
  ],
  "related": [
    "SUSE-SU-2025:3751-1"
  ],
  "schema_version": "1.7.3",
  "summary": "net: marvell: prestera: fix handling IPv4 routes with nhid"
}