{"schema_version":"1.7.3","id":"CVE-2025-65953","published":"2025-11-25T23:13:09.619Z","modified":"2025-12-05T10:21:52.133090Z","aliases":["GHSA-r95p-wjm8-2qxr"],"summary":"NanoMQ UAF of retain message due to invalid MQTTV5 properties","details":"NanoMQ MQTT Broker (NanoMQ) is an all-around Edge Messaging Platform. Prior to version 0.22.5, a Heap-Use-After-Free (UAF) vulnerability exists in the TCP transport component of NanoMQ, which relies on the underlying NanoNNG library (specifically in src/sp/transport/mqtt/broker_tcp.c). The vulnerability is due to improper resource management and premature cleanup of message and pipe structures under specific malformed MQTTV5 retain message traffic conditions. This issue has been patched in version 0.22.5.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/nanomq/nanomq","events":[{"introduced":"0"},{"fixed":"6b0f5a8585098a13186d88b552d194aa4522e382"}],"database_specific":{"versions":[{"introduced":"0"},{"fixed":"0.22.5"}]}}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-65953.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/65xxx/CVE-2025-65953.json"},{"type":"ADVISORY","url":"https://github.com/nanomq/nanomq/security/advisories/GHSA-r95p-wjm8-2qxr"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-65953"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-416"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/65xxx/CVE-2025-65953.json"},"severity":[{"type":"CVSS_V4","score":"CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L"}]}