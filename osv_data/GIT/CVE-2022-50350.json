{"schema_version":"1.7.3","id":"CVE-2022-50350","published":"2025-09-16T16:11:42Z","modified":"2025-10-29T20:49:33.451534Z","summary":"scsi: target: iscsi: Fix a race condition between login_work and the login thread","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: target: iscsi: Fix a race condition between login_work and the login thread\n\nIn case a malicious initiator sends some random data immediately after a\nlogin PDU; the iscsi_target_sk_data_ready() callback will schedule the\nlogin_work and, at the same time, the negotiation may end without clearing\nthe LOGIN_FLAGS_INITIAL_PDU flag (because no additional PDU exchanges are\nrequired to complete the login).\n\nThe login has been completed but the login_work function will find the\nLOGIN_FLAGS_INITIAL_PDU flag set and will never stop from rescheduling\nitself; at this point, if the initiator drops the connection, the\niscsit_conn structure will be freed, login_work will dereference a released\nsocket structure and the kernel crashes.\n\nBUG: kernel NULL pointer dereference, address: 0000000000000230\nPF: supervisor write access in kernel mode\nPF: error_code(0x0002) - not-present page\nWorkqueue: events iscsi_target_do_login_rx [iscsi_target_mod]\nRIP: 0010:_raw_read_lock_bh+0x15/0x30\nCall trace:\n iscsi_target_do_login_rx+0x75/0x3f0 [iscsi_target_mod]\n process_one_work+0x1e8/0x3c0\n\nFix this bug by forcing login_work to stop after the login has been\ncompleted and the socket callbacks have been restored.\n\nAdd a comment to clearify the return values of iscsi_target_do_login()","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d381a8010a052813a88e20e089be4a58aad8b40a"},{"fixed":"1533b8b3058db618409f41554ebe768c2e3acfae"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d381a8010a052813a88e20e089be4a58aad8b40a"},{"fixed":"3ecdca49ca49d4770639d81503c873b6d25887c4"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d381a8010a052813a88e20e089be4a58aad8b40a"},{"fixed":"fec1b2fa62c162d03f5dcd7b03e3c89d3116d49f"}]}],"versions":["v3.11","v3.11-rc6","v3.11-rc7","v3.12","v3.12-rc1","v3.12-rc2","v3.12-rc3","v3.12-rc4","v3.12-rc5","v3.12-rc6","v3.12-rc7","v3.13","v3.13-rc1","v3.13-rc2","v3.13-rc3","v3.13-rc4","v3.13-rc5","v3.13-rc6","v3.13-rc7","v3.13-rc8","v3.14","v3.14-rc1","v3.14-rc2","v3.14-rc3","v3.14-rc4","v3.14-rc5","v3.14-rc6","v3.14-rc7","v3.14-rc8","v3.15","v3.15-rc1","v3.15-rc2","v3.15-rc3","v3.15-rc4","v3.15-rc5","v3.15-rc6","v3.15-rc7","v3.15-rc8","v3.16","v3.16-rc1","v3.16-rc2","v3.16-rc3","v3.16-rc4","v3.16-rc5","v3.16-rc6","v3.16-rc7","v3.17","v3.17-rc1","v3.17-rc2","v3.17-rc3","v3.17-rc4","v3.17-rc5","v3.17-rc6","v3.17-rc7","v3.18","v3.18-rc1","v3.18-rc2","v3.18-rc3","v3.18-rc4","v3.18-rc5","v3.18-rc6","v3.18-rc7","v3.19","v3.19-rc1","v3.19-rc2","v3.19-rc3","v3.19-rc4","v3.19-rc5","v3.19-rc6","v3.19-rc7","v4.0","v4.0-rc1","v4.0-rc2","v4.0-rc3","v4.0-rc4","v4.0-rc5","v4.0-rc6","v4.0-rc7","v4.1","v4.1-rc1","v4.1-rc2","v4.1-rc3","v4.1-rc4","v4.1-rc5","v4.1-rc6","v4.1-rc7","v4.1-rc8","v4.10","v4.10-rc1","v4.10-rc2","v4.10-rc3","v4.10-rc4","v4.10-rc5","v4.10-rc6","v4.10-rc7","v4.10-rc8","v4.11","v4.11-rc1","v4.11-rc2","v4.11-rc3","v4.11-rc4","v4.11-rc5","v4.11-rc6","v4.11-rc7","v4.11-rc8","v4.12","v4.12-rc1","v4.12-rc2","v4.12-rc3","v4.12-rc4","v4.12-rc5","v4.12-rc6","v4.12-rc7","v4.13","v4.13-rc1","v4.13-rc2","v4.13-rc3","v4.13-rc4","v4.13-rc5","v4.13-rc6","v4.13-rc7","v4.14","v4.14-rc1","v4.14-rc2","v4.14-rc3","v4.14-rc4","v4.14-rc5","v4.14-rc6","v4.14-rc7","v4.14-rc8","v4.15","v4.15-rc1","v4.15-rc2","v4.15-rc3","v4.15-rc4","v4.15-rc5","v4.15-rc6","v4.15-rc7","v4.15-rc8","v4.15-rc9","v4.16","v4.16-rc1","v4.16-rc2","v4.16-rc3","v4.16-rc4","v4.16-rc5","v4.16-rc6","v4.16-rc7","v4.17","v4.17-rc1","v4.17-rc2","v4.17-rc3","v4.17-rc4","v4.17-rc5","v4.17-rc6","v4.17-rc7","v4.18","v4.18-rc1","v4.18-rc2","v4.18-rc3","v4.18-rc4","v4.18-rc5","v4.18-rc6","v4.18-rc7","v4.18-rc8","v4.19","v4.19-rc1","v4.19-rc2","v4.19-rc3","v4.19-rc4","v4.19-rc5","v4.19-rc6","v4.19-rc7","v4.19-rc8","v4.2","v4.2-rc1","v4.2-rc2","v4.2-rc3","v4.2-rc4","v4.2-rc5","v4.2-rc6","v4.2-rc7","v4.2-rc8","v4.20","v4.20-rc1","v4.20-rc2","v4.20-rc3","v4.20-rc4","v4.20-rc5","v4.20-rc6","v4.20-rc7","v4.3","v4.3-rc1","v4.3-rc2","v4.3-rc3","v4.3-rc4","v4.3-rc5","v4.3-rc6","v4.3-rc7","v4.4","v4.4-rc1","v4.4-rc2","v4.4-rc3","v4.4-rc4","v4.4-rc5","v4.4-rc6","v4.4-rc7","v4.4-rc8","v4.5","v4.5-rc1","v4.5-rc2","v4.5-rc3","v4.5-rc4","v4.5-rc5","v4.5-rc6","v4.5-rc7","v4.6","v4.6-rc1","v4.6-rc2","v4.6-rc3","v4.6-rc4","v4.6-rc5","v4.6-rc6","v4.6-rc7","v4.7","v4.7-rc1","v4.7-rc2","v4.7-rc3","v4.7-rc4","v4.7-rc5","v4.7-rc6","v4.7-rc7","v4.8","v4.8-rc1","v4.8-rc2","v4.8-rc3","v4.8-rc4","v4.8-rc5","v4.8-rc6","v4.8-rc7","v4.8-rc8","v4.9","v4.9-rc1","v4.9-rc2","v4.9-rc3","v4.9-rc4","v4.9-rc5","v4.9-rc6","v4.9-rc7","v4.9-rc8","v5.0","v5.0-rc1","v5.0-rc2","v5.0-rc3","v5.0-rc4","v5.0-rc5","v5.0-rc6","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.10","v6.0.11","v6.0.12","v6.0.13","v6.0.14","v6.0.15","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.0.8","v6.0.9","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50350.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"130714081376393221196787292169163649219","length":586},"id":"CVE-2022-50350-1b88d8e1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fec1b2fa62c162d03f5dcd7b03e3c89d3116d49f","target":{"file":"drivers/target/iscsi/iscsi_target_nego.c","function":"iscsi_target_start_negotiation"}},{"deprecated":false,"digest":{"line_hashes":["322898389338357491427039394101353531282","104733041577982097237045874533481343350","109219420019576749951967268180900704964","135242393641879468792425061786405133118","31775253325106885440893642336877587794","65484671233516350789563403059586633798","219391327166372738071990949721946775893","35257796750099583273825549180428841290","224014370147309203628877795172767793972","279146534547552915287584311857706775946","324169864783635544354891489127490025441","74664803147995009715789297252573737634"],"threshold":0.9},"id":"CVE-2022-50350-43285e65","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1533b8b3058db618409f41554ebe768c2e3acfae","target":{"file":"drivers/target/iscsi/iscsi_target_nego.c"}},{"deprecated":false,"digest":{"line_hashes":["322898389338357491427039394101353531282","104733041577982097237045874533481343350","109219420019576749951967268180900704964","135242393641879468792425061786405133118","31775253325106885440893642336877587794","65484671233516350789563403059586633798","219391327166372738071990949721946775893","35257796750099583273825549180428841290","224014370147309203628877795172767793972","279146534547552915287584311857706775946","324169864783635544354891489127490025441","74664803147995009715789297252573737634"],"threshold":0.9},"id":"CVE-2022-50350-53453eb0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fec1b2fa62c162d03f5dcd7b03e3c89d3116d49f","target":{"file":"drivers/target/iscsi/iscsi_target_nego.c"}},{"deprecated":false,"digest":{"function_hash":"130714081376393221196787292169163649219","length":586},"id":"CVE-2022-50350-653a4b3f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1533b8b3058db618409f41554ebe768c2e3acfae","target":{"file":"drivers/target/iscsi/iscsi_target_nego.c","function":"iscsi_target_start_negotiation"}},{"deprecated":false,"digest":{"line_hashes":["322898389338357491427039394101353531282","104733041577982097237045874533481343350","109219420019576749951967268180900704964","135242393641879468792425061786405133118","31775253325106885440893642336877587794","65484671233516350789563403059586633798","219391327166372738071990949721946775893","35257796750099583273825549180428841290","224014370147309203628877795172767793972","279146534547552915287584311857706775946","324169864783635544354891489127490025441","74664803147995009715789297252573737634"],"threshold":0.9},"id":"CVE-2022-50350-7754ed11","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3ecdca49ca49d4770639d81503c873b6d25887c4","target":{"file":"drivers/target/iscsi/iscsi_target_nego.c"}},{"deprecated":false,"digest":{"function_hash":"130714081376393221196787292169163649219","length":586},"id":"CVE-2022-50350-bb8d7f74","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3ecdca49ca49d4770639d81503c873b6d25887c4","target":{"file":"drivers/target/iscsi/iscsi_target_nego.c","function":"iscsi_target_start_negotiation"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"3.12.0"},{"fixed":"6.0.16"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.1.0"},{"fixed":"6.1.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50350.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1533b8b3058db618409f41554ebe768c2e3acfae"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3ecdca49ca49d4770639d81503c873b6d25887c4"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fec1b2fa62c162d03f5dcd7b03e3c89d3116d49f"}]}