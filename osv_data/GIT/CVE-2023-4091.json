{"schema_version":"1.7.3","id":"CVE-2023-4091","published":"2023-11-03T08:15:08.197Z","modified":"2025-11-20T12:19:49.845223Z","related":["ALSA-2023:6744","ALSA-2023:7467","MGASA-2023-0340","SUSE-SU-2023:4040-1","SUSE-SU-2023:4046-1","SUSE-SU-2023:4059-1","SUSE-SU-2023:4096-1","USN-6425-3","openSUSE-SU-2024:13332-1"],"details":"A vulnerability was discovered in Samba, where the flaw allows SMB clients to truncate files, even with read-only permissions when the Samba VFS module \"acl_xattr\" is configured with \"acl_xattr:ignore system acls = yes\". The SMB protocol allows opening files when the client requests read-only access but then implicitly truncates the opened file to 0 bytes if the client specifies a separate OVERWRITE create disposition request. The issue arises in configurations that bypass kernel file system permissions checks, relying solely on Samba's permissions.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/samba-team/samba","events":[{"introduced":"0"},{"fixed":"7ec207cd4146919e4ee88e5522647c169baf6922"}]}],"versions":["ldb-1.1.0","ldb-1.1.10","ldb-1.1.11","ldb-1.1.12","ldb-1.1.13","ldb-1.1.14","ldb-1.1.15","ldb-1.1.16","ldb-1.1.17","ldb-1.1.18","ldb-1.1.19","ldb-1.1.2","ldb-1.1.20","ldb-1.1.21","ldb-1.1.22","ldb-1.1.23","ldb-1.1.24","ldb-1.1.25","ldb-1.1.26","ldb-1.1.27","ldb-1.1.28","ldb-1.1.29","ldb-1.1.3","ldb-1.1.30","ldb-1.1.31","ldb-1.1.4","ldb-1.1.5","ldb-1.1.6","ldb-1.1.8","ldb-1.1.9","ldb-1.2.0","ldb-1.2.1","ldb-1.2.2","ldb-1.3.0","ldb-1.3.1","ldb-1.3.2","ldb-1.4.0","ldb-1.4.1","ldb-1.5.0","ldb-1.5.1","ldb-1.5.2","ldb-1.6.1","ldb-1.6.2","ldb-1.6.3","ldb-2.0.5","ldb-2.1.0","ldb-2.1.1","ldb-2.2.0","ldb-2.4.0","ldb-2.5.0","ldb-2.6.0","ldb-2.6.1","ldb-2.6.2","samba-4.0.0alpha10","samba-4.0.0alpha11","samba-4.0.0alpha13","samba-4.0.0alpha14","samba-4.0.0alpha15","samba-4.0.0alpha16","samba-4.0.0alpha17","samba-4.0.0alpha18","samba-4.0.0alpha19","samba-4.0.0alpha20","samba-4.0.0alpha21","samba-4.0.0alpha6","samba-4.0.0alpha7","samba-4.0.0alpha8","samba-4.0.0alpha9","samba-4.0.0beta1","samba-4.0.0beta2","samba-4.0.0beta3","samba-4.0.0beta4","samba-4.0.0beta5","samba-4.0.0beta6","samba-4.0.0beta7","samba-4.0.0beta8","samba-4.0.0rc1","samba-4.10.0rc1","samba-4.11.0rc1","samba-4.12.0rc1","samba-4.13.0rc1","samba-4.14.0rc1","samba-4.15.0rc1","samba-4.16.0rc1","samba-4.17.0","samba-4.17.0rc1","samba-4.17.0rc2","samba-4.17.0rc3","samba-4.17.0rc4","samba-4.17.0rc5","samba-4.17.1","samba-4.17.10","samba-4.17.11","samba-4.17.2","samba-4.17.3","samba-4.17.4","samba-4.17.5","samba-4.17.6","samba-4.17.7","samba-4.17.8","samba-4.17.9","samba-4.2.0rc1","samba-4.3.0rc1","samba-4.4.0rc1","samba-4.5.0rc1","samba-4.6.0rc1","samba-4.7.0rc1","samba-4.8.0rc1","samba-4.9.0rc1","talloc-1.3.1","talloc-2.0.0","talloc-2.0.1","talloc-2.0.7","talloc-2.0.8","talloc-2.1.0","talloc-2.1.1","talloc-2.1.10","talloc-2.1.11","talloc-2.1.12","talloc-2.1.13","talloc-2.1.14","talloc-2.1.15","talloc-2.1.16","talloc-2.1.2","talloc-2.1.3","talloc-2.1.4","talloc-2.1.5","talloc-2.1.6","talloc-2.1.7","talloc-2.1.8","talloc-2.1.9","talloc-2.2.0","talloc-2.3.0","talloc-2.3.1","talloc-2.3.2","talloc-2.3.3","talloc-2.3.4","tdb-1.1.5","tdb-1.2.0","tdb-1.2.1","tdb-1.2.10","tdb-1.2.11","tdb-1.2.12","tdb-1.2.13","tdb-1.3.0","tdb-1.3.1","tdb-1.3.10","tdb-1.3.11","tdb-1.3.12","tdb-1.3.13","tdb-1.3.14","tdb-1.3.15","tdb-1.3.16","tdb-1.3.17","tdb-1.3.18","tdb-1.3.2","tdb-1.3.3","tdb-1.3.4","tdb-1.3.5","tdb-1.3.6","tdb-1.3.7","tdb-1.3.8","tdb-1.3.9","tdb-1.4.0","tdb-1.4.1","tdb-1.4.2","tdb-1.4.3","tdb-1.4.4","tdb-1.4.5","tdb-1.4.6","tdb-1.4.7","tevent-0.10.0","tevent-0.10.1","tevent-0.10.2","tevent-0.11.0","tevent-0.12.0","tevent-0.12.1","tevent-0.13.0","tevent-0.9.11","tevent-0.9.12","tevent-0.9.13","tevent-0.9.14","tevent-0.9.15","tevent-0.9.16","tevent-0.9.17","tevent-0.9.18","tevent-0.9.19","tevent-0.9.20","tevent-0.9.21","tevent-0.9.22","tevent-0.9.23","tevent-0.9.24","tevent-0.9.25","tevent-0.9.26","tevent-0.9.27","tevent-0.9.28","tevent-0.9.29","tevent-0.9.30","tevent-0.9.31","tevent-0.9.32","tevent-0.9.33","tevent-0.9.34","tevent-0.9.35","tevent-0.9.36","tevent-0.9.37","tevent-0.9.38","tevent-0.9.39","tevent-0.9.8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-4091.json"}}],"references":[{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2024/04/msg00015.html"},{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZUMVALLFFDFC53JZMUWA6HPD7HUGAP5I/"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2023:6209"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2023:6744"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2023:7371"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2023:7408"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2023:7464"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2023:7467"},{"type":"ADVISORY","url":"https://access.redhat.com/security/cve/CVE-2023-4091"},{"type":"ADVISORY","url":"https://www.samba.org/samba/security/CVE-2023-4091.html"},{"type":"ADVISORY","url":"https://security.netapp.com/advisory/ntap-20231124-0002/"},{"type":"REPORT","url":"https://bugzilla.redhat.com/show_bug.cgi?id=2241882"},{"type":"REPORT","url":"https://bugzilla.samba.org/show_bug.cgi?id=15439"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"}]}