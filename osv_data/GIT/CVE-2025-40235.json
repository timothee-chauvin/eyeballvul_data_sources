{"schema_version":"1.7.3","id":"CVE-2025-40235","published":"2025-12-04T15:31:25.785Z","modified":"2025-12-05T12:32:30.278834Z","summary":"btrfs: directly free partially initialized fs_info in btrfs_check_leaked_roots()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: directly free partially initialized fs_info in btrfs_check_leaked_roots()\n\nIf fs_info->super_copy or fs_info->super_for_commit allocated failed in\nbtrfs_get_tree_subvol(), then no need to call btrfs_free_fs_info().\nOtherwise btrfs_check_leaked_roots() would access NULL pointer because\nfs_info->allocated_roots had not been initialised.\n\nsyzkaller reported the following information:\n  ------------[ cut here ]------------\n  BUG: unable to handle page fault for address: fffffffffffffbb0\n  #PF: supervisor read access in kernel mode\n  #PF: error_code(0x0000) - not-present page\n  PGD 64c9067 P4D 64c9067 PUD 64cb067 PMD 0\n  Oops: Oops: 0000 [#1] SMP KASAN PTI\n  CPU: 0 UID: 0 PID: 1402 Comm: syz.1.35 Not tainted 6.15.8 #4 PREEMPT(lazy)\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), (...)\n  RIP: 0010:arch_atomic_read arch/x86/include/asm/atomic.h:23 [inline]\n  RIP: 0010:raw_atomic_read include/linux/atomic/atomic-arch-fallback.h:457 [inline]\n  RIP: 0010:atomic_read include/linux/atomic/atomic-instrumented.h:33 [inline]\n  RIP: 0010:refcount_read include/linux/refcount.h:170 [inline]\n  RIP: 0010:btrfs_check_leaked_roots+0x18f/0x2c0 fs/btrfs/disk-io.c:1230\n  [...]\n  Call Trace:\n   <TASK>\n   btrfs_free_fs_info+0x310/0x410 fs/btrfs/disk-io.c:1280\n   btrfs_get_tree_subvol+0x592/0x6b0 fs/btrfs/super.c:2029\n   btrfs_get_tree+0x63/0x80 fs/btrfs/super.c:2097\n   vfs_get_tree+0x98/0x320 fs/super.c:1759\n   do_new_mount+0x357/0x660 fs/namespace.c:3899\n   path_mount+0x716/0x19c0 fs/namespace.c:4226\n   do_mount fs/namespace.c:4239 [inline]\n   __do_sys_mount fs/namespace.c:4450 [inline]\n   __se_sys_mount fs/namespace.c:4427 [inline]\n   __x64_sys_mount+0x28c/0x310 fs/namespace.c:4427\n   do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n   do_syscall_64+0x92/0x180 arch/x86/entry/syscall_64.c:94\n   entry_SYSCALL_64_after_hwframe+0x76/0x7e\n  RIP: 0033:0x7f032eaffa8d\n  [...]","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3bb17a25bcb09abbd667c6ac86c7c9109ae82bcd"},{"fixed":"b1c2b4e6ffd307720ab6ce42f6749b0c02ba0a73"},{"fixed":"0c2b2d4d053e9840e6da6ed581befa20309f281a"},{"fixed":"17679ac6df6c4830ba711835aa8cf961be36cfa1"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.35","v6.12.36","v6.12.37","v6.12.38","v6.12.39","v6.12.4","v6.12.40","v6.12.41","v6.12.42","v6.12.43","v6.12.44","v6.12.45","v6.12.46","v6.12.47","v6.12.48","v6.12.49","v6.12.5","v6.12.50","v6.12.51","v6.12.52","v6.12.53","v6.12.54","v6.12.55","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.17.3","v6.17.4","v6.17.5","v6.7","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40235.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.12.56"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.17.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40235.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0c2b2d4d053e9840e6da6ed581befa20309f281a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/17679ac6df6c4830ba711835aa8cf961be36cfa1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b1c2b4e6ffd307720ab6ce42f6749b0c02ba0a73"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/40xxx/CVE-2025-40235.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-40235"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/40xxx/CVE-2025-40235.json"}}