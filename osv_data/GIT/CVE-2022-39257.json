{
  "id": "CVE-2022-39257",
  "details": "Matrix iOS SDK allows developers to build iOS apps compatible with Matrix. Prior to version 0.23.19, an attacker cooperating with a malicious homeserver can construct messages appearing to have come from another person. Such messages will be marked with a grey shield on some platforms, but this may be missing in others. This attack is possible due to the matrix-ios-sdk implementing a too permissive key forwarding strategy. The default policy for accepting key forwards has been made more strict in the matrix-ios-sdk version 0.23.19. matrix-ios-sdk will now only accept forwarded keys in response to previously issued requests and only from own, verified devices. The SDK now sets a `trusted` flag on the decrypted message upon decryption, based on whether the key used to decrypt the message was received from a trusted source. Clients need to ensure that messages decrypted with a key with `trusted = false` are decorated appropriately (for example, by showing a warning for such messages). This attack requires coordination between a malicious home server and an attacker, so those who trust their home servers do not need a workaround.",
  "modified": "2025-01-15T02:34:29.009217Z",
  "published": "2022-09-28T21:15:14Z",
  "related": [
    "GHSA-qxr3-5jmq-xcf4"
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/matrix-org/matrix-ios-sdk/security/advisories/GHSA-qxr3-5jmq-xcf4"
    },
    {
      "type": "ADVISORY",
      "url": "https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients"
    },
    {
      "type": "FIX",
      "url": "https://github.com/matrix-org/matrix-ios-sdk/commit/5ca86c328a5faaab429c240551cb9ca8f0f6262c"
    },
    {
      "type": "WEB",
      "url": "https://github.com/matrix-org/matrix-ios-sdk/releases/tag/v0.23.19"
    }
  ],
  "affected": [
    {
      "ranges": [
        {
          "type": "GIT",
          "repo": "https://github.com/matrix-org/matrix-ios-sdk",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5ca86c328a5faaab429c240551cb9ca8f0f6262c"
            },
            {
              "fixed": "5ca86c328a5faaab429c240551cb9ca8f0f6262c"
            }
          ]
        }
      ],
      "versions": [
        "before_privacy_merge",
        "v0.1.0",
        "v0.10.0",
        "v0.10.1",
        "v0.10.10",
        "v0.10.11",
        "v0.10.12",
        "v0.10.3",
        "v0.10.4",
        "v0.10.5",
        "v0.10.6",
        "v0.10.7",
        "v0.10.8",
        "v0.10.9",
        "v0.11.0",
        "v0.11.1",
        "v0.11.2",
        "v0.11.3",
        "v0.11.4",
        "v0.11.5",
        "v0.11.6",
        "v0.12.0",
        "v0.12.1",
        "v0.12.2",
        "v0.12.3",
        "v0.12.4",
        "v0.12.5",
        "v0.13.0",
        "v0.13.1",
        "v0.14.0",
        "v0.15.0",
        "v0.15.1",
        "v0.15.2",
        "v0.16.0",
        "v0.16.1",
        "v0.16.10",
        "v0.16.11",
        "v0.16.12",
        "v0.16.13",
        "v0.16.14",
        "v0.16.15",
        "v0.16.16",
        "v0.16.17",
        "v0.16.18",
        "v0.16.19",
        "v0.16.2",
        "v0.16.20",
        "v0.16.3",
        "v0.16.4",
        "v0.16.5",
        "v0.16.6",
        "v0.16.7",
        "v0.16.8",
        "v0.16.9",
        "v0.17.0",
        "v0.17.1",
        "v0.17.10",
        "v0.17.11",
        "v0.17.2",
        "v0.17.3",
        "v0.17.4",
        "v0.17.5",
        "v0.17.6",
        "v0.17.7",
        "v0.17.8",
        "v0.17.9",
        "v0.18.0",
        "v0.18.1",
        "v0.18.10",
        "v0.18.11",
        "v0.18.12",
        "v0.18.2",
        "v0.18.3",
        "v0.18.4",
        "v0.18.5",
        "v0.18.6",
        "v0.18.7",
        "v0.18.8",
        "v0.18.9",
        "v0.19.0",
        "v0.19.1",
        "v0.19.2",
        "v0.19.3",
        "v0.19.4",
        "v0.19.5",
        "v0.19.6",
        "v0.19.7",
        "v0.19.8",
        "v0.2.0",
        "v0.2.1",
        "v0.2.2",
        "v0.20.0",
        "v0.20.1",
        "v0.20.10",
        "v0.20.11",
        "v0.20.12",
        "v0.20.13",
        "v0.20.14",
        "v0.20.15",
        "v0.20.16",
        "v0.20.2",
        "v0.20.3",
        "v0.20.4",
        "v0.20.5",
        "v0.20.6",
        "v0.20.7",
        "v0.20.8",
        "v0.20.9",
        "v0.21.0",
        "v0.22.0",
        "v0.22.1",
        "v0.22.2",
        "v0.22.3",
        "v0.22.4",
        "v0.22.5",
        "v0.22.6",
        "v0.23.0",
        "v0.23.1",
        "v0.23.10",
        "v0.23.11",
        "v0.23.12",
        "v0.23.13",
        "v0.23.14",
        "v0.23.15",
        "v0.23.16",
        "v0.23.17",
        "v0.23.18",
        "v0.23.2",
        "v0.23.3",
        "v0.23.4",
        "v0.23.5",
        "v0.23.6",
        "v0.23.7",
        "v0.23.8",
        "v0.23.9",
        "v0.3.0",
        "v0.3.1",
        "v0.3.1-r1",
        "v0.3.2",
        "v0.4.0",
        "v0.5.0",
        "v0.5.1",
        "v0.5.2",
        "v0.5.3",
        "v0.5.4",
        "v0.5.5",
        "v0.5.6",
        "v0.5.7",
        "v0.6.0",
        "v0.6.1",
        "v0.6.10",
        "v0.6.11",
        "v0.6.12",
        "v0.6.13",
        "v0.6.14",
        "v0.6.15",
        "v0.6.16",
        "v0.6.17",
        "v0.6.2",
        "v0.6.3",
        "v0.6.4",
        "v0.6.5",
        "v0.6.6",
        "v0.6.7",
        "v0.6.8",
        "v0.6.9",
        "v0.7.0",
        "v0.7.1",
        "v0.7.10",
        "v0.7.11",
        "v0.7.2",
        "v0.7.3",
        "v0.7.4",
        "v0.7.5",
        "v0.7.6",
        "v0.7.7",
        "v0.7.8",
        "v0.7.9",
        "v0.8.0",
        "v0.8.1",
        "v0.8.2",
        "v0.9.0",
        "v0.9.1",
        "v0.9.2",
        "v0.9.3"
      ],
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-39257.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
    }
  ]
}