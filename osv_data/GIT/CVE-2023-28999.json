{"schema_version":"1.7.3","id":"CVE-2023-28999","published":"2023-04-04T12:51:08.241Z","modified":"2025-11-28T11:35:00.409794Z","aliases":["GHSA-8875-wxww-3rr8"],"summary":"Nextcloud: Lack of authenticity of metadata keys allows a malicious server to gain access to E2EE folders","details":"Nextcloud is an open-source productivity platform. In Nextcloud Desktop client 3.0.0 until 3.8.0, Nextcloud Android app 3.13.0 until 3.25.0, and Nextcloud iOS app 3.0.5 until 4.8.0, a malicious server administrator can gain full access to an end-to-end encrypted folder. They can decrypt files, recover the folder structure and add new files.â€‹ This issue is fixed in Nextcloud Desktop 3.8.0, Nextcloud Android 3.25.0, and Nextcloud iOS 4.8.0. No known workarounds are available.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/nextcloud/android","events":[{"introduced":"9f2489c61e5da69fd8b9b515ad1a885d0b433672"},{"fixed":"2eebcd636d195056f41cacf08213d7321764c88f"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-28999.json"}},{"ranges":[{"type":"GIT","repo":"https://github.com/nextcloud/desktop","events":[{"introduced":"ff175088a391007b66bfca89ef35cf29e37cf001"},{"fixed":"b15f9376b2761b7dd9726aa3a110b1077ef57094"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-28999.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"101649583395170060309763545000262885430","length":1163},"id":"CVE-2023-28999-3f19e2b9","signature_type":"Function","signature_version":"v1","source":"https://github.com/nextcloud/desktop/commit/b15f9376b2761b7dd9726aa3a110b1077ef57094","target":{"file":"src/libsync/vfs/cfapi/hydrationjob.cpp","function":"OCC::HydrationJob::slotCheckFolderEncryptedMetadata"}},{"deprecated":false,"digest":{"line_hashes":["226972522689971151640741611966896760315","6761838625930364135452577204500142493","323669476810890076709762257632198786258","95887726979464850580531724852363227229"],"threshold":0.9},"id":"CVE-2023-28999-9075e7af","signature_type":"Line","signature_version":"v1","source":"https://github.com/nextcloud/desktop/commit/b15f9376b2761b7dd9726aa3a110b1077ef57094","target":{"file":"src/libsync/vfs/cfapi/vfs_cfapi.cpp"}},{"deprecated":false,"digest":{"line_hashes":["184768993908712843135059723499629664191","263677768931353285972848147053892066026","17820304022799912052226267570635727754","247028315761105296216753869082916283057","319535011696866341067214169084501544005","292697869727850455733347997137348214683","8399253846568777635206679802043293474","142788300903851892392876694930015003353","167288391152401584260673006011530660946","276384299447226568337644657957432986217"],"threshold":0.9},"id":"CVE-2023-28999-9fddbf04","signature_type":"Line","signature_version":"v1","source":"https://github.com/nextcloud/desktop/commit/b15f9376b2761b7dd9726aa3a110b1077ef57094","target":{"file":"src/libsync/clientsideencryption.cpp"}},{"deprecated":false,"digest":{"line_hashes":["157470299154970211748345832830191459969","189283325233178648012609185252195439590","40148955164420873735148142005907145131","227522160379164553196595713112759768916"],"threshold":0.9},"id":"CVE-2023-28999-bedc4517","signature_type":"Line","signature_version":"v1","source":"https://github.com/nextcloud/desktop/commit/b15f9376b2761b7dd9726aa3a110b1077ef57094","target":{"file":"src/libsync/vfs/cfapi/hydrationjob.cpp"}},{"deprecated":false,"digest":{"function_hash":"174592396439734652915231344929463948220","length":1135},"id":"CVE-2023-28999-dcf1eb19","signature_type":"Function","signature_version":"v1","source":"https://github.com/nextcloud/desktop/commit/b15f9376b2761b7dd9726aa3a110b1077ef57094","target":{"file":"src/libsync/vfs/cfapi/vfs_cfapi.cpp","function":"VfsCfApi::scheduleHydrationJob"}}]}},{"ranges":[{"type":"GIT","repo":"https://github.com/nextcloud/ios","events":[{"introduced":"3f03074d8f5060733256281d063db9e2cbc43552"},{"fixed":"206f5d46966c0504e199307477d8ee759faa6607"}]}],"versions":["3.0.10","3.0.11","3.0.12","3.0.13","3.0.14","3.0.15","3.1.0","3.2.0","3.3.0","3.4.0","3.4.1","3.4.2","3.4.3","3.4.4","3.4.5","4.0.0","4.0.1","4.0.2","4.0.3","4.0.4","4.0.5","4.0.6","4.1.0","4.2.0","4.2.1","4.2.2","4.3.0","4.3.1","4.4.0","4.4.1","4.4.2","4.4.3","4.4.4","4.5.0","4.5.1","4.5.2","4.5.3","4.5.4","4.5.5","4.5.6","4.5.7","4.6.0","4.7.0","v3.0.5","v3.0.6","v3.0.7","v3.0.8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-28999.json"}}],"references":[{"type":"WEB","url":"https://ethz.ch/content/dam/ethz/special-interest/infk/inst-infsec/appliedcrypto/education/theses/report_DanieleCoppola.pdf"},{"type":"FIX","url":"https://github.com/nextcloud/desktop/pull/5560"},{"type":"ADVISORY","url":"https://github.com/nextcloud/security-advisories/security/advisories/GHSA-8875-wxww-3rr8"}],"database_specific":{"cwe_ids":["CWE-325"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:P/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:L"}]}