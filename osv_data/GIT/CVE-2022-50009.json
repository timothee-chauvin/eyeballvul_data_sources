{"schema_version":"1.7.3","id":"CVE-2022-50009","published":"2025-06-18T11:01:14Z","modified":"2025-10-21T12:05:09.110830Z","summary":"f2fs: fix null-ptr-deref in f2fs_get_dnode_of_data","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix null-ptr-deref in f2fs_get_dnode_of_data\n\nThere is issue as follows when test f2fs atomic write:\nF2FS-fs (loop0): Can't find valid F2FS filesystem in 2th superblock\nF2FS-fs (loop0): invalid crc_offset: 0\nF2FS-fs (loop0): f2fs_check_nid_range: out-of-range nid=1, run fsck to fix.\nF2FS-fs (loop0): f2fs_check_nid_range: out-of-range nid=2, run fsck to fix.\n==================================================================\nBUG: KASAN: null-ptr-deref in f2fs_get_dnode_of_data+0xac/0x16d0\nRead of size 8 at addr 0000000000000028 by task rep/1990\n\nCPU: 4 PID: 1990 Comm: rep Not tainted 5.19.0-rc6-next-20220715 #266\nCall Trace:\n <TASK>\n dump_stack_lvl+0x6e/0x91\n print_report.cold+0x49a/0x6bb\n kasan_report+0xa8/0x130\n f2fs_get_dnode_of_data+0xac/0x16d0\n f2fs_do_write_data_page+0x2a5/0x1030\n move_data_page+0x3c5/0xdf0\n do_garbage_collect+0x2015/0x36c0\n f2fs_gc+0x554/0x1d30\n f2fs_balance_fs+0x7f5/0xda0\n f2fs_write_single_data_page+0xb66/0xdc0\n f2fs_write_cache_pages+0x716/0x1420\n f2fs_write_data_pages+0x84f/0x9a0\n do_writepages+0x130/0x3a0\n filemap_fdatawrite_wbc+0x87/0xa0\n file_write_and_wait_range+0x157/0x1c0\n f2fs_do_sync_file+0x206/0x12d0\n f2fs_sync_file+0x99/0xc0\n vfs_fsync_range+0x75/0x140\n f2fs_file_write_iter+0xd7b/0x1850\n vfs_write+0x645/0x780\n ksys_write+0xf1/0x1e0\n do_syscall_64+0x3b/0x90\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nAs 3db1de0e582c commit changed atomic write way which new a cow_inode for\natomic write file, and also mark cow_inode as FI_ATOMIC_FILE.\nWhen f2fs_do_write_data_page write cow_inode will use cow_inode's cow_inode\nwhich is NULL. Then will trigger null-ptr-deref.\nTo solve above issue, introduce FI_COW_FILE flag for COW inode.\n\nFiexes: 3db1de0e582c(\"f2fs: change the current atomic write way\")","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"98e4da8ca301e062d79ae168c67e56f3c3de3ce4"},{"fixed":"0f63e33eca6fa29a11c76fa31db5fe1cada5ad6e"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"98e4da8ca301e062d79ae168c67e56f3c3de3ce4"},{"fixed":"7000ad53ec1b17bd2fac76984b7b0c663755cbb7"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"98e4da8ca301e062d79ae168c67e56f3c3de3ce4"},{"fixed":"4a2c5b7994960fac29cf8a3f4e62855bae1b27d4"}]}],"versions":["v3.10","v3.10-rc1","v3.10-rc2","v3.10-rc3","v3.10-rc4","v3.10-rc5","v3.10-rc6","v3.10-rc7","v3.11","v3.11-rc1","v3.11-rc2","v3.11-rc3","v3.11-rc4","v3.11-rc5","v3.11-rc6","v3.11-rc7","v3.12","v3.12-rc1","v3.12-rc2","v3.12-rc3","v3.12-rc4","v3.12-rc5","v3.12-rc6","v3.12-rc7","v3.13","v3.13-rc1","v3.13-rc2","v3.13-rc3","v3.13-rc4","v3.13-rc5","v3.13-rc6","v3.13-rc7","v3.13-rc8","v3.14","v3.14-rc1","v3.14-rc2","v3.14-rc3","v3.14-rc4","v3.14-rc5","v3.14-rc6","v3.14-rc7","v3.14-rc8","v3.15","v3.15-rc1","v3.15-rc2","v3.15-rc3","v3.15-rc4","v3.15-rc5","v3.15-rc6","v3.15-rc7","v3.15-rc8","v3.16","v3.16-rc1","v3.16-rc2","v3.16-rc3","v3.16-rc4","v3.16-rc5","v3.16-rc6","v3.16-rc7","v3.17","v3.17-rc1","v3.17-rc2","v3.17-rc3","v3.17-rc4","v3.17-rc5","v3.17-rc6","v3.17-rc7","v3.18","v3.18-rc1","v3.18-rc2","v3.18-rc3","v3.18-rc4","v3.18-rc5","v3.18-rc6","v3.18-rc7","v3.19","v3.19-rc1","v3.19-rc2","v3.19-rc3","v3.19-rc4","v3.19-rc5","v3.19-rc6","v3.19-rc7","v3.8","v3.8-rc1","v3.8-rc2","v3.8-rc3","v3.8-rc4","v3.8-rc5","v3.8-rc6","v3.8-rc7","v3.9","v3.9-rc1","v3.9-rc2","v3.9-rc3","v3.9-rc4","v3.9-rc5","v3.9-rc6","v3.9-rc7","v3.9-rc8","v4.0","v4.0-rc1","v4.0-rc2","v4.0-rc3","v4.0-rc4","v4.0-rc5","v4.0-rc6","v4.0-rc7","v4.1","v4.1-rc1","v4.1-rc2","v4.1-rc3","v4.1-rc4","v4.1-rc5","v4.1-rc6","v4.1-rc7","v4.1-rc8","v4.10","v4.10-rc1","v4.10-rc2","v4.10-rc3","v4.10-rc4","v4.10-rc5","v4.10-rc6","v4.10-rc7","v4.10-rc8","v4.11","v4.11-rc1","v4.11-rc2","v4.11-rc3","v4.11-rc4","v4.11-rc5","v4.11-rc6","v4.11-rc7","v4.11-rc8","v4.12","v4.12-rc1","v4.12-rc2","v4.12-rc3","v4.12-rc4","v4.12-rc5","v4.12-rc6","v4.12-rc7","v4.13","v4.13-rc1","v4.13-rc2","v4.13-rc3","v4.13-rc4","v4.13-rc5","v4.13-rc6","v4.13-rc7","v4.14","v4.14-rc1","v4.14-rc2","v4.14-rc3","v4.14-rc4","v4.14-rc5","v4.14-rc6","v4.14-rc7","v4.14-rc8","v4.15","v4.15-rc1","v4.15-rc2","v4.15-rc3","v4.15-rc4","v4.15-rc5","v4.15-rc6","v4.15-rc7","v4.15-rc8","v4.15-rc9","v4.16","v4.16-rc1","v4.16-rc2","v4.16-rc3","v4.16-rc4","v4.16-rc5","v4.16-rc6","v4.16-rc7","v4.17","v4.17-rc1","v4.17-rc2","v4.17-rc3","v4.17-rc4","v4.17-rc5","v4.17-rc6","v4.17-rc7","v4.18","v4.18-rc1","v4.18-rc2","v4.18-rc3","v4.18-rc4","v4.18-rc5","v4.18-rc6","v4.18-rc7","v4.18-rc8","v4.19","v4.19-rc1","v4.19-rc2","v4.19-rc3","v4.19-rc4","v4.19-rc5","v4.19-rc6","v4.19-rc7","v4.19-rc8","v4.2","v4.2-rc1","v4.2-rc2","v4.2-rc3","v4.2-rc4","v4.2-rc5","v4.2-rc6","v4.2-rc7","v4.2-rc8","v4.20","v4.20-rc1","v4.20-rc2","v4.20-rc3","v4.20-rc4","v4.20-rc5","v4.20-rc6","v4.20-rc7","v4.3","v4.3-rc1","v4.3-rc2","v4.3-rc3","v4.3-rc4","v4.3-rc5","v4.3-rc6","v4.3-rc7","v4.4","v4.4-rc1","v4.4-rc2","v4.4-rc3","v4.4-rc4","v4.4-rc5","v4.4-rc6","v4.4-rc7","v4.4-rc8","v4.5","v4.5-rc1","v4.5-rc2","v4.5-rc3","v4.5-rc4","v4.5-rc5","v4.5-rc6","v4.5-rc7","v4.6","v4.6-rc1","v4.6-rc2","v4.6-rc3","v4.6-rc4","v4.6-rc5","v4.6-rc6","v4.6-rc7","v4.7","v4.7-rc1","v4.7-rc2","v4.7-rc3","v4.7-rc4","v4.7-rc5","v4.7-rc6","v4.7-rc7","v4.8","v4.8-rc1","v4.8-rc2","v4.8-rc3","v4.8-rc4","v4.8-rc5","v4.8-rc6","v4.8-rc7","v4.8-rc8","v4.9","v4.9-rc1","v4.9-rc2","v4.9-rc3","v4.9-rc4","v4.9-rc5","v4.9-rc6","v4.9-rc7","v4.9-rc8","v5.0","v5.0-rc1","v5.0-rc2","v5.0-rc3","v5.0-rc4","v5.0-rc5","v5.0-rc6","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.18.1","v5.18.10","v5.18.11","v5.18.12","v5.18.13","v5.18.14","v5.18.15","v5.18.16","v5.18.17","v5.18.2","v5.18.3","v5.18.4","v5.18.5","v5.18.6","v5.18.7","v5.18.8","v5.18.9","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.19.1","v5.19.2","v5.19.3","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50009.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["25593255481040154744912085493675964950","26520933438006687739528809850265428973","310030670049796197445716099789385520541","284699181327405451815333123515588719861","143229611411159083791806583523661445261","33592010771463352033498234639412406467","182643946203089148359631362132071784857","12419386625540323522887944424400695401"],"threshold":0.9},"id":"CVE-2022-50009-0a1d8274","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7000ad53ec1b17bd2fac76984b7b0c663755cbb7","target":{"file":"fs/f2fs/segment.c"}},{"deprecated":false,"digest":{"function_hash":"130310281068169529947173926420555150138","length":490},"id":"CVE-2022-50009-1bd74564","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a2c5b7994960fac29cf8a3f4e62855bae1b27d4","target":{"file":"fs/f2fs/segment.c","function":"f2fs_abort_atomic_write"}},{"deprecated":false,"digest":{"line_hashes":["244501815639424793797528055856226557197","247276342807399864795358605212315481248","236099185776706560727002291350279183319","293539852260940348079595909701614422940","293319914168781999038158796219969710637","68071107837254716874942678759594819187","290764176705362120629728752826532043042"],"threshold":0.9},"id":"CVE-2022-50009-2892daee","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a2c5b7994960fac29cf8a3f4e62855bae1b27d4","target":{"file":"fs/f2fs/f2fs.h"}},{"deprecated":false,"digest":{"function_hash":"306184090853333091235451703992682944221","length":1706},"id":"CVE-2022-50009-302c6569","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a2c5b7994960fac29cf8a3f4e62855bae1b27d4","target":{"file":"fs/f2fs/file.c","function":"f2fs_ioc_start_atomic_write"}},{"deprecated":false,"digest":{"function_hash":"92109230622051738813161899925050406017","length":469},"id":"CVE-2022-50009-3cd29ebd","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0f63e33eca6fa29a11c76fa31db5fe1cada5ad6e","target":{"file":"fs/f2fs/segment.c","function":"f2fs_abort_atomic_write"}},{"deprecated":false,"digest":{"line_hashes":["175767494624947399523261376699511221558","19243389952415807791736714137647430705","145659669535032572137404168729436247363","65720855144485854793384895591022888260"],"threshold":0.9},"id":"CVE-2022-50009-4f8f80e1","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a2c5b7994960fac29cf8a3f4e62855bae1b27d4","target":{"file":"fs/f2fs/file.c"}},{"deprecated":false,"digest":{"function_hash":"92109230622051738813161899925050406017","length":469},"id":"CVE-2022-50009-5be84d5f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7000ad53ec1b17bd2fac76984b7b0c663755cbb7","target":{"file":"fs/f2fs/segment.c","function":"f2fs_abort_atomic_write"}},{"deprecated":false,"digest":{"line_hashes":["244501815639424793797528055856226557197","247276342807399864795358605212315481248","236099185776706560727002291350279183319","293539852260940348079595909701614422940","293319914168781999038158796219969710637","68071107837254716874942678759594819187","290764176705362120629728752826532043042"],"threshold":0.9},"id":"CVE-2022-50009-5f66b23f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0f63e33eca6fa29a11c76fa31db5fe1cada5ad6e","target":{"file":"fs/f2fs/f2fs.h"}},{"deprecated":false,"digest":{"line_hashes":["25593255481040154744912085493675964950","26520933438006687739528809850265428973","310030670049796197445716099789385520541","284699181327405451815333123515588719861","143229611411159083791806583523661445261","33592010771463352033498234639412406467","182643946203089148359631362132071784857","12419386625540323522887944424400695401"],"threshold":0.9},"id":"CVE-2022-50009-62d1c176","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0f63e33eca6fa29a11c76fa31db5fe1cada5ad6e","target":{"file":"fs/f2fs/segment.c"}},{"deprecated":false,"digest":{"line_hashes":["25593255481040154744912085493675964950","26520933438006687739528809850265428973","310030670049796197445716099789385520541","63345855940161302145338129242869239557","143229611411159083791806583523661445261","33592010771463352033498234639412406467","182643946203089148359631362132071784857","12419386625540323522887944424400695401"],"threshold":0.9},"id":"CVE-2022-50009-772412dc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a2c5b7994960fac29cf8a3f4e62855bae1b27d4","target":{"file":"fs/f2fs/segment.c"}},{"deprecated":false,"digest":{"function_hash":"232397360488508144301281128199346563349","length":1780},"id":"CVE-2022-50009-a1d699c5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0f63e33eca6fa29a11c76fa31db5fe1cada5ad6e","target":{"file":"fs/f2fs/file.c","function":"f2fs_ioc_start_atomic_write"}},{"deprecated":false,"digest":{"line_hashes":["175767494624947399523261376699511221558","19243389952415807791736714137647430705","223249991323475659632388926480502226294","283227003757957847850234268346529677071"],"threshold":0.9},"id":"CVE-2022-50009-cf7cc186","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0f63e33eca6fa29a11c76fa31db5fe1cada5ad6e","target":{"file":"fs/f2fs/file.c"}},{"deprecated":false,"digest":{"function_hash":"234742675047051942237786498178017473019","length":1676},"id":"CVE-2022-50009-dc6be72d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7000ad53ec1b17bd2fac76984b7b0c663755cbb7","target":{"file":"fs/f2fs/file.c","function":"f2fs_ioc_start_atomic_write"}},{"deprecated":false,"digest":{"line_hashes":["244501815639424793797528055856226557197","247276342807399864795358605212315481248","236099185776706560727002291350279183319","293539852260940348079595909701614422940","293319914168781999038158796219969710637","68071107837254716874942678759594819187","290764176705362120629728752826532043042"],"threshold":0.9},"id":"CVE-2022-50009-e43fe6e4","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7000ad53ec1b17bd2fac76984b7b0c663755cbb7","target":{"file":"fs/f2fs/f2fs.h"}},{"deprecated":false,"digest":{"line_hashes":["175767494624947399523261376699511221558","19243389952415807791736714137647430705","145659669535032572137404168729436247363","65720855144485854793384895591022888260"],"threshold":0.9},"id":"CVE-2022-50009-f4620df6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7000ad53ec1b17bd2fac76984b7b0c663755cbb7","target":{"file":"fs/f2fs/file.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"3.8.0"},{"fixed":"5.18.18"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.19.0"},{"fixed":"5.19.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50009.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0f63e33eca6fa29a11c76fa31db5fe1cada5ad6e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4a2c5b7994960fac29cf8a3f4e62855bae1b27d4"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7000ad53ec1b17bd2fac76984b7b0c663755cbb7"}]}