{"schema_version":"1.7.3","id":"CVE-2022-49896","published":"2025-05-01T14:10:38Z","modified":"2025-10-21T11:25:43.706408Z","summary":"cxl/pmem: Fix cxl_pmem_region and cxl_memdev leak","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ncxl/pmem: Fix cxl_pmem_region and cxl_memdev leak\n\nWhen a cxl_nvdimm object goes through a ->remove() event (device\nphysically removed, nvdimm-bridge disabled, or nvdimm device disabled),\nthen any associated regions must also be disabled. As highlighted by the\ncxl-create-region.sh test [1], a single device may host multiple\nregions, but the driver was only tracking one region at a time. This\nleads to a situation where only the last enabled region per nvdimm\ndevice is cleaned up properly. Other regions are leaked, and this also\ncauses cxl_memdev reference leaks.\n\nFix the tracking by allowing cxl_nvdimm objects to track multiple region\nassociations.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"04ad63f086d1a9649b8b082748cbc7a570ade461"},{"fixed":"f43b6bfdbab78606735ba81185cf0602b81e40b6"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"04ad63f086d1a9649b8b082748cbc7a570ade461"},{"fixed":"4d07ae22e79ebc2d7528bbc69daa53b86981cb3a"}]}],"versions":["v5.19","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.1-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49896.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"146700593862289021015012527076130199503","length":97},"id":"CVE-2022-49896-01bd8815","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/core/pmem.c","function":"cxl_nvdimm_release"}},{"deprecated":false,"digest":{"line_hashes":["120313822452931247434256861702008482186","188889995186087359836080025070319692107","118632369916594959282592910859720035471","281347894175040765304642111071880143951","317946960108322883701325282713040497840","61300694646924252036069363823613871290","125839006218515441979275992759889877279"],"threshold":0.9},"id":"CVE-2022-49896-0273d411","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/core/pmem.c"}},{"deprecated":false,"digest":{"function_hash":"336239060479351688221361147084601548852","length":409},"id":"CVE-2022-49896-1465e863","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/core/pmem.c","function":"cxl_nvdimm_alloc"}},{"deprecated":false,"digest":{"function_hash":"239235610066974924718242602873855952942","length":373},"id":"CVE-2022-49896-31d33c23","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/pmem.c","function":"unregister_nvdimm"}},{"deprecated":false,"digest":{"line_hashes":["120313822452931247434256861702008482186","188889995186087359836080025070319692107","118632369916594959282592910859720035471","281347894175040765304642111071880143951","317946960108322883701325282713040497840","61300694646924252036069363823613871290","125839006218515441979275992759889877279"],"threshold":0.9},"id":"CVE-2022-49896-3ad51681","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/core/pmem.c"}},{"deprecated":false,"digest":{"function_hash":"146700593862289021015012527076130199503","length":97},"id":"CVE-2022-49896-42bb2ac1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/core/pmem.c","function":"cxl_nvdimm_release"}},{"deprecated":false,"digest":{"function_hash":"273567114947268055488372826763061265224","length":409},"id":"CVE-2022-49896-451cc9a9","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/pmem.c","function":"unregister_nvdimm_region"}},{"deprecated":false,"digest":{"function_hash":"239235610066974924718242602873855952942","length":373},"id":"CVE-2022-49896-7516160e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/pmem.c","function":"unregister_nvdimm"}},{"deprecated":false,"digest":{"function_hash":"207893418951739251103858783468948625073","length":3329},"id":"CVE-2022-49896-821aaf9f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/pmem.c","function":"cxl_pmem_region_probe"}},{"deprecated":false,"digest":{"line_hashes":["296020758648318746223163880389584463166","339198278843608831544305918284947516812","247287721717550600186815516087091920432","42703828145529104722401963391454572603","66929529756165286768179396378689903189","214504641573757810274230573915276944388","270986341427103004817245421230743576504","258243326330989295322427184307862255202","55608531888575976101287928025834606795","20960289983355408281374096462142336123","230615040559682752623397563668941881979","111726379487591043937507516340860548571","62611897993550122944714354419323233987","73546062235846395857910156954294983052","281305040050779668608932929620519651001","269930949594911889602398784975864164094","160174648760802697743390642378207032361","98935416892045238270319055402982161000","92817806472884979486514528037596394845","36597315724335407732847840786139537958","98825823589047176607107981329913551665","61993229883845513234827719075127759973","343110713044419455224013758407837175","191905443376323414418884159461789660934","132954435015526998313605066237636097778","31844336349882817704055088270496231072","315483569737039888170693415741159583950","126391141546421763451003528114783015545","87102013490042657548270118889640156797","233409901166692226603201506379336635441","178091087087269086134501030413337267865","58308873816622370188484076039724898046","151108636198748462103591245053942684720","121178405614136231385848317466123032412","205922266974676975119214338625223724582","85573128132173082192492854645576478296","311795992474449694442294742446499469818","322629479368617555651452808888019509219","222851297359025561392056313658014248925","69530553110278776420106491864271655166","247353207294297324567580692039269631818","47551844524374708496316869279940768685","186969280519643907360932498375414940779","282432732274356158770099900452266975621","318344861915498026372989182099835407646","183475050974035579430568675709202192756","91828077407815917475238050734595543816","91957433121491264251527017895726749348","69771576832088032520445782232015427288","197825113434209409858805499641713066370","39710073266683352089397215562447491588","339781933259226931966647028505408159044","58631972557989154146415783476614930794","155097068330070285188598862129363625538","20465991250639646015882197186879327530","108021432731605501753910616681369514614","7396282772744628049688323877778402506","245030939123568291294921079378404530175","201053293821856738941200457760882699076","164229249819592759649661398886551378429","55939862624901079636952295968552140434","245030939123568291294921079378404530175","312759841103670384852115707366578640971","121883923819030448043642079081184341478","253819603238566637284505428662235458416","90200505760491731969156999082421299615","1284167520433811362042726858542909379","20831537452425136321315325171606234649","254649889753154388567216852486619844941","122661112314869930038230009769683705496","258280865878693283117716005092181261766","297324763508292405761126020859179476255","205554392540078748316462954955053746948","42881510918535416144968297441539110556","216533079036572069336585976602677641377","102214960357402272242907313407569893427","294296576693090117572185657978558002692","231456389300562549476666799169574940510","216669910543787101628094739459732712455","194896065821330805232802794689470788842","100340329233022536285103463601855094660","291166411548274324056877336684413204488","107801121238340241556307962110468779259","203084413559488984864385280964916395856","111896778320498918518711391791407429050","39847575606911111019323653556244732974","115233115288377700313600530815149328023","60697582167332543759981963087130580337"],"threshold":0.9},"id":"CVE-2022-49896-9e9a544c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/pmem.c"}},{"deprecated":false,"digest":{"line_hashes":["241822283772914603143004774494981876819","157492736324814103627162171116329131477","333873709901930597500015721885685285524","199268609842626277062899918014136438951"],"threshold":0.9},"id":"CVE-2022-49896-a1fd9c6c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/cxl.h"}},{"deprecated":false,"digest":{"line_hashes":["296020758648318746223163880389584463166","339198278843608831544305918284947516812","247287721717550600186815516087091920432","42703828145529104722401963391454572603","66929529756165286768179396378689903189","214504641573757810274230573915276944388","270986341427103004817245421230743576504","258243326330989295322427184307862255202","55608531888575976101287928025834606795","20960289983355408281374096462142336123","230615040559682752623397563668941881979","111726379487591043937507516340860548571","62611897993550122944714354419323233987","73546062235846395857910156954294983052","281305040050779668608932929620519651001","269930949594911889602398784975864164094","160174648760802697743390642378207032361","98935416892045238270319055402982161000","92817806472884979486514528037596394845","36597315724335407732847840786139537958","98825823589047176607107981329913551665","61993229883845513234827719075127759973","343110713044419455224013758407837175","191905443376323414418884159461789660934","132954435015526998313605066237636097778","31844336349882817704055088270496231072","315483569737039888170693415741159583950","126391141546421763451003528114783015545","87102013490042657548270118889640156797","233409901166692226603201506379336635441","178091087087269086134501030413337267865","58308873816622370188484076039724898046","151108636198748462103591245053942684720","121178405614136231385848317466123032412","205922266974676975119214338625223724582","85573128132173082192492854645576478296","311795992474449694442294742446499469818","322629479368617555651452808888019509219","222851297359025561392056313658014248925","69530553110278776420106491864271655166","247353207294297324567580692039269631818","47551844524374708496316869279940768685","186969280519643907360932498375414940779","282432732274356158770099900452266975621","318344861915498026372989182099835407646","183475050974035579430568675709202192756","91828077407815917475238050734595543816","91957433121491264251527017895726749348","69771576832088032520445782232015427288","197825113434209409858805499641713066370","39710073266683352089397215562447491588","339781933259226931966647028505408159044","58631972557989154146415783476614930794","155097068330070285188598862129363625538","20465991250639646015882197186879327530","108021432731605501753910616681369514614","7396282772744628049688323877778402506","245030939123568291294921079378404530175","201053293821856738941200457760882699076","164229249819592759649661398886551378429","55939862624901079636952295968552140434","245030939123568291294921079378404530175","312759841103670384852115707366578640971","121883923819030448043642079081184341478","253819603238566637284505428662235458416","90200505760491731969156999082421299615","1284167520433811362042726858542909379","20831537452425136321315325171606234649","254649889753154388567216852486619844941","122661112314869930038230009769683705496","258280865878693283117716005092181261766","297324763508292405761126020859179476255","205554392540078748316462954955053746948","42881510918535416144968297441539110556","216533079036572069336585976602677641377","102214960357402272242907313407569893427","294296576693090117572185657978558002692","231456389300562549476666799169574940510","216669910543787101628094739459732712455","194896065821330805232802794689470788842","100340329233022536285103463601855094660","291166411548274324056877336684413204488","107801121238340241556307962110468779259","203084413559488984864385280964916395856","111896778320498918518711391791407429050","39847575606911111019323653556244732974","115233115288377700313600530815149328023","60697582167332543759981963087130580337"],"threshold":0.9},"id":"CVE-2022-49896-a96b0903","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/pmem.c"}},{"deprecated":false,"digest":{"function_hash":"207893418951739251103858783468948625073","length":3329},"id":"CVE-2022-49896-c1884d0f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/pmem.c","function":"cxl_pmem_region_probe"}},{"deprecated":false,"digest":{"line_hashes":["241822283772914603143004774494981876819","157492736324814103627162171116329131477","333873709901930597500015721885685285524","199268609842626277062899918014136438951"],"threshold":0.9},"id":"CVE-2022-49896-d06089f5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4d07ae22e79ebc2d7528bbc69daa53b86981cb3a","target":{"file":"drivers/cxl/cxl.h"}},{"deprecated":false,"digest":{"function_hash":"273567114947268055488372826763061265224","length":409},"id":"CVE-2022-49896-dc543147","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/pmem.c","function":"unregister_nvdimm_region"}},{"deprecated":false,"digest":{"function_hash":"336239060479351688221361147084601548852","length":409},"id":"CVE-2022-49896-dd354d2f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f43b6bfdbab78606735ba81185cf0602b81e40b6","target":{"file":"drivers/cxl/core/pmem.c","function":"cxl_nvdimm_alloc"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.0.0"},{"fixed":"6.0.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49896.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4d07ae22e79ebc2d7528bbc69daa53b86981cb3a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f43b6bfdbab78606735ba81185cf0602b81e40b6"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}