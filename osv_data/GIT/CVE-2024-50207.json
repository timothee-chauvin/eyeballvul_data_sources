{"schema_version":"1.7.3","id":"CVE-2024-50207","published":"2024-11-08T06:07:57.780Z","modified":"2025-11-20T06:24:00.873896Z","related":["USN-7276-1","USN-7277-1","openSUSE-SU-2024:14500-1","openSUSE-SU-2025:14705-1"],"summary":"ring-buffer: Fix reader locking when changing the sub buffer order","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nring-buffer: Fix reader locking when changing the sub buffer order\n\nThe function ring_buffer_subbuf_order_set() updates each\nring_buffer_per_cpu and installs new sub buffers that match the requested\npage order. This operation may be invoked concurrently with readers that\nrely on some of the modified data, such as the head bit (RB_PAGE_HEAD), or\nthe ring_buffer_per_cpu.pages and reader_page pointers. However, no\nexclusive access is acquired by ring_buffer_subbuf_order_set(). Modifying\nthe mentioned data while a reader also operates on them can then result in\nincorrect memory access and various crashes.\n\nFix the problem by taking the reader_lock when updating a specific\nring_buffer_per_cpu in ring_buffer_subbuf_order_set().","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8e7b58c27b3c567316a51079b375b846f9223bba"},{"fixed":"a569290525a05162d5dd26d9845591eaf46e5802"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8e7b58c27b3c567316a51079b375b846f9223bba"},{"fixed":"09661f75e75cb6c1d2d8326a70c311d46729235f"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.11.3","v6.11.4","v6.11.5","v6.12-rc1","v6.12-rc2","v6.7","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50207.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["242860865380642963941997320645180167920","79272560353123374187153402327851799403","151893631794691769691919450570808713256","85025990390070794871856923589262106442","83656860364684814537655731313845500265","219051129746340836556012213374055701145","102516525667910225349543526965978604812","295425230933925828580845026190642215033","287837802061331913185548867164777601976","208552126016932547997807389546233071681","199051261141853036026778798360875519356","216746112888340825919821243818969709769","298556930361266912644911836162212737563","1139544581620614590352763444208494161","59814036264204118123473268287240568332","248335913336867648812368106761542764271","33652225002196480772457436793035311500","307763129897072014065962580183648443811","156385302850081748880983691991877523921","253872896155729509805894195561030849840","46425654399418177863249089901950868712","139126699480241192734763113172849756061","59358566891409453234721640874209653888","48742043528318820425991707759155751511","262845540931486192965864423940351026562","244300474258804147176438043949547767823","262034267202916283227550501550036619236","75697641797961492542382663327305082662"],"threshold":0.9},"id":"CVE-2024-50207-0373f034","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a569290525a05162d5dd26d9845591eaf46e5802","target":{"file":"kernel/trace/ring_buffer.c"}},{"deprecated":false,"digest":{"function_hash":"92804010506164527551748016860978961429","length":2549},"id":"CVE-2024-50207-5ab528d8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a569290525a05162d5dd26d9845591eaf46e5802","target":{"file":"kernel/trace/ring_buffer.c","function":"ring_buffer_subbuf_order_set"}},{"deprecated":false,"digest":{"line_hashes":["242860865380642963941997320645180167920","79272560353123374187153402327851799403","151893631794691769691919450570808713256","85025990390070794871856923589262106442","83656860364684814537655731313845500265","219051129746340836556012213374055701145","102516525667910225349543526965978604812","295425230933925828580845026190642215033","287837802061331913185548867164777601976","208552126016932547997807389546233071681","199051261141853036026778798360875519356","216746112888340825919821243818969709769","298556930361266912644911836162212737563","1139544581620614590352763444208494161","59814036264204118123473268287240568332","248335913336867648812368106761542764271","33652225002196480772457436793035311500","307763129897072014065962580183648443811","156385302850081748880983691991877523921","253872896155729509805894195561030849840","46425654399418177863249089901950868712","139126699480241192734763113172849756061","59358566891409453234721640874209653888","48742043528318820425991707759155751511","262845540931486192965864423940351026562","244300474258804147176438043949547767823","262034267202916283227550501550036619236","75697641797961492542382663327305082662"],"threshold":0.9},"id":"CVE-2024-50207-86a902d7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@09661f75e75cb6c1d2d8326a70c311d46729235f","target":{"file":"kernel/trace/ring_buffer.c"}},{"deprecated":false,"digest":{"function_hash":"92804010506164527551748016860978961429","length":2549},"id":"CVE-2024-50207-bfbcb69d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@09661f75e75cb6c1d2d8326a70c311d46729235f","target":{"file":"kernel/trace/ring_buffer.c","function":"ring_buffer_subbuf_order_set"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.11.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50207.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/09661f75e75cb6c1d2d8326a70c311d46729235f"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a569290525a05162d5dd26d9845591eaf46e5802"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}