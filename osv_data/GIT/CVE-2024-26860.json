{"schema_version":"1.7.3","id":"CVE-2024-26860","published":"2024-04-17T10:27:24Z","modified":"2025-10-21T20:18:14.712293Z","related":["SUSE-SU-2024:2135-1","SUSE-SU-2024:2203-1","SUSE-SU-2024:2973-1"],"summary":"dm-integrity: fix a memory leak when rechecking the data","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndm-integrity: fix a memory leak when rechecking the data\n\nMemory for the \"checksums\" pointer will leak if the data is rechecked\nafter checksum failure (because the associated kfree won't happen due\nto 'goto skip_io').\n\nFix this by freeing the checksums memory before recheck, and just use\nthe \"checksum_onstack\" memory for storing checksum during recheck.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"906414f4596469004632de29126c55751ed82c5e"},{"fixed":"20e21c3c0195d915f33bc7321ee6b362177bf5bf"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d6824a28b244e8a750952848e4bd2167e1e9a17e"},{"fixed":"338580a7fb9b0930bb38098007e89cc0fc496bf7"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"eb7b14a6a923c5678573c4d238c781cc83fcbc0f"},{"fixed":"74abc2fe09691f3d836d8a54d599ca71f1e4287b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"c88f5e553fe38b2ffc4c33d08654e5281b297677"},{"fixed":"6d35654f03c35c273240d85ec67e3f2c3596c4e0"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"c88f5e553fe38b2ffc4c33d08654e5281b297677"},{"fixed":"55e565c42dce81a4e49c13262d5bc4eb4c2e588a"}]}],"versions":["v6.1.80","v6.1.81","v6.1.82","v6.6.19","v6.6.20","v6.6.21","v6.6.22","v6.7.10","v6.7.7","v6.7.8","v6.7.9","v6.8","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.8.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26860.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.83"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.23"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.7.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.8.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26860.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/20e21c3c0195d915f33bc7321ee6b362177bf5bf"},{"type":"WEB","url":"https://git.kernel.org/stable/c/338580a7fb9b0930bb38098007e89cc0fc496bf7"},{"type":"WEB","url":"https://git.kernel.org/stable/c/55e565c42dce81a4e49c13262d5bc4eb4c2e588a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6d35654f03c35c273240d85ec67e3f2c3596c4e0"},{"type":"WEB","url":"https://git.kernel.org/stable/c/74abc2fe09691f3d836d8a54d599ca71f1e4287b"}]}