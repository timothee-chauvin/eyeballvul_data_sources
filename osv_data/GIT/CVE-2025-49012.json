{"schema_version":"1.7.3","id":"CVE-2025-49012","published":"2025-06-05T22:29:40.744Z","modified":"2025-12-05T10:18:28.473949Z","aliases":["GHSA-gcxr-m95v-qcf7"],"summary":"Himmelblau's Name-Based Group Matching in `pam_allow_groups` Leads to Potential Security Bypass","details":"Himmelblau is an interoperability suite for Microsoft Azure Entra ID and Intune. Himmelblau versions 0.9.0 through 0.9.14 and 1.00-alpha are vulnerable to a privilege escalation issue when Entra ID group-based access restrictions are configured using group display names instead of object IDs. Starting in version 0.9.0, Himmelblau introduced support for specifying group names in the `pam_allow_groups` configuration option. However, Microsoft Entra ID permits the creation of multiple groups with the same `displayName` via the Microsoft Graph APIâ€”even by non-admin users, depending on tenant settings. As a result, a user could create a personal group with the same name as a legitimate access group (e.g., `\"Allow-Linux-Login\"`), add themselves to it, and be granted authentication or `sudo` rights by Himmelblau. Because affected Himmelblau versions compare group names by either `displayName` or by the immutable `objectId`, this allows bypassing access control mechanisms intended to restrict login to members of official, centrally-managed groups. This issue is fixed in Himmelblau version **0.9.15** and later. In these versions, group name matching in `pam_allow_groups` has been deprecated and removed, and only group `objectId`s (GUIDs) may be specified for secure group-based filtering. To mitigate the issue without upgrading, replace all entries in `pam_allow_groups` with the objectId of the target Entra ID group(s) and/or audit your tenant for groups with duplicate display names using the Microsoft Graph API.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/himmelblau-idm/himmelblau","events":[{"introduced":"e0a9a019da5407b3f8f525570c83f6ae7a8bd2e2"},{"fixed":"d6935b40d321125893da4a988084de4b55b3e11f"}],"database_specific":{"versions":[{"introduced":"0.9.0"},{"fixed":"0.9.15"}]}},{"type":"GIT","repo":"https://github.com/himmelblau-idm/himmelblau","events":[{"introduced":"0"},{"last_affected":"baf3d8bcf373e488f55ec3ebd5a39632da0b1e65"}],"database_specific":{"versions":[{"introduced":"0"},{"last_affected":"= 1.0.0-alpha"}]}}],"versions":["0.0.1","0.0.2","0.0.3","0.0.4","0.1.0","0.2.0","0.5.0","0.5.3","0.6.0","0.6.1","0.7.0","0.9.0","0.9.0-beta","0.9.0-beta2","0.9.1","0.9.10","0.9.11","0.9.12","0.9.13","0.9.14","0.9.2","0.9.3","0.9.4","0.9.5","0.9.6","0.9.7","0.9.8","0.9.9","1.0.0-alpha"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-49012.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/49xxx/CVE-2025-49012.json"},{"type":"FIX","url":"https://github.com/himmelblau-idm/himmelblau/commit/918577f6a8392a71d9d3d67f20962c372a0c01c6"},{"type":"REPORT","url":"https://github.com/himmelblau-idm/himmelblau/issues/554"},{"type":"ADVISORY","url":"https://github.com/himmelblau-idm/himmelblau/security/advisories/GHSA-gcxr-m95v-qcf7"},{"type":"WEB","url":"https://learn.microsoft.com/en-us/answers/questions/1035045/azure-ad-b2c-creates-groups-with-the-same-name-usi?utm_source=chatgpt.com"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-49012"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-287"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/49xxx/CVE-2025-49012.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N"}]}