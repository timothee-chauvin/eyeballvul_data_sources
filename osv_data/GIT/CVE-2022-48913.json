{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48913.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "300411304692663011586393048712093393020",
              "length": 251.0
            },
            "id": "CVE-2022-48913-1cdd21a4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6418634238ade86f2b08192928787f39d8afb58c",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "__blk_trace_remove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "202516095294133631339835960672285991592",
              "length": 1968.0
            },
            "id": "CVE-2022-48913-2b0757ae",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30939293262eb433c960c4532a0d59c4073b2b84",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "do_blk_trace_setup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "199477292591099748679755045914260702066",
              "length": 468.0
            },
            "id": "CVE-2022-48913-2d97aa19",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30939293262eb433c960c4532a0d59c4073b2b84",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_remove_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "202516095294133631339835960672285991592",
              "length": 1968.0
            },
            "id": "CVE-2022-48913-31c4a26f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@78acc7dbd84a8c173a08584750845c31611160f2",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "do_blk_trace_setup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "180918027445862843720709667287240461914",
              "length": 94.0
            },
            "id": "CVE-2022-48913-354cdb04",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@78acc7dbd84a8c173a08584750845c31611160f2",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_cleanup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "202516095294133631339835960672285991592",
              "length": 1968.0
            },
            "id": "CVE-2022-48913-50b048d3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6418634238ade86f2b08192928787f39d8afb58c",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "do_blk_trace_setup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "300411304692663011586393048712093393020",
              "length": 251.0
            },
            "id": "CVE-2022-48913-574f9138",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30939293262eb433c960c4532a0d59c4073b2b84",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "__blk_trace_remove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "4349711951368064418538793495520715011",
                "184315569691509287212496373274752988525",
                "178954966893875998230739235118907377411",
                "327392052840911374381198384286173767276",
                "151042298482787626075590341110807698621",
                "43250041096533275639393949420474280154",
                "114011626677522851845889374277399408321",
                "289714491547974423035965310112856550181",
                "82791453778615986040240024098119691003",
                "31265197102809255256170255707486446381",
                "301797165752305448173063653258657781872",
                "96286918777518969173151427848847493817",
                "184772330804211141864584002322662966535",
                "204519544803211474015259698562763037475",
                "292084302483543614419594023400508590170",
                "25526212694661764548880606885042802339",
                "46815937873956701064985519042719654644",
                "10621223477881139606880967191121670290",
                "122117066181349167822968940219879004738",
                "142257899650237764868749328909499136305",
                "320218975542518725833576134492734543232",
                "140835662006498593054606998361052673145",
                "300975179366362073501111939519580633246",
                "317286445518343711313330608606702190266",
                "66485320460525017643800044902721625997",
                "74242795657103713464540337119309388564",
                "179771927714210733644049138451856520041",
                "281136412898877065330869821941613734226",
                "216984768159480820977908612420259737283",
                "56263945476378887440228326169906297858"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48913-5eb94348",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6418634238ade86f2b08192928787f39d8afb58c",
            "target": {
              "file": "kernel/trace/blktrace.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "180918027445862843720709667287240461914",
              "length": 94.0
            },
            "id": "CVE-2022-48913-6d4662fe",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6418634238ade86f2b08192928787f39d8afb58c",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_cleanup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "180918027445862843720709667287240461914",
              "length": 94.0
            },
            "id": "CVE-2022-48913-6fad6aef",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30939293262eb433c960c4532a0d59c4073b2b84",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_cleanup"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "26668627048286942099484030125488627396",
              "length": 188.0
            },
            "id": "CVE-2022-48913-8d08d3b9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6418634238ade86f2b08192928787f39d8afb58c",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_free"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "26668627048286942099484030125488627396",
              "length": 188.0
            },
            "id": "CVE-2022-48913-9c472824",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@78acc7dbd84a8c173a08584750845c31611160f2",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_free"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "26668627048286942099484030125488627396",
              "length": 188.0
            },
            "id": "CVE-2022-48913-a12d2fba",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30939293262eb433c960c4532a0d59c4073b2b84",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_free"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "40783911325007518886738910447688508022",
              "length": 493.0
            },
            "id": "CVE-2022-48913-a9834332",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30939293262eb433c960c4532a0d59c4073b2b84",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_setup_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "4349711951368064418538793495520715011",
                "184315569691509287212496373274752988525",
                "178954966893875998230739235118907377411",
                "327392052840911374381198384286173767276",
                "151042298482787626075590341110807698621",
                "43250041096533275639393949420474280154",
                "114011626677522851845889374277399408321",
                "289714491547974423035965310112856550181",
                "82791453778615986040240024098119691003",
                "31265197102809255256170255707486446381",
                "301797165752305448173063653258657781872",
                "96286918777518969173151427848847493817",
                "184772330804211141864584002322662966535",
                "204519544803211474015259698562763037475",
                "292084302483543614419594023400508590170",
                "25526212694661764548880606885042802339",
                "46815937873956701064985519042719654644",
                "10621223477881139606880967191121670290",
                "122117066181349167822968940219879004738",
                "142257899650237764868749328909499136305",
                "320218975542518725833576134492734543232",
                "140835662006498593054606998361052673145",
                "300975179366362073501111939519580633246",
                "317286445518343711313330608606702190266",
                "66485320460525017643800044902721625997",
                "74242795657103713464540337119309388564",
                "179771927714210733644049138451856520041",
                "281136412898877065330869821941613734226",
                "216984768159480820977908612420259737283",
                "56263945476378887440228326169906297858"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48913-a9add4c7",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@78acc7dbd84a8c173a08584750845c31611160f2",
            "target": {
              "file": "kernel/trace/blktrace.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "4349711951368064418538793495520715011",
                "184315569691509287212496373274752988525",
                "178954966893875998230739235118907377411",
                "327392052840911374381198384286173767276",
                "151042298482787626075590341110807698621",
                "43250041096533275639393949420474280154",
                "114011626677522851845889374277399408321",
                "289714491547974423035965310112856550181",
                "82791453778615986040240024098119691003",
                "31265197102809255256170255707486446381",
                "301797165752305448173063653258657781872",
                "96286918777518969173151427848847493817",
                "184772330804211141864584002322662966535",
                "204519544803211474015259698562763037475",
                "292084302483543614419594023400508590170",
                "25526212694661764548880606885042802339",
                "46815937873956701064985519042719654644",
                "10621223477881139606880967191121670290",
                "122117066181349167822968940219879004738",
                "142257899650237764868749328909499136305",
                "320218975542518725833576134492734543232",
                "140835662006498593054606998361052673145",
                "300975179366362073501111939519580633246",
                "317286445518343711313330608606702190266",
                "66485320460525017643800044902721625997",
                "74242795657103713464540337119309388564",
                "179771927714210733644049138451856520041",
                "281136412898877065330869821941613734226",
                "216984768159480820977908612420259737283",
                "56263945476378887440228326169906297858"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48913-aea8cf1d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@30939293262eb433c960c4532a0d59c4073b2b84",
            "target": {
              "file": "kernel/trace/blktrace.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "300411304692663011586393048712093393020",
              "length": 251.0
            },
            "id": "CVE-2022-48913-b0582625",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@78acc7dbd84a8c173a08584750845c31611160f2",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "__blk_trace_remove"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "199477292591099748679755045914260702066",
              "length": 468.0
            },
            "id": "CVE-2022-48913-b81c7d10",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6418634238ade86f2b08192928787f39d8afb58c",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_remove_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "40783911325007518886738910447688508022",
              "length": 493.0
            },
            "id": "CVE-2022-48913-c4383d31",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6418634238ade86f2b08192928787f39d8afb58c",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_setup_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "199477292591099748679755045914260702066",
              "length": 468.0
            },
            "id": "CVE-2022-48913-d26c599f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@78acc7dbd84a8c173a08584750845c31611160f2",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_remove_queue"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "40783911325007518886738910447688508022",
              "length": 493.0
            },
            "id": "CVE-2022-48913-db078ff4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@78acc7dbd84a8c173a08584750845c31611160f2",
            "target": {
              "file": "kernel/trace/blktrace.c",
              "function": "blk_trace_setup_queue"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "c0ea57608b691d6cde8aff23e11f9858a86b5918"
            },
            {
              "fixed": "78acc7dbd84a8c173a08584750845c31611160f2"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "c0ea57608b691d6cde8aff23e11f9858a86b5918"
            },
            {
              "fixed": "6418634238ade86f2b08192928787f39d8afb58c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "c0ea57608b691d6cde8aff23e11f9858a86b5918"
            },
            {
              "fixed": "30939293262eb433c960c4532a0d59c4073b2b84"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.12",
        "v5.12-rc1",
        "v5.12-rc1-dontuse",
        "v5.12-rc2",
        "v5.12-rc3",
        "v5.12-rc4",
        "v5.12-rc5",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.3",
        "v5.15.4",
        "v5.15.5",
        "v5.15.6",
        "v5.15.7",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.16.1",
        "v5.16.10",
        "v5.16.11",
        "v5.16.12",
        "v5.16.2",
        "v5.16.3",
        "v5.16.4",
        "v5.16.5",
        "v5.16.6",
        "v5.16.7",
        "v5.16.8",
        "v5.16.9",
        "v5.17-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48913.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.12.0"
            },
            {
              "fixed": "5.15.27"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.16.13"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nblktrace: fix use after free for struct blk_trace\n\nWhen tracing the whole disk, 'dropped' and 'msg' will be created\nunder 'q->debugfs_dir' and 'bt->dir' is NULL, thus blk_trace_free()\nwon't remove those files. What's worse, the following UAF can be\ntriggered because of accessing stale 'dropped' and 'msg':\n\n==================================================================\nBUG: KASAN: use-after-free in blk_dropped_read+0x89/0x100\nRead of size 4 at addr ffff88816912f3d8 by task blktrace/1188\n\nCPU: 27 PID: 1188 Comm: blktrace Not tainted 5.17.0-rc4-next-20220217+ #469\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS ?-20190727_073836-4\nCall Trace:\n <TASK>\n dump_stack_lvl+0x34/0x44\n print_address_description.constprop.0.cold+0xab/0x381\n ? blk_dropped_read+0x89/0x100\n ? blk_dropped_read+0x89/0x100\n kasan_report.cold+0x83/0xdf\n ? blk_dropped_read+0x89/0x100\n kasan_check_range+0x140/0x1b0\n blk_dropped_read+0x89/0x100\n ? blk_create_buf_file_callback+0x20/0x20\n ? kmem_cache_free+0xa1/0x500\n ? do_sys_openat2+0x258/0x460\n full_proxy_read+0x8f/0xc0\n vfs_read+0xc6/0x260\n ksys_read+0xb9/0x150\n ? vfs_write+0x3d0/0x3d0\n ? fpregs_assert_state_consistent+0x55/0x60\n ? exit_to_user_mode_prepare+0x39/0x1e0\n do_syscall_64+0x35/0x80\n entry_SYSCALL_64_after_hwframe+0x44/0xae\nRIP: 0033:0x7fbc080d92fd\nCode: ce 20 00 00 75 10 b8 00 00 00 00 0f 05 48 3d 01 f0 ff ff 73 31 c3 48 83 1\nRSP: 002b:00007fbb95ff9cb0 EFLAGS: 00000293 ORIG_RAX: 0000000000000000\nRAX: ffffffffffffffda RBX: 00007fbb95ff9dc0 RCX: 00007fbc080d92fd\nRDX: 0000000000000100 RSI: 00007fbb95ff9cc0 RDI: 0000000000000045\nRBP: 0000000000000045 R08: 0000000000406299 R09: 00000000fffffffd\nR10: 000000000153afa0 R11: 0000000000000293 R12: 00007fbb780008c0\nR13: 00007fbb78000938 R14: 0000000000608b30 R15: 00007fbb780029c8\n </TASK>\n\nAllocated by task 1050:\n kasan_save_stack+0x1e/0x40\n __kasan_kmalloc+0x81/0xa0\n do_blk_trace_setup+0xcb/0x410\n __blk_trace_setup+0xac/0x130\n blk_trace_ioctl+0xe9/0x1c0\n blkdev_ioctl+0xf1/0x390\n __x64_sys_ioctl+0xa5/0xe0\n do_syscall_64+0x35/0x80\n entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nFreed by task 1050:\n kasan_save_stack+0x1e/0x40\n kasan_set_track+0x21/0x30\n kasan_set_free_info+0x20/0x30\n __kasan_slab_free+0x103/0x180\n kfree+0x9a/0x4c0\n __blk_trace_remove+0x53/0x70\n blk_trace_ioctl+0x199/0x1c0\n blkdev_common_ioctl+0x5e9/0xb30\n blkdev_ioctl+0x1a5/0x390\n __x64_sys_ioctl+0xa5/0xe0\n do_syscall_64+0x35/0x80\n entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nThe buggy address belongs to the object at ffff88816912f380\n which belongs to the cache kmalloc-96 of size 96\nThe buggy address is located 88 bytes inside of\n 96-byte region [ffff88816912f380, ffff88816912f3e0)\nThe buggy address belongs to the page:\npage:000000009a1b4e7c refcount:1 mapcount:0 mapping:0000000000000000 index:0x0f\nflags: 0x17ffffc0000200(slab|node=0|zone=2|lastcpupid=0x1fffff)\nraw: 0017ffffc0000200 ffffea00044f1100 dead000000000002 ffff88810004c780\nraw: 0000000000000000 0000000000200020 00000001ffffffff 0000000000000000\npage dumped because: kasan: bad access detected\n\nMemory state around the buggy address:\n ffff88816912f280: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc\n ffff88816912f300: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc\n>ffff88816912f380: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc\n                                                    ^\n ffff88816912f400: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc\n ffff88816912f480: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc\n==================================================================",
  "id": "CVE-2022-48913",
  "modified": "2025-10-14T21:04:31.719052Z",
  "published": "2024-08-22T01:31:34Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/30939293262eb433c960c4532a0d59c4073b2b84"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6418634238ade86f2b08192928787f39d8afb58c"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/78acc7dbd84a8c173a08584750845c31611160f2"
    }
  ],
  "related": [
    "SUSE-SU-2024:3190-1",
    "SUSE-SU-2024:3209-1",
    "SUSE-SU-2024:3227-1",
    "SUSE-SU-2024:3408-1",
    "SUSE-SU-2024:3483-1"
  ],
  "schema_version": "1.7.3",
  "summary": "blktrace: fix use after free for struct blk_trace"
}