{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21751.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "338121490290666634244313821736826038696",
                "106744075547640905736468993455223513521",
                "99169320767326357233771462604367245160",
                "86539458929402957995365498825475383226",
                "95919885756169007769317941909905034629",
                "240726318989346815730855585987058926191",
                "307212065001146607536985376548720521184",
                "216117665500126462931552866164964772729",
                "98362982499848346546533697939917777508",
                "170164860004633681954852802394761986959",
                "134367401171908569313301208267150696271",
                "44767233784392556834935592821717719402",
                "152812360795143122203433927799986533831",
                "166906053697940712853138072428074861410",
                "15599530448249257249075232550803945567",
                "228453116282301499677480215142590120398",
                "264228113101900782918901832678170695952",
                "52032130404328254151721316379874607215",
                "136875224503095262700382188136462264408",
                "95897246870355843142264666506200600468",
                "39170606646261409089516977285414691754",
                "33756736089150110926539471719057058152",
                "167652610803949011345541283740329943643",
                "157241764066634333264816425047470156360",
                "101442318650027951774837009894850008864",
                "28713786854498400779624321597292439534",
                "82177879875541929985808865682124803066",
                "132480047095815826167490403889680708589",
                "271987762764077692959617372378516947031",
                "325407480764719204184984814810772311104"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21751-375cb676",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1ce840c7a659aa53a31ef49f0271b4fd0dc10296",
            "target": {
              "file": "drivers/net/ethernet/mellanox/mlx5/core/steering/hws/matcher.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "146149898999055709662643511161652006747",
              "length": 1389.0
            },
            "id": "CVE-2025-21751-926ea5c6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1ce840c7a659aa53a31ef49f0271b4fd0dc10296",
            "target": {
              "file": "drivers/net/ethernet/mellanox/mlx5/core/steering/hws/matcher.c",
              "function": "hws_matcher_disconnect"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "338121490290666634244313821736826038696",
                "106744075547640905736468993455223513521",
                "99169320767326357233771462604367245160",
                "86539458929402957995365498825475383226",
                "95919885756169007769317941909905034629",
                "240726318989346815730855585987058926191",
                "307212065001146607536985376548720521184",
                "216117665500126462931552866164964772729",
                "98362982499848346546533697939917777508",
                "170164860004633681954852802394761986959",
                "134367401171908569313301208267150696271",
                "44767233784392556834935592821717719402",
                "152812360795143122203433927799986533831",
                "166906053697940712853138072428074861410",
                "15599530448249257249075232550803945567",
                "228453116282301499677480215142590120398",
                "264228113101900782918901832678170695952",
                "52032130404328254151721316379874607215",
                "136875224503095262700382188136462264408",
                "95897246870355843142264666506200600468",
                "39170606646261409089516977285414691754",
                "33756736089150110926539471719057058152",
                "167652610803949011345541283740329943643",
                "157241764066634333264816425047470156360",
                "101442318650027951774837009894850008864",
                "28713786854498400779624321597292439534",
                "82177879875541929985808865682124803066",
                "132480047095815826167490403889680708589",
                "271987762764077692959617372378516947031",
                "325407480764719204184984814810772311104"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21751-eb799113",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5682aad0276ff9b9b0eff3188eb6a1f504d6b436",
            "target": {
              "file": "drivers/net/ethernet/mellanox/mlx5/core/steering/hws/mlx5hws_matcher.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "146149898999055709662643511161652006747",
              "length": 1389.0
            },
            "id": "CVE-2025-21751-ec22beb9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5682aad0276ff9b9b0eff3188eb6a1f504d6b436",
            "target": {
              "file": "drivers/net/ethernet/mellanox/mlx5/core/steering/hws/mlx5hws_matcher.c",
              "function": "hws_matcher_disconnect"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "146149898999055709662643511161652006747",
              "length": 1389.0
            },
            "id": "CVE-2025-21751-f560b3d4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@23a86c76a1a197e8fbbbd0ce3e826eb58c471624",
            "target": {
              "file": "drivers/net/ethernet/mellanox/mlx5/core/steering/hws/matcher.c",
              "function": "hws_matcher_disconnect"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "338121490290666634244313821736826038696",
                "106744075547640905736468993455223513521",
                "99169320767326357233771462604367245160",
                "86539458929402957995365498825475383226",
                "95919885756169007769317941909905034629",
                "240726318989346815730855585987058926191",
                "307212065001146607536985376548720521184",
                "216117665500126462931552866164964772729",
                "98362982499848346546533697939917777508",
                "170164860004633681954852802394761986959",
                "134367401171908569313301208267150696271",
                "44767233784392556834935592821717719402",
                "152812360795143122203433927799986533831",
                "166906053697940712853138072428074861410",
                "15599530448249257249075232550803945567",
                "228453116282301499677480215142590120398",
                "264228113101900782918901832678170695952",
                "52032130404328254151721316379874607215",
                "136875224503095262700382188136462264408",
                "95897246870355843142264666506200600468",
                "39170606646261409089516977285414691754",
                "33756736089150110926539471719057058152",
                "167652610803949011345541283740329943643",
                "157241764066634333264816425047470156360",
                "101442318650027951774837009894850008864",
                "28713786854498400779624321597292439534",
                "82177879875541929985808865682124803066",
                "132480047095815826167490403889680708589",
                "271987762764077692959617372378516947031",
                "325407480764719204184984814810772311104"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21751-f612e80b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@23a86c76a1a197e8fbbbd0ce3e826eb58c471624",
            "target": {
              "file": "drivers/net/ethernet/mellanox/mlx5/core/steering/hws/matcher.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "472dd792348f6601ccaa97d5626ee4faff891901"
            },
            {
              "fixed": "5682aad0276ff9b9b0eff3188eb6a1f504d6b436"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "472dd792348f6601ccaa97d5626ee4faff891901"
            },
            {
              "fixed": "23a86c76a1a197e8fbbbd0ce3e826eb58c471624"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "472dd792348f6601ccaa97d5626ee4faff891901"
            },
            {
              "fixed": "1ce840c7a659aa53a31ef49f0271b4fd0dc10296"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.11",
        "v6.11-rc7",
        "v6.12",
        "v6.12-rc1",
        "v6.12-rc2",
        "v6.12-rc3",
        "v6.12-rc4",
        "v6.12-rc5",
        "v6.12-rc6",
        "v6.12-rc7",
        "v6.12.1",
        "v6.12.10",
        "v6.12.11",
        "v6.12.12",
        "v6.12.13",
        "v6.12.14",
        "v6.12.15",
        "v6.12.16",
        "v6.12.17",
        "v6.12.18",
        "v6.12.19",
        "v6.12.2",
        "v6.12.20",
        "v6.12.21",
        "v6.12.22",
        "v6.12.23",
        "v6.12.24",
        "v6.12.25",
        "v6.12.26",
        "v6.12.27",
        "v6.12.28",
        "v6.12.29",
        "v6.12.3",
        "v6.12.30",
        "v6.12.31",
        "v6.12.32",
        "v6.12.33",
        "v6.12.34",
        "v6.12.35",
        "v6.12.36",
        "v6.12.37",
        "v6.12.38",
        "v6.12.39",
        "v6.12.4",
        "v6.12.40",
        "v6.12.41",
        "v6.12.42",
        "v6.12.43",
        "v6.12.44",
        "v6.12.45",
        "v6.12.46",
        "v6.12.47",
        "v6.12.5",
        "v6.12.6",
        "v6.12.7",
        "v6.12.8",
        "v6.12.9",
        "v6.13",
        "v6.13-rc1",
        "v6.13-rc2",
        "v6.13-rc3",
        "v6.13-rc4",
        "v6.13-rc5",
        "v6.13-rc6",
        "v6.13-rc7",
        "v6.13.1",
        "v6.13.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21751.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.12.0"
            },
            {
              "fixed": "6.12.48"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.13.0"
            },
            {
              "fixed": "6.13.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: HWS, change error flow on matcher disconnect\n\nCurrently, when firmware failure occurs during matcher disconnect flow,\nthe error flow of the function reconnects the matcher back and returns\nan error, which continues running the calling function and eventually\nfrees the matcher that is being disconnected.\nThis leads to a case where we have a freed matcher on the matchers list,\nwhich in turn leads to use-after-free and eventual crash.\n\nThis patch fixes that by not trying to reconnect the matcher back when\nsome FW command fails during disconnect.\n\nNote that we're dealing here with FW error. We can't overcome this\nproblem. This might lead to bad steering state (e.g. wrong connection\nbetween matchers), and will also lead to resource leakage, as it is\nthe case with any other error handling during resource destruction.\n\nHowever, the goal here is to allow the driver to continue and not crash\nthe machine with use-after-free error.",
  "id": "CVE-2025-21751",
  "modified": "2025-10-22T08:50:05.808247Z",
  "published": "2025-02-27T02:12:22Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1ce840c7a659aa53a31ef49f0271b4fd0dc10296"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/23a86c76a1a197e8fbbbd0ce3e826eb58c471624"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5682aad0276ff9b9b0eff3188eb6a1f504d6b436"
    }
  ],
  "related": [
    "CGA-cwp3-925r-xjqg",
    "CGA-hfh5-r3gf-qjqh",
    "CGA-w6q2-774w-7vp9"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "net/mlx5: HWS, change error flow on matcher disconnect"
}