{"schema_version":"1.7.3","id":"CVE-2025-38731","published":"2025-09-05T17:20:30.618Z","modified":"2025-11-20T09:54:20.271500Z","summary":"drm/xe: Fix vm_bind_ioctl double free bug","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/xe: Fix vm_bind_ioctl double free bug\n\nIf the argument check during an array bind fails, the bind_ops are freed\ntwice as seen below. Fix this by setting bind_ops to NULL after freeing.\n\n==================================================================\nBUG: KASAN: double-free in xe_vm_bind_ioctl+0x1b2/0x21f0 [xe]\nFree of addr ffff88813bb9b800 by task xe_vm/14198\n\nCPU: 5 UID: 0 PID: 14198 Comm: xe_vm Not tainted 6.16.0-xe-eudebug-cmanszew+ #520 PREEMPT(full)\nHardware name: Intel Corporation Alder Lake Client Platform/AlderLake-P DDR5 RVP, BIOS ADLPFWI1.R00.2411.A02.2110081023 10/08/2021\nCall Trace:\n <TASK>\n dump_stack_lvl+0x82/0xd0\n print_report+0xcb/0x610\n ? __virt_addr_valid+0x19a/0x300\n ? xe_vm_bind_ioctl+0x1b2/0x21f0 [xe]\n kasan_report_invalid_free+0xc8/0xf0\n ? xe_vm_bind_ioctl+0x1b2/0x21f0 [xe]\n ? xe_vm_bind_ioctl+0x1b2/0x21f0 [xe]\n check_slab_allocation+0x102/0x130\n kfree+0x10d/0x440\n ? should_fail_ex+0x57/0x2f0\n ? xe_vm_bind_ioctl+0x1b2/0x21f0 [xe]\n xe_vm_bind_ioctl+0x1b2/0x21f0 [xe]\n ? __pfx_xe_vm_bind_ioctl+0x10/0x10 [xe]\n ? __lock_acquire+0xab9/0x27f0\n ? lock_acquire+0x165/0x300\n ? drm_dev_enter+0x53/0xe0 [drm]\n ? find_held_lock+0x2b/0x80\n ? drm_dev_exit+0x30/0x50 [drm]\n ? drm_ioctl_kernel+0x128/0x1c0 [drm]\n drm_ioctl_kernel+0x128/0x1c0 [drm]\n ? __pfx_xe_vm_bind_ioctl+0x10/0x10 [xe]\n ? find_held_lock+0x2b/0x80\n ? __pfx_drm_ioctl_kernel+0x10/0x10 [drm]\n ? should_fail_ex+0x57/0x2f0\n ? __pfx_xe_vm_bind_ioctl+0x10/0x10 [xe]\n drm_ioctl+0x352/0x620 [drm]\n ? __pfx_drm_ioctl+0x10/0x10 [drm]\n ? __pfx_rpm_resume+0x10/0x10\n ? do_raw_spin_lock+0x11a/0x1b0\n ? find_held_lock+0x2b/0x80\n ? __pm_runtime_resume+0x61/0xc0\n ? rcu_is_watching+0x20/0x50\n ? trace_irq_enable.constprop.0+0xac/0xe0\n xe_drm_ioctl+0x91/0xc0 [xe]\n __x64_sys_ioctl+0xb2/0x100\n ? rcu_is_watching+0x20/0x50\n do_syscall_64+0x68/0x2e0\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\nRIP: 0033:0x7fa9acb24ded\n\n(cherry picked from commit a01b704527c28a2fd43a17a85f8996b75ec8492a)","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b43e864af0d4e74636c0e1dee857ce3275a84829"},{"fixed":"77a946bf1af0e8110ef6e243394217a17f9b7e33"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b43e864af0d4e74636c0e1dee857ce3275a84829"},{"fixed":"111fb43a557726079a67ce3ab51f602ddbf7097e"}]}],"versions":["v6.14","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.17-rc1","v6.17-rc2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38731.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"58348301260202196612032067604900210640","length":4515},"id":"CVE-2025-38731-1107b40c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@77a946bf1af0e8110ef6e243394217a17f9b7e33","target":{"file":"drivers/gpu/drm/xe/xe_vm.c","function":"xe_vm_bind_ioctl"}},{"deprecated":false,"digest":{"function_hash":"215295935048032177728476678303981391449","length":3197},"id":"CVE-2025-38731-7f2c7789","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@77a946bf1af0e8110ef6e243394217a17f9b7e33","target":{"file":"drivers/gpu/drm/xe/xe_vm.c","function":"vm_bind_ioctl_check_args"}},{"deprecated":false,"digest":{"line_hashes":["79482526406488717638502955641430327124","40287731608096732075952207379191701626","132488961023917120543027601684230022602","233739368283572862933151434294580587919","67331732407563185487720433168551101874","268825238264527006443008359820079558570","222292649231167463300390417277990245685","23459670944515109828566344950372161056"],"threshold":0.9},"id":"CVE-2025-38731-8c39c2c6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@77a946bf1af0e8110ef6e243394217a17f9b7e33","target":{"file":"drivers/gpu/drm/xe/xe_vm.c"}},{"deprecated":false,"digest":{"function_hash":"78645176018350993596873518499751950315","length":4585},"id":"CVE-2025-38731-97deb4d3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@111fb43a557726079a67ce3ab51f602ddbf7097e","target":{"file":"drivers/gpu/drm/xe/xe_vm.c","function":"xe_vm_bind_ioctl"}},{"deprecated":false,"digest":{"line_hashes":["79482526406488717638502955641430327124","40287731608096732075952207379191701626","132488961023917120543027601684230022602","233739368283572862933151434294580587919","67331732407563185487720433168551101874","268825238264527006443008359820079558570","222292649231167463300390417277990245685","23459670944515109828566344950372161056"],"threshold":0.9},"id":"CVE-2025-38731-b4ea5f6f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@111fb43a557726079a67ce3ab51f602ddbf7097e","target":{"file":"drivers/gpu/drm/xe/xe_vm.c"}},{"deprecated":false,"digest":{"function_hash":"215295935048032177728476678303981391449","length":3197},"id":"CVE-2025-38731-daff2207","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@111fb43a557726079a67ce3ab51f602ddbf7097e","target":{"file":"drivers/gpu/drm/xe/xe_vm.c","function":"vm_bind_ioctl_check_args"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.16.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38731.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/111fb43a557726079a67ce3ab51f602ddbf7097e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/77a946bf1af0e8110ef6e243394217a17f9b7e33"}]}