{"schema_version":"1.7.3","id":"CVE-2024-26130","published":"2024-02-21T16:28:18Z","modified":"2025-10-22T18:41:30.266976Z","aliases":["CGA-f4qg-9fw4-8247","GHSA-6vqw-3v5j-54x4","PYSEC-2024-225"],"related":["ALSA-2025:15608","CGA-f62w-c924-7874","CGA-fmv3-6w9v-j6vx","CGA-mg75-rw8r-52jj","CGA-mrw4-v42x-3chg","CGA-pp43-3329-7mh9","CGA-rhv7-2mv6-m9fr","MGASA-2025-0069","SUSE-SU-2024:0763-1","SUSE-SU-2024:2138-1","openSUSE-SU-2024:13710-1"],"summary":"cryptography NULL pointer deference with pkcs12.serialize_key_and_certificates when called with a non-matching certificate and private key and an hmac_hash override","details":"cryptography is a package designed to expose cryptographic primitives and recipes to Python developers. Starting in version 38.0.0 and prior to version 42.0.4, if `pkcs12.serialize_key_and_certificates` is called with both a certificate whose public key did not match the provided private key and an `encryption_algorithm` with `hmac_hash` set (via `PrivateFormat.PKCS12.encryption_builder().hmac_hash(...)`, then a NULL pointer dereference would occur, crashing the Python process. This has been resolved in version 42.0.4, the first version in which a `ValueError` is properly raised.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/pyca/cryptography","events":[{"introduced":"52d6f1a491f6ade379ace124b843ffba9fb4ab4f"},{"fixed":"fe18470f7d05f963e7267e34fdf985d81ea6ceea"}]}],"versions":["38.0.0","39.0.0","40.0.0","41.0.0","42.0.0","42.0.1","42.0.2","42.0.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26130.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/pyca/cryptography/security/advisories/GHSA-6vqw-3v5j-54x4"},{"type":"FIX","url":"https://github.com/pyca/cryptography/commit/97d231672763cdb5959a3b191e692a362f1b9e55"},{"type":"FIX","url":"https://github.com/pyca/cryptography/pull/10423"}],"database_specific":{"cwe_ids":["CWE-476"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}