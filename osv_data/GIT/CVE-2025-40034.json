{"schema_version":"1.7.3","id":"CVE-2025-40034","published":"2025-10-28T11:48:16.335Z","modified":"2025-12-01T20:07:35.469432Z","summary":"PCI/AER: Avoid NULL pointer dereference in aer_ratelimit()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nPCI/AER: Avoid NULL pointer dereference in aer_ratelimit()\n\nWhen platform firmware supplies error information to the OS, e.g., via the\nACPI APEI GHES mechanism, it may identify an error source device that\ndoesn't advertise an AER Capability and therefore dev->aer_info, which\ncontains AER stats and ratelimiting data, is NULL.\n\npci_dev_aer_stats_incr() already checks dev->aer_info for NULL, but\naer_ratelimit() did not, leading to NULL pointer dereferences like this one\nfrom the URL below:\n\n  {1}[Hardware Error]: Hardware error from APEI Generic Hardware Error Source: 0\n  {1}[Hardware Error]: event severity: corrected\n  {1}[Hardware Error]:   device_id: 0000:00:00.0\n  {1}[Hardware Error]:   vendor_id: 0x8086, device_id: 0x2020\n  {1}[Hardware Error]:   aer_cor_status: 0x00001000, aer_cor_mask: 0x00002000\n  BUG: kernel NULL pointer dereference, address: 0000000000000264\n  RIP: 0010:___ratelimit+0xc/0x1b0\n  pci_print_aer+0x141/0x360\n  aer_recover_work_func+0xb5/0x130\n\n[8086:2020] is an Intel \"Sky Lake-E DMI3 Registers\" device that claims to\nbe a Root Port but does not advertise an AER Capability.\n\nAdd a NULL check in aer_ratelimit() to avoid the NULL pointer dereference.\nNote that this also prevents ratelimiting these events from GHES.\n\n[bhelgaas: add crash details to commit log]","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a57f2bfb4a5863f83087867c0e671f2418212d23"},{"fixed":"41683624cbff0a26bb7e0627f4a7e1b51a8779a8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a57f2bfb4a5863f83087867c0e671f2418212d23"},{"fixed":"deb2f228388ff3a9d0623e3b59a053e9235c341d"}]}],"versions":["v6.15","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40034.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"135034165633923001766010463489105495127","length":282},"id":"CVE-2025-40034-1eca2d6a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@deb2f228388ff3a9d0623e3b59a053e9235c341d","target":{"file":"drivers/pci/pcie/aer.c","function":"aer_ratelimit"}},{"deprecated":false,"digest":{"line_hashes":["258548625391902220955240224388975824063","181884950179620830910504524904022108239","160288634649737274938102147865416922377","99947133764485198945533237684382396944"],"threshold":0.9},"id":"CVE-2025-40034-21d91db6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@deb2f228388ff3a9d0623e3b59a053e9235c341d","target":{"file":"drivers/pci/pcie/aer.c"}},{"deprecated":false,"digest":{"function_hash":"135034165633923001766010463489105495127","length":282},"id":"CVE-2025-40034-2fa4e2f4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@41683624cbff0a26bb7e0627f4a7e1b51a8779a8","target":{"file":"drivers/pci/pcie/aer.c","function":"aer_ratelimit"}},{"deprecated":false,"digest":{"line_hashes":["258548625391902220955240224388975824063","181884950179620830910504524904022108239","160288634649737274938102147865416922377","99947133764485198945533237684382396944"],"threshold":0.9},"id":"CVE-2025-40034-3c3a8963","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@41683624cbff0a26bb7e0627f4a7e1b51a8779a8","target":{"file":"drivers/pci/pcie/aer.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40034.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/41683624cbff0a26bb7e0627f4a7e1b51a8779a8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/deb2f228388ff3a9d0623e3b59a053e9235c341d"}]}