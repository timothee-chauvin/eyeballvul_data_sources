{"schema_version":"1.7.3","id":"CVE-2022-49152","published":"2025-02-26T01:55:18Z","modified":"2025-10-21T08:57:16.962109Z","summary":"XArray: Fix xas_create_range() when multi-order entry present","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nXArray: Fix xas_create_range() when multi-order entry present\n\nIf there is already an entry present that is of order >= XA_CHUNK_SHIFT\nwhen we call xas_create_range(), xas_create_range() will misinterpret\nthat entry as a node and dereference xa_node->parent, generally leading\nto a crash that looks something like this:\n\ngeneral protection fault, probably for non-canonical address 0xdffffc0000000001:\n0000 [#1] PREEMPT SMP KASAN\nKASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]\nCPU: 0 PID: 32 Comm: khugepaged Not tainted 5.17.0-rc8-syzkaller-00003-g56e337f2cf13 #0\nRIP: 0010:xa_parent_locked include/linux/xarray.h:1207 [inline]\nRIP: 0010:xas_create_range+0x2d9/0x6e0 lib/xarray.c:725\n\nIt's deterministically reproducable once you know what the problem is,\nbut producing it in a live kernel requires khugepaged to hit a race.\nWhile the problem has been present since xas_create_range() was\nintroduced, I'm not aware of a way to hit it before the page cache was\nconverted to use multi-index entries.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"6b24ca4a1a8d4ee3221d6d44ddbb99f542e4bda3"},{"fixed":"18f13edf3424b3b61814b69d5269b2e14584800c"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"6b24ca4a1a8d4ee3221d6d44ddbb99f542e4bda3"},{"fixed":"3e3c658055c002900982513e289398a1aad4a488"}]}],"versions":["v5.16","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49152.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"279580651357910770193350271706372840124","length":912},"id":"CVE-2022-49152-1bb6b1d4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@18f13edf3424b3b61814b69d5269b2e14584800c","target":{"file":"lib/test_xarray.c","function":"check_create_range"}},{"deprecated":false,"digest":{"function_hash":"168462413731251386788828017925001027626","length":901},"id":"CVE-2022-49152-201f4f59","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@18f13edf3424b3b61814b69d5269b2e14584800c","target":{"file":"lib/xarray.c","function":"xas_create_range"}},{"deprecated":false,"digest":{"line_hashes":["236673303370232155483406321399916443377","302966042083978661609530475600328596886","194941478556462271455606108017519218742","127865027862046429326916198526544196764","337834453572243824018765013483992273278","263063904871549353171626482576552912513","38233224495242408979650463536233543149"],"threshold":0.9},"id":"CVE-2022-49152-416aef65","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@18f13edf3424b3b61814b69d5269b2e14584800c","target":{"file":"lib/test_xarray.c"}},{"deprecated":false,"digest":{"function_hash":"168462413731251386788828017925001027626","length":901},"id":"CVE-2022-49152-71ee8259","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e3c658055c002900982513e289398a1aad4a488","target":{"file":"lib/xarray.c","function":"xas_create_range"}},{"deprecated":false,"digest":{"line_hashes":["236673303370232155483406321399916443377","302966042083978661609530475600328596886","194941478556462271455606108017519218742","127865027862046429326916198526544196764","337834453572243824018765013483992273278","263063904871549353171626482576552912513","38233224495242408979650463536233543149"],"threshold":0.9},"id":"CVE-2022-49152-72670dc2","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e3c658055c002900982513e289398a1aad4a488","target":{"file":"lib/test_xarray.c"}},{"deprecated":false,"digest":{"line_hashes":["338020990777416942166546940713349574374","286833840448209916202213219334795824304","293580865110768879107887752964411041770","120970443224700431308221753571526366595"],"threshold":0.9},"id":"CVE-2022-49152-a7024f70","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@18f13edf3424b3b61814b69d5269b2e14584800c","target":{"file":"lib/xarray.c"}},{"deprecated":false,"digest":{"function_hash":"279580651357910770193350271706372840124","length":912},"id":"CVE-2022-49152-da6f58d0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e3c658055c002900982513e289398a1aad4a488","target":{"file":"lib/test_xarray.c","function":"check_create_range"}},{"deprecated":false,"digest":{"line_hashes":["338020990777416942166546940713349574374","286833840448209916202213219334795824304","293580865110768879107887752964411041770","120970443224700431308221753571526366595"],"threshold":0.9},"id":"CVE-2022-49152-e90bfc43","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e3c658055c002900982513e289398a1aad4a488","target":{"file":"lib/xarray.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49152.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/18f13edf3424b3b61814b69d5269b2e14584800c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3e3c658055c002900982513e289398a1aad4a488"}]}