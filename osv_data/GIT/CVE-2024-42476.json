{"schema_version":"1.7.3","id":"CVE-2024-42476","published":"2024-08-15T18:48:08Z","modified":"2025-10-22T18:43:08.713273Z","aliases":["GHSA-pc9j-53g7-5x54"],"summary":"oauth CSRF vulnerability","details":"In the OAuth library for nim prior to version 0.11, the Authorization Code grant and Implicit grant both rely on the `state` parameter to prevent cross-site request forgery (CSRF) attacks where a resource owner might have their session associated with protected resources belonging to an attacker. When this project is compiled with certain compiler flags set, it is possible that the `state` parameter will not be checked at all, creating a CSRF vulnerability. Version 0.11 checks the `state` parameter using a regular `if` statement or `doAssert` instead of relying on a plain `assert`. `doAssert` will achieve the desired behavior even if `-d:danger` or `--assertions:off` is set.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/cordea/oauth","events":[{"introduced":"0"},{"fixed":"ec2e058fc46f04deaf3cb55eca32b3b83c614953"}]}],"versions":["v0.10","v0.2","v0.3","v0.4","v0.4.1","v0.5","v0.6","v0.7","v0.8","v0.9"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42476.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CORDEA/oauth/security/advisories/GHSA-pc9j-53g7-5x54"},{"type":"WEB","url":"https://github.com/CORDEA/oauth/blob/b8c163b0d9cfad6d29ce8c1fb394e5f47182ee1c/src/oauth2.nim#L235"},{"type":"WEB","url":"https://github.com/CORDEA/oauth/blob/b8c163b0d9cfad6d29ce8c1fb394e5f47182ee1c/src/oauth2.nim#L255"}],"database_specific":{"cwe_ids":["CWE-352"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N"}]}