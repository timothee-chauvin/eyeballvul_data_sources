{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-29224.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "24041686724182097173256306906080501288",
                "252967638319918323834073665705927279000",
                "271139533640407507398622199373409479623"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-29224-5831657f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/9b1c3962172a972bc0359398af6daa3790bb59db",
            "target": {
              "file": "test/common/upstream/health_checker_impl_test.cc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "3749512947775229565343376235121669038",
              "length": 549.0
            },
            "id": "CVE-2022-29224-ad35a70d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/9b1c3962172a972bc0359398af6daa3790bb59db",
            "target": {
              "file": "source/common/upstream/health_checker_impl.cc",
              "function": "GrpcHealthCheckerImpl::GrpcActiveHealthCheckSession::onRpcComplete"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "235595305435126318241125707023326192390",
                "164129799215690160411934611783827995787",
                "246951694618104111347878013845969191046",
                "50825736953436195541821108831604264466",
                "239489752693216153541047302784892117151",
                "258308413937337240082288438209359107065",
                "100465983463732742019063373106271287746",
                "250009255018626236861819001791874241231",
                "168365465298933049712943297248497827927",
                "27643905264031195804911934959448270271",
                "259646350999562208378967093275756429114",
                "244622674933507111277468325651466690440",
                "293427927840762721365986514940068808884",
                "79147873236443861286944112011218473784"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-29224-c66bf4f5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/9b1c3962172a972bc0359398af6daa3790bb59db",
            "target": {
              "file": "source/common/upstream/health_checker_impl.cc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "185503534765757608212591793565849056616",
              "length": 538.0
            },
            "id": "CVE-2022-29224-fb495a12",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/envoyproxy/envoy/commit/9b1c3962172a972bc0359398af6daa3790bb59db",
            "target": {
              "file": "source/common/upstream/health_checker_impl.cc",
              "function": "GrpcHealthCheckerImpl::GrpcActiveHealthCheckSession::onGoAway"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "9b1c3962172a972bc0359398af6daa3790bb59db"
            }
          ],
          "repo": "https://github.com/envoyproxy/envoy",
          "type": "GIT"
        }
      ],
      "versions": []
    }
  ],
  "aliases": [
    "BIT-envoy-2022-29224"
  ],
  "details": "Envoy is a cloud-native high-performance proxy. Versions of envoy prior to 1.22.1 are subject to a segmentation fault in the GrpcHealthCheckerImpl. Envoy can perform various types of upstream health checking. One of them uses gRPC. Envoy also has a feature which can \u201chold\u201d (prevent removal) upstream hosts obtained via service discovery until configured active health checking fails. If an attacker controls an upstream host and also controls service discovery of that host (via DNS, the EDS API, etc.), an attacker can crash Envoy by forcing removal of the host from service discovery, and then failing the gRPC health check request. This will crash Envoy via a null pointer dereference. Users are advised to upgrade to resolve this vulnerability. Users unable to upgrade may disable gRPC health checking and/or replace it with a different health checking type as a mitigation.",
  "id": "CVE-2022-29224",
  "modified": "2025-07-01T18:04:13Z",
  "published": "2022-06-09T19:15:10Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-m4j9-86g3-8f49"
    },
    {
      "type": "FIX",
      "url": "https://github.com/envoyproxy/envoy/commit/9b1c3962172a972bc0359398af6daa3790bb59db"
    }
  ],
  "related": [
    "GHSA-m4j9-86g3-8f49"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ]
}