{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21696.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "236977285983785899620535476934688271009",
              "length": 1208.0
            },
            "id": "CVE-2025-21696-013ac6af",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/mremap.c",
              "function": "move_ptes"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "25842114185487299857265983642391716077",
                "283202145690778682205889966677599971782",
                "1126880549686419687480597959488351932",
                "159953546146322371939794924619458022528",
                "251789530843864452737865912197023686358",
                "33484173707173575315223521318948967075",
                "264310326518866034983334344500519070563",
                "45174390059216371439901562844392836823"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-03e99aac",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/hugetlb.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "122496953266106657411296278150343235011",
                "97646567325986264998455196834339787648",
                "303134716301366665141759707499190762182",
                "111429716191227378384538057677408244665",
                "37124437733065523744626765438005028683",
                "269896746848011924705202535478236247024"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-05d020e2",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "include/linux/userfaultfd_k.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "25000743885793043519079084991761688283",
              "length": 528.0
            },
            "id": "CVE-2025-21696-0dc309ea",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/hugetlb.c",
              "function": "move_huge_pte"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "25000743885793043519079084991761688283",
              "length": 528.0
            },
            "id": "CVE-2025-21696-0ee776e3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/hugetlb.c",
              "function": "move_huge_pte"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "116646138050024284335220658378814236583",
              "length": 657.0
            },
            "id": "CVE-2025-21696-29a300e4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/mremap.c",
              "function": "move_normal_pud"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "91936663029407752367720425455572430786",
                "289695046339000709935878581016054217476",
                "95031663997129128183644384946199459791",
                "75603698926618389534692407574612787939",
                "75390098543085922742325765452291878611",
                "225355819055729223206047935745585168222",
                "303194006010623952293019741748162955319"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-2fbbfb1f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/huge_memory.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "285331956068422426821364071296164100856",
                "303263670064760027164580851423941003889",
                "179568766286867245346198615141208561718",
                "1778323555658950331150022930673110629",
                "218141713657156208584777354509506017059",
                "93891877448246695382110314337423251804",
                "146893735436428800983312940882824895790",
                "104434984268440644783913251904285434208",
                "220108759961020368734651141979724048901",
                "330609615285100139244318045395130620478",
                "137586252339255593434059259461491086792",
                "76540239746408621566418371452237330464",
                "72077477271127323564964972754895758269",
                "81625688981858205294951127328772885772"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-455954da",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/mremap.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "91936663029407752367720425455572430786",
                "289695046339000709935878581016054217476",
                "95031663997129128183644384946199459791",
                "75603698926618389534692407574612787939",
                "75390098543085922742325765452291878611",
                "225355819055729223206047935745585168222",
                "303194006010623952293019741748162955319"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-4beaff4e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/huge_memory.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "20385993018323934398546413385871146379",
              "length": 873.0
            },
            "id": "CVE-2025-21696-55d4acd4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "move_huge_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "25842114185487299857265983642391716077",
                "283202145690778682205889966677599971782",
                "1126880549686419687480597959488351932",
                "159953546146322371939794924619458022528",
                "251789530843864452737865912197023686358",
                "33484173707173575315223521318948967075",
                "264310326518866034983334344500519070563",
                "45174390059216371439901562844392836823"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-57c29705",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/hugetlb.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "122496953266106657411296278150343235011",
                "97646567325986264998455196834339787648",
                "303134716301366665141759707499190762182",
                "111429716191227378384538057677408244665",
                "37124437733065523744626765438005028683",
                "269896746848011924705202535478236247024"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-9acb8c50",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "include/linux/userfaultfd_k.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "316861109032863551341186972360618216868",
              "length": 1228.0
            },
            "id": "CVE-2025-21696-abbe7190",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/mremap.c",
              "function": "move_ptes"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "18486648587798982774578673734504010103",
              "length": 779.0
            },
            "id": "CVE-2025-21696-bc4d01da",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@310ac886d68de661c3a334198d8604b722d7fdf8",
            "target": {
              "file": "mm/mremap.c",
              "function": "move_normal_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "18486648587798982774578673734504010103",
              "length": 779.0
            },
            "id": "CVE-2025-21696-ca1181ac",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/mremap.c",
              "function": "move_normal_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "20385993018323934398546413385871146379",
              "length": 873.0
            },
            "id": "CVE-2025-21696-e0bc724a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "move_huge_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "285331956068422426821364071296164100856",
                "303263670064760027164580851423941003889",
                "179568766286867245346198615141208561718",
                "229550621851677837860588493776218675389",
                "218141713657156208584777354509506017059",
                "93891877448246695382110314337423251804",
                "146893735436428800983312940882824895790",
                "104434984268440644783913251904285434208",
                "220108759961020368734651141979724048901",
                "330609615285100139244318045395130620478",
                "137586252339255593434059259461491086792",
                "76540239746408621566418371452237330464",
                "72077477271127323564964972754895758269",
                "81625688981858205294951127328772885772"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-21696-f3e805f9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/mremap.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "116646138050024284335220658378814236583",
              "length": 657.0
            },
            "id": "CVE-2025-21696-fc1ba0e2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0cef0bb836e3cfe00f08f9606c72abd72fe78ca3",
            "target": {
              "file": "mm/mremap.c",
              "function": "move_normal_pud"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "63b2d4174c4ad1f40b48d7138e71bcb564c1fe03"
            },
            {
              "fixed": "310ac886d68de661c3a334198d8604b722d7fdf8"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "63b2d4174c4ad1f40b48d7138e71bcb564c1fe03"
            },
            {
              "fixed": "0cef0bb836e3cfe00f08f9606c72abd72fe78ca3"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.10",
        "v5.10-rc1",
        "v5.10-rc2",
        "v5.10-rc3",
        "v5.10-rc4",
        "v5.10-rc5",
        "v5.10-rc6",
        "v5.10-rc7",
        "v5.11",
        "v5.11-rc1",
        "v5.11-rc2",
        "v5.11-rc3",
        "v5.11-rc4",
        "v5.11-rc5",
        "v5.11-rc6",
        "v5.11-rc7",
        "v5.12",
        "v5.12-rc1",
        "v5.12-rc1-dontuse",
        "v5.12-rc2",
        "v5.12-rc3",
        "v5.12-rc4",
        "v5.12-rc5",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v5.7",
        "v5.7-rc1",
        "v5.7-rc2",
        "v5.7-rc3",
        "v5.7-rc4",
        "v5.7-rc5",
        "v5.7-rc6",
        "v5.7-rc7",
        "v5.8",
        "v5.8-rc1",
        "v5.8-rc2",
        "v5.8-rc3",
        "v5.8-rc4",
        "v5.8-rc5",
        "v5.8-rc6",
        "v5.8-rc7",
        "v5.9",
        "v5.9-rc1",
        "v5.9-rc2",
        "v5.9-rc3",
        "v5.9-rc4",
        "v5.9-rc5",
        "v5.9-rc6",
        "v5.9-rc7",
        "v5.9-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.11",
        "v6.11-rc1",
        "v6.11-rc2",
        "v6.11-rc3",
        "v6.11-rc4",
        "v6.11-rc5",
        "v6.11-rc6",
        "v6.11-rc7",
        "v6.12",
        "v6.12-rc1",
        "v6.12-rc2",
        "v6.12-rc3",
        "v6.12-rc4",
        "v6.12-rc5",
        "v6.12-rc6",
        "v6.12-rc7",
        "v6.12.1",
        "v6.12.10",
        "v6.12.2",
        "v6.12.3",
        "v6.12.4",
        "v6.12.5",
        "v6.12.6",
        "v6.12.7",
        "v6.12.8",
        "v6.12.9",
        "v6.13-rc1",
        "v6.13-rc2",
        "v6.13-rc3",
        "v6.13-rc4",
        "v6.13-rc5",
        "v6.13-rc6",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21696.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.7.0"
            },
            {
              "fixed": "6.12.11"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: clear uffd-wp PTE/PMD state on mremap()\n\nWhen mremap()ing a memory region previously registered with userfaultfd as\nwrite-protected but without UFFD_FEATURE_EVENT_REMAP, an inconsistency in\nflag clearing leads to a mismatch between the vma flags (which have\nuffd-wp cleared) and the pte/pmd flags (which do not have uffd-wp\ncleared).  This mismatch causes a subsequent mprotect(PROT_WRITE) to\ntrigger a warning in page_table_check_pte_flags() due to setting the pte\nto writable while uffd-wp is still set.\n\nFix this by always explicitly clearing the uffd-wp pte/pmd flags on any\nsuch mremap() so that the values are consistent with the existing clearing\nof VM_UFFD_WP.  Be careful to clear the logical flag regardless of its\nphysical form; a PTE bit, a swap PTE bit, or a PTE marker.  Cover PTE,\nhuge PMD and hugetlb paths.",
  "id": "CVE-2025-21696",
  "modified": "2025-10-22T08:31:54.462236Z",
  "published": "2025-02-12T13:27:54Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0cef0bb836e3cfe00f08f9606c72abd72fe78ca3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/310ac886d68de661c3a334198d8604b722d7fdf8"
    }
  ],
  "related": [
    "SUSE-SU-2025:01707-1",
    "SUSE-SU-2025:01919-1",
    "SUSE-SU-2025:01951-1",
    "SUSE-SU-2025:01964-1",
    "SUSE-SU-2025:01967-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "mm: clear uffd-wp PTE/PMD state on mremap()"
}