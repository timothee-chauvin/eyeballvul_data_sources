{"schema_version":"1.7.3","id":"CVE-2025-21746","published":"2025-02-27T02:12:18.477Z","modified":"2025-11-20T08:29:10.929208Z","related":["USN-7521-2"],"summary":"Input: synaptics - fix crash when enabling pass-through port","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nInput: synaptics - fix crash when enabling pass-through port\n\nWhen enabling a pass-through port an interrupt might come before psmouse\ndriver binds to the pass-through port. However synaptics sub-driver\ntries to access psmouse instance presumably associated with the\npass-through port to figure out if only 1 byte of response or entire\nprotocol packet needs to be forwarded to the pass-through port and may\ncrash if psmouse instance has not been attached to the port yet.\n\nFix the crash by introducing open() and close() methods for the port and\ncheck if the port is open before trying to access psmouse instance.\nBecause psmouse calls serio_open() only after attaching psmouse instance\nto serio port instance this prevents the potential crash.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"100e16959c3ca8cb7be788ed3e2c5867481f35f6"},{"fixed":"a2cbcd70133dc0d4d4c95ad4cd5412b935354c7c"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"100e16959c3ca8cb7be788ed3e2c5867481f35f6"},{"fixed":"3e179d3f1ada963475395d81bfe91daef4d1a24c"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"100e16959c3ca8cb7be788ed3e2c5867481f35f6"},{"fixed":"87da1ea93ec9f9f0004e5b12e78789bc94e360bf"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"100e16959c3ca8cb7be788ed3e2c5867481f35f6"},{"fixed":"08bd5b7c9a2401faabdaa1472d45c7de0755fd7e"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.2","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.2","v6.3","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21746.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["291470763259960079303608462937266962614","289747855278997311119541180934225570100","39379273990291663598658602778975358689","194864444044834602806939180259511131797","266626049891764375574571945127713011527","216755496837169827226872796947263141636","320208074270943425877506286520550401851","49975449391581877365431870969023420487","300247319788139523613790646266618460851","217276276362142629589021462291293170104","84343136803935052849567443128637735016","339267526145192321380424060026038034134","309453192906518025964205584247244831153","68918115023299343173071027358446566097","161758471623834105393725602602650184181","247232790853558209433999992618363751038","247591834322140426954060232793190790133","110948639605492764747600243714216781374","13797838720387670112896995550258424118","297489808780654014563320608770464498846","173873407657453476426315345328360724604","195764194983601801168264150636538679261","102868308636793807850258092622360209768","192268169930889753938337072671125753650","30230810799448171185328560390232028911","66243879887962508357951285213907414409","250379066747166145941127559948214208488","295557787401029681908108441913379865839","184474890175620923369796990538806436052","179544151242804104002131947848273074532"],"threshold":0.9},"id":"CVE-2025-21746-14504475","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e179d3f1ada963475395d81bfe91daef4d1a24c","target":{"file":"drivers/input/mouse/synaptics.c"}},{"deprecated":false,"digest":{"function_hash":"48729525561138897930898559700497242195","length":683},"id":"CVE-2025-21746-1c3e05f3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2cbcd70133dc0d4d4c95ad4cd5412b935354c7c","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pt_create"}},{"deprecated":false,"digest":{"line_hashes":["9604014915951862352430310282814108986","161582058896162863091011774641386901586","222621287561022046071024033300003443847","175801150893191967011763801139907016098"],"threshold":0.9},"id":"CVE-2025-21746-22006668","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@08bd5b7c9a2401faabdaa1472d45c7de0755fd7e","target":{"file":"drivers/input/mouse/synaptics.h"}},{"deprecated":false,"digest":{"line_hashes":["9604014915951862352430310282814108986","161582058896162863091011774641386901586","222621287561022046071024033300003443847","175801150893191967011763801139907016098"],"threshold":0.9},"id":"CVE-2025-21746-27f6f365","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@87da1ea93ec9f9f0004e5b12e78789bc94e360bf","target":{"file":"drivers/input/mouse/synaptics.h"}},{"deprecated":false,"digest":{"function_hash":"261346571883130167243172926223980322350","length":512},"id":"CVE-2025-21746-2f42fe98","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e179d3f1ada963475395d81bfe91daef4d1a24c","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_process_byte"}},{"deprecated":false,"digest":{"function_hash":"89420593357425281286179460588337905320","length":683},"id":"CVE-2025-21746-4044e2ab","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e179d3f1ada963475395d81bfe91daef4d1a24c","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pt_create"}},{"deprecated":false,"digest":{"line_hashes":["9604014915951862352430310282814108986","161582058896162863091011774641386901586","222621287561022046071024033300003443847","175801150893191967011763801139907016098"],"threshold":0.9},"id":"CVE-2025-21746-43ed11fe","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e179d3f1ada963475395d81bfe91daef4d1a24c","target":{"file":"drivers/input/mouse/synaptics.h"}},{"deprecated":false,"digest":{"line_hashes":["291470763259960079303608462937266962614","289747855278997311119541180934225570100","39379273990291663598658602778975358689","194864444044834602806939180259511131797","266626049891764375574571945127713011527","216755496837169827226872796947263141636","320208074270943425877506286520550401851","49975449391581877365431870969023420487","300247319788139523613790646266618460851","217276276362142629589021462291293170104","84343136803935052849567443128637735016","339267526145192321380424060026038034134","309453192906518025964205584247244831153","68918115023299343173071027358446566097","161758471623834105393725602602650184181","247232790853558209433999992618363751038","247591834322140426954060232793190790133","110948639605492764747600243714216781374","13797838720387670112896995550258424118","297489808780654014563320608770464498846","173873407657453476426315345328360724604","195764194983601801168264150636538679261","102868308636793807850258092622360209768","192268169930889753938337072671125753650","30230810799448171185328560390232028911","66243879887962508357951285213907414409","250379066747166145941127559948214208488","295557787401029681908108441913379865839","184474890175620923369796990538806436052","179544151242804104002131947848273074532"],"threshold":0.9},"id":"CVE-2025-21746-47560530","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2cbcd70133dc0d4d4c95ad4cd5412b935354c7c","target":{"file":"drivers/input/mouse/synaptics.c"}},{"deprecated":false,"digest":{"function_hash":"261346571883130167243172926223980322350","length":512},"id":"CVE-2025-21746-71453d44","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@87da1ea93ec9f9f0004e5b12e78789bc94e360bf","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_process_byte"}},{"deprecated":false,"digest":{"function_hash":"261346571883130167243172926223980322350","length":512},"id":"CVE-2025-21746-74a51f93","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2cbcd70133dc0d4d4c95ad4cd5412b935354c7c","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_process_byte"}},{"deprecated":false,"digest":{"function_hash":"259306058622448952901295685720410737122","length":377},"id":"CVE-2025-21746-77af3591","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2cbcd70133dc0d4d4c95ad4cd5412b935354c7c","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pass_pt_packet"}},{"deprecated":false,"digest":{"function_hash":"259306058622448952901295685720410737122","length":377},"id":"CVE-2025-21746-87cc0923","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3e179d3f1ada963475395d81bfe91daef4d1a24c","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pass_pt_packet"}},{"deprecated":false,"digest":{"function_hash":"259306058622448952901295685720410737122","length":377},"id":"CVE-2025-21746-a121f0fb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@08bd5b7c9a2401faabdaa1472d45c7de0755fd7e","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pass_pt_packet"}},{"deprecated":false,"digest":{"function_hash":"259306058622448952901295685720410737122","length":377},"id":"CVE-2025-21746-a1894943","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@87da1ea93ec9f9f0004e5b12e78789bc94e360bf","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pass_pt_packet"}},{"deprecated":false,"digest":{"line_hashes":["57563822823669162461199885313577296598","258424557813736866029463798136752630017","39379273990291663598658602778975358689","194864444044834602806939180259511131797","266626049891764375574571945127713011527","216755496837169827226872796947263141636","320208074270943425877506286520550401851","49975449391581877365431870969023420487","300247319788139523613790646266618460851","217276276362142629589021462291293170104","84343136803935052849567443128637735016","339267526145192321380424060026038034134","309453192906518025964205584247244831153","68918115023299343173071027358446566097","161758471623834105393725602602650184181","247232790853558209433999992618363751038","247591834322140426954060232793190790133","110948639605492764747600243714216781374","13797838720387670112896995550258424118","297489808780654014563320608770464498846","173873407657453476426315345328360724604","195764194983601801168264150636538679261","102868308636793807850258092622360209768","192268169930889753938337072671125753650","30230810799448171185328560390232028911","66243879887962508357951285213907414409","250379066747166145941127559948214208488","295557787401029681908108441913379865839","184474890175620923369796990538806436052","179544151242804104002131947848273074532"],"threshold":0.9},"id":"CVE-2025-21746-a5063aee","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@87da1ea93ec9f9f0004e5b12e78789bc94e360bf","target":{"file":"drivers/input/mouse/synaptics.c"}},{"deprecated":false,"digest":{"line_hashes":["57563822823669162461199885313577296598","258424557813736866029463798136752630017","39379273990291663598658602778975358689","194864444044834602806939180259511131797","266626049891764375574571945127713011527","216755496837169827226872796947263141636","320208074270943425877506286520550401851","49975449391581877365431870969023420487","300247319788139523613790646266618460851","217276276362142629589021462291293170104","84343136803935052849567443128637735016","339267526145192321380424060026038034134","309453192906518025964205584247244831153","68918115023299343173071027358446566097","161758471623834105393725602602650184181","247232790853558209433999992618363751038","247591834322140426954060232793190790133","110948639605492764747600243714216781374","13797838720387670112896995550258424118","297489808780654014563320608770464498846","173873407657453476426315345328360724604","195764194983601801168264150636538679261","102868308636793807850258092622360209768","192268169930889753938337072671125753650","30230810799448171185328560390232028911","66243879887962508357951285213907414409","250379066747166145941127559948214208488","295557787401029681908108441913379865839","184474890175620923369796990538806436052","179544151242804104002131947848273074532"],"threshold":0.9},"id":"CVE-2025-21746-b9f8fd94","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@08bd5b7c9a2401faabdaa1472d45c7de0755fd7e","target":{"file":"drivers/input/mouse/synaptics.c"}},{"deprecated":false,"digest":{"function_hash":"89420593357425281286179460588337905320","length":683},"id":"CVE-2025-21746-ce2297c7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@08bd5b7c9a2401faabdaa1472d45c7de0755fd7e","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pt_create"}},{"deprecated":false,"digest":{"line_hashes":["9604014915951862352430310282814108986","161582058896162863091011774641386901586","222621287561022046071024033300003443847","175801150893191967011763801139907016098"],"threshold":0.9},"id":"CVE-2025-21746-d60d9010","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2cbcd70133dc0d4d4c95ad4cd5412b935354c7c","target":{"file":"drivers/input/mouse/synaptics.h"}},{"deprecated":false,"digest":{"function_hash":"89420593357425281286179460588337905320","length":683},"id":"CVE-2025-21746-dff86f47","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@87da1ea93ec9f9f0004e5b12e78789bc94e360bf","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_pt_create"}},{"deprecated":false,"digest":{"function_hash":"261346571883130167243172926223980322350","length":512},"id":"CVE-2025-21746-f3fa4bf1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@08bd5b7c9a2401faabdaa1472d45c7de0755fd7e","target":{"file":"drivers/input/mouse/synaptics.c","function":"synaptics_process_byte"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.5.0"},{"fixed":"6.6.80"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.17"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21746.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/08bd5b7c9a2401faabdaa1472d45c7de0755fd7e"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3e179d3f1ada963475395d81bfe91daef4d1a24c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/87da1ea93ec9f9f0004e5b12e78789bc94e360bf"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a2cbcd70133dc0d4d4c95ad4cd5412b935354c7c"}]}