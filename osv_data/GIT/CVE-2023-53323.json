{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53323.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "64345819663824807277204190002694887551",
                "227221950848307990612378751411446506695",
                "280393395219756998385733472700863993662",
                "58236835094672413045038424998832805733",
                "232352440582708965497933052499410686831",
                "170341755865522817782561645566026696248"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53323-11697f00",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcced95b6ba2a507a83b8b3e0358a8ac16b13e35",
            "target": {
              "file": "fs/ext2/inode.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "73945476955653762449996858733314104485",
              "length": 848.0
            },
            "id": "CVE-2023-53323-4283c2e6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5cee8bfb8cbd99c97aff85d2bf066b6a496e13ab",
            "target": {
              "file": "fs/ext2/inode.c",
              "function": "ext2_setsize"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "64345819663824807277204190002694887551",
                "227221950848307990612378751411446506695",
                "280393395219756998385733472700863993662",
                "58236835094672413045038424998832805733",
                "232352440582708965497933052499410686831",
                "170341755865522817782561645566026696248"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53323-5fd4bf2f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9e54fd14bd143c261e52fde74355e85e9526c58c",
            "target": {
              "file": "fs/ext2/inode.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "64345819663824807277204190002694887551",
                "227221950848307990612378751411446506695",
                "280393395219756998385733472700863993662",
                "58236835094672413045038424998832805733",
                "232352440582708965497933052499410686831",
                "170341755865522817782561645566026696248"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53323-7403de78",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5cee8bfb8cbd99c97aff85d2bf066b6a496e13ab",
            "target": {
              "file": "fs/ext2/inode.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "73945476955653762449996858733314104485",
              "length": 848.0
            },
            "id": "CVE-2023-53323-9f4aeca1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9e54fd14bd143c261e52fde74355e85e9526c58c",
            "target": {
              "file": "fs/ext2/inode.c",
              "function": "ext2_setsize"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "73945476955653762449996858733314104485",
              "length": 848.0
            },
            "id": "CVE-2023-53323-e50aadfb",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcced95b6ba2a507a83b8b3e0358a8ac16b13e35",
            "target": {
              "file": "fs/ext2/inode.c",
              "function": "ext2_setsize"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "2aa3048e03d38d5358be2553d4b638c1a018498c"
            },
            {
              "fixed": "9e54fd14bd143c261e52fde74355e85e9526c58c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "2aa3048e03d38d5358be2553d4b638c1a018498c"
            },
            {
              "fixed": "5cee8bfb8cbd99c97aff85d2bf066b6a496e13ab"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "2aa3048e03d38d5358be2553d4b638c1a018498c"
            },
            {
              "fixed": "fcced95b6ba2a507a83b8b3e0358a8ac16b13e35"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.14",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1",
        "v6.1.10",
        "v6.1.11",
        "v6.1.12",
        "v6.1.13",
        "v6.1.14",
        "v6.1.15",
        "v6.1.16",
        "v6.1.17",
        "v6.1.18",
        "v6.1.19",
        "v6.1.2",
        "v6.1.20",
        "v6.1.21",
        "v6.1.22",
        "v6.1.23",
        "v6.1.24",
        "v6.1.25",
        "v6.1.26",
        "v6.1.27",
        "v6.1.28",
        "v6.1.29",
        "v6.1.3",
        "v6.1.30",
        "v6.1.31",
        "v6.1.32",
        "v6.1.33",
        "v6.1.34",
        "v6.1.35",
        "v6.1.36",
        "v6.1.37",
        "v6.1.38",
        "v6.1.39",
        "v6.1.4",
        "v6.1.5",
        "v6.1.6",
        "v6.1.7",
        "v6.1.8",
        "v6.1.9",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.4.1",
        "v6.4.2",
        "v6.4.3",
        "v6.4.4"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53323.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.15.0"
            },
            {
              "fixed": "6.1.40"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.4.5"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\next2/dax: Fix ext2_setsize when len is page aligned\n\nPAGE_ALIGN(x) macro gives the next highest value which is multiple of\npagesize. But if x is already page aligned then it simply returns x.\nSo, if x passed is 0 in dax_zero_range() function, that means the\nlength gets passed as 0 to ->iomap_begin().\n\nIn ext2 it then calls ext2_get_blocks -> max_blocks as 0 and hits bug_on\nhere in ext2_get_blocks().\n\tBUG_ON(maxblocks == 0);\n\nInstead we should be calling dax_truncate_page() here which takes\ncare of it. i.e. it only calls dax_zero_range if the offset is not\npage/block aligned.\n\nThis can be easily triggered with following on fsdax mounted pmem\ndevice.\n\ndd if=/dev/zero of=file count=1 bs=512\ntruncate -s 0 file\n\n[79.525838] EXT2-fs (pmem0): DAX enabled. Warning: EXPERIMENTAL, use at your own risk\n[79.529376] ext2 filesystem being mounted at /mnt1/test supports timestamps until 2038 (0x7fffffff)\n[93.793207] ------------[ cut here ]------------\n[93.795102] kernel BUG at fs/ext2/inode.c:637!\n[93.796904] invalid opcode: 0000 [#1] PREEMPT SMP PTI\n[93.798659] CPU: 0 PID: 1192 Comm: truncate Not tainted 6.3.0-rc2-xfstests-00056-g131086faa369 #139\n[93.806459] RIP: 0010:ext2_get_blocks.constprop.0+0x524/0x610\n<...>\n[93.835298] Call Trace:\n[93.836253]  <TASK>\n[93.837103]  ? lock_acquire+0xf8/0x110\n[93.838479]  ? d_lookup+0x69/0xd0\n[93.839779]  ext2_iomap_begin+0xa7/0x1c0\n[93.841154]  iomap_iter+0xc7/0x150\n[93.842425]  dax_zero_range+0x6e/0xa0\n[93.843813]  ext2_setsize+0x176/0x1b0\n[93.845164]  ext2_setattr+0x151/0x200\n[93.846467]  notify_change+0x341/0x4e0\n[93.847805]  ? lock_acquire+0xf8/0x110\n[93.849143]  ? do_truncate+0x74/0xe0\n[93.850452]  ? do_truncate+0x84/0xe0\n[93.851739]  do_truncate+0x84/0xe0\n[93.852974]  do_sys_ftruncate+0x2b4/0x2f0\n[93.854404]  do_syscall_64+0x3f/0x90\n[93.855789]  entry_SYSCALL_64_after_hwframe+0x72/0xdc",
  "id": "CVE-2023-53323",
  "modified": "2025-10-15T06:20:22.460145Z",
  "published": "2025-09-16T16:11:58Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5cee8bfb8cbd99c97aff85d2bf066b6a496e13ab"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9e54fd14bd143c261e52fde74355e85e9526c58c"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/fcced95b6ba2a507a83b8b3e0358a8ac16b13e35"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "ext2/dax: Fix ext2_setsize when len is page aligned"
}