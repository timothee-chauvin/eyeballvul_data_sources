{"schema_version":"1.7.3","id":"CVE-2022-23495","published":"2022-12-08T21:25:40.257Z","modified":"2025-12-04T10:11:16.023360Z","aliases":["GHSA-x39j-h85h-3f46","GO-2022-1155"],"summary":"ProtoNode may be modified such that common method calls may panic in ipfs/go-merkledag","details":"go-merkledag implements the 'DAGService' interface and adds two ipld node types, Protobuf and Raw for the ipfs project. A `ProtoNode` may be modified in such a way as to cause various encode errors which will trigger a panic on common method calls that don't allow for error returns. A `ProtoNode` should only be able to encode to valid DAG-PB, attempting to encode invalid DAG-PB forms will result in an error from the codec. Manipulation of an existing (newly created or decoded) `ProtoNode` using the modifier methods did not account for certain states that would place the `ProtoNode` into an unencodeable form. Due to conformance with the [`github.com/ipfs/go-block-format#Block`](https://pkg.go.dev/github.com/ipfs/go-block-format#Block) and [`github.com/ipfs/go-ipld-format#Node`](https://pkg.go.dev/github.com/ipfs/go-ipld-format#Node) interfaces, certain methods, which internally require a re-encode if state has changed, will panic due to the inability to return an error. This issue has been addressed across a number of pull requests. Users are advised to upgrade to version 0.8.1 for a complete set of fixes. Users unable to upgrade may attempt to mitigate this issue by sanitising inputs when allowing user-input to set a new `CidBuilder` on a `ProtoNode` and by sanitising `Tsize` (`Link#Size`) values such that they are a reasonable byte-size for sub-DAGs where derived from user-input.\n","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/ipfs/go-merkledag","events":[{"introduced":"8794146d52c211b8af0456e734a248649e636be0"},{"fixed":"503ecaa8b898d65ddaee92ba8c6ae60b824004c1"}]}],"versions":["v0.4.0","v0.4.1","v0.5.0","v0.5.1","v0.6.0","v0.7.0","v0.8.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-23495.json"}}],"references":[{"type":"WEB","url":"https://en.wikipedia.org/wiki/Directed_acyclic_graph"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/23xxx/CVE-2022-23495.json"},{"type":"REPORT","url":"https://github.com/ipfs/go-merkledag/issues/90"},{"type":"FIX","url":"https://github.com/ipfs/go-merkledag/pull/91"},{"type":"FIX","url":"https://github.com/ipfs/go-merkledag/pull/92"},{"type":"FIX","url":"https://github.com/ipfs/go-merkledag/pull/93"},{"type":"WEB","url":"https://github.com/ipfs/go-merkledag/releases/tag/v0.8.0"},{"type":"WEB","url":"https://github.com/ipfs/go-merkledag/releases/tag/v0.8.1"},{"type":"ADVISORY","url":"https://github.com/ipfs/go-merkledag/security/advisories/GHSA-x39j-h85h-3f46"},{"type":"REPORT","url":"https://github.com/ipfs/kubo/issues/9297"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-23495"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-755"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/23xxx/CVE-2022-23495.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}