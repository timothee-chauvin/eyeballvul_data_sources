{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50069.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "133434898272255020158970121333947945092",
              "length": 132.0
            },
            "id": "CVE-2022-50069-5f477c70",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@41fd6cc88aaf7058b9dfc9c7a09cc80f99c8c830",
            "target": {
              "file": "include/linux/bpfptr.h",
              "function": "strncpy_from_bpfptr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "249544035460631593622853122362241039078",
              "length": 154.0
            },
            "id": "CVE-2022-50069-90c95e04",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@41fd6cc88aaf7058b9dfc9c7a09cc80f99c8c830",
            "target": {
              "file": "include/linux/bpfptr.h",
              "function": "copy_from_bpfptr_offset"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "173394642800567899483980967280250257200",
                "102793621715384769682861928200427001513",
                "118392104711276151998609715404295477054",
                "11557036352189704052311136556979895655",
                "253078395531572297880438045110757813216",
                "36150487317747607792523850209367683327",
                "283579464950541746975571245513657665407"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50069-a398dd5c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@41fd6cc88aaf7058b9dfc9c7a09cc80f99c8c830",
            "target": {
              "file": "include/linux/bpfptr.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "249544035460631593622853122362241039078",
              "length": 154.0
            },
            "id": "CVE-2022-50069-a5b35be8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e2dcac2f58f5a95ab092d1da237ffdc0da1832cf",
            "target": {
              "file": "include/linux/bpfptr.h",
              "function": "copy_from_bpfptr_offset"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "173394642800567899483980967280250257200",
                "102793621715384769682861928200427001513",
                "118392104711276151998609715404295477054",
                "11557036352189704052311136556979895655",
                "253078395531572297880438045110757813216",
                "36150487317747607792523850209367683327",
                "283579464950541746975571245513657665407"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50069-d74eab4c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e2dcac2f58f5a95ab092d1da237ffdc0da1832cf",
            "target": {
              "file": "include/linux/bpfptr.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "133434898272255020158970121333947945092",
              "length": 132.0
            },
            "id": "CVE-2022-50069-dad4da10",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e2dcac2f58f5a95ab092d1da237ffdc0da1832cf",
            "target": {
              "file": "include/linux/bpfptr.h",
              "function": "strncpy_from_bpfptr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "133434898272255020158970121333947945092",
              "length": 132.0
            },
            "id": "CVE-2022-50069-dede2fff",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1f6db7148ed7382b336c5827af33b5d9e992630e",
            "target": {
              "file": "include/linux/bpfptr.h",
              "function": "strncpy_from_bpfptr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "249544035460631593622853122362241039078",
              "length": 154.0
            },
            "id": "CVE-2022-50069-e252ec64",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1f6db7148ed7382b336c5827af33b5d9e992630e",
            "target": {
              "file": "include/linux/bpfptr.h",
              "function": "copy_from_bpfptr_offset"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "173394642800567899483980967280250257200",
                "102793621715384769682861928200427001513",
                "118392104711276151998609715404295477054",
                "11557036352189704052311136556979895655",
                "253078395531572297880438045110757813216",
                "36150487317747607792523850209367683327",
                "283579464950541746975571245513657665407"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50069-e950a2c6",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1f6db7148ed7382b336c5827af33b5d9e992630e",
            "target": {
              "file": "include/linux/bpfptr.h"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "af2ac3e13e45752af03c8a933f9b6e18841b128b"
            },
            {
              "fixed": "41fd6cc88aaf7058b9dfc9c7a09cc80f99c8c830"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "af2ac3e13e45752af03c8a933f9b6e18841b128b"
            },
            {
              "fixed": "1f6db7148ed7382b336c5827af33b5d9e992630e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "af2ac3e13e45752af03c8a933f9b6e18841b128b"
            },
            {
              "fixed": "e2dcac2f58f5a95ab092d1da237ffdc0da1832cf"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.27",
        "v5.15.28",
        "v5.15.29",
        "v5.15.3",
        "v5.15.30",
        "v5.15.31",
        "v5.15.32",
        "v5.15.33",
        "v5.15.34",
        "v5.15.35",
        "v5.15.36",
        "v5.15.37",
        "v5.15.38",
        "v5.15.39",
        "v5.15.4",
        "v5.15.40",
        "v5.15.41",
        "v5.15.42",
        "v5.15.43",
        "v5.15.44",
        "v5.15.45",
        "v5.15.46",
        "v5.15.47",
        "v5.15.48",
        "v5.15.49",
        "v5.15.5",
        "v5.15.50",
        "v5.15.51",
        "v5.15.52",
        "v5.15.53",
        "v5.15.54",
        "v5.15.55",
        "v5.15.56",
        "v5.15.57",
        "v5.15.58",
        "v5.15.59",
        "v5.15.6",
        "v5.15.60",
        "v5.15.61",
        "v5.15.62",
        "v5.15.7",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v5.19.1",
        "v5.19.2",
        "v5.19.3"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50069.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.14.0"
            },
            {
              "fixed": "5.15.63"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.19.4"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nBPF: Fix potential bad pointer dereference in bpf_sys_bpf()\n\nThe bpf_sys_bpf() helper function allows an eBPF program to load another\neBPF program from within the kernel. In this case the argument union\nbpf_attr pointer (as well as the insns and license pointers inside) is a\nkernel address instead of a userspace address (which is the case of a\nusual bpf() syscall). To make the memory copying process in the syscall\nwork in both cases, bpfptr_t was introduced to wrap around the pointer\nand distinguish its origin. Specifically, when copying memory contents\nfrom a bpfptr_t, a copy_from_user() is performed in case of a userspace\naddress and a memcpy() is performed for a kernel address.\n\nThis can lead to problems because the in-kernel pointer is never checked\nfor validity. The problem happens when an eBPF syscall program tries to\ncall bpf_sys_bpf() to load a program but provides a bad insns pointer --\nsay 0xdeadbeef -- in the bpf_attr union. The helper calls __sys_bpf()\nwhich would then call bpf_prog_load() to load the program.\nbpf_prog_load() is responsible for copying the eBPF instructions to the\nnewly allocated memory for the program; it creates a kernel bpfptr_t for\ninsns and invokes copy_from_bpfptr(). Internally, all bpfptr_t\noperations are backed by the corresponding sockptr_t operations, which\nperforms direct memcpy() on kernel pointers for copy_from/strncpy_from\noperations. Therefore, the code is always happy to dereference the bad\npointer to trigger a un-handle-able page fault and in turn an oops.\nHowever, this is not supposed to happen because at that point the eBPF\nprogram is already verified and should not cause a memory error.\n\nSample KASAN trace:\n\n[   25.685056][  T228] ==================================================================\n[   25.685680][  T228] BUG: KASAN: user-memory-access in copy_from_bpfptr+0x21/0x30\n[   25.686210][  T228] Read of size 80 at addr 00000000deadbeef by task poc/228\n[   25.686732][  T228]\n[   25.686893][  T228] CPU: 3 PID: 228 Comm: poc Not tainted 5.19.0-rc7 #7\n[   25.687375][  T228] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS d55cb5a 04/01/2014\n[   25.687991][  T228] Call Trace:\n[   25.688223][  T228]  <TASK>\n[   25.688429][  T228]  dump_stack_lvl+0x73/0x9e\n[   25.688747][  T228]  print_report+0xea/0x200\n[   25.689061][  T228]  ? copy_from_bpfptr+0x21/0x30\n[   25.689401][  T228]  ? _printk+0x54/0x6e\n[   25.689693][  T228]  ? _raw_spin_lock_irqsave+0x70/0xd0\n[   25.690071][  T228]  ? copy_from_bpfptr+0x21/0x30\n[   25.690412][  T228]  kasan_report+0xb5/0xe0\n[   25.690716][  T228]  ? copy_from_bpfptr+0x21/0x30\n[   25.691059][  T228]  kasan_check_range+0x2bd/0x2e0\n[   25.691405][  T228]  ? copy_from_bpfptr+0x21/0x30\n[   25.691734][  T228]  memcpy+0x25/0x60\n[   25.692000][  T228]  copy_from_bpfptr+0x21/0x30\n[   25.692328][  T228]  bpf_prog_load+0x604/0x9e0\n[   25.692653][  T228]  ? cap_capable+0xb4/0xe0\n[   25.692956][  T228]  ? security_capable+0x4f/0x70\n[   25.693324][  T228]  __sys_bpf+0x3af/0x580\n[   25.693635][  T228]  bpf_sys_bpf+0x45/0x240\n[   25.693937][  T228]  bpf_prog_f0ec79a5a3caca46_bpf_func1+0xa2/0xbd\n[   25.694394][  T228]  bpf_prog_run_pin_on_cpu+0x2f/0xb0\n[   25.694756][  T228]  bpf_prog_test_run_syscall+0x146/0x1c0\n[   25.695144][  T228]  bpf_prog_test_run+0x172/0x190\n[   25.695487][  T228]  __sys_bpf+0x2c5/0x580\n[   25.695776][  T228]  __x64_sys_bpf+0x3a/0x50\n[   25.696084][  T228]  do_syscall_64+0x60/0x90\n[   25.696393][  T228]  ? fpregs_assert_state_consistent+0x50/0x60\n[   25.696815][  T228]  ? exit_to_user_mode_prepare+0x36/0xa0\n[   25.697202][  T228]  ? syscall_exit_to_user_mode+0x20/0x40\n[   25.697586][  T228]  ? do_syscall_64+0x6e/0x90\n[   25.697899][  T228]  entry_SYSCALL_64_after_hwframe+0x63/0xcd\n[   25.698312][  T228] RIP: 0033:0x7f6d543fb759\n[   25.698624][  T228] Code: 08 5b 89 e8 5d c3 66 2e 0f 1f 84 00 00 00 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d \n---truncated---",
  "id": "CVE-2022-50069",
  "modified": "2025-10-21T11:57:41.871967Z",
  "published": "2025-06-18T11:02:14Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1f6db7148ed7382b336c5827af33b5d9e992630e"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/41fd6cc88aaf7058b9dfc9c7a09cc80f99c8c830"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e2dcac2f58f5a95ab092d1da237ffdc0da1832cf"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "BPF: Fix potential bad pointer dereference in bpf_sys_bpf()"
}