{"schema_version":"1.7.3","id":"CVE-2025-68299","published":"2025-12-16T15:06:18.246Z","modified":"2025-12-16T20:25:18.628562Z","summary":"afs: Fix delayed allocation of a cell's anonymous key","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nafs: Fix delayed allocation of a cell's anonymous key\n\nThe allocation of a cell's anonymous key is done in a background thread\nalong with other cell setup such as doing a DNS upcall.  In the reported\nbug, this is triggered by afs_parse_source() parsing the device name given\nto mount() and calling afs_lookup_cell() with the name of the cell.\n\nThe normal key lookup then tries to use the key description on the\nanonymous authentication key as the reference for request_key() - but it\nmay not yet be set and so an oops can happen.\n\nThis has been made more likely to happen by the fix for dynamic lookup\nfailure.\n\nFix this by firstly allocating a reference name and attaching it to the\nafs_cell record when the record is created.  It can share the memory\nallocation with the cell name (unfortunately it can't just overlap the cell\nname by prepending it with \"afs@\" as the cell name already has a '.'\nprepended for other purposes).  This reference name is then passed to\nrequest_key().\n\nSecondly, the anon key is now allocated on demand at the point a key is\nrequested in afs_request_key() if it is not already allocated.  A mutex is\nused to prevent multiple allocation for a cell.\n\nThirdly, make afs_request_key_rcu() return NULL if the anonymous key isn't\nyet allocated (if we need it) and then the caller can return -ECHILD to\ndrop out of RCU-mode and afs_request_key() can be called.\n\nNote that the anonymous key is kind of necessary to make the key lookup\ncache work as that doesn't currently cache a negative lookup, but it's\nprobably worth some investigation to see if NULL can be used instead.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"7e33b15d5a6578a99ebf189cea34983270ae92dd"},{"fixed":"5613bde937dfac6725e9c3fc766b9d6b8481e55b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"330e2c514823008b22e6afd2055715bc46dd8d55"},{"fixed":"d27c71257825dced46104eefe42e4d9964bd032e"}]}],"versions":["v6.17.10","v6.17.9","v6.18-rc2","v6.18-rc3","v6.18-rc4","v6.18-rc5","v6.18-rc6","v6.18-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-68299.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.17.9"},{"fixed":"6.17.11"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-68299.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/5613bde937dfac6725e9c3fc766b9d6b8481e55b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d27c71257825dced46104eefe42e4d9964bd032e"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/68xxx/CVE-2025-68299.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-68299"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2025/68xxx/CVE-2025-68299.json"}}