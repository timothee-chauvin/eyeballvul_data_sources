{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53523.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "91915068197778177786267951708280738835",
                "306168563119944309752910859837259557016",
                "18458148136963949044237413979520884313",
                "274686061681827832549358433817601818627",
                "64390193569840060183199648469585281495",
                "91540427371358167096096254916056921306",
                "329833464334991828973237913052183952012",
                "110360780708480651852553198360834158507",
                "94575271276903886274845818086853982384",
                "137607169576838318512379319660172497482",
                "210101234424596462500146966664268029010",
                "159049854475675475760708243009052051573",
                "228477146471156789549723193987652975175",
                "161345105094641779703543039849446720373",
                "2237768345349180470591190609368735984",
                "191937154979761657367241949077242051026",
                "98934535643535164905097202716974533088",
                "69380715902078129723458458681864488212",
                "87450190750476500996632012082525927647",
                "112908740458079219818224026010097681904",
                "263101042643943002331526254089354672279",
                "92441713813613033989942650849924936095",
                "308026776660116330522622962072092039866",
                "308715751373663937922213696632699221247",
                "169813423176832530621242653305954084802",
                "225741837885162413358985013059525499605",
                "273356682623001305040424095979887640206",
                "249563202071404989867358504607746076727",
                "326541703250638529878516614250987631824",
                "197415338538301394024760771864035104952",
                "60266157242877718118092262583729188975",
                "332134417831592531498678703722656494702",
                "146247808941643744809360230445016501536",
                "51122002451970143597805444299283938982",
                "63807633075185098091054285593511058490",
                "84715670069361692373704162132744921523",
                "164458328883180534881164701156408836886",
                "256408333930000076225803970633931421159",
                "55227273004622965359214074135053786014",
                "277991957116123057802080006940465528081",
                "90394961885880428792157425778938406337",
                "133078696899846168191153381241110011965",
                "74401765446548996859000443021807685279",
                "266502436139858668434601556539471249828",
                "136306367126248312023424691523382281802",
                "300765965718684344514388893913702650533",
                "188190613700643427501719197283408254167",
                "196111839594162699798528373558246150504",
                "242310018455121420065861211424177956428",
                "194545416812723393134011856455868573661",
                "136734703970624464313727802471205593010",
                "109154360194763964703910588001400519617",
                "36298206609733858494725287957687167721",
                "315227169922796487246431470806087286705",
                "46640092127127374104469918902409360960",
                "39238794454898834117230055028433993091",
                "153570389999231478096334904589028182761",
                "266945791259506017307129434010927288250",
                "60985800189058299540588043690360243385",
                "267731528362506319262132773062502120906",
                "180419067593930592667096038182375033613",
                "297683184529226363168538516167870991160",
                "269801177184399139824483920529732358235",
                "301493418006608355381267775353280676232",
                "26216834712225511236156221396293041974",
                "1875989955356521248024142154164521669",
                "313486814098205662548893285900901712783",
                "225912956189329619796826940474280830827",
                "253978960814696274076733740013834376531",
                "241608432308458489240001501395943831916",
                "74149050225860976532766699509296420266",
                "241380375982953163253080702471383744736",
                "158294044055442231695545853230628523301",
                "39427218939079652682206009963314758574",
                "41152056252313592346069747595920658378",
                "188113158083651524016499620798856547024",
                "7269190381134819174906102711794293165",
                "129748867237433341486961786676412146451",
                "296074932288126348000464506563612984741",
                "301034732223913746975903994823769395134",
                "122872783028537972129866658968928454825",
                "224538292606402252715733413680221961465",
                "27443321914966559598313817967493712012",
                "128478387362079546390672582805203902942",
                "254767511282008939520747714742599345709",
                "118528657903962652332733687280275653520",
                "217350493928951848839149089389456020489",
                "19292257100659352874738058430815837816",
                "290975147647637836310504388648790799375",
                "150028991543487823528356875364409177457",
                "187684124500084752209707379136831441725",
                "196911119954563274670104621184271409533",
                "322391253104559989286399006856489280538",
                "190232032960601244543488762524977691085",
                "124635446621768921579911055919698158770",
                "89840588286121641353003845921445779283",
                "232569661976630220551599526542011878533",
                "206511123104094849232326806342013378682",
                "201026071377367357591757952668769185907",
                "266273785652897867865018379588122308180",
                "70670600548911456299714116176773945026",
                "178733962372533517271121499753687805354",
                "95289926304761582443370464106764625315",
                "274592565540639886712447779384698107908",
                "68861481709077079517668135684197973868"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53523-1762177c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@210a8cffc9c1b044281c0a868485c870c9c11374",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "157614797760596299618994123033766291548",
              "length": 2871.0
            },
            "id": "CVE-2023-53523-6d36756f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@210a8cffc9c1b044281c0a868485c870c9c11374",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_can_open"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "157614797760596299618994123033766291548",
              "length": 2871.0
            },
            "id": "CVE-2023-53523-7d6a9239",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5886e4d5ecec3e22844efed90b2dd383ef804b3a",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_can_open"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "227087471323379277335078868994659012138",
              "length": 674.0
            },
            "id": "CVE-2023-53523-82a3f20d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5886e4d5ecec3e22844efed90b2dd383ef804b3a",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_can_close"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "291058835735230257309844547108856844173",
              "length": 268.0
            },
            "id": "CVE-2023-53523-95c5d22b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5886e4d5ecec3e22844efed90b2dd383ef804b3a",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_usb_skb_set_timestamp"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "88238875739799254539262180470995046764",
              "length": 2577.0
            },
            "id": "CVE-2023-53523-a8ad1ee9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5886e4d5ecec3e22844efed90b2dd383ef804b3a",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_usb_receive_bulk_callback"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "291058835735230257309844547108856844173",
              "length": 268.0
            },
            "id": "CVE-2023-53523-a973af61",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@210a8cffc9c1b044281c0a868485c870c9c11374",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_usb_skb_set_timestamp"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "191143628454714202482169956873372875676",
              "length": 360.0
            },
            "id": "CVE-2023-53523-a9e722c0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5886e4d5ecec3e22844efed90b2dd383ef804b3a",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_usb_get_timestamp"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "88238875739799254539262180470995046764",
              "length": 2577.0
            },
            "id": "CVE-2023-53523-aa13c071",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@210a8cffc9c1b044281c0a868485c870c9c11374",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_usb_receive_bulk_callback"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "91915068197778177786267951708280738835",
                "306168563119944309752910859837259557016",
                "18458148136963949044237413979520884313",
                "274686061681827832549358433817601818627",
                "64390193569840060183199648469585281495",
                "91540427371358167096096254916056921306",
                "329833464334991828973237913052183952012",
                "110360780708480651852553198360834158507",
                "94575271276903886274845818086853982384",
                "137607169576838318512379319660172497482",
                "210101234424596462500146966664268029010",
                "159049854475675475760708243009052051573",
                "228477146471156789549723193987652975175",
                "161345105094641779703543039849446720373",
                "2237768345349180470591190609368735984",
                "191937154979761657367241949077242051026",
                "98934535643535164905097202716974533088",
                "69380715902078129723458458681864488212",
                "87450190750476500996632012082525927647",
                "112908740458079219818224026010097681904",
                "263101042643943002331526254089354672279",
                "92441713813613033989942650849924936095",
                "308026776660116330522622962072092039866",
                "308715751373663937922213696632699221247",
                "169813423176832530621242653305954084802",
                "225741837885162413358985013059525499605",
                "273356682623001305040424095979887640206",
                "249563202071404989867358504607746076727",
                "326541703250638529878516614250987631824",
                "197415338538301394024760771864035104952",
                "60266157242877718118092262583729188975",
                "332134417831592531498678703722656494702",
                "146247808941643744809360230445016501536",
                "51122002451970143597805444299283938982",
                "63807633075185098091054285593511058490",
                "84715670069361692373704162132744921523",
                "164458328883180534881164701156408836886",
                "256408333930000076225803970633931421159",
                "55227273004622965359214074135053786014",
                "277991957116123057802080006940465528081",
                "90394961885880428792157425778938406337",
                "133078696899846168191153381241110011965",
                "74401765446548996859000443021807685279",
                "266502436139858668434601556539471249828",
                "136306367126248312023424691523382281802",
                "300765965718684344514388893913702650533",
                "188190613700643427501719197283408254167",
                "196111839594162699798528373558246150504",
                "242310018455121420065861211424177956428",
                "194545416812723393134011856455868573661",
                "136734703970624464313727802471205593010",
                "109154360194763964703910588001400519617",
                "36298206609733858494725287957687167721",
                "315227169922796487246431470806087286705",
                "46640092127127374104469918902409360960",
                "39238794454898834117230055028433993091",
                "153570389999231478096334904589028182761",
                "266945791259506017307129434010927288250",
                "60985800189058299540588043690360243385",
                "267731528362506319262132773062502120906",
                "180419067593930592667096038182375033613",
                "297683184529226363168538516167870991160",
                "269801177184399139824483920529732358235",
                "301493418006608355381267775353280676232",
                "26216834712225511236156221396293041974",
                "1875989955356521248024142154164521669",
                "313486814098205662548893285900901712783",
                "225912956189329619796826940474280830827",
                "253978960814696274076733740013834376531",
                "241608432308458489240001501395943831916",
                "74149050225860976532766699509296420266",
                "241380375982953163253080702471383744736",
                "158294044055442231695545853230628523301",
                "39427218939079652682206009963314758574",
                "41152056252313592346069747595920658378",
                "188113158083651524016499620798856547024",
                "7269190381134819174906102711794293165",
                "129748867237433341486961786676412146451",
                "296074932288126348000464506563612984741",
                "301034732223913746975903994823769395134",
                "122872783028537972129866658968928454825",
                "224538292606402252715733413680221961465",
                "27443321914966559598313817967493712012",
                "128478387362079546390672582805203902942",
                "254767511282008939520747714742599345709",
                "118528657903962652332733687280275653520",
                "217350493928951848839149089389456020489",
                "19292257100659352874738058430815837816",
                "290975147647637836310504388648790799375",
                "150028991543487823528356875364409177457",
                "187684124500084752209707379136831441725",
                "196911119954563274670104621184271409533",
                "322391253104559989286399006856489280538",
                "190232032960601244543488762524977691085",
                "124635446621768921579911055919698158770",
                "89840588286121641353003845921445779283",
                "232569661976630220551599526542011878533",
                "206511123104094849232326806342013378682",
                "201026071377367357591757952668769185907",
                "266273785652897867865018379588122308180",
                "70670600548911456299714116176773945026",
                "178733962372533517271121499753687805354",
                "95289926304761582443370464106764625315",
                "274592565540639886712447779384698107908",
                "68861481709077079517668135684197973868"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53523-b9635db2",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5886e4d5ecec3e22844efed90b2dd383ef804b3a",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "191143628454714202482169956873372875676",
              "length": 360.0
            },
            "id": "CVE-2023-53523-c560ae18",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@210a8cffc9c1b044281c0a868485c870c9c11374",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_usb_get_timestamp"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "227087471323379277335078868994659012138",
              "length": 674.0
            },
            "id": "CVE-2023-53523-e57cb69c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@210a8cffc9c1b044281c0a868485c870c9c11374",
            "target": {
              "file": "drivers/net/can/usb/gs_usb.c",
              "function": "gs_can_close"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "45dfa45f52e66f8eee30a64b16550a9c47915044"
            },
            {
              "fixed": "210a8cffc9c1b044281c0a868485c870c9c11374"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "45dfa45f52e66f8eee30a64b16550a9c47915044"
            },
            {
              "fixed": "5886e4d5ecec3e22844efed90b2dd383ef804b3a"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.0",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.4.1",
        "v6.4.2",
        "v6.4.3",
        "v6.4.4",
        "v6.4.5",
        "v6.4.6",
        "v6.5-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53523.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.1.0"
            },
            {
              "fixed": "6.4.7"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ncan: gs_usb: fix time stamp counter initialization\n\nIf the gs_usb device driver is unloaded (or unbound) before the\ninterface is shut down, the USB stack first calls the struct\nusb_driver::disconnect and then the struct net_device_ops::ndo_stop\ncallback.\n\nIn gs_usb_disconnect() all pending bulk URBs are killed, i.e. no more\nRX'ed CAN frames are send from the USB device to the host. Later in\ngs_can_close() a reset control message is send to each CAN channel to\nremove the controller from the CAN bus. In this race window the USB\ndevice can still receive CAN frames from the bus and internally queue\nthem to be send to the host.\n\nAt least in the current version of the candlelight firmware, the queue\nof received CAN frames is not emptied during the reset command. After\nloading (or binding) the gs_usb driver, new URBs are submitted during\nthe struct net_device_ops::ndo_open callback and the candlelight\nfirmware starts sending its already queued CAN frames to the host.\n\nHowever, this scenario was not considered when implementing the\nhardware timestamp function. The cycle counter/time counter\ninfrastructure is set up (gs_usb_timestamp_init()) after the USBs are\nsubmitted, resulting in a NULL pointer dereference if\ntimecounter_cyc2time() (via the call chain:\ngs_usb_receive_bulk_callback() -> gs_usb_set_timestamp() ->\ngs_usb_skb_set_timestamp()) is called too early.\n\nMove the gs_usb_timestamp_init() function before the URBs are\nsubmitted to fix this problem.\n\nFor a comprehensive solution, we need to consider gs_usb devices with\nmore than 1 channel. The cycle counter/time counter infrastructure is\nsetup per channel, but the RX URBs are per device. Once gs_can_open()\nof _a_ channel has been called, and URBs have been submitted, the\ngs_usb_receive_bulk_callback() can be called for _all_ available\nchannels, even for channels that are not running, yet. As cycle\ncounter/time counter has not set up, this will again lead to a NULL\npointer dereference.\n\nConvert the cycle counter/time counter from a \"per channel\" to a \"per\ndevice\" functionality. Also set it up, before submitting any URBs to\nthe device.\n\nFurther in gs_usb_receive_bulk_callback(), don't process any URBs for\nnot started CAN channels, only resubmit the URB.",
  "id": "CVE-2023-53523",
  "modified": "2025-10-15T07:03:59.405673Z",
  "published": "2025-10-01T11:46:09Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/210a8cffc9c1b044281c0a868485c870c9c11374"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5886e4d5ecec3e22844efed90b2dd383ef804b3a"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "can: gs_usb: fix time stamp counter initialization"
}