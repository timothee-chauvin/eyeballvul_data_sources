{"schema_version":"1.7.3","id":"CVE-2025-37918","published":"2025-05-20T15:21:48.473Z","modified":"2025-11-20T09:21:22.342153Z","related":["MGASA-2025-0182","MGASA-2025-0183","SUSE-SU-2025:01964-1","SUSE-SU-2025:01965-1","SUSE-SU-2025:02923-1"],"summary":"Bluetooth: btusb: avoid NULL pointer dereference in skb_dequeue()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: btusb: avoid NULL pointer dereference in skb_dequeue()\n\nA NULL pointer dereference can occur in skb_dequeue() when processing a\nQCA firmware crash dump on WCN7851 (0489:e0f3).\n\n[ 93.672166] Bluetooth: hci0: ACL memdump size(589824)\n\n[ 93.672475] BUG: kernel NULL pointer dereference, address: 0000000000000008\n[ 93.672517] Workqueue: hci0 hci_devcd_rx [bluetooth]\n[ 93.672598] RIP: 0010:skb_dequeue+0x50/0x80\n\nThe issue stems from handle_dump_pkt_qca() returning 0 even when a dump\npacket is successfully processed. This is because it incorrectly\nforwards the return value of hci_devcd_init() (which returns 0 on\nsuccess). As a result, the caller (btusb_recv_acl_qca() or\nbtusb_recv_evt_qca()) assumes the packet was not handled and passes it\nto hci_recv_frame(), leading to premature kfree() of the skb.\n\nLater, hci_devcd_rx() attempts to dequeue the same skb from the dump\nqueue, resulting in a NULL pointer dereference.\n\nFix this by:\n1. Making handle_dump_pkt_qca() return 0 on success and negative errno\n   on failure, consistent with kernel conventions.\n2. Splitting dump packet detection into separate functions for ACL\n   and event packets for better structure and readability.\n\nThis ensures dump packets are properly identified and consumed, avoiding\ndouble handling and preventing NULL pointer access.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"20981ce2d5a5f79d17da1ace3a93df7b3c6ba3d6"},{"fixed":"2e8d44ebaa7babdd5c5ab50ca275826e241920d6"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"20981ce2d5a5f79d17da1ace3a93df7b3c6ba3d6"},{"fixed":"b70b41591ec48c78ec6a885e1f57bfc4029e5e13"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"20981ce2d5a5f79d17da1ace3a93df7b3c6ba3d6"},{"fixed":"8563d9fabd8a4b726ba7acab4737c438bf11a059"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"20981ce2d5a5f79d17da1ace3a93df7b3c6ba3d6"},{"fixed":"0317b033abcd1d8dd2798f0e2de5e84543d0bd22"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.3","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.85","v6.6.86","v6.6.87","v6.6.88","v6.6.89","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37918.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"195716139104049459933673328512635964996","length":140},"id":"CVE-2025-37918-02f54989","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0317b033abcd1d8dd2798f0e2de5e84543d0bd22","target":{"file":"drivers/bluetooth/btusb.c","function":"btusb_recv_evt_qca"}},{"deprecated":false,"digest":{"function_hash":"195716139104049459933673328512635964996","length":140},"id":"CVE-2025-37918-0f64c8e1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8d44ebaa7babdd5c5ab50ca275826e241920d6","target":{"file":"drivers/bluetooth/btusb.c","function":"btusb_recv_acl_qca"}},{"deprecated":false,"digest":{"line_hashes":["208217095797202932702905497971105541754","259839140441983613311033495265544974217","300642841828703662019656978660716983987","263715622278462315868492870766775474769","13681456522605890106603595213799615592","260824379509801002480350782988943255960","307075591573639277784050021625843942560","76447782259521743150399694983830612139","157429110525797002282055420168287936078","181160234796255154734503985266295602982","5083974945615017723021523027483610287","309840559096662590340015203055781543934","84715936468482238166227122119052572953","263484605557231754358586426161470530369","257339120235013747100093392281651550536","159401367112990225966814406367240652172","41809858572803126903917688573785822885","166704664615291638505539226045464004736","59194827222439391467592748457107610029","107368180104125196901730160571119587209","313118957850685380176440383104891976395","193515745749058540365752347350511377511","335275391548436945320195374821345176180","201531950852673311133471983210605564588","66790185089453511301458376372632017886","84996057921653726940066837412018457867","143606627259205835730324325509106111857","124010071523629056369363255852200843327","30563864018584499787947853539926538940","35369245040657703578475438561906001302","173498737399491005330061733419335158146","103059828560851906570751515060481442437","223042406710440513180661262557870856133","76007708218303332356075506805513355815","240625949298868092832927715774933946279","45011389780903189002276847201020708432","200022176440788757656696830375896015536","183326845818793720814556630485928528459","117490854876774673679498973218210754128","200343945310443823564281320995850048590","206174229955591360070896901703759578150","235652612303725544269803294112273277633","117662485058554003001481249551240517406","280909613450358621878531557042640566113","90176711606185140827026369991436426683","200343945310443823564281320995850048590","206174229955591360070896901703759578150","61990878664420843094149163844252972109"],"threshold":0.9},"id":"CVE-2025-37918-5757ee60","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8d44ebaa7babdd5c5ab50ca275826e241920d6","target":{"file":"drivers/bluetooth/btusb.c"}},{"deprecated":false,"digest":{"function_hash":"195716139104049459933673328512635964996","length":140},"id":"CVE-2025-37918-608676ed","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0317b033abcd1d8dd2798f0e2de5e84543d0bd22","target":{"file":"drivers/bluetooth/btusb.c","function":"btusb_recv_acl_qca"}},{"deprecated":false,"digest":{"line_hashes":["208217095797202932702905497971105541754","259839140441983613311033495265544974217","300642841828703662019656978660716983987","263715622278462315868492870766775474769","13681456522605890106603595213799615592","260824379509801002480350782988943255960","307075591573639277784050021625843942560","76447782259521743150399694983830612139","157429110525797002282055420168287936078","181160234796255154734503985266295602982","5083974945615017723021523027483610287","309840559096662590340015203055781543934","84715936468482238166227122119052572953","263484605557231754358586426161470530369","257339120235013747100093392281651550536","159401367112990225966814406367240652172","41809858572803126903917688573785822885","166704664615291638505539226045464004736","59194827222439391467592748457107610029","107368180104125196901730160571119587209","313118957850685380176440383104891976395","193515745749058540365752347350511377511","335275391548436945320195374821345176180","201531950852673311133471983210605564588","66790185089453511301458376372632017886","84996057921653726940066837412018457867","143606627259205835730324325509106111857","124010071523629056369363255852200843327","30563864018584499787947853539926538940","35369245040657703578475438561906001302","173498737399491005330061733419335158146","103059828560851906570751515060481442437","223042406710440513180661262557870856133","76007708218303332356075506805513355815","240625949298868092832927715774933946279","45011389780903189002276847201020708432","200022176440788757656696830375896015536","183326845818793720814556630485928528459","117490854876774673679498973218210754128","200343945310443823564281320995850048590","206174229955591360070896901703759578150","235652612303725544269803294112273277633","117662485058554003001481249551240517406","280909613450358621878531557042640566113","90176711606185140827026369991436426683","200343945310443823564281320995850048590","206174229955591360070896901703759578150","61990878664420843094149163844252972109"],"threshold":0.9},"id":"CVE-2025-37918-95b90e81","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0317b033abcd1d8dd2798f0e2de5e84543d0bd22","target":{"file":"drivers/bluetooth/btusb.c"}},{"deprecated":false,"digest":{"function_hash":"195716139104049459933673328512635964996","length":140},"id":"CVE-2025-37918-a4335a9a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8563d9fabd8a4b726ba7acab4737c438bf11a059","target":{"file":"drivers/bluetooth/btusb.c","function":"btusb_recv_evt_qca"}},{"deprecated":false,"digest":{"line_hashes":["208217095797202932702905497971105541754","259839140441983613311033495265544974217","300642841828703662019656978660716983987","263715622278462315868492870766775474769","13681456522605890106603595213799615592","260824379509801002480350782988943255960","307075591573639277784050021625843942560","76447782259521743150399694983830612139","157429110525797002282055420168287936078","181160234796255154734503985266295602982","5083974945615017723021523027483610287","309840559096662590340015203055781543934","84715936468482238166227122119052572953","263484605557231754358586426161470530369","257339120235013747100093392281651550536","159401367112990225966814406367240652172","41809858572803126903917688573785822885","166704664615291638505539226045464004736","59194827222439391467592748457107610029","107368180104125196901730160571119587209","313118957850685380176440383104891976395","193515745749058540365752347350511377511","335275391548436945320195374821345176180","201531950852673311133471983210605564588","66790185089453511301458376372632017886","84996057921653726940066837412018457867","143606627259205835730324325509106111857","124010071523629056369363255852200843327","30563864018584499787947853539926538940","35369245040657703578475438561906001302","173498737399491005330061733419335158146","103059828560851906570751515060481442437","223042406710440513180661262557870856133","76007708218303332356075506805513355815","240625949298868092832927715774933946279","45011389780903189002276847201020708432","200022176440788757656696830375896015536","183326845818793720814556630485928528459","117490854876774673679498973218210754128","200343945310443823564281320995850048590","206174229955591360070896901703759578150","235652612303725544269803294112273277633","117662485058554003001481249551240517406","280909613450358621878531557042640566113","90176711606185140827026369991436426683","200343945310443823564281320995850048590","206174229955591360070896901703759578150","61990878664420843094149163844252972109"],"threshold":0.9},"id":"CVE-2025-37918-ad4b12e5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8563d9fabd8a4b726ba7acab4737c438bf11a059","target":{"file":"drivers/bluetooth/btusb.c"}},{"deprecated":false,"digest":{"function_hash":"51592609946956447498970111874452074422","length":2724},"id":"CVE-2025-37918-adf3cee8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0317b033abcd1d8dd2798f0e2de5e84543d0bd22","target":{"file":"drivers/bluetooth/btusb.c","function":"handle_dump_pkt_qca"}},{"deprecated":false,"digest":{"function_hash":"195716139104049459933673328512635964996","length":140},"id":"CVE-2025-37918-bd8c5aeb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8563d9fabd8a4b726ba7acab4737c438bf11a059","target":{"file":"drivers/bluetooth/btusb.c","function":"btusb_recv_acl_qca"}},{"deprecated":false,"digest":{"function_hash":"51592609946956447498970111874452074422","length":2724},"id":"CVE-2025-37918-cab29d73","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8d44ebaa7babdd5c5ab50ca275826e241920d6","target":{"file":"drivers/bluetooth/btusb.c","function":"handle_dump_pkt_qca"}},{"deprecated":false,"digest":{"function_hash":"195716139104049459933673328512635964996","length":140},"id":"CVE-2025-37918-d7169d82","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2e8d44ebaa7babdd5c5ab50ca275826e241920d6","target":{"file":"drivers/bluetooth/btusb.c","function":"btusb_recv_evt_qca"}},{"deprecated":false,"digest":{"function_hash":"51592609946956447498970111874452074422","length":2724},"id":"CVE-2025-37918-f8327957","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8563d9fabd8a4b726ba7acab4737c438bf11a059","target":{"file":"drivers/bluetooth/btusb.c","function":"handle_dump_pkt_qca"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.4.0"},{"fixed":"6.6.90"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.28"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.14.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37918.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0317b033abcd1d8dd2798f0e2de5e84543d0bd22"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2e8d44ebaa7babdd5c5ab50ca275826e241920d6"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8563d9fabd8a4b726ba7acab4737c438bf11a059"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b70b41591ec48c78ec6a885e1f57bfc4029e5e13"}]}