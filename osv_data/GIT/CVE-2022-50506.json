{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50506.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "28578817823263537681036978581430452915",
              "length": 1088.0
            },
            "id": "CVE-2022-50506-0960cd44",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@05580a3bbf3cec677cb00a85dfeb21d6a9b48eaf",
            "target": {
              "file": "drivers/block/drbd/drbd_req.c",
              "function": "drbd_req_new"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "273353339412522568083962768688647269470",
                "249396980206438467037159478815141866323",
                "182508982502361865668759978336064593482",
                "248619799282761034531349029641471393871",
                "328577400407483840828453406684938964584",
                "159116626837836184141967426603297158711",
                "73071378800687195253139654074533155265",
                "295488000377150139867037247962046220363",
                "80604130458035220378733228124494545249",
                "98380271705765823962244854761941948571",
                "194092820256586863600867331735484727604",
                "318069575134606330689076725027053071544",
                "243410062030605036258462765116737303717"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50506-12f001b1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@05580a3bbf3cec677cb00a85dfeb21d6a9b48eaf",
            "target": {
              "file": "drivers/block/drbd/drbd_req.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "283779788592217632915357260091410405257",
              "length": 980.0
            },
            "id": "CVE-2022-50506-324a6237",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@05580a3bbf3cec677cb00a85dfeb21d6a9b48eaf",
            "target": {
              "file": "drivers/block/drbd/drbd_req.c",
              "function": "drbd_request_prepare"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "283779788592217632915357260091410405257",
              "length": 980.0
            },
            "id": "CVE-2022-50506-9bda1ac0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d42ddf7f27b6723549ee6d4c8b1b418b59bf6b5",
            "target": {
              "file": "drivers/block/drbd/drbd_req.c",
              "function": "drbd_request_prepare"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "28578817823263537681036978581430452915",
              "length": 1088.0
            },
            "id": "CVE-2022-50506-bd6e5da8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d42ddf7f27b6723549ee6d4c8b1b418b59bf6b5",
            "target": {
              "file": "drivers/block/drbd/drbd_req.c",
              "function": "drbd_req_new"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "273353339412522568083962768688647269470",
                "249396980206438467037159478815141866323",
                "182508982502361865668759978336064593482",
                "248619799282761034531349029641471393871",
                "328577400407483840828453406684938964584",
                "159116626837836184141967426603297158711",
                "73071378800687195253139654074533155265",
                "295488000377150139867037247962046220363",
                "80604130458035220378733228124494545249",
                "98380271705765823962244854761941948571",
                "194092820256586863600867331735484727604",
                "318069575134606330689076725027053071544",
                "243410062030605036258462765116737303717"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50506-f3aa9282",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6d42ddf7f27b6723549ee6d4c8b1b418b59bf6b5",
            "target": {
              "file": "drivers/block/drbd/drbd_req.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "c347a787e34cba0e5a80a04082dacaf259105605"
            },
            {
              "fixed": "05580a3bbf3cec677cb00a85dfeb21d6a9b48eaf"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "c347a787e34cba0e5a80a04082dacaf259105605"
            },
            {
              "fixed": "6d42ddf7f27b6723549ee6d4c8b1b418b59bf6b5"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.17",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.0.1",
        "v6.0.2",
        "v6.0.3",
        "v6.0.4",
        "v6.0.5"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50506.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.18.0"
            },
            {
              "fixed": "6.0.6"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrbd: only clone bio if we have a backing device\n\nCommit c347a787e34cb (drbd: set ->bi_bdev in drbd_req_new) moved a\nbio_set_dev call (which has since been removed) to \"earlier\", from\ndrbd_request_prepare to drbd_req_new.\n\nThe problem is that this accesses device->ldev->backing_bdev, which is\nnot NULL-checked at this point. When we don't have an ldev (i.e. when\nthe DRBD device is diskless), this leads to a null pointer deref.\n\nSo, only allocate the private_bio if we actually have a disk. This is\nalso a small optimization, since we don't clone the bio to only to\nimmediately free it again in the diskless case.",
  "id": "CVE-2022-50506",
  "modified": "2025-10-15T02:23:28.290396Z",
  "published": "2025-10-04T15:43:54Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/05580a3bbf3cec677cb00a85dfeb21d6a9b48eaf"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6d42ddf7f27b6723549ee6d4c8b1b418b59bf6b5"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "drbd: only clone bio if we have a backing device"
}