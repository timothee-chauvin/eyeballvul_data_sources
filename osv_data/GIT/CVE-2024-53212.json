{"schema_version":"1.7.3","id":"CVE-2024-53212","published":"2024-12-27T13:49:57.904Z","modified":"2025-11-20T07:24:07.015700Z","related":["USN-7276-1","USN-7277-1"],"summary":"netlink: fix false positive warning in extack during dumps","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnetlink: fix false positive warning in extack during dumps\n\nCommit under fixes extended extack reporting to dumps.\nIt works under normal conditions, because extack errors are\nusually reported during ->start() or the first ->dump(),\nit's quite rare that the dump starts okay but fails later.\nIf the dump does fail later, however, the input skb will\nalready have the initiating message pulled, so checking\nif bad attr falls within skb->data will fail.\n\nSwitch the check to using nlh, which is always valid.\n\nsyzbot found a way to hit that scenario by filling up\nthe receive queue. In this case we initiate a dump\nbut don't call ->dump() until there is read space for\nan skb.\n\nWARNING: CPU: 1 PID: 5845 at net/netlink/af_netlink.c:2210 netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209\nRIP: 0010:netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209\nCall Trace:\n <TASK>\n netlink_dump_done+0x513/0x970 net/netlink/af_netlink.c:2250\n netlink_dump+0x91f/0xe10 net/netlink/af_netlink.c:2351\n netlink_recvmsg+0x6bb/0x11d0 net/netlink/af_netlink.c:1983\n sock_recvmsg_nosec net/socket.c:1051 [inline]\n sock_recvmsg+0x22f/0x280 net/socket.c:1073\n __sys_recvfrom+0x246/0x3d0 net/socket.c:2267\n __do_sys_recvfrom net/socket.c:2285 [inline]\n __se_sys_recvfrom net/socket.c:2281 [inline]\n __x64_sys_recvfrom+0xde/0x100 net/socket.c:2281\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n RIP: 0033:0x7ff37dd17a79","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8af4f60472fce1f22db5068107b37bcc1a65eabd"},{"fixed":"6406d0ce0414b807af5d2a4b781c3f3ee52b8a4d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8af4f60472fce1f22db5068107b37bcc1a65eabd"},{"fixed":"28af028a71371df5fcbf807fd4444bba8d0c33cc"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8af4f60472fce1f22db5068107b37bcc1a65eabd"},{"fixed":"3bf39fa849ab8ed52abb6715922e6102d3df9f97"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.10","v6.11.2","v6.11.3","v6.11.4","v6.11.5","v6.11.6","v6.11.7","v6.11.8","v6.11.9","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.9","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-53212.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"200140899895044918999973109407978908545","length":1221},"id":"CVE-2024-53212-246bed08","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6406d0ce0414b807af5d2a4b781c3f3ee52b8a4d","target":{"file":"net/netlink/af_netlink.c","function":"netlink_ack"}},{"deprecated":false,"digest":{"function_hash":"200140899895044918999973109407978908545","length":1221},"id":"CVE-2024-53212-274015d9","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bf39fa849ab8ed52abb6715922e6102d3df9f97","target":{"file":"net/netlink/af_netlink.c","function":"netlink_ack"}},{"deprecated":false,"digest":{"function_hash":"250393858395546269284662149853271841563","length":691},"id":"CVE-2024-53212-32b81c35","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6406d0ce0414b807af5d2a4b781c3f3ee52b8a4d","target":{"file":"net/netlink/af_netlink.c","function":"netlink_dump_done"}},{"deprecated":false,"digest":{"line_hashes":["218140787169480090005092870380027017791","111604255769144772925760335331165850481","79221816838429126298861458923042872344","151583455199409075713613717808624405868","326156425027951815005668234530126846866","188090002515197470195974231179335222635","223187330035310335538085838955071988760","63142240447801850743193441838378010387","217288162877396187940630109860944552286","285301607625285623443821251406902815035","15914096295438108921459931763660365075","310917867992090571944987999701672026082","181767517523744504916669610233433170265","76147295807033364971556409605397221370","317515103033240656441396688939543820925","280395259378009532035130355638690221829","209317914942568048943034732389125571448","25720766751635546132507991186594017223","299938197797336117309200102023548232729","228512552931691443966185904465101961610","250907473228273158461758103921073079954","97317527346898086576887486069460930503","135702497087546875708951171076283216672","102742335722946977526973882574404076957","131277521952816396080394401862904279188","86036547290032491730562526997866971796"],"threshold":0.9},"id":"CVE-2024-53212-363f394b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bf39fa849ab8ed52abb6715922e6102d3df9f97","target":{"file":"net/netlink/af_netlink.c"}},{"deprecated":false,"digest":{"function_hash":"146267474566227668736669610417552593303","length":1090},"id":"CVE-2024-53212-3a10a580","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@28af028a71371df5fcbf807fd4444bba8d0c33cc","target":{"file":"net/netlink/af_netlink.c","function":"netlink_ack_tlv_fill"}},{"deprecated":false,"digest":{"function_hash":"250393858395546269284662149853271841563","length":691},"id":"CVE-2024-53212-b5ae4464","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@28af028a71371df5fcbf807fd4444bba8d0c33cc","target":{"file":"net/netlink/af_netlink.c","function":"netlink_dump_done"}},{"deprecated":false,"digest":{"function_hash":"200140899895044918999973109407978908545","length":1221},"id":"CVE-2024-53212-c491d5d8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@28af028a71371df5fcbf807fd4444bba8d0c33cc","target":{"file":"net/netlink/af_netlink.c","function":"netlink_ack"}},{"deprecated":false,"digest":{"line_hashes":["218140787169480090005092870380027017791","111604255769144772925760335331165850481","79221816838429126298861458923042872344","151583455199409075713613717808624405868","326156425027951815005668234530126846866","188090002515197470195974231179335222635","223187330035310335538085838955071988760","63142240447801850743193441838378010387","217288162877396187940630109860944552286","285301607625285623443821251406902815035","15914096295438108921459931763660365075","310917867992090571944987999701672026082","181767517523744504916669610233433170265","76147295807033364971556409605397221370","317515103033240656441396688939543820925","280395259378009532035130355638690221829","209317914942568048943034732389125571448","25720766751635546132507991186594017223","299938197797336117309200102023548232729","228512552931691443966185904465101961610","250907473228273158461758103921073079954","97317527346898086576887486069460930503","135702497087546875708951171076283216672","102742335722946977526973882574404076957","131277521952816396080394401862904279188","86036547290032491730562526997866971796"],"threshold":0.9},"id":"CVE-2024-53212-d9ea80d3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6406d0ce0414b807af5d2a4b781c3f3ee52b8a4d","target":{"file":"net/netlink/af_netlink.c"}},{"deprecated":false,"digest":{"line_hashes":["218140787169480090005092870380027017791","111604255769144772925760335331165850481","79221816838429126298861458923042872344","151583455199409075713613717808624405868","326156425027951815005668234530126846866","188090002515197470195974231179335222635","223187330035310335538085838955071988760","63142240447801850743193441838378010387","217288162877396187940630109860944552286","285301607625285623443821251406902815035","15914096295438108921459931763660365075","310917867992090571944987999701672026082","181767517523744504916669610233433170265","76147295807033364971556409605397221370","317515103033240656441396688939543820925","280395259378009532035130355638690221829","209317914942568048943034732389125571448","25720766751635546132507991186594017223","299938197797336117309200102023548232729","228512552931691443966185904465101961610","250907473228273158461758103921073079954","97317527346898086576887486069460930503","135702497087546875708951171076283216672","102742335722946977526973882574404076957","131277521952816396080394401862904279188","86036547290032491730562526997866971796"],"threshold":0.9},"id":"CVE-2024-53212-dd5fbc49","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@28af028a71371df5fcbf807fd4444bba8d0c33cc","target":{"file":"net/netlink/af_netlink.c"}},{"deprecated":false,"digest":{"function_hash":"146267474566227668736669610417552593303","length":1090},"id":"CVE-2024-53212-eb63a4cc","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bf39fa849ab8ed52abb6715922e6102d3df9f97","target":{"file":"net/netlink/af_netlink.c","function":"netlink_ack_tlv_fill"}},{"deprecated":false,"digest":{"function_hash":"250393858395546269284662149853271841563","length":691},"id":"CVE-2024-53212-f9278de5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3bf39fa849ab8ed52abb6715922e6102d3df9f97","target":{"file":"net/netlink/af_netlink.c","function":"netlink_dump_done"}},{"deprecated":false,"digest":{"function_hash":"146267474566227668736669610417552593303","length":1090},"id":"CVE-2024-53212-fac2a0b4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6406d0ce0414b807af5d2a4b781c3f3ee52b8a4d","target":{"file":"net/netlink/af_netlink.c","function":"netlink_ack_tlv_fill"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.10.0"},{"fixed":"6.11.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.12.0"},{"fixed":"6.12.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-53212.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/28af028a71371df5fcbf807fd4444bba8d0c33cc"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3bf39fa849ab8ed52abb6715922e6102d3df9f97"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6406d0ce0414b807af5d2a4b781c3f3ee52b8a4d"}]}