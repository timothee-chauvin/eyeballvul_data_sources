{"schema_version":"1.7.3","id":"CVE-2025-40145","published":"2025-11-12T10:23:26.013Z","modified":"2025-12-01T20:43:21.601997Z","summary":"PCI/pwrctrl: Fix double cleanup on devm_add_action_or_reset() failure","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nPCI/pwrctrl: Fix double cleanup on devm_add_action_or_reset() failure\n\nWhen devm_add_action_or_reset() fails, it calls the passed cleanup\nfunction.  Hence the caller must not repeat that cleanup.\n\nReplace the \"goto err_regulator_free\" by the actual freeing, as there\nwill never be a need again for a second user of this label.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"75996c92f4de309f855471927e6489f5a354cfd4"},{"fixed":"77732c58fef6247b71493dc3997af0ec0aaad5c7"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"75996c92f4de309f855471927e6489f5a354cfd4"},{"fixed":"ab81f2f79c683c94bac622aafafbe8232e547159"}]}],"versions":["v6.14","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40145.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["79294604603320766605315337076471125593","171438902943377225557814667642380497140","224184040404095587015995999716746489882","171045939010635281419687433487893886361","31015787477694440516290463798147508667","212862935448886337607423703054825799664","270630050993379001675416875125560423333","308598563229459669684744462250627701147","171012662262595170039101266931268335973","309104881433704456572545144854203300548","209188503146287418334451799247412445570","143307776744014683664826554844588113958","83270442685812752153542845040797951635","3757886027416870641969581664012781565","225324010454640515146478323193415393912","249452249223580051208820477987175919164","61458109653235649127343858374093366414"],"threshold":0.9},"id":"CVE-2025-40145-aa578409","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@77732c58fef6247b71493dc3997af0ec0aaad5c7","target":{"file":"drivers/pci/pwrctrl/slot.c"}},{"deprecated":false,"digest":{"function_hash":"325555028421867317314479824754963596578","length":1131},"id":"CVE-2025-40145-ab1dc0e4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ab81f2f79c683c94bac622aafafbe8232e547159","target":{"file":"drivers/pci/pwrctrl/slot.c","function":"pci_pwrctrl_slot_probe"}},{"deprecated":false,"digest":{"line_hashes":["79294604603320766605315337076471125593","171438902943377225557814667642380497140","224184040404095587015995999716746489882","171045939010635281419687433487893886361","31015787477694440516290463798147508667","212862935448886337607423703054825799664","270630050993379001675416875125560423333","308598563229459669684744462250627701147","171012662262595170039101266931268335973","309104881433704456572545144854203300548","209188503146287418334451799247412445570","143307776744014683664826554844588113958","83270442685812752153542845040797951635","3757886027416870641969581664012781565","225324010454640515146478323193415393912","249452249223580051208820477987175919164","61458109653235649127343858374093366414"],"threshold":0.9},"id":"CVE-2025-40145-d44afa5a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ab81f2f79c683c94bac622aafafbe8232e547159","target":{"file":"drivers/pci/pwrctrl/slot.c"}},{"deprecated":false,"digest":{"function_hash":"325555028421867317314479824754963596578","length":1131},"id":"CVE-2025-40145-ff5a029c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@77732c58fef6247b71493dc3997af0ec0aaad5c7","target":{"file":"drivers/pci/pwrctrl/slot.c","function":"pci_pwrctrl_slot_probe"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40145.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/77732c58fef6247b71493dc3997af0ec0aaad5c7"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ab81f2f79c683c94bac622aafafbe8232e547159"}]}