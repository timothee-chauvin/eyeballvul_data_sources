{"schema_version":"1.7.3","id":"CVE-2022-50219","published":"2025-06-18T11:03:54Z","modified":"2025-10-21T12:44:46.519946Z","summary":"bpf: Fix KASAN use-after-free Read in compute_effective_progs","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix KASAN use-after-free Read in compute_effective_progs\n\nSyzbot found a Use After Free bug in compute_effective_progs().\nThe reproducer creates a number of BPF links, and causes a fault\ninjected alloc to fail, while calling bpf_link_detach on them.\nLink detach triggers the link to be freed by bpf_link_free(),\nwhich calls __cgroup_bpf_detach() and update_effective_progs().\nIf the memory allocation in this function fails, the function restores\nthe pointer to the bpf_cgroup_link on the cgroup list, but the memory\ngets freed just after it returns. After this, every subsequent call to\nupdate_effective_progs() causes this already deallocated pointer to be\ndereferenced in prog_list_length(), and triggers KASAN UAF error.\n\nTo fix this issue don't preserve the pointer to the prog or link in the\nlist, but remove it and replace it with a dummy prog without shrinking\nthe table. The subsequent call to __cgroup_bpf_detach() or\n__cgroup_bpf_detach() will correct it.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"af6eea57437a830293eab56246b6025cc7d46ee7"},{"fixed":"3527e3cbb84d8868c4d4e91ba55915f96d39ec3d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"af6eea57437a830293eab56246b6025cc7d46ee7"},{"fixed":"1f8ca9c40e6222ce431e9ba5dae3cccce8ef9443"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"af6eea57437a830293eab56246b6025cc7d46ee7"},{"fixed":"6336388715afa419cc97d0255bda3bba1b96b7ca"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"af6eea57437a830293eab56246b6025cc7d46ee7"},{"fixed":"be001f9da71eaa3b61e186fb88bde3279728bdca"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"af6eea57437a830293eab56246b6025cc7d46ee7"},{"fixed":"4c46091ee985ae84c60c5e95055d779fcd291d87"}]}],"versions":["v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.10.1","v5.10.10","v5.10.100","v5.10.101","v5.10.102","v5.10.103","v5.10.104","v5.10.105","v5.10.106","v5.10.107","v5.10.108","v5.10.109","v5.10.11","v5.10.110","v5.10.111","v5.10.112","v5.10.113","v5.10.114","v5.10.115","v5.10.116","v5.10.117","v5.10.118","v5.10.119","v5.10.12","v5.10.120","v5.10.121","v5.10.122","v5.10.123","v5.10.124","v5.10.125","v5.10.126","v5.10.127","v5.10.128","v5.10.129","v5.10.13","v5.10.130","v5.10.131","v5.10.132","v5.10.133","v5.10.134","v5.10.135","v5.10.136","v5.10.137","v5.10.14","v5.10.15","v5.10.16","v5.10.17","v5.10.18","v5.10.19","v5.10.2","v5.10.20","v5.10.21","v5.10.22","v5.10.23","v5.10.24","v5.10.25","v5.10.26","v5.10.27","v5.10.28","v5.10.29","v5.10.3","v5.10.30","v5.10.31","v5.10.32","v5.10.33","v5.10.34","v5.10.35","v5.10.36","v5.10.37","v5.10.38","v5.10.39","v5.10.4","v5.10.40","v5.10.41","v5.10.42","v5.10.43","v5.10.44","v5.10.45","v5.10.46","v5.10.47","v5.10.48","v5.10.49","v5.10.5","v5.10.50","v5.10.51","v5.10.52","v5.10.53","v5.10.54","v5.10.55","v5.10.56","v5.10.57","v5.10.58","v5.10.59","v5.10.6","v5.10.60","v5.10.61","v5.10.62","v5.10.63","v5.10.64","v5.10.65","v5.10.66","v5.10.67","v5.10.68","v5.10.69","v5.10.7","v5.10.70","v5.10.71","v5.10.72","v5.10.73","v5.10.74","v5.10.75","v5.10.76","v5.10.77","v5.10.78","v5.10.79","v5.10.8","v5.10.80","v5.10.81","v5.10.82","v5.10.83","v5.10.84","v5.10.85","v5.10.86","v5.10.87","v5.10.88","v5.10.89","v5.10.9","v5.10.90","v5.10.91","v5.10.92","v5.10.93","v5.10.94","v5.10.95","v5.10.96","v5.10.97","v5.10.98","v5.10.99","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.34","v5.15.35","v5.15.36","v5.15.37","v5.15.38","v5.15.39","v5.15.4","v5.15.40","v5.15.41","v5.15.42","v5.15.43","v5.15.44","v5.15.45","v5.15.46","v5.15.47","v5.15.48","v5.15.49","v5.15.5","v5.15.50","v5.15.51","v5.15.52","v5.15.53","v5.15.54","v5.15.55","v5.15.56","v5.15.57","v5.15.58","v5.15.59","v5.15.6","v5.15.60","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.18.1","v5.18.10","v5.18.11","v5.18.12","v5.18.13","v5.18.14","v5.18.15","v5.18.16","v5.18.17","v5.18.2","v5.18.3","v5.18.4","v5.18.5","v5.18.6","v5.18.7","v5.18.8","v5.18.9","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.19.1","v5.6","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50219.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["328474571572877791072376422976248940742","38464312255499953760072555467577740571","330594403719539343045276245853765427348","213421038275056567424959130430964069838","296839697531864142229957613952114547627","10349979549502066406575010483925381415","333317050807596024243154209679998120212","299985249334716022603727515027632314344","289984378601889258522989197688157528293","173506811164328240194944062282688054057","222956957650865872327549066185145698166","276523096653077819699930212734909290148","127264798574253388911255455154852634464","21353736311189608905605293090190592747","26016447154694989374795343827767125852","4631187920261286597253106024115032363","248016689461637054060051802186110621288","335392337044417450394293469966590776121","287978380304720420365855779177323441422","120804643310854154824375665764457199406"],"threshold":0.9},"id":"CVE-2022-50219-1696e3b7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4c46091ee985ae84c60c5e95055d779fcd291d87","target":{"file":"kernel/bpf/cgroup.c"}},{"deprecated":false,"digest":{"function_hash":"180956664548805722311570364254937884717","length":841},"id":"CVE-2022-50219-1e3553de","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4c46091ee985ae84c60c5e95055d779fcd291d87","target":{"file":"kernel/bpf/cgroup.c","function":"__cgroup_bpf_detach"}},{"deprecated":false,"digest":{"function_hash":"180956664548805722311570364254937884717","length":841},"id":"CVE-2022-50219-2325e2a6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@be001f9da71eaa3b61e186fb88bde3279728bdca","target":{"file":"kernel/bpf/cgroup.c","function":"__cgroup_bpf_detach"}},{"deprecated":false,"digest":{"function_hash":"180956664548805722311570364254937884717","length":841},"id":"CVE-2022-50219-24e2a4ed","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6336388715afa419cc97d0255bda3bba1b96b7ca","target":{"file":"kernel/bpf/cgroup.c","function":"__cgroup_bpf_detach"}},{"deprecated":false,"digest":{"line_hashes":["258253080630255717062774177700287688958","213740889490997436523170259921163357609","47865930773452385372222708370718881005","213421038275056567424959130430964069838","296839697531864142229957613952114547627","10349979549502066406575010483925381415","333317050807596024243154209679998120212","299985249334716022603727515027632314344","289984378601889258522989197688157528293","173506811164328240194944062282688054057","222956957650865872327549066185145698166","276523096653077819699930212734909290148","127264798574253388911255455154852634464","21353736311189608905605293090190592747","26016447154694989374795343827767125852","4631187920261286597253106024115032363","248016689461637054060051802186110621288","335392337044417450394293469966590776121","96022812150053883955374326703497393920","275090239234939824843785901093712515019"],"threshold":0.9},"id":"CVE-2022-50219-59f2964a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1f8ca9c40e6222ce431e9ba5dae3cccce8ef9443","target":{"file":"kernel/bpf/cgroup.c"}},{"deprecated":false,"digest":{"function_hash":"128026355697426220443586655269184638462","length":834},"id":"CVE-2022-50219-75120481","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1f8ca9c40e6222ce431e9ba5dae3cccce8ef9443","target":{"file":"kernel/bpf/cgroup.c","function":"__cgroup_bpf_detach"}},{"deprecated":false,"digest":{"line_hashes":["328474571572877791072376422976248940742","38464312255499953760072555467577740571","330594403719539343045276245853765427348","213421038275056567424959130430964069838","296839697531864142229957613952114547627","10349979549502066406575010483925381415","333317050807596024243154209679998120212","299985249334716022603727515027632314344","289984378601889258522989197688157528293","173506811164328240194944062282688054057","222956957650865872327549066185145698166","276523096653077819699930212734909290148","127264798574253388911255455154852634464","21353736311189608905605293090190592747","26016447154694989374795343827767125852","4631187920261286597253106024115032363","248016689461637054060051802186110621288","335392337044417450394293469966590776121","287978380304720420365855779177323441422","120804643310854154824375665764457199406"],"threshold":0.9},"id":"CVE-2022-50219-abdb59b8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6336388715afa419cc97d0255bda3bba1b96b7ca","target":{"file":"kernel/bpf/cgroup.c"}},{"deprecated":false,"digest":{"line_hashes":["328474571572877791072376422976248940742","38464312255499953760072555467577740571","330594403719539343045276245853765427348","213421038275056567424959130430964069838","296839697531864142229957613952114547627","10349979549502066406575010483925381415","333317050807596024243154209679998120212","299985249334716022603727515027632314344","289984378601889258522989197688157528293","173506811164328240194944062282688054057","222956957650865872327549066185145698166","276523096653077819699930212734909290148","127264798574253388911255455154852634464","21353736311189608905605293090190592747","26016447154694989374795343827767125852","4631187920261286597253106024115032363","248016689461637054060051802186110621288","335392337044417450394293469966590776121","287978380304720420365855779177323441422","120804643310854154824375665764457199406"],"threshold":0.9},"id":"CVE-2022-50219-abefa2b2","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@be001f9da71eaa3b61e186fb88bde3279728bdca","target":{"file":"kernel/bpf/cgroup.c"}},{"deprecated":false,"digest":{"line_hashes":["258253080630255717062774177700287688958","213740889490997436523170259921163357609","47865930773452385372222708370718881005","155498653613914146535688217114499890142","261597721770666686053731271826633522808","332771958173550490477343556336840724727","249161484494477598737293671416880690442","118344652680806158576556907466036162410","804999749362050679498560418281991991","72310298708917964863958052279252199315","333197776132667569057992900111866639487","276523096653077819699930212734909290148","127264798574253388911255455154852634464","326843207739153837337987664189576661156","33378538512555950927417525927503159671","4631187920261286597253106024115032363","248016689461637054060051802186110621288","335392337044417450394293469966590776121","96022812150053883955374326703497393920","275090239234939824843785901093712515019"],"threshold":0.9},"id":"CVE-2022-50219-b82b0fd6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3527e3cbb84d8868c4d4e91ba55915f96d39ec3d","target":{"file":"kernel/bpf/cgroup.c"}},{"deprecated":false,"digest":{"function_hash":"231021469285892037367278175614532111163","length":750},"id":"CVE-2022-50219-dc25a418","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3527e3cbb84d8868c4d4e91ba55915f96d39ec3d","target":{"file":"kernel/bpf/cgroup.c","function":"__cgroup_bpf_detach"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.7.0"},{"fixed":"5.10.138"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.11.0"},{"fixed":"5.15.61"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.18.18"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.19.0"},{"fixed":"5.19.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50219.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1f8ca9c40e6222ce431e9ba5dae3cccce8ef9443"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3527e3cbb84d8868c4d4e91ba55915f96d39ec3d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4c46091ee985ae84c60c5e95055d779fcd291d87"},{"type":"WEB","url":"https://git.kernel.org/stable/c/6336388715afa419cc97d0255bda3bba1b96b7ca"},{"type":"WEB","url":"https://git.kernel.org/stable/c/be001f9da71eaa3b61e186fb88bde3279728bdca"}]}