{"schema_version":"1.7.3","id":"CVE-2025-39814","published":"2025-09-16T13:00:15.552Z","modified":"2025-11-20T10:07:00.170554Z","summary":"ice: fix NULL pointer dereference in ice_unplug_aux_dev() on reset","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nice: fix NULL pointer dereference in ice_unplug_aux_dev() on reset\n\nIssuing a reset when the driver is loaded without RDMA support, will\nresults in a crash as it attempts to remove RDMA's non-existent auxbus\ndevice:\necho 1 > /sys/class/net/<if>/device/reset\n\nBUG: kernel NULL pointer dereference, address: 0000000000000008\n...\nRIP: 0010:ice_unplug_aux_dev+0x29/0x70 [ice]\n...\nCall Trace:\n<TASK>\nice_prepare_for_reset+0x77/0x260 [ice]\npci_dev_save_and_disable+0x2c/0x70\npci_reset_function+0x88/0x130\nreset_store+0x5a/0xa0\nkernfs_fop_write_iter+0x15e/0x210\nvfs_write+0x273/0x520\nksys_write+0x6b/0xe0\ndo_syscall_64+0x79/0x3b0\nentry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nice_unplug_aux_dev() checks pf->cdev_info->adev for NULL pointer, but\npf->cdev_info will also be NULL, leading to the deref in the trace above.\n\nIntroduce a flag to be set when the creation of the auxbus device is\nsuccessful, to avoid multiple NULL pointer checks in ice_unplug_aux_dev().","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"c24a65b6a27c78d8540409800886b6622ea86ebf"},{"fixed":"db783756a7d7cfaea039411971d0dc0a374e85cb"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"c24a65b6a27c78d8540409800886b6622ea86ebf"},{"fixed":"60dfe2434eed13082f26eb7409665dfafb38fa51"}]}],"versions":["v6.15","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.16.4","v6.17-rc1","v6.17-rc2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39814.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["77177872420974239318564840260039155926","222321594818190001083323366789478735341","131564727369129038763113784863096520320","331032688834710488384531050992274291774","306767009438649701767222429613903595449","259547726886452829019812553161017565160","88609845828196547860078017123468875275","242452494150097111004618197356727492096","66703392479208725627224489919239487135","71775479716516500674573348273413050201","297481368956228223936351611051987736841","8855223034401070739695048030145162942","13742235101148540384432202450054980805","224821222265829104911539965332946636477","164169857469115137588632575164299908434"],"threshold":0.9},"id":"CVE-2025-39814-0cc0cf37","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60dfe2434eed13082f26eb7409665dfafb38fa51","target":{"file":"drivers/net/ethernet/intel/ice/ice_idc.c"}},{"deprecated":false,"digest":{"function_hash":"75524080293980465193659628831041600940","length":767},"id":"CVE-2025-39814-4a4cd512","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60dfe2434eed13082f26eb7409665dfafb38fa51","target":{"file":"drivers/net/ethernet/intel/ice/ice_idc.c","function":"ice_plug_aux_dev"}},{"deprecated":false,"digest":{"line_hashes":["77177872420974239318564840260039155926","222321594818190001083323366789478735341","131564727369129038763113784863096520320","331032688834710488384531050992274291774","306767009438649701767222429613903595449","259547726886452829019812553161017565160","88609845828196547860078017123468875275","242452494150097111004618197356727492096","66703392479208725627224489919239487135","71775479716516500674573348273413050201","297481368956228223936351611051987736841","8855223034401070739695048030145162942","13742235101148540384432202450054980805","224821222265829104911539965332946636477","164169857469115137588632575164299908434"],"threshold":0.9},"id":"CVE-2025-39814-7f12e041","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db783756a7d7cfaea039411971d0dc0a374e85cb","target":{"file":"drivers/net/ethernet/intel/ice/ice_idc.c"}},{"deprecated":false,"digest":{"function_hash":"75524080293980465193659628831041600940","length":767},"id":"CVE-2025-39814-99c31280","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db783756a7d7cfaea039411971d0dc0a374e85cb","target":{"file":"drivers/net/ethernet/intel/ice/ice_idc.c","function":"ice_plug_aux_dev"}},{"deprecated":false,"digest":{"line_hashes":["55264577719815544851017600903443371174","128214037511591655145791332061549667532","164616414890825276695454722144284199547","338635981188341726085416650091977975568"],"threshold":0.9},"id":"CVE-2025-39814-a09de750","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60dfe2434eed13082f26eb7409665dfafb38fa51","target":{"file":"drivers/net/ethernet/intel/ice/ice.h"}},{"deprecated":false,"digest":{"function_hash":"53722377753956646362362452693306793649","length":246},"id":"CVE-2025-39814-d21d5536","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db783756a7d7cfaea039411971d0dc0a374e85cb","target":{"file":"drivers/net/ethernet/intel/ice/ice_idc.c","function":"ice_unplug_aux_dev"}},{"deprecated":false,"digest":{"line_hashes":["55264577719815544851017600903443371174","128214037511591655145791332061549667532","164616414890825276695454722144284199547","338635981188341726085416650091977975568"],"threshold":0.9},"id":"CVE-2025-39814-e97699be","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db783756a7d7cfaea039411971d0dc0a374e85cb","target":{"file":"drivers/net/ethernet/intel/ice/ice.h"}},{"deprecated":false,"digest":{"function_hash":"53722377753956646362362452693306793649","length":246},"id":"CVE-2025-39814-ef2174a7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60dfe2434eed13082f26eb7409665dfafb38fa51","target":{"file":"drivers/net/ethernet/intel/ice/ice_idc.c","function":"ice_unplug_aux_dev"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.16.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39814.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/60dfe2434eed13082f26eb7409665dfafb38fa51"},{"type":"WEB","url":"https://git.kernel.org/stable/c/db783756a7d7cfaea039411971d0dc0a374e85cb"}]}