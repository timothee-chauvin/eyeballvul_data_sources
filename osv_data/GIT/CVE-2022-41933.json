{"schema_version":"1.7.3","id":"CVE-2022-41933","published":"2022-11-23T00:00:00Z","modified":"2025-10-25T04:09:34.745899Z","aliases":["GHSA-q2hm-2h45-v5g3"],"related":["GHSA-599v-w48h-rjrm","GHSA-q2hm-2h45-v5g3"],"summary":"Plaintext storage of password in org.xwiki.platform:xwiki-platform-security-authentication-default","details":"XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. When the `reset a forgotten password` feature of XWiki was used, the password was then stored in plain text in database. This only concerns XWiki 13.1RC1 and newer versions. Note that it only concerns the reset password feature available from the \"Forgot your password\" link in the login view: the features allowing a user to change their password, or for an admin to change a user password are not impacted. This vulnerability is particularly dangerous in combination with other vulnerabilities allowing to perform data leak of personal data from users, such as GHSA-599v-w48h-rjrm. Note that this vulnerability only concerns the users of the main wiki: in case of farms, the users registered on subwiki are not impacted thanks to a bug we discovered when investigating this. The problem has been patched in version 14.6RC1, 14.4.3 and 13.10.8. The patch involves a migration of the impacted users as well as the history of the page, to ensure no password remains in plain text in the database. This migration also involves to inform the users about the possible disclosure of their passwords: by default, two emails are automatically sent to the impacted users. A first email to inform about the possibility that their password have been leaked, and a second email using the reset password feature to ask them to set a new password. It's also possible for administrators to set some properties for the migration: it's possible to decide if the user password should be reset (default) or if the passwords should be kept but only hashed. Note that in the first option, the users won't be able to login anymore until they set a new password if they were impacted. Note that in both options, mails will be sent to users to inform them and encourage them to change their passwords.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/xwiki/xwiki-commons","events":[{"introduced":"0"},{"fixed":"f1061cdd99a531c74466c225011a1d25d203a14b"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-41933.json"}},{"ranges":[{"type":"GIT","repo":"https://github.com/xwiki/xwiki-platform","events":[{"introduced":"0"},{"fixed":"443e8398b75a1295067d74afb5898370782d863a"}]}],"versions":["xwiki-application-calendar-1.0","xwiki-platform-7.3-milestone-2","xwiki-platform-7.4-milestone-1","xwiki-platform-7.4-milestone-2","xwiki-platform-8.0-milestone-1","xwiki-platform-8.0-milestone-2","xwiki-platform-8.1-milestone-1","xwiki-platform-8.1-milestone-2","xwiki-platform-8.2-milestone-1","xwiki-platform-8.2-milestone-2","xwiki-platform-8.3-milestone-1","xwiki-platform-9.9-rc-2","xwiki-plugin-tag-1.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-41933.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["90576602890231816670622566346488979613","256153266954381331551207504636563929037","56261395946095919314262759618067472347","222098884251611851131085530966547361754"],"threshold":0.9},"id":"CVE-2022-41933-12981ec0","signature_type":"Line","signature_version":"v1","source":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a","target":{"file":"xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/main/java/org/xwiki/security/authentication/internal/DefaultResetPasswordManager.java"}},{"deprecated":false,"digest":{"line_hashes":["79636843596387114764147586481749756315","41786802238863921255723863642699744440","224111669459895563201809560936989808188","53503429330140416269873286115610288629","225489279170312544627616523240140820932","48632094453618076041816286999142899220","28349855848965789802956519586962443204","171535584296160738892160064102989711039","214354546142944702495034090149724056290","339368273614905577849063453122004561863","302876013638112814892737941559992340095","226697293484576283293512644629615053991","260938350985322178643032867154723034866","14392932945343515342480640892126819776"],"threshold":0.9},"id":"CVE-2022-41933-5cafa81d","signature_type":"Line","signature_version":"v1","source":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a","target":{"file":"xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/test/java/org/xwiki/security/authentication/internal/ResetPasswordMailSenderTest.java"}},{"deprecated":false,"digest":{"line_hashes":["307852904462326581587085554686288650062","211974615625366270927698952710170388161","28370263561477459027742029216733691599","19768697612390193061027257013511822976","75989865722536105584307437451072293768","180747075492490919065214455934656284109","231351949340356945301232882532672050471","23182002846002669805595428913290509200","210025372033033322370609512830315125591","276457294660239318062295130566302188220","253751052043779652639983737308388378738","40522808639048304146321519505623622498","90360502708031303822547626674737140020","927355667327609307381197426442030972","268575232726808772923811154699550497649","311926310743519813034306032784159541060","281828960380047832325719804632704770084","57223475160888797928159480743222564085","258173374715039028928952513354489165694","22189918549192295488214960295745067198","157084486200461635112373141266600939290","176764136889135572810648168175356257005","323312783146451914867570026802551204488","62604061103671164046772626385185934974","223013601857101564107851793012969924144","206044988005493583073105412183504671172","226466240645913154808134696220727418273","244470404515475580633151224739068990049","335062233667954010684504793021209647919","188525604436970636544387968562559271984","211080219196911329096478653833500494209","82706663062514021978958353828628298744","84523090424984324223717514606278011132","122996320254265832192334269876700341311","316463786552807701586368171616947508755","293897032503583970305978809749437589924","177275495640230045347434548065033828258","135269423176288673944929163582157502516","118570297406224206068410677964409962186","64539017106023574444956145038015664824","150811964149192495312775860299787468624"],"threshold":0.9},"id":"CVE-2022-41933-92593042","signature_type":"Line","signature_version":"v1","source":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a","target":{"file":"xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/main/java/org/xwiki/security/authentication/internal/ResetPasswordMailSender.java"}},{"deprecated":false,"digest":{"function_hash":"243050493196439947429739571106352840220","length":1450},"id":"CVE-2022-41933-b3f35404","signature_type":"Function","signature_version":"v1","source":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a","target":{"file":"xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/main/java/org/xwiki/security/authentication/internal/ResetPasswordMailSender.java","function":"sendResetPasswordEmail"}},{"deprecated":false,"digest":{"function_hash":"21477067464046592539574879294110305764","length":727},"id":"CVE-2022-41933-c0040b8e","signature_type":"Function","signature_version":"v1","source":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a","target":{"file":"xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/test/java/org/xwiki/security/authentication/internal/DefaultResetPasswordManagerTest.java","function":"resetPassword"}},{"deprecated":false,"digest":{"line_hashes":["60994698369322368695274529363407095703","120603146933037052609149543435583545092","238180327893816214807450388483040477350","9782917798565651180677677476555964632"],"threshold":0.9},"id":"CVE-2022-41933-d49cb4bc","signature_type":"Line","signature_version":"v1","source":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a","target":{"file":"xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/test/java/org/xwiki/security/authentication/internal/DefaultResetPasswordManagerTest.java"}},{"deprecated":false,"digest":{"function_hash":"113477646705004769340561855932581772100","length":726},"id":"CVE-2022-41933-f195939a","signature_type":"Function","signature_version":"v1","source":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a","target":{"file":"xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/main/java/org/xwiki/security/authentication/internal/DefaultResetPasswordManager.java","function":"resetPassword"}}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm"},{"type":"ADVISORY","url":"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q2hm-2h45-v5g3"},{"type":"FIX","url":"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a#diff-f8a8f8ba80dfc55f044e2e60b521ce379176430ca6921b0f87b79cf682531f79L322"},{"type":"WEB","url":"https://jira.xwiki.org/browse/XWIKI-19869"},{"type":"WEB","url":"https://jira.xwiki.org/browse/XWIKI-19945"}],"database_specific":{"cwe_ids":["CWE-312"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:N/A:N"}]}