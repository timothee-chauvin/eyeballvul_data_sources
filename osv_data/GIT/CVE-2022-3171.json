{"schema_version":"1.7.3","id":"CVE-2022-3171","published":"2022-10-12T23:15:09Z","modified":"2025-10-21T07:06:51.213095Z","aliases":["CGA-xp6q-2w42-9mfm","GHSA-h4h5-3hr4-j3g2"],"related":["CGA-4823-v8jx-rx3q","CGA-j4r7-qxxx-756w","CGA-jwcm-r7hw-56j9","GHSA-h4h5-3hr4-j3g2","MGASA-2023-0092","SUSE-SU-2022:3922-1","SUSE-SU-2023:2783-1","SUSE-SU-2023:2783-2"],"details":"A parsing issue with binary data in protobuf-java core and lite versions prior to 3.21.7, 3.20.3, 3.19.6 and 3.16.3 can lead to a denial of service attack. Inputs containing multiple instances of non-repeated embedded messages with repeated or unknown fields causes objects to be converted back-n-forth between mutable and immutable forms, resulting in potentially long garbage collection pauses. We recommend updating to the versions mentioned above.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/protocolbuffers/protobuf","events":[{"introduced":"0"},{"fixed":"b8c2488f480bbe3d66b9874c2fcd434201caa48a"}]}],"versions":["3.15.0-rc1","conformance-build-tag","v16.2","v2.4.1","v2.5.0","v2.6.0","v2.6.1","v2.6.1rc1","v3.0.0","v3.0.0-alpha-1","v3.0.0-alpha-2","v3.0.0-alpha-3","v3.0.0-alpha-4","v3.0.0-beta-1","v3.0.0-beta-1-bzl-fix","v3.0.0-beta-2","v3.0.0-beta-3","v3.0.0-beta-3-pre-1","v3.0.0-beta-4","v3.0.2","v3.1.0","v3.1.0-alpha-1","v3.10.0","v3.10.0-rc1","v3.11.0","v3.11.0-rc1","v3.11.0-rc2","v3.11.1","v3.11.2","v3.11.3","v3.11.4","v3.12.0","v3.12.0-rc1","v3.12.0-rc2","v3.12.1","v3.12.2","v3.12.3","v3.13.0","v3.13.0-rc3","v3.13.0.1","v3.14.0","v3.14.0-rc1","v3.14.0-rc2","v3.14.0-rc3","v3.15.0","v3.15.0-rc1","v3.15.0-rc2","v3.15.1","v3.15.2","v3.15.3","v3.15.4","v3.15.5","v3.15.6","v3.15.7","v3.16.0","v3.16.0-rc1","v3.16.0-rc2","v3.16.1","v3.16.2","v3.3.0","v3.3.0rc1","v3.3.1","v3.3.2","v3.4.0","v3.4.0rc1","v3.4.0rc2","v3.4.0rc3","v3.4.1","v3.5.0","v3.5.0.1","v3.5.1","v3.5.2","v3.6.0","v3.6.0.1","v3.6.0rc1","v3.6.0rc2","v3.6.1","v3.7.0","v3.7.0-rc.2","v3.7.0-rc.3","v3.7.0rc1","v3.7.0rc2","v3.7.1","v3.8.0","v3.8.0-rc1","v3.9.0-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-3171.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-3c760779","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/wrappers.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-51960048","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/descriptor.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-610f4e97","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/timestamp.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-6bc36508","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/api.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-7b523458","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/compiler/plugin.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-892436e4","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/type.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-8c2e0192","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/any.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-b0f21209","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/empty.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-c1227f64","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/duration.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-d5e132eb","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/field_mask.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-ebeb0e90","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/source_context.pb.h"}},{"deprecated":false,"digest":{"line_hashes":["14463844651962961940331438795809373578","214516298593296203942852467115320028386","261809066153928994664321823254706116376","307626444442344817117879599035219910274"],"threshold":0.9},"id":"CVE-2022-3171-fd9bc12e","signature_type":"Line","signature_version":"v1","source":"https://github.com/protocolbuffers/protobuf/commit/b8c2488f480bbe3d66b9874c2fcd434201caa48a","target":{"file":"src/google/protobuf/struct.pb.h"}}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-h4h5-3hr4-j3g2"},{"type":"ADVISORY","url":"https://security.gentoo.org/glsa/202301-09"},{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CBAUKJQL6O4TIWYBENORSY5P43TVB4M3/"},{"type":"WEB","url":"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MPCGUT3T5L6C3IDWUPSUO22QDCGQKTOP/"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}