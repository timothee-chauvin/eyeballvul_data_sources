{"schema_version":"1.7.3","id":"CVE-2022-49127","published":"2025-02-26T01:55:04.643Z","modified":"2025-11-19T13:18:33.179967Z","summary":"ref_tracker: implement use-after-free detection","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nref_tracker: implement use-after-free detection\n\nWhenever ref_tracker_dir_init() is called, mark the struct ref_tracker_dir\nas dead.\n\nTest the dead status from ref_tracker_alloc() and ref_tracker_free()\n\nThis should detect buggy dev_put()/dev_hold() happening too late\nin netdevice dismantle process.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4e66934eaadc83b27ada8d42b60894018f3bfabf"},{"fixed":"3743c9de303fa36c2e2ca2522ab280c52bcafbd2"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4e66934eaadc83b27ada8d42b60894018f3bfabf"},{"fixed":"e3ececfe668facd87d920b608349a32607060e66"}]}],"versions":["v5.16","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49127.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["91244770138668947819841620019570565648","100209318224815166029599425209099639201","115389790689657731257834346378345584050","67655556263552851270379346967881521061","21668387911000239889087072778525852763","210452557402132451279979631305590073748","167222549670566091809171546047568795342","334907172223365168383610553136689210090"],"threshold":0.9},"id":"CVE-2022-49127-12cb302b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3743c9de303fa36c2e2ca2522ab280c52bcafbd2","target":{"file":"include/linux/ref_tracker.h"}},{"deprecated":false,"digest":{"function_hash":"148252295059274426566970765012476149268","length":738},"id":"CVE-2022-49127-14851335","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3743c9de303fa36c2e2ca2522ab280c52bcafbd2","target":{"file":"lib/ref_tracker.c","function":"ref_tracker_alloc"}},{"deprecated":false,"digest":{"function_hash":"243353422121804046810467003815481165717","length":639},"id":"CVE-2022-49127-1724263b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3743c9de303fa36c2e2ca2522ab280c52bcafbd2","target":{"file":"lib/ref_tracker.c","function":"ref_tracker_dir_exit"}},{"deprecated":false,"digest":{"function_hash":"243353422121804046810467003815481165717","length":639},"id":"CVE-2022-49127-1f7bf746","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e3ececfe668facd87d920b608349a32607060e66","target":{"file":"lib/ref_tracker.c","function":"ref_tracker_dir_exit"}},{"deprecated":false,"digest":{"function_hash":"112649470600871158022840867828449628211","length":1133},"id":"CVE-2022-49127-46ec9bdc","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3743c9de303fa36c2e2ca2522ab280c52bcafbd2","target":{"file":"lib/ref_tracker.c","function":"ref_tracker_free"}},{"deprecated":false,"digest":{"function_hash":"182679242684263097370843094418298509253","length":263},"id":"CVE-2022-49127-64b0d892","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e3ececfe668facd87d920b608349a32607060e66","target":{"file":"include/linux/ref_tracker.h","function":"ref_tracker_dir_init"}},{"deprecated":false,"digest":{"line_hashes":["91244770138668947819841620019570565648","100209318224815166029599425209099639201","115389790689657731257834346378345584050","67655556263552851270379346967881521061","21668387911000239889087072778525852763","210452557402132451279979631305590073748","167222549670566091809171546047568795342","334907172223365168383610553136689210090"],"threshold":0.9},"id":"CVE-2022-49127-683f4c8a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e3ececfe668facd87d920b608349a32607060e66","target":{"file":"include/linux/ref_tracker.h"}},{"deprecated":false,"digest":{"function_hash":"112649470600871158022840867828449628211","length":1133},"id":"CVE-2022-49127-850e096c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e3ececfe668facd87d920b608349a32607060e66","target":{"file":"lib/ref_tracker.c","function":"ref_tracker_free"}},{"deprecated":false,"digest":{"line_hashes":["263493077110747515851657060248575252797","328296714946629197250825612469380840949","237553821653884453423595077911499550428","234918053898666453769021588743568292429","15619889350667951309279410926470733777","105492262192888624601122009977018575663","303440621195072542513105838234948749001","212745164055341145204064634626225705952","319401701070952057587253712334338377854"],"threshold":0.9},"id":"CVE-2022-49127-af6c7232","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e3ececfe668facd87d920b608349a32607060e66","target":{"file":"lib/ref_tracker.c"}},{"deprecated":false,"digest":{"line_hashes":["263493077110747515851657060248575252797","328296714946629197250825612469380840949","237553821653884453423595077911499550428","234918053898666453769021588743568292429","15619889350667951309279410926470733777","105492262192888624601122009977018575663","303440621195072542513105838234948749001","212745164055341145204064634626225705952","319401701070952057587253712334338377854"],"threshold":0.9},"id":"CVE-2022-49127-baa22bab","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3743c9de303fa36c2e2ca2522ab280c52bcafbd2","target":{"file":"lib/ref_tracker.c"}},{"deprecated":false,"digest":{"function_hash":"182679242684263097370843094418298509253","length":263},"id":"CVE-2022-49127-cc1ade09","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3743c9de303fa36c2e2ca2522ab280c52bcafbd2","target":{"file":"include/linux/ref_tracker.h","function":"ref_tracker_dir_init"}},{"deprecated":false,"digest":{"function_hash":"148252295059274426566970765012476149268","length":738},"id":"CVE-2022-49127-f9b4b7ed","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e3ececfe668facd87d920b608349a32607060e66","target":{"file":"lib/ref_tracker.c","function":"ref_tracker_alloc"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49127.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3743c9de303fa36c2e2ca2522ab280c52bcafbd2"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e3ececfe668facd87d920b608349a32607060e66"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}