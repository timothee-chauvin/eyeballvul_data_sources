{"schema_version":"1.7.3","id":"CVE-2018-16841","published":"2018-11-28T14:29:00.347Z","modified":"2025-11-19T17:35:20.786298Z","related":["MGASA-2019-0011","SUSE-SU-2018:4066-1","openSUSE-SU-2024:11365-1"],"details":"Samba from version 4.3.0 and before versions 4.7.12, 4.8.7 and 4.9.3 are vulnerable to a denial of service. When configured to accept smart-card authentication, Samba's KDC will call talloc_free() twice on the same memory if the principal in a validly signed certificate does not match the principal in the AS-REQ. This is only possible after authentication with a trusted certificate. talloc is robust against further corruption from a double-free with talloc_free() and directly calls abort(), terminating the KDC process.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/samba-team/samba","events":[{"introduced":"b85f6018c803fb9aad82820d4b5505179ec5bac3"},{"fixed":"b7d190f89d7674cf58a02486fa9887d393918611"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2018-16841.json"}}],"references":[{"type":"ADVISORY","url":"http://www.securityfocus.com/bid/106023"},{"type":"REPORT","url":"https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-16841"},{"type":"ADVISORY","url":"https://security.gentoo.org/glsa/202003-52"},{"type":"ADVISORY","url":"https://security.netapp.com/advisory/ntap-20181127-0001/"},{"type":"ADVISORY","url":"https://usn.ubuntu.com/3827-1/"},{"type":"ADVISORY","url":"https://usn.ubuntu.com/3827-2/"},{"type":"ADVISORY","url":"https://www.debian.org/security/2018/dsa-4345"},{"type":"FIX","url":"https://www.samba.org/samba/security/CVE-2018-16841.html"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}