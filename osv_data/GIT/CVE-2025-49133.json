{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-49133.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "91387592028675461997877095717241857353",
                "46043278828797612329583053409392477945",
                "290701491914702545293558201693678448267",
                "179078528010704461247847609789006065676",
                "89976829304750532194459578391855678356",
                "3813253998734237481309170010756697659",
                "25494423567064737236276331515657882949",
                "70147998749310796507018545356815385329",
                "11110004286565532341654438813567125647"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-49133-08df5df7",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/crypto/openssl/CryptHash.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "208586757102970530878562186476694338659",
                "208341190440247310063698707490328420088",
                "164504368535418962434445457555371447380",
                "53061649858386026513557069202946532228",
                "24400452444878837171420307935255108597"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-49133-88768195",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/crypto/CryptHash_fp.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "110830384868023181374212913749012154525",
                "195335677874360671005066615088067406239",
                "139770765966781114838541921534107145299",
                "161927505493685847401328142236829225168",
                "237653238515592734483595549056604187941",
                "58808915068985783206517233263950066424",
                "164113591438980628234204807458395193016",
                "56929236599932381610125478645481229181",
                "155655634464747686679182454301383396961",
                "98332868914268254006063472449028909954",
                "287078660006371891235642164093651702801",
                "276958886360006029218412958960920976195",
                "96677443537478843391359066453099930625",
                "72337614200572553388048156607844172450",
                "140588280118808835477640757074431395516",
                "159376765082532381756147477675019513749",
                "320736185507227739845358245016841253587",
                "161905651710234821282138684942253823159",
                "180697105913521249945237127677392569090",
                "78004217241506381048952124349575807005",
                "57833132747775884518164613183030422051",
                "2808046626516888132398087398147785351",
                "199425846635952633644505113840341931047",
                "278668133804529750204333938272554093419",
                "336506120896233261071099402622690618970",
                "74487754015921472552880063975625287670",
                "246144418070073470403821521249681724229",
                "300751124189907970519023877579328375629",
                "33729865116200128858884709956913880061",
                "169712341671356331356578309570007065986",
                "333336891578233060598421810574510093802",
                "254444762017899788904808751077959653240",
                "4469825291237727941941468370966114413",
                "131264415294300930712130665315292520253",
                "268989465032650533126611767263297998927",
                "172442407239522537002115380360357451442",
                "133169797100173072658482076310541515701",
                "217268310730680064319167733247374661113",
                "310388249129737548740322349614574416538",
                "248428915193250955286353991301603673281",
                "21787361574465134461028363288799642545",
                "210226503878164329466142730749373246164"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-49133-ca45bef8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/CryptUtil.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "221981491509906236489174022074160007062",
              "length": 801.0
            },
            "id": "CVE-2025-49133-cf1fe8a1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/CryptUtil.c",
              "function": "CryptSelectSignScheme"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "222618300359375868561426923428212684009",
                "112774421520859308995697409772969159891",
                "105308254526206672501321940335536140664",
                "106967519160790612746572883393594020556",
                "37302831347958675420968095559099376790",
                "318596456629620426577810778791410241002",
                "235793896461109925302241331622523813072",
                "18326731251167480864874614524731372222",
                "179193064650277356885867852704916782386",
                "288018180999912860106059652783530701296",
                "129046868282185197848296242791889904771",
                "87656892435991160728665602763837873816"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-49133-ed0d3c1d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/SigningCommands.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "167761883188394251752351933301685579721",
              "length": 1085.0
            },
            "id": "CVE-2025-49133-f18b363d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/SigningCommands.c",
              "function": "TPM2_Sign"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "25391857597255945963761654353419968044",
              "length": 650.0
            },
            "id": "CVE-2025-49133-f1e257d0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/CryptUtil.c",
              "function": "CryptIsAsymSignScheme"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "84562840235413168440635479089076522643",
              "length": 559.0
            },
            "id": "CVE-2025-49133-faf6f645",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1",
            "target": {
              "file": "src/tpm2/CryptUtil.c",
              "function": "CryptHmacSign"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "04b2d8e9afc0a9b6bffe562a23e58c0de11532d1"
            }
          ],
          "repo": "https://github.com/stefanberger/libtpms",
          "type": "GIT"
        }
      ],
      "versions": [
        "v0.10.0",
        "v0.10.0-rc1",
        "v0.5.2",
        "v0.5.2.1",
        "v0.6.0",
        "v0.7.0",
        "v0.8.0",
        "v0.9.0"
      ]
    }
  ],
  "aliases": [
    "GHSA-25w5-6fjj-hf8g"
  ],
  "details": "Libtpms is a library that targets the integration of TPM functionality into hypervisors, primarily into Qemu. Libtpms, which is derived from the TPM 2.0 reference implementation code published by the Trusted Computing Group, is prone to a potential out of bounds (OOB) read vulnerability. The vulnerability occurs in the \u2018CryptHmacSign\u2019 function with an inconsistent pairing of the signKey and signScheme parameters, where the signKey is ALG_KEYEDHASH key and inScheme is an ECC or RSA scheme. The reported vulnerability is in the \u2018CryptHmacSign\u2019 function, which is defined in the \"Part 4: Supporting Routines \u2013 Code\" document, section \"7.151 - /tpm/src/crypt/CryptUtil.c \". This vulnerability can be triggered from user-mode applications by sending malicious commands to a TPM 2.0/vTPM (swtpm) whose firmware is based on an affected TCG reference implementation. The effect on libtpms is that it will cause an abort due to the detection of the out-of-bounds access, thus for example making a vTPM (swtpm) unavailable to a VM. This vulnerability is fixed in 0.7.12, 0.8.10, 0.9.7, and 0.10.1.",
  "id": "CVE-2025-49133",
  "modified": "2025-10-10T05:10:28.155925Z",
  "published": "2025-06-10T20:15:24Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/stefanberger/libtpms/security/advisories/GHSA-25w5-6fjj-hf8g"
    },
    {
      "type": "FIX",
      "url": "https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1"
    },
    {
      "type": "WEB",
      "url": "https://trustedcomputinggroup.org/resource/tpm-library-specification"
    },
    {
      "type": "WEB",
      "url": "https://trustedcomputinggroup.org/wp-content/uploads/TPM-2.0-1.83-Part-4-Supporting-Routines-Code.pdf"
    }
  ],
  "related": [
    "ALSA-2025:12100",
    "ALSA-2025:16428"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ]
}