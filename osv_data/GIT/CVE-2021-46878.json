{"schema_version":"1.7.3","id":"CVE-2021-46878","published":"2023-04-11T18:15:58Z","modified":"2025-10-21T06:41:53.854057Z","aliases":["BIT-fluent-bit-2021-46878"],"details":"An issue was discovered in Treasure Data Fluent Bit 1.7.1, erroneous parsing in flb_pack_msgpack_to_json_format leads to type confusion bug that interprets whatever is on the stack as msgpack maps and arrays, leading to use-after-free. This can be used by an attacker to craft a specially craft file and trick the victim opening it using the affect software, triggering use-after-free and execute arbitrary code on the target system.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/fluent/fluent-bit","events":[{"introduced":"0"},{"last_affected":"7edd2235cd2da7fe76258b7faa59ee9b37f52f8b"}]}],"versions":["0.13-dev-0.10","0.13-dev-0.11","0.13-dev-0.12","0.13-dev-0.13","0.13-dev-0.14","0.13-dev-0.15","0.13-dev-0.16","0.13-dev-0.17","0.13-dev-0.18","0.13-dev-0.4","0.13-dev-0.5","0.13-dev-0.6","0.13-dev-0.7","0.13-dev-0.8","0.13-dev-0.9","v0.10.0","v0.11.0","v0.12.0","v0.12.1","v0.12.2","v0.12.3","v0.12.4","v0.13.0","v0.14.0","v0.3","v0.4","v0.5","v0.5.1","v0.6.0","v0.7.0","v0.8.0","v0.8.1","v0.8.2","v0.9.0","v1.0.0","v1.1.0","v1.2.0","v1.3.0","v1.4.0","v1.5.0","v1.6.0","v1.7.0","v1.7.0-rc1","v1.7.0-rc2","v1.7.0-rc3","v1.7.0-rc4","v1.7.0-rc5","v1.7.0-rc6","v1.7.0-rc7","v1.7.0-rc8","v1.7.0-rc9","v1.7.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-46878.json"}}],"references":[{"type":"REPORT","url":"https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=27742"},{"type":"FIX","url":"https://github.com/fluent/fluent-bit/pull/3115"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"}]}