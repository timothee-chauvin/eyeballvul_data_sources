{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48814.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "259792548493762981691991285200741464942",
              "length": 315.0
            },
            "id": "CVE-2022-48814-0492d243",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bd488afc3b39e045ba71aab472233f2a78726e7b",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c",
              "function": "vsc9953_mdio_bus_free"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "77642642214210409705101627564761243461",
                "74354774919297397682409224949031548597",
                "195750149901502186458403304551123665803",
                "27141492480661959040060331253506773241",
                "140534006092241315612987310219424171370",
                "111257975833545229593827339262285205822",
                "80948991043095986844925828303905512957",
                "147834672082864154539719518324665509669"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48814-0a00377d",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d13e7221035947c62800c9d3d99b4ed570e27e7",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "274512319417588157591447773410321375664",
              "length": 1224.0
            },
            "id": "CVE-2022-48814-177ed5d8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bd488afc3b39e045ba71aab472233f2a78726e7b",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c",
              "function": "vsc9953_mdio_bus_alloc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "207607989796727339523956592860920530592",
              "length": 1287.0
            },
            "id": "CVE-2022-48814-3c422b0c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e816362d823cd46c666e64d8bffe329ee22f4cc",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c",
              "function": "vsc9953_mdio_bus_alloc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "59001319304816054099902187454917869893",
                "149102352603798254756837791018163812555",
                "159220299796103731524005503318742432958",
                "27141492480661959040060331253506773241",
                "173158703474322103532514367156789795148",
                "250849225691121184099837799520065597356",
                "80948991043095986844925828303905512957",
                "147834672082864154539719518324665509669"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48814-52335d14",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bd488afc3b39e045ba71aab472233f2a78726e7b",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "77642642214210409705101627564761243461",
                "74354774919297397682409224949031548597",
                "195750149901502186458403304551123665803",
                "27141492480661959040060331253506773241",
                "140534006092241315612987310219424171370",
                "111257975833545229593827339262285205822",
                "80948991043095986844925828303905512957",
                "147834672082864154539719518324665509669"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-48814-5e2b8a56",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e816362d823cd46c666e64d8bffe329ee22f4cc",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "36664596050076886443086874849228940813",
              "length": 284.0
            },
            "id": "CVE-2022-48814-6485bae5",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d13e7221035947c62800c9d3d99b4ed570e27e7",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c",
              "function": "vsc9953_mdio_bus_free"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "207607989796727339523956592860920530592",
              "length": 1287.0
            },
            "id": "CVE-2022-48814-8735b40f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1d13e7221035947c62800c9d3d99b4ed570e27e7",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c",
              "function": "vsc9953_mdio_bus_alloc"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "36664596050076886443086874849228940813",
              "length": 284.0
            },
            "id": "CVE-2022-48814-f46608b4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e816362d823cd46c666e64d8bffe329ee22f4cc",
            "target": {
              "file": "drivers/net/dsa/ocelot/seville_vsc9953.c",
              "function": "vsc9953_mdio_bus_free"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "ac3a68d56651c3dad2c12c7afce065fe15267f44"
            },
            {
              "fixed": "1d13e7221035947c62800c9d3d99b4ed570e27e7"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "ac3a68d56651c3dad2c12c7afce065fe15267f44"
            },
            {
              "fixed": "0e816362d823cd46c666e64d8bffe329ee22f4cc"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "ac3a68d56651c3dad2c12c7afce065fe15267f44"
            },
            {
              "fixed": "bd488afc3b39e045ba71aab472233f2a78726e7b"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.10",
        "v5.10-rc1",
        "v5.10-rc2",
        "v5.10-rc3",
        "v5.10-rc4",
        "v5.10-rc5",
        "v5.10-rc6",
        "v5.10-rc7",
        "v5.11",
        "v5.11-rc1",
        "v5.11-rc2",
        "v5.11-rc3",
        "v5.11-rc4",
        "v5.11-rc5",
        "v5.11-rc6",
        "v5.11-rc7",
        "v5.12",
        "v5.12-rc1",
        "v5.12-rc1-dontuse",
        "v5.12-rc2",
        "v5.12-rc3",
        "v5.12-rc4",
        "v5.12-rc5",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.3",
        "v5.15.4",
        "v5.15.5",
        "v5.15.6",
        "v5.15.7",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.16.1",
        "v5.16.2",
        "v5.16.3",
        "v5.16.4",
        "v5.16.5",
        "v5.16.6",
        "v5.16.7",
        "v5.16.8",
        "v5.16.9",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.8",
        "v5.8-rc3",
        "v5.8-rc4",
        "v5.8-rc5",
        "v5.8-rc6",
        "v5.8-rc7",
        "v5.9",
        "v5.9-rc1",
        "v5.9-rc2",
        "v5.9-rc3",
        "v5.9-rc4",
        "v5.9-rc5",
        "v5.9-rc6",
        "v5.9-rc7",
        "v5.9-rc8"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48814.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.9.0"
            },
            {
              "fixed": "5.15.27"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.16.10"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: dsa: seville: register the mdiobus under devres\n\nAs explained in commits:\n74b6d7d13307 (\"net: dsa: realtek: register the MDIO bus under devres\")\n5135e96a3dd2 (\"net: dsa: don't allocate the slave_mii_bus using devres\")\n\nmdiobus_free() will panic when called from devm_mdiobus_free() <-\ndevres_release_all() <- __device_release_driver(), and that mdiobus was\nnot previously unregistered.\n\nThe Seville VSC9959 switch is a platform device, so the initial set of\nconstraints that I thought would cause this (I2C or SPI buses which call\n->remove on ->shutdown) do not apply. But there is one more which\napplies here.\n\nIf the DSA master itself is on a bus that calls ->remove from ->shutdown\n(like dpaa2-eth, which is on the fsl-mc bus), there is a device link\nbetween the switch and the DSA master, and device_links_unbind_consumers()\nwill unbind the seville switch driver on shutdown.\n\nSo the same treatment must be applied to all DSA switch drivers, which\nis: either use devres for both the mdiobus allocation and registration,\nor don't use devres at all.\n\nThe seville driver has a code structure that could accommodate both the\nmdiobus_unregister and mdiobus_free calls, but it has an external\ndependency upon mscc_miim_setup() from mdio-mscc-miim.c, which calls\ndevm_mdiobus_alloc_size() on its behalf. So rather than restructuring\nthat, and exporting yet one more symbol mscc_miim_teardown(), let's work\nwith devres and replace of_mdiobus_register with the devres variant.\nWhen we use all-devres, we can ensure that devres doesn't free a\nstill-registered bus (it either runs both callbacks, or none).",
  "id": "CVE-2022-48814",
  "modified": "2025-10-21T08:21:36.932945Z",
  "published": "2024-07-16T11:44:03Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0e816362d823cd46c666e64d8bffe329ee22f4cc"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1d13e7221035947c62800c9d3d99b4ed570e27e7"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/bd488afc3b39e045ba71aab472233f2a78726e7b"
    }
  ],
  "related": [
    "SUSE-SU-2024:2894-1",
    "SUSE-SU-2024:2902-1",
    "SUSE-SU-2024:2929-1",
    "SUSE-SU-2024:2939-1",
    "SUSE-SU-2024:2947-1"
  ],
  "schema_version": "1.7.3",
  "summary": "net: dsa: seville: register the mdiobus under devres"
}