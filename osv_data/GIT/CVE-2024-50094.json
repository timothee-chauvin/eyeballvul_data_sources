{"schema_version":"1.7.3","id":"CVE-2024-50094","published":"2024-11-05T17:04:57.299Z","modified":"2025-11-20T06:21:38.217460Z","related":["USN-7276-1","USN-7277-1","openSUSE-SU-2024:14500-1","openSUSE-SU-2025:14705-1"],"summary":"sfc: Don't invoke xdp_do_flush() from netpoll.","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nsfc: Don't invoke xdp_do_flush() from netpoll.\n\nYury reported a crash in the sfc driver originated from\nnetpoll_send_udp(). The netconsole sends a message and then netpoll\ninvokes the driver's NAPI function with a budget of zero. It is\ndedicated to allow driver to free TX resources, that it may have used\nwhile sending the packet.\n\nIn the netpoll case the driver invokes xdp_do_flush() unconditionally,\nleading to crash because bpf_net_context was never assigned.\n\nInvoke xdp_do_flush() only if budget is not zero.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"401cb7dae8130fd34eb84648e02ab4c506df7d5e"},{"fixed":"65d4fc76d75c136744e67754d20feda609e7b793"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"401cb7dae8130fd34eb84648e02ab4c506df7d5e"},{"fixed":"55e802468e1d38dec8e25a2fdb6078d45b647e8c"}]}],"versions":["v6.10","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.11.3","v6.12-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50094.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["149226387505950248488405233919470741021","59215603443492102125989826622993389920","287251499143680995912289289354566752973","301733405791094598909586016446796725675"],"threshold":0.9},"id":"CVE-2024-50094-3bc4d456","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e802468e1d38dec8e25a2fdb6078d45b647e8c","target":{"file":"drivers/net/ethernet/sfc/siena/efx_channels.c"}},{"deprecated":false,"digest":{"function_hash":"33382897854624934380685688511446152206","length":833},"id":"CVE-2024-50094-7f87dede","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e802468e1d38dec8e25a2fdb6078d45b647e8c","target":{"file":"drivers/net/ethernet/sfc/efx_channels.c","function":"efx_poll"}},{"deprecated":false,"digest":{"line_hashes":["149226387505950248488405233919470741021","59215603443492102125989826622993389920","287251499143680995912289289354566752973","301733405791094598909586016446796725675"],"threshold":0.9},"id":"CVE-2024-50094-d2c32e52","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e802468e1d38dec8e25a2fdb6078d45b647e8c","target":{"file":"drivers/net/ethernet/sfc/efx_channels.c"}},{"deprecated":false,"digest":{"function_hash":"33382897854624934380685688511446152206","length":833},"id":"CVE-2024-50094-de0f6304","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e802468e1d38dec8e25a2fdb6078d45b647e8c","target":{"file":"drivers/net/ethernet/sfc/siena/efx_channels.c","function":"efx_poll"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.11.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50094.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/55e802468e1d38dec8e25a2fdb6078d45b647e8c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/65d4fc76d75c136744e67754d20feda609e7b793"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}