{"schema_version":"1.7.3","id":"CVE-2025-22046","published":"2025-04-16T14:12:06.454Z","modified":"2025-11-20T09:02:04.053623Z","summary":"uprobes/x86: Harden uretprobe syscall trampoline check","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nuprobes/x86: Harden uretprobe syscall trampoline check\n\nJann reported a possible issue when trampoline_check_ip returns\naddress near the bottom of the address space that is allowed to\ncall into the syscall if uretprobes are not set up:\n\n   https://lore.kernel.org/bpf/202502081235.5A6F352985@keescook/T/#m9d416df341b8fbc11737dacbcd29f0054413cbbf\n\nThough the mmap minimum address restrictions will typically prevent\ncreating mappings there, let's make sure uretprobe syscall checks\nfor that.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ff474a78cef5cb5f32be52fe25b78441327a2e7c"},{"fixed":"c35771342e47d58ab9433f3be1c3c30f2c5fa4f3"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ff474a78cef5cb5f32be52fe25b78441327a2e7c"},{"fixed":"b0065d712049c87e1994c6eac00c6a637e39b325"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ff474a78cef5cb5f32be52fe25b78441327a2e7c"},{"fixed":"d4e48b8d59fe162938a5004ace698c847e6a3207"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ff474a78cef5cb5f32be52fe25b78441327a2e7c"},{"fixed":"fa6192adc32f4fdfe5b74edd5b210e12afd6ecc0"}]}],"versions":["v6.10","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.10","v6.13.2","v6.13.3","v6.13.4","v6.13.5","v6.13.6","v6.13.7","v6.13.8","v6.13.9","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22046.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["113510629824517967780235404822452818061","220300131095162263319983681191523348160","83780106836833489283584070065428458037","122602864348889512099765128950512951943","237320116449974420228348061793763282698","286972395912718608444229347796196751821","78457900097064067635155562268567619329","146451751959530874637877013433657342398","265500779467452965874204252738093148791","300123089529565249469020132631917661600","37148922732151379268261748283300904639","7435087152066010847686194512103545697","127776370686244609461179894893385822592"],"threshold":0.9},"id":"CVE-2025-22046-04fd4908","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c35771342e47d58ab9433f3be1c3c30f2c5fa4f3","target":{"file":"arch/x86/kernel/uprobes.c"}},{"deprecated":false,"digest":{"function_hash":"328418662890197175541290890430492079694","length":186},"id":"CVE-2025-22046-0962cb74","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b0065d712049c87e1994c6eac00c6a637e39b325","target":{"file":"kernel/events/uprobes.c","function":"uprobe_get_trampoline_vaddr"}},{"deprecated":false,"digest":{"function_hash":"182655947812240554396293752194173227050","length":820},"id":"CVE-2025-22046-0d5c71a7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c35771342e47d58ab9433f3be1c3c30f2c5fa4f3","target":{"file":"arch/x86/kernel/uprobes.c","function":"SYSCALL_DEFINE0"}},{"deprecated":false,"digest":{"line_hashes":["39037588423730440882943772566403300237","64115642829374038853985831090099024021","133394980103514186262958066071580973466","135718494450774887614951907629006868551","165083066582846045557812378987253652253","59887947748964824395923177064218848388"],"threshold":0.9},"id":"CVE-2025-22046-26e85946","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d4e48b8d59fe162938a5004ace698c847e6a3207","target":{"file":"kernel/events/uprobes.c"}},{"deprecated":false,"digest":{"line_hashes":["113510629824517967780235404822452818061","220300131095162263319983681191523348160","83780106836833489283584070065428458037","122602864348889512099765128950512951943","237320116449974420228348061793763282698","286972395912718608444229347796196751821","78457900097064067635155562268567619329","146451751959530874637877013433657342398","265500779467452965874204252738093148791","300123089529565249469020132631917661600","37148922732151379268261748283300904639","7435087152066010847686194512103545697","127776370686244609461179894893385822592"],"threshold":0.9},"id":"CVE-2025-22046-30e0bdc3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa6192adc32f4fdfe5b74edd5b210e12afd6ecc0","target":{"file":"arch/x86/kernel/uprobes.c"}},{"deprecated":false,"digest":{"function_hash":"286345210299522502641373055183268206559","length":152},"id":"CVE-2025-22046-47dcde44","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa6192adc32f4fdfe5b74edd5b210e12afd6ecc0","target":{"file":"arch/x86/kernel/uprobes.c","function":"trampoline_check_ip"}},{"deprecated":false,"digest":{"line_hashes":["39037588423730440882943772566403300237","64115642829374038853985831090099024021","133394980103514186262958066071580973466","135718494450774887614951907629006868551","165083066582846045557812378987253652253","59887947748964824395923177064218848388"],"threshold":0.9},"id":"CVE-2025-22046-6f87d7d6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa6192adc32f4fdfe5b74edd5b210e12afd6ecc0","target":{"file":"kernel/events/uprobes.c"}},{"deprecated":false,"digest":{"function_hash":"286345210299522502641373055183268206559","length":152},"id":"CVE-2025-22046-829a5d8a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d4e48b8d59fe162938a5004ace698c847e6a3207","target":{"file":"arch/x86/kernel/uprobes.c","function":"trampoline_check_ip"}},{"deprecated":false,"digest":{"line_hashes":["39037588423730440882943772566403300237","64115642829374038853985831090099024021","133394980103514186262958066071580973466","135718494450774887614951907629006868551","165083066582846045557812378987253652253","59887947748964824395923177064218848388"],"threshold":0.9},"id":"CVE-2025-22046-84737d61","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c35771342e47d58ab9433f3be1c3c30f2c5fa4f3","target":{"file":"kernel/events/uprobes.c"}},{"deprecated":false,"digest":{"line_hashes":["39037588423730440882943772566403300237","64115642829374038853985831090099024021","133394980103514186262958066071580973466","135718494450774887614951907629006868551","165083066582846045557812378987253652253","59887947748964824395923177064218848388"],"threshold":0.9},"id":"CVE-2025-22046-86d7a8d1","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b0065d712049c87e1994c6eac00c6a637e39b325","target":{"file":"kernel/events/uprobes.c"}},{"deprecated":false,"digest":{"line_hashes":["113510629824517967780235404822452818061","220300131095162263319983681191523348160","83780106836833489283584070065428458037","122602864348889512099765128950512951943","237320116449974420228348061793763282698","286972395912718608444229347796196751821","78457900097064067635155562268567619329","146451751959530874637877013433657342398","265500779467452965874204252738093148791","300123089529565249469020132631917661600","37148922732151379268261748283300904639","7435087152066010847686194512103545697","127776370686244609461179894893385822592"],"threshold":0.9},"id":"CVE-2025-22046-8b2f1c00","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d4e48b8d59fe162938a5004ace698c847e6a3207","target":{"file":"arch/x86/kernel/uprobes.c"}},{"deprecated":false,"digest":{"function_hash":"286345210299522502641373055183268206559","length":152},"id":"CVE-2025-22046-b45e00a6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b0065d712049c87e1994c6eac00c6a637e39b325","target":{"file":"arch/x86/kernel/uprobes.c","function":"trampoline_check_ip"}},{"deprecated":false,"digest":{"function_hash":"328418662890197175541290890430492079694","length":186},"id":"CVE-2025-22046-bb33a779","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d4e48b8d59fe162938a5004ace698c847e6a3207","target":{"file":"kernel/events/uprobes.c","function":"uprobe_get_trampoline_vaddr"}},{"deprecated":false,"digest":{"function_hash":"328418662890197175541290890430492079694","length":186},"id":"CVE-2025-22046-c0b59ee3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa6192adc32f4fdfe5b74edd5b210e12afd6ecc0","target":{"file":"kernel/events/uprobes.c","function":"uprobe_get_trampoline_vaddr"}},{"deprecated":false,"digest":{"function_hash":"182655947812240554396293752194173227050","length":820},"id":"CVE-2025-22046-d010008f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b0065d712049c87e1994c6eac00c6a637e39b325","target":{"file":"arch/x86/kernel/uprobes.c","function":"SYSCALL_DEFINE0"}},{"deprecated":false,"digest":{"line_hashes":["113510629824517967780235404822452818061","220300131095162263319983681191523348160","83780106836833489283584070065428458037","122602864348889512099765128950512951943","237320116449974420228348061793763282698","286972395912718608444229347796196751821","78457900097064067635155562268567619329","146451751959530874637877013433657342398","265500779467452965874204252738093148791","300123089529565249469020132631917661600","37148922732151379268261748283300904639","7435087152066010847686194512103545697","127776370686244609461179894893385822592"],"threshold":0.9},"id":"CVE-2025-22046-d5a859a5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b0065d712049c87e1994c6eac00c6a637e39b325","target":{"file":"arch/x86/kernel/uprobes.c"}},{"deprecated":false,"digest":{"function_hash":"182655947812240554396293752194173227050","length":820},"id":"CVE-2025-22046-d77aab42","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d4e48b8d59fe162938a5004ace698c847e6a3207","target":{"file":"arch/x86/kernel/uprobes.c","function":"SYSCALL_DEFINE0"}},{"deprecated":false,"digest":{"function_hash":"182655947812240554396293752194173227050","length":820},"id":"CVE-2025-22046-ee9e672a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa6192adc32f4fdfe5b74edd5b210e12afd6ecc0","target":{"file":"arch/x86/kernel/uprobes.c","function":"SYSCALL_DEFINE0"}},{"deprecated":false,"digest":{"function_hash":"328418662890197175541290890430492079694","length":186},"id":"CVE-2025-22046-f3beb7ca","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c35771342e47d58ab9433f3be1c3c30f2c5fa4f3","target":{"file":"kernel/events/uprobes.c","function":"uprobe_get_trampoline_vaddr"}},{"deprecated":false,"digest":{"function_hash":"286345210299522502641373055183268206559","length":152},"id":"CVE-2025-22046-f5757dfb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c35771342e47d58ab9433f3be1c3c30f2c5fa4f3","target":{"file":"arch/x86/kernel/uprobes.c","function":"trampoline_check_ip"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.12.23"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.14.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22046.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b0065d712049c87e1994c6eac00c6a637e39b325"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c35771342e47d58ab9433f3be1c3c30f2c5fa4f3"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d4e48b8d59fe162938a5004ace698c847e6a3207"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fa6192adc32f4fdfe5b74edd5b210e12afd6ecc0"}]}