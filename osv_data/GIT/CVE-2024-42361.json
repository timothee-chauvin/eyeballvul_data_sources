{"schema_version":"1.7.3","id":"CVE-2024-42361","published":"2024-08-20T20:56:20Z","modified":"2025-10-30T22:45:17.658005Z","summary":"GHSL-2023-256: HertzBeat Authenticated (guest role) SQL injection in /api/monitor/{monitorId}/metric/{metricFull}","details":"Hertzbeat is an open source, real-time monitoring system. Hertzbeat 1.6.0 and earlier declares a /api/monitor/{monitorId}/metric/{metricFull} endpoint to download job metrics. In the process, it executes a SQL query with user-controlled data, allowing for SQL injection.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/dromara/hertzbeat","events":[{"introduced":"0"},{"last_affected":"708b5a2b1b4a3955fb8a3790cec0654259bbd5da"}],"database_specific":{"versions":[{"introduced":"0"},{"last_affected":"1.6.0"}]}}],"versions":["v1.6.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42361.json"}},{"ranges":[{"type":"GIT","repo":"https://github.com/apache/hertzbeat","events":[{"introduced":"0"},{"fixed":"708b5a2b1b4a3955fb8a3790cec0654259bbd5da"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42361.json"}}],"references":[{"type":"ADVISORY","url":"https://securitylab.github.com/advisories/GHSL-2023-254_GHSL-2023-256_HertzBeat/"},{"type":"WEB","url":"https://github.com/dromara/hertzbeat/blob/1f12ac9f2a1a3d86b1d476775e14174243b250a8/manager/src/main/java/org/dromara/hertzbeat/manager/controller/MonitorsController.java#L202"},{"type":"WEB","url":"https://github.com/dromara/hertzbeat/blob/1f12ac9f2a1a3d86b1d476775e14174243b250a8/warehouse/src/main/java/org/dromara/hertzbeat/warehouse/store/HistoryTdEngineDataStorage.java#L242"},{"type":"WEB","url":"https://github.com/dromara/hertzbeat/blob/1f12ac9f2a1a3d86b1d476775e14174243b250a8/warehouse/src/main/java/org/dromara/hertzbeat/warehouse/store/HistoryTdEngineDataStorage.java#L295"}],"database_specific":{"cwe_ids":["CWE-89"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"}]}