{"schema_version":"1.7.3","id":"CVE-2025-39924","published":"2025-10-01T08:07:12.300Z","modified":"2025-11-20T10:10:41.291290Z","summary":"erofs: fix invalid algorithm for encoded extents","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: fix invalid algorithm for encoded extents\n\nThe current algorithm sanity checks do not properly apply to new\nencoded extents.\n\nUnify the algorithm check with Z_EROFS_COMPRESSION(_RUNTIME)_MAX\nand ensure consistency with sbi->available_compr_algs.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1d191b4ca51d73699cb127386b95ac152af2b930"},{"fixed":"db5d7abd379a8dcf030be8f52f99cadf7e397ba8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1d191b4ca51d73699cb127386b95ac152af2b930"},{"fixed":"131897c65e2b86cf14bec7379f44aa8fbb407526"}]}],"versions":["v6.14","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.16.4","v6.16.5","v6.16.6","v6.16.7","v6.17-rc1","v6.17-rc2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39924.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"24047174038685260667375235765909503219","length":2914},"id":"CVE-2025-39924-49bc37f5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db5d7abd379a8dcf030be8f52f99cadf7e397ba8","target":{"file":"fs/erofs/zmap.c","function":"z_erofs_fill_inode"}},{"deprecated":false,"digest":{"function_hash":"264677769574194935623996464311367148250","length":858},"id":"CVE-2025-39924-56a75aed","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db5d7abd379a8dcf030be8f52f99cadf7e397ba8","target":{"file":"fs/erofs/zmap.c","function":"z_erofs_map_blocks_iter"}},{"deprecated":false,"digest":{"function_hash":"232717660533109995872835392231175739530","length":2935},"id":"CVE-2025-39924-68ff94b5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@131897c65e2b86cf14bec7379f44aa8fbb407526","target":{"file":"fs/erofs/zmap.c","function":"z_erofs_fill_inode"}},{"deprecated":false,"digest":{"function_hash":"270003798663580035511296246025765918158","length":3885},"id":"CVE-2025-39924-6e4046d4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db5d7abd379a8dcf030be8f52f99cadf7e397ba8","target":{"file":"fs/erofs/zmap.c","function":"z_erofs_map_blocks_fo"}},{"deprecated":false,"digest":{"line_hashes":["227319492702900080830745222551778212453","2876574945202315531424950471745087322","235406464403427989364827242031790864182","6641230013715448337520958145824811590","27897562817459391109074496230304261425","283899011573957658864012480259684423552","273090379724403542180454840102309542167","59754427596260831346770846140732206658","257467779944226746175713731095153939726","195180661036017514518128070616549818891","240281036955387711489598835294847785492","240592148340871035270495940312815542628","102743540152535159110491086353169483976","90515665399275905326522700671004655714","80875724606363933804236132677991775237","43923768316208706067311587652218466744","81145851251204501110061278417586891605","284699933890997078188926873843130646838","196322772425458405518456417312794933734","127740781400465171150823370490483321945","329305237481505273555758528673439398793","277324232880462979500769947110488153391","57247872945818491165871847406375231881","50605477871186895112291639863101583063","246903891130618542433231341071542036614","121207777311382596842686894774226887444","305904031271732410472339670842232112879","293695065011611691086526327751735575620","1686932770407014781988728170404801148","134739452957466971794588774756780601803","172851767543424002059012792620579504241","191516321905508912349629343879113049857","34059800458959499029403260272796662771","268471348236478286305868154012893579743","254740816169373459878175458791561212791","21854320755533411883973685615555545428","6561461965754089524299513642320305260","266406490153564931513726900454696607043","19011112279817209265069714055015102518","2989071327746558525355535677966293638","335989248590576680001634829076113901103","277965159738176975717933954798022061177","127084117779056616623845951687497162579","319928716785433892703330178343882521991","335785417805799758150813768289101012438","299771977792772665154160261423659884476","269175404128004030976011001176645660046","82845654076028358495899060694181236446","168770793356397618776091216001855043770","253534234915008658480712130720864443561","279406571443728949333911409548962720157","257268550504797199531548552007085150567","236607722625778436094797342736316290145","269601122165311216829203766378023109827","98648996029695248798816633545051865005"],"threshold":0.9},"id":"CVE-2025-39924-71e6fffe","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@131897c65e2b86cf14bec7379f44aa8fbb407526","target":{"file":"fs/erofs/zmap.c"}},{"deprecated":false,"digest":{"function_hash":"95728149582436334489450995518580729318","length":3686},"id":"CVE-2025-39924-c4ecb534","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@131897c65e2b86cf14bec7379f44aa8fbb407526","target":{"file":"fs/erofs/zmap.c","function":"z_erofs_map_blocks_fo"}},{"deprecated":false,"digest":{"function_hash":"264677769574194935623996464311367148250","length":858},"id":"CVE-2025-39924-e0dd6f3a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@131897c65e2b86cf14bec7379f44aa8fbb407526","target":{"file":"fs/erofs/zmap.c","function":"z_erofs_map_blocks_iter"}},{"deprecated":false,"digest":{"line_hashes":["115354597062290631633976431859041260379","109822867240904026705866871219328669546","235406464403427989364827242031790864182","6641230013715448337520958145824811590","27897562817459391109074496230304261425","283899011573957658864012480259684423552","273090379724403542180454840102309542167","59754427596260831346770846140732206658","257467779944226746175713731095153939726","195180661036017514518128070616549818891","240281036955387711489598835294847785492","240592148340871035270495940312815542628","102743540152535159110491086353169483976","90515665399275905326522700671004655714","80875724606363933804236132677991775237","43923768316208706067311587652218466744","81145851251204501110061278417586891605","284699933890997078188926873843130646838","196322772425458405518456417312794933734","127740781400465171150823370490483321945","329305237481505273555758528673439398793","277324232880462979500769947110488153391","57247872945818491165871847406375231881","50605477871186895112291639863101583063","246903891130618542433231341071542036614","121207777311382596842686894774226887444","305904031271732410472339670842232112879","293695065011611691086526327751735575620","1686932770407014781988728170404801148","134739452957466971794588774756780601803","172851767543424002059012792620579504241","191516321905508912349629343879113049857","34059800458959499029403260272796662771","268471348236478286305868154012893579743","254740816169373459878175458791561212791","21854320755533411883973685615555545428","6561461965754089524299513642320305260","266406490153564931513726900454696607043","19011112279817209265069714055015102518","2989071327746558525355535677966293638","335989248590576680001634829076113901103","277965159738176975717933954798022061177","127084117779056616623845951687497162579","319928716785433892703330178343882521991","335785417805799758150813768289101012438","299771977792772665154160261423659884476","269175404128004030976011001176645660046","82845654076028358495899060694181236446","168770793356397618776091216001855043770","253534234915008658480712130720864443561","279406571443728949333911409548962720157","257268550504797199531548552007085150567","236607722625778436094797342736316290145","269601122165311216829203766378023109827","98648996029695248798816633545051865005"],"threshold":0.9},"id":"CVE-2025-39924-f4102494","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db5d7abd379a8dcf030be8f52f99cadf7e397ba8","target":{"file":"fs/erofs/zmap.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.16.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39924.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/131897c65e2b86cf14bec7379f44aa8fbb407526"},{"type":"WEB","url":"https://git.kernel.org/stable/c/db5d7abd379a8dcf030be8f52f99cadf7e397ba8"}]}