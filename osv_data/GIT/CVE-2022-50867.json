{"schema_version":"1.7.3","id":"CVE-2022-50867","published":"2025-12-30T12:15:38.520Z","modified":"2025-12-30T20:24:14.765498Z","summary":"drm/msm/a6xx: Fix kvzalloc vs state_kcalloc usage","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/msm/a6xx: Fix kvzalloc vs state_kcalloc usage\n\nadreno_show_object() is a trap!  It will re-allocate the pointer it is\npassed on first call, when the data is ascii85 encoded, using kvmalloc/\nkvfree().  Which means the data *passed* to it must be kvmalloc'd, ie.\nwe cannot use the state_kcalloc() helper.\n\nThis partially reverts commit ec8f1813bf8d (\"drm/msm/a6xx: Replace\nkcalloc() with kvzalloc()\"), but adds the missing kvfree() to fix the\nmemory leak that was present previously.  And adds a warning comment.\n\nPatchwork: https://patchwork.freedesktop.org/patch/507014/","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b859f9b009bbfbc236d9b076c64c59ccb41b8737"},{"fixed":"4b1bbc0571a5d7ee10f754186dc3d619b9ced5c1"},{"fixed":"83d18e9d9c0150d98dc24e3642ea93f5e245322c"}]}],"versions":["v5.16","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50867.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"6.0.7"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50867.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4b1bbc0571a5d7ee10f754186dc3d619b9ced5c1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/83d18e9d9c0150d98dc24e3642ea93f5e245322c"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50867.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-50867"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50867.json"}}