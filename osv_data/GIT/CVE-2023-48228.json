{"schema_version":"1.7.3","id":"CVE-2023-48228","published":"2023-11-21T20:48:32.552Z","modified":"2025-12-05T00:10:46.464146Z","aliases":["GHSA-fm34-v8xq-f2c3"],"summary":"OAuth2: PKCE can be fully circumvented","details":"authentik is an open-source identity provider. When initialising a oauth2 flow with a `code_challenge` and `code_method` (thus requesting PKCE), the single sign-on provider (authentik) must check if there is a matching and existing `code_verifier` during the token step. Prior to versions 2023.10.4 and 2023.8.5, authentik checks if the contents of `code_verifier` is matching only when it is provided. When it is left out completely, authentik simply accepts the token request with out it; even when the flow was started with a `code_challenge`. authentik 2023.8.5 and 2023.10.4 fix this issue.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/goauthentik/authentik","events":[{"introduced":"0"},{"fixed":"1516fe86dab2f62754a9c37679e0488dcf829c77"}]}],"versions":["version/0.0.10-alpha","version/0.0.11-alpha","version/0.0.12-alpha","version/0.0.13-alpha","version/0.0.2-alpha","version/0.0.3-alpha","version/0.0.4-alpha","version/0.0.5-alpha","version/0.0.6-alpha","version/0.0.7-alpha","version/0.0.8-alpha","version/0.0.9-alpha","version/0.1.0-beta","version/0.1.1-beta","version/0.1.10-beta","version/0.1.11-beta","version/0.1.12-beta","version/0.1.13-beta","version/0.1.14-beta","version/0.1.15-beta","version/0.1.16-beta","version/0.1.17-beta","version/0.1.18-beta","version/0.1.19-beta","version/0.1.2-beta","version/0.1.20-beta","version/0.1.21-beta","version/0.1.22-beta","version/0.1.23-beta","version/0.1.24-beta","version/0.1.25-beta","version/0.1.26-beta","version/0.1.27-beta","version/0.1.28-beta","version/0.1.29-beta","version/0.1.3-beta","version/0.1.30-beta","version/0.1.31-beta","version/0.1.32-beta","version/0.1.33-beta","version/0.1.34-beta","version/0.1.35-beta","version/0.1.36-beta","version/0.1.37-beta","version/0.1.38-beta","version/0.1.4-beta","version/0.1.5-beta","version/0.1.6-beta","version/0.1.7-beta","version/0.1.8-beta","version/0.1.9-beta","version/0.10.0-rc1","version/0.10.0-rc2","version/0.10.0-rc3","version/0.10.0-rc4","version/0.10.0-rc5","version/0.10.0-rc6","version/0.10.0-stable","version/0.10.1-stable","version/0.10.2-stable","version/0.10.3-stable","version/0.10.4-stable","version/0.10.5-stable","version/0.10.6-stable","version/0.10.7-stable","version/0.10.8-stable","version/0.10.9-stable","version/0.11.0-stable","version/0.12.0-stable","version/0.12.1-stable","version/0.12.10-stable","version/0.12.11-stable","version/0.12.2-stable","version/0.12.3-stable","version/0.12.4-stable","version/0.12.5-stable","version/0.12.6-stable","version/0.12.7-stable","version/0.12.8-stable","version/0.12.9-stable","version/0.13.0-rc1","version/0.13.0-rc2","version/0.13.0-rc3","version/0.13.0-rc4","version/0.13.0-stable","version/0.13.1-stable","version/0.13.2-stable","version/0.13.3-stable","version/0.2.0-beta","version/0.2.1-beta","version/0.2.2-beta","version/0.2.3-beta","version/0.2.4-beta","version/0.2.5-beta","version/0.2.6-beta","version/0.2.7-beta","version/0.2.8-beta","version/0.3.0-beta","version/0.4.0-beta","version/0.4.1-beta","version/0.4.2-beta","version/0.5.0-beta","version/0.6.0-beta","version/0.6.1-beta","version/0.6.10-beta","version/0.6.11-beta","version/0.6.2-beta","version/0.6.3-beta","version/0.6.4-beta","version/0.6.5-beta","version/0.6.6-beta","version/0.6.7-beta","version/0.6.8-beta","version/0.6.9-beta","version/0.7.0-beta","version/0.7.1-beta","version/0.7.10-beta","version/0.7.11-beta","version/0.7.12-beta","version/0.7.13-beta","version/0.7.14-beta","version/0.7.15-beta","version/0.7.16-beta","version/0.7.17-beta","version/0.7.2-beta","version/0.7.3-beta","version/0.7.4-beta","version/0.7.5-beta","version/0.7.6-beta","version/0.7.7-beta","version/0.7.8-beta","version/0.7.9-beta","version/0.8.0-beta","version/0.8.1-beta","version/0.8.10-beta","version/0.8.11-beta","version/0.8.12-beta","version/0.8.14-beta","version/0.8.15-beta","version/0.8.2-beta","version/0.8.3-beta","version/0.8.4-beta","version/0.8.5-beta","version/0.8.6-beta","version/0.8.7-beta","version/0.8.8-beta","version/0.8.9-beta","version/0.9.0-pre1","version/0.9.0-pre2","version/0.9.0-pre3","version/0.9.0-pre4","version/0.9.0-pre5","version/0.9.0-pre6","version/0.9.0-pre7","version/0.9.0-rc1","version/0.9.0-rc2","version/0.9.0-stable","version/2021.1.1-rc1","version/2021.1.1-rc2","version/2021.1.1-stable","version/2021.1.2-stable","version/2021.1.3-stable","version/2021.1.4-stable","version/2021.10.1","version/2021.10.1-rc1","version/2021.10.1-rc2","version/2021.10.1-rc3","version/2021.10.2","version/2021.10.3","version/2021.10.4","version/2021.12.1","version/2021.12.1-rc1","version/2021.12.1-rc2","version/2021.12.1-rc3","version/2021.12.1-rc4","version/2021.12.1-rc5","version/2021.12.2","version/2021.12.3","version/2021.12.4","version/2021.12.5","version/2021.2.1-rc1","version/2021.2.1-rc2","version/2021.2.1-stable","version/2021.2.2-stable","version/2021.2.3-stable","version/2021.2.4-stable","version/2021.2.5-stable","version/2021.2.6-stable","version/2021.3.1","version/2021.3.1-rc1","version/2021.3.1-rc2","version/2021.3.2","version/2021.3.3","version/2021.3.4","version/2021.4.1","version/2021.4.1-rc1","version/2021.4.1-rc2","version/2021.4.2","version/2021.4.3","version/2021.4.4","version/2021.4.5","version/2021.5.1","version/2021.5.1-rc1","version/2021.5.1-rc10","version/2021.5.1-rc2","version/2021.5.1-rc3","version/2021.5.1-rc4","version/2021.5.1-rc5","version/2021.5.1-rc6","version/2021.5.1-rc7","version/2021.5.1-rc8","version/2021.5.1-rc9","version/2021.5.2","version/2021.5.3","version/2021.5.4","version/2021.6.1","version/2021.6.1-rc1","version/2021.6.1-rc2","version/2021.6.1-rc3","version/2021.6.1-rc4","version/2021.6.1-rc5","version/2021.6.1-rc6","version/2021.6.2","version/2021.6.3","version/2021.6.4","version/2021.7.1","version/2021.7.1-rc1","version/2021.7.1-rc2","version/2021.7.2","version/2021.7.3","version/2021.8.1","version/2021.8.1-rc1","version/2021.8.1-rc2","version/2021.8.2","version/2021.8.3","version/2021.8.4","version/2021.9.1","version/2021.9.1-rc1","version/2021.9.1-rc2","version/2021.9.1-rc3","version/2021.9.2","version/2021.9.3","version/2021.9.4","version/2021.9.5","version/2021.9.6","version/2021.9.7","version/2021.9.8","version/2022.1.1","version/2022.1.2","version/2022.1.3","version/2022.1.4","version/2022.1.5","version/2022.10.0","version/2022.10.1","version/2022.11.0","version/2022.11.1","version/2022.11.2","version/2022.11.3","version/2022.11.4","version/2022.12.0","version/2022.12.1","version/2022.12.2","version/2022.2.1","version/2022.3.1","version/2022.3.2","version/2022.3.3","version/2022.4.1","version/2022.5.1","version/2022.5.2","version/2022.5.3","version/2022.6.1","version/2022.6.2","version/2022.6.3","version/2022.7.1","version/2022.7.2","version/2022.7.3","version/2022.8.1","version/2022.8.2","version/2022.9.0","version/2023.1.0","version/2023.1.1","version/2023.1.2","version/2023.2.0","version/2023.2.1","version/2023.2.2","version/2023.5.0","version/2023.5.1","version/2023.5.2","version/2023.5.3","version/2023.6.0","version/2023.6.1","version/2023.8.0","version/2023.8.1","version/2023.8.2","version/2023.8.3","version/2023.8.4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-48228.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/48xxx/CVE-2023-48228.json"},{"type":"WEB","url":"https://github.com/goauthentik/authentik/blob/dd4e9030b4e667d3720be2feda24c08972602274/authentik/providers/oauth2/views/token.py#L225"},{"type":"FIX","url":"https://github.com/goauthentik/authentik/commit/3af77ab3821fe9c7df8055ba5eade3d1ecea03a6"},{"type":"FIX","url":"https://github.com/goauthentik/authentik/commit/6b9afed21f7c39f171a4a445654cfe415bba37d5"},{"type":"FIX","url":"https://github.com/goauthentik/authentik/commit/b88e39411c12e3f9e04125a7887f12354f760a14"},{"type":"FIX","url":"https://github.com/goauthentik/authentik/pull/7666"},{"type":"FIX","url":"https://github.com/goauthentik/authentik/pull/7668"},{"type":"FIX","url":"https://github.com/goauthentik/authentik/pull/7669"},{"type":"WEB","url":"https://github.com/goauthentik/authentik/releases/tag/version%2F2023.10.4"},{"type":"WEB","url":"https://github.com/goauthentik/authentik/releases/tag/version%2F2023.8.5"},{"type":"ADVISORY","url":"https://github.com/goauthentik/authentik/security/advisories/GHSA-fm34-v8xq-f2c3"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2023-48228"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-287"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/48xxx/CVE-2023-48228.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"}]}