{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35787.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "179770903664361641688184110759696728189",
              "length": 738.0
            },
            "id": "CVE-2024-35787-078a2439",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@736ad6c577a367834118f57417038d45bb5e0a31",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_set_bit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "325523765181253623482009608797722057312",
                "315074142979760923359421214896959495428",
                "73056798449557510066390674911930211489",
                "244250147663891721859106973964964675184",
                "66936966217010519901862403990714603294",
                "125639195696010524172311253183073384048",
                "176418652032912730183544651551585236513",
                "250583269779256269437063039973019584379",
                "145441696839011024335901429327087679925",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35787-0a3ac997",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@736ad6c577a367834118f57417038d45bb5e0a31",
            "target": {
              "file": "drivers/md/md-bitmap.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "301784616227449775238184427449872864363",
              "length": 775.0
            },
            "id": "CVE-2024-35787-1d56b04a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ecbd8ebb51bf7e4939d83b9e6022a55cac44ef06",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_clear_bit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "184704553579049011443737404739168277982",
              "length": 1202.0
            },
            "id": "CVE-2024-35787-3fb14d87",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@736ad6c577a367834118f57417038d45bb5e0a31",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "__write_sb_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "184704553579049011443737404739168277982",
              "length": 1202.0
            },
            "id": "CVE-2024-35787-4f3a2a11",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ecbd8ebb51bf7e4939d83b9e6022a55cac44ef06",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "__write_sb_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "301784616227449775238184427449872864363",
              "length": 775.0
            },
            "id": "CVE-2024-35787-7481753c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5a95815b17428ce2f56ec18da5e0d1b2a1a15240",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_clear_bit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "301784616227449775238184427449872864363",
              "length": 775.0
            },
            "id": "CVE-2024-35787-75468f53",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@736ad6c577a367834118f57417038d45bb5e0a31",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_clear_bit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "287717978023133228361705104237439247516",
              "length": 370.0
            },
            "id": "CVE-2024-35787-777dac75",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@736ad6c577a367834118f57417038d45bb5e0a31",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "filemap_write_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "179770903664361641688184110759696728189",
              "length": 738.0
            },
            "id": "CVE-2024-35787-8be49ecc",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ecbd8ebb51bf7e4939d83b9e6022a55cac44ef06",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_set_bit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "325523765181253623482009608797722057312",
                "315074142979760923359421214896959495428",
                "73056798449557510066390674911930211489",
                "244250147663891721859106973964964675184",
                "66936966217010519901862403990714603294",
                "125639195696010524172311253183073384048",
                "176418652032912730183544651551585236513",
                "250583269779256269437063039973019584379",
                "145441696839011024335901429327087679925",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35787-9502cf5c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e55eb65fd5e09faf5a0e49ffcdd37905aaf4da",
            "target": {
              "file": "drivers/md/md-bitmap.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "325523765181253623482009608797722057312",
                "315074142979760923359421214896959495428",
                "73056798449557510066390674911930211489",
                "244250147663891721859106973964964675184",
                "66936966217010519901862403990714603294",
                "125639195696010524172311253183073384048",
                "176418652032912730183544651551585236513",
                "250583269779256269437063039973019584379",
                "145441696839011024335901429327087679925",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35787-bd75d83b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5a95815b17428ce2f56ec18da5e0d1b2a1a15240",
            "target": {
              "file": "drivers/md/md-bitmap.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "287717978023133228361705104237439247516",
              "length": 370.0
            },
            "id": "CVE-2024-35787-ce1333a7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ecbd8ebb51bf7e4939d83b9e6022a55cac44ef06",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "filemap_write_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "287717978023133228361705104237439247516",
              "length": 370.0
            },
            "id": "CVE-2024-35787-d4710f94",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5a95815b17428ce2f56ec18da5e0d1b2a1a15240",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "filemap_write_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "184704553579049011443737404739168277982",
              "length": 1202.0
            },
            "id": "CVE-2024-35787-d89b47cf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e55eb65fd5e09faf5a0e49ffcdd37905aaf4da",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "__write_sb_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "287717978023133228361705104237439247516",
              "length": 370.0
            },
            "id": "CVE-2024-35787-dea5ef85",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e55eb65fd5e09faf5a0e49ffcdd37905aaf4da",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "filemap_write_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "301784616227449775238184427449872864363",
              "length": 775.0
            },
            "id": "CVE-2024-35787-e1a31cdf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e55eb65fd5e09faf5a0e49ffcdd37905aaf4da",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_clear_bit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "184704553579049011443737404739168277982",
              "length": 1202.0
            },
            "id": "CVE-2024-35787-e225a504",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5a95815b17428ce2f56ec18da5e0d1b2a1a15240",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "__write_sb_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "179770903664361641688184110759696728189",
              "length": 738.0
            },
            "id": "CVE-2024-35787-f0fa1e28",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5a95815b17428ce2f56ec18da5e0d1b2a1a15240",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_set_bit"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "325523765181253623482009608797722057312",
                "315074142979760923359421214896959495428",
                "73056798449557510066390674911930211489",
                "244250147663891721859106973964964675184",
                "66936966217010519901862403990714603294",
                "125639195696010524172311253183073384048",
                "176418652032912730183544651551585236513",
                "250583269779256269437063039973019584379",
                "145441696839011024335901429327087679925",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794",
                "51645414971514239097672764785806698974",
                "300579966987785382970809114562223514622",
                "75294853918284677194624306842416639794"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-35787-f7753b69",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ecbd8ebb51bf7e4939d83b9e6022a55cac44ef06",
            "target": {
              "file": "drivers/md/md-bitmap.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "179770903664361641688184110759696728189",
              "length": 738.0
            },
            "id": "CVE-2024-35787-f940d4cd",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55e55eb65fd5e09faf5a0e49ffcdd37905aaf4da",
            "target": {
              "file": "drivers/md/md-bitmap.c",
              "function": "md_bitmap_file_set_bit"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "d7038f951828da19fa9aafddfa087b69032c9687"
            },
            {
              "fixed": "736ad6c577a367834118f57417038d45bb5e0a31"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "d7038f951828da19fa9aafddfa087b69032c9687"
            },
            {
              "fixed": "55e55eb65fd5e09faf5a0e49ffcdd37905aaf4da"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "d7038f951828da19fa9aafddfa087b69032c9687"
            },
            {
              "fixed": "5a95815b17428ce2f56ec18da5e0d1b2a1a15240"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "d7038f951828da19fa9aafddfa087b69032c9687"
            },
            {
              "fixed": "ecbd8ebb51bf7e4939d83b9e6022a55cac44ef06"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.5",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.10",
        "v6.7.11",
        "v6.7.2",
        "v6.7.3",
        "v6.7.4",
        "v6.7.5",
        "v6.7.6",
        "v6.7.7",
        "v6.7.8",
        "v6.7.9",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35787.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.24"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.12"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.8.0"
            },
            {
              "fixed": "6.8.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmd/md-bitmap: fix incorrect usage for sb_index\n\nCommit d7038f951828 (\"md-bitmap: don't use ->index for pages backing the\nbitmap file\") removed page->index from bitmap code, but left wrong code\nlogic for clustered-md. current code never set slot offset for cluster\nnodes, will sometimes cause crash in clustered env.\n\nCall trace (partly):\n md_bitmap_file_set_bit+0x110/0x1d8 [md_mod]\n md_bitmap_startwrite+0x13c/0x240 [md_mod]\n raid1_make_request+0x6b0/0x1c08 [raid1]\n md_handle_request+0x1dc/0x368 [md_mod]\n md_submit_bio+0x80/0xf8 [md_mod]\n __submit_bio+0x178/0x300\n submit_bio_noacct_nocheck+0x11c/0x338\n submit_bio_noacct+0x134/0x614\n submit_bio+0x28/0xdc\n submit_bh_wbc+0x130/0x1cc\n submit_bh+0x1c/0x28",
  "id": "CVE-2024-35787",
  "modified": "2025-10-15T10:21:11.534106Z",
  "published": "2024-05-17T12:24:35Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/55e55eb65fd5e09faf5a0e49ffcdd37905aaf4da"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/5a95815b17428ce2f56ec18da5e0d1b2a1a15240"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/736ad6c577a367834118f57417038d45bb5e0a31"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/ecbd8ebb51bf7e4939d83b9e6022a55cac44ef06"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "md/md-bitmap: fix incorrect usage for sb_index"
}