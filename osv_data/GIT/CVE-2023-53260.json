{"schema_version":"1.7.3","id":"CVE-2023-53260","published":"2025-09-15T14:46:31Z","modified":"2025-10-21T15:28:34.000194Z","summary":"ovl: fix null pointer dereference in ovl_permission()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\novl: fix null pointer dereference in ovl_permission()\n\nFollowing process:\n          P1                     P2\n path_lookupat\n  link_path_walk\n   inode_permission\n    ovl_permission\n      ovl_i_path_real(inode, &realpath)\n        path->dentry = ovl_i_dentry_upper(inode)\n                          drop_cache\n\t\t\t   __dentry_kill(ovl_dentry)\n\t\t            iput(ovl_inode)\n\t\t             ovl_destroy_inode(ovl_inode)\n\t\t              dput(oi->__upperdentry)\n\t\t               dentry_kill(upperdentry)\n\t\t                dentry_unlink_inode\n\t\t\t\t upperdentry->d_inode = NULL\n      realinode = d_inode(realpath.dentry) // return NULL\n      inode_permission(realinode)\n       inode->i_sb  // NULL pointer dereference\n, will trigger an null pointer dereference at realinode:\n  [  335.664979] BUG: kernel NULL pointer dereference,\n                 address: 0000000000000002\n  [  335.668032] CPU: 0 PID: 2592 Comm: ls Not tainted 6.3.0\n  [  335.669956] RIP: 0010:inode_permission+0x33/0x2c0\n  [  335.678939] Call Trace:\n  [  335.679165]  <TASK>\n  [  335.679371]  ovl_permission+0xde/0x320\n  [  335.679723]  inode_permission+0x15e/0x2c0\n  [  335.680090]  link_path_walk+0x115/0x550\n  [  335.680771]  path_lookupat.isra.0+0xb2/0x200\n  [  335.681170]  filename_lookup+0xda/0x240\n  [  335.681922]  vfs_statx+0xa6/0x1f0\n  [  335.682233]  vfs_fstatat+0x7b/0xb0\n\nFetch a reproducer in [Link].\n\nUse the helper ovl_i_path_realinode() to get realinode and then do\nnon-nullptr checking.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4b7791b2e95805eaa9568761741d33cf929c930c"},{"fixed":"53dd2ca2c02fdcfe3aad2345091d371063f97d17"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4b7791b2e95805eaa9568761741d33cf929c930c"},{"fixed":"69f9ae7edf9ec0ff500429101923347fcba5c8c4"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4b7791b2e95805eaa9568761741d33cf929c930c"},{"fixed":"1a73f5b8f079fd42a544c1600beface50c63af7c"}]}],"versions":["v5.18","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1","v6.1.10","v6.1.11","v6.1.12","v6.1.13","v6.1.14","v6.1.15","v6.1.16","v6.1.17","v6.1.18","v6.1.19","v6.1.2","v6.1.20","v6.1.21","v6.1.22","v6.1.23","v6.1.24","v6.1.25","v6.1.26","v6.1.27","v6.1.28","v6.1.29","v6.1.3","v6.1.30","v6.1.31","v6.1.32","v6.1.33","v6.1.34","v6.1.35","v6.1.36","v6.1.37","v6.1.38","v6.1.39","v6.1.4","v6.1.40","v6.1.41","v6.1.42","v6.1.5","v6.1.6","v6.1.7","v6.1.8","v6.1.9","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.4.1","v6.4.2","v6.4.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53260.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"148123440981662978004032463776134875285","length":640},"id":"CVE-2023-53260-4dc4f302","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53dd2ca2c02fdcfe3aad2345091d371063f97d17","target":{"file":"fs/overlayfs/inode.c","function":"ovl_permission"}},{"deprecated":false,"digest":{"line_hashes":["170043098391656221847578075928577019098","32975670672430431655816707614054643363","78444291089231329588542113883064379652","276338156773259342743887566345097669685","59135680421780167585339442913115207874","48566610639837235965534568640102860177","300101434056908191329195357824899477136","147114574339013249201481558319871741545","179810709283614535465416365844180245681"],"threshold":0.9},"id":"CVE-2023-53260-70e0d30c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@53dd2ca2c02fdcfe3aad2345091d371063f97d17","target":{"file":"fs/overlayfs/inode.c"}},{"deprecated":false,"digest":{"line_hashes":["170043098391656221847578075928577019098","32975670672430431655816707614054643363","78444291089231329588542113883064379652","276338156773259342743887566345097669685","59135680421780167585339442913115207874","195472053211201335602119625530219076278","300101434056908191329195357824899477136","147114574339013249201481558319871741545","179810709283614535465416365844180245681"],"threshold":0.9},"id":"CVE-2023-53260-9c91136c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@69f9ae7edf9ec0ff500429101923347fcba5c8c4","target":{"file":"fs/overlayfs/inode.c"}},{"deprecated":false,"digest":{"function_hash":"292378772158518079693812449969723586094","length":641},"id":"CVE-2023-53260-9ef3177a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@69f9ae7edf9ec0ff500429101923347fcba5c8c4","target":{"file":"fs/overlayfs/inode.c","function":"ovl_permission"}},{"deprecated":false,"digest":{"line_hashes":["170043098391656221847578075928577019098","32975670672430431655816707614054643363","78444291089231329588542113883064379652","276338156773259342743887566345097669685","59135680421780167585339442913115207874","195472053211201335602119625530219076278","300101434056908191329195357824899477136","147114574339013249201481558319871741545","179810709283614535465416365844180245681"],"threshold":0.9},"id":"CVE-2023-53260-d38df870","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1a73f5b8f079fd42a544c1600beface50c63af7c","target":{"file":"fs/overlayfs/inode.c"}},{"deprecated":false,"digest":{"function_hash":"292378772158518079693812449969723586094","length":641},"id":"CVE-2023-53260-e8e87681","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1a73f5b8f079fd42a544c1600beface50c63af7c","target":{"file":"fs/overlayfs/inode.c","function":"ovl_permission"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.19.0"},{"fixed":"6.1.43"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.4.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53260.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1a73f5b8f079fd42a544c1600beface50c63af7c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/53dd2ca2c02fdcfe3aad2345091d371063f97d17"},{"type":"WEB","url":"https://git.kernel.org/stable/c/69f9ae7edf9ec0ff500429101923347fcba5c8c4"}]}