{"schema_version":"1.7.3","id":"CVE-2022-50307","published":"2025-09-15T14:46:02Z","modified":"2025-10-21T12:34:40.760798Z","summary":"s390/cio: fix out-of-bounds access on cio_ignore free","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ns390/cio: fix out-of-bounds access on cio_ignore free\n\nThe channel-subsystem-driver scans for newly available devices whenever\ndevice-IDs are removed from the cio_ignore list using a command such as:\n\n  echo free >/proc/cio_ignore\n\nSince an I/O device scan might interfer with running I/Os, commit\n172da89ed0ea (\"s390/cio: avoid excessive path-verification requests\")\nintroduced an optimization to exclude online devices from the scan.\n\nThe newly added check for online devices incorrectly assumes that\nan I/O-subchannel's drvdata points to a struct io_subchannel_private.\nFor devices that are bound to a non-default I/O subchannel driver, such\nas the vfio_ccw driver, this results in an out-of-bounds read access\nduring each scan.\n\nFix this by changing the scan logic to rely on a driver-independent\nonline indication. For this we can use struct subchannel->config.ena,\nwhich is the driver's requested subchannel-enabled state. Since I/Os\ncan only be started on enabled subchannels, this matches the intent\nof the original optimization of not scanning devices where I/O might\nbe running.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"172da89ed0eaf9d9348f5decb86ad04c624b39d1"},{"fixed":"0e501fd0f38e42304bfa0d46a812d93f80294a87"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"172da89ed0eaf9d9348f5decb86ad04c624b39d1"},{"fixed":"106ab66cf5467726ca5ead51623043d37c06820a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"172da89ed0eaf9d9348f5decb86ad04c624b39d1"},{"fixed":"1b6074112742f65ece71b0f299ca5a6a887d2db6"}]}],"versions":["v5.15","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.34","v5.15.35","v5.15.36","v5.15.37","v5.15.38","v5.15.39","v5.15.4","v5.15.40","v5.15.41","v5.15.42","v5.15.43","v5.15.44","v5.15.45","v5.15.46","v5.15.47","v5.15.48","v5.15.49","v5.15.5","v5.15.50","v5.15.51","v5.15.52","v5.15.53","v5.15.54","v5.15.55","v5.15.56","v5.15.57","v5.15.58","v5.15.59","v5.15.6","v5.15.60","v5.15.61","v5.15.62","v5.15.63","v5.15.64","v5.15.65","v5.15.66","v5.15.67","v5.15.68","v5.15.69","v5.15.7","v5.15.70","v5.15.71","v5.15.72","v5.15.73","v5.15.74","v5.15.75","v5.15.76","v5.15.77","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.1-rc1","v6.1-rc2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50307.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["1827384593066500137704507967141562548","96900296461488095079372851771735122969","58773180532303933510267367741735168782","133641365345202943837128848024380358759","117565291751293508638908224986334439348","299243217574691619218250562202062428417","222533876085397572826074105094119989623","48320607231041415710374389589983439628","85780237244134675288258450957637028550"],"threshold":0.9},"id":"CVE-2022-50307-27e01f8d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e501fd0f38e42304bfa0d46a812d93f80294a87","target":{"file":"drivers/s390/cio/css.c"}},{"deprecated":false,"digest":{"function_hash":"304244821070837667795683057073982586758","length":271},"id":"CVE-2022-50307-28e365e1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0e501fd0f38e42304bfa0d46a812d93f80294a87","target":{"file":"drivers/s390/cio/css.c","function":"__unset_online"}},{"deprecated":false,"digest":{"function_hash":"304244821070837667795683057073982586758","length":271},"id":"CVE-2022-50307-372f202c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@106ab66cf5467726ca5ead51623043d37c06820a","target":{"file":"drivers/s390/cio/css.c","function":"__unset_online"}},{"deprecated":false,"digest":{"line_hashes":["1827384593066500137704507967141562548","96900296461488095079372851771735122969","58773180532303933510267367741735168782","133641365345202943837128848024380358759","117565291751293508638908224986334439348","299243217574691619218250562202062428417","222533876085397572826074105094119989623","48320607231041415710374389589983439628","85780237244134675288258450957637028550"],"threshold":0.9},"id":"CVE-2022-50307-5041fefc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1b6074112742f65ece71b0f299ca5a6a887d2db6","target":{"file":"drivers/s390/cio/css.c"}},{"deprecated":false,"digest":{"line_hashes":["1827384593066500137704507967141562548","96900296461488095079372851771735122969","58773180532303933510267367741735168782","133641365345202943837128848024380358759","117565291751293508638908224986334439348","299243217574691619218250562202062428417","222533876085397572826074105094119989623","48320607231041415710374389589983439628","85780237244134675288258450957637028550"],"threshold":0.9},"id":"CVE-2022-50307-5347bd65","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@106ab66cf5467726ca5ead51623043d37c06820a","target":{"file":"drivers/s390/cio/css.c"}},{"deprecated":false,"digest":{"function_hash":"304244821070837667795683057073982586758","length":271},"id":"CVE-2022-50307-7d6a612f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1b6074112742f65ece71b0f299ca5a6a887d2db6","target":{"file":"drivers/s390/cio/css.c","function":"__unset_online"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.15.0"},{"fixed":"5.15.78"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"6.0.7"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50307.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0e501fd0f38e42304bfa0d46a812d93f80294a87"},{"type":"WEB","url":"https://git.kernel.org/stable/c/106ab66cf5467726ca5ead51623043d37c06820a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1b6074112742f65ece71b0f299ca5a6a887d2db6"}]}