{"schema_version":"1.7.3","id":"CVE-2025-39768","published":"2025-09-11T16:56:22Z","modified":"2025-10-22T15:19:52.036459Z","summary":"net/mlx5: HWS, fix complex rules rehash error flow","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: HWS, fix complex rules rehash error flow\n\nMoving rules from matcher to matcher should not fail.\nHowever, if it does fail due to various reasons, the error flow\nshould allow the kernel to continue functioning (albeit with broken\nsteering rules) instead of going into series of soft lock-ups or\nsome other problematic behaviour.\n\nSimilar to the simple rules, complex rules rehash logic suffers\nfrom the same problems. This patch fixes the error flow for moving\ncomplex rules:\n - If new rule creation fails before it was even enqeued, do not\n   poll for completion\n - If TIMEOUT happened while moving the rule, no point trying\n   to poll for completions for other rules. Something is broken,\n   completion won't come, just abort the rehash sequence.\n - If some other completion with error received, don't give up.\n   Continue handling rest of the rules to minimize the damage.\n - Make sure that the first error code that was received will\n   be actually returned to the caller instead of replacing it\n   with the generic error code.\n\nAll the aforementioned issues stem from the same bad error flow,\nso no point fixing them one by one and leaving partially broken\ncode - fixing them in one patch.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"17e0accac577fd6ea2090934d71a8c6f36702a26"},{"fixed":"37d54bc28d092bc3b314da45d730f00e9d86ec2a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"17e0accac577fd6ea2090934d71a8c6f36702a26"},{"fixed":"4a842b1bf18a32ee0c25dd6dd98728b786a76fe4"}]}],"versions":["v6.15","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.17-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39768.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["316097223030597784413318581147390423118","129568726313222221110856065285258536428","53668533238821990843848050115155752918","20825572945359166677875377871243564422","192075907519552077740891463239557396363","189368374532867018204406001307514714267","317467358215154099977801186197033479693","13029472098853171846310876605358427109","69613115827038176688938950366298598248","160338061766730618329754776023725929117","256500157979956630067591813479681536871","84774416890163384933051962474926220022","185916535467716664747778384041503004280","243339443388013115681979949650851080732","45332755467391896289987283890338158974","11173892271107346323430116878942932175","34502365576672107817185660819192525852","129570271482305946623109190779728331283","210640095179028261980130662057431341020","3005010766987651809152831717856618089","206247864854576681529683410671506599323","79837415457443181363860500413418803196","116562834783102606790213042444314474168","63282569025143164911426988663232008696","111953231693746728068577167282565702861","55715444097649643113823877679456132061","22804447839002092056887425006004959085","281781330119534554582731080613762899227"],"threshold":0.9},"id":"CVE-2025-39768-9caa0539","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a842b1bf18a32ee0c25dd6dd98728b786a76fe4","target":{"file":"drivers/net/ethernet/mellanox/mlx5/core/steering/hws/bwc_complex.c"}},{"deprecated":false,"digest":{"function_hash":"90660597673480737703581870189441946371","length":1676},"id":"CVE-2025-39768-c8ac40db","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37d54bc28d092bc3b314da45d730f00e9d86ec2a","target":{"file":"drivers/net/ethernet/mellanox/mlx5/core/steering/hws/bwc_complex.c","function":"mlx5hws_bwc_matcher_move_all_complex"}},{"deprecated":false,"digest":{"function_hash":"90660597673480737703581870189441946371","length":1676},"id":"CVE-2025-39768-eb1f9e9b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4a842b1bf18a32ee0c25dd6dd98728b786a76fe4","target":{"file":"drivers/net/ethernet/mellanox/mlx5/core/steering/hws/bwc_complex.c","function":"mlx5hws_bwc_matcher_move_all_complex"}},{"deprecated":false,"digest":{"line_hashes":["316097223030597784413318581147390423118","129568726313222221110856065285258536428","53668533238821990843848050115155752918","20825572945359166677875377871243564422","192075907519552077740891463239557396363","189368374532867018204406001307514714267","317467358215154099977801186197033479693","13029472098853171846310876605358427109","69613115827038176688938950366298598248","160338061766730618329754776023725929117","256500157979956630067591813479681536871","84774416890163384933051962474926220022","185916535467716664747778384041503004280","243339443388013115681979949650851080732","45332755467391896289987283890338158974","11173892271107346323430116878942932175","34502365576672107817185660819192525852","129570271482305946623109190779728331283","210640095179028261980130662057431341020","3005010766987651809152831717856618089","206247864854576681529683410671506599323","79837415457443181363860500413418803196","116562834783102606790213042444314474168","63282569025143164911426988663232008696","111953231693746728068577167282565702861","55715444097649643113823877679456132061","22804447839002092056887425006004959085","281781330119534554582731080613762899227"],"threshold":0.9},"id":"CVE-2025-39768-f10e3ad0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37d54bc28d092bc3b314da45d730f00e9d86ec2a","target":{"file":"drivers/net/ethernet/mellanox/mlx5/core/steering/hws/bwc_complex.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.16.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39768.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/37d54bc28d092bc3b314da45d730f00e9d86ec2a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4a842b1bf18a32ee0c25dd6dd98728b786a76fe4"}]}