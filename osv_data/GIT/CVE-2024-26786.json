{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26786.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "203675950703230640816127306981502452449",
              "length": 523.0
            },
            "id": "CVE-2024-26786-09aa80d0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f1fb745ee0a6fe43f1d84ec369c7e6af2310fda9",
            "target": {
              "file": "drivers/iommu/iommufd/io_pagetable.c",
              "function": "iopt_add_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "203675950703230640816127306981502452449",
              "length": 523.0
            },
            "id": "CVE-2024-26786-3c498542",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aeb004c0cd6958e910123a1607634401009c9539",
            "target": {
              "file": "drivers/iommu/iommufd/io_pagetable.c",
              "function": "iopt_add_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "203675950703230640816127306981502452449",
              "length": 523.0
            },
            "id": "CVE-2024-26786-70f1f6cf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9526a46cc0c378d381560279bea9aa34c84298a0",
            "target": {
              "file": "drivers/iommu/iommufd/io_pagetable.c",
              "function": "iopt_add_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "19831432324176695873212817247676582478",
                "224921852598938360363145857450429395824",
                "164827799417549146182651925841000997346",
                "161602890759434970869766824628746993082",
                "179120283953312801706277703873645903277",
                "324285172732592277567764857464951791259",
                "196081269515955809503122443260607269108",
                "55515225236211978657168594485867031465",
                "317345078107376572694386022386752631321",
                "128458254383284371726445782097956308430",
                "159910511971333033566758213860967196512",
                "201484678545577974884801569265094402474",
                "314239145586635715283303191288890702114",
                "131866224847100076231229133690184537886",
                "228263589789356459203616837486561680683",
                "217238161929609083889251443669556717134"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26786-7258909c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f1fb745ee0a6fe43f1d84ec369c7e6af2310fda9",
            "target": {
              "file": "drivers/iommu/iommufd/io_pagetable.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "19831432324176695873212817247676582478",
                "224921852598938360363145857450429395824",
                "164827799417549146182651925841000997346",
                "161602890759434970869766824628746993082",
                "179120283953312801706277703873645903277",
                "324285172732592277567764857464951791259",
                "196081269515955809503122443260607269108",
                "55515225236211978657168594485867031465",
                "317345078107376572694386022386752631321",
                "128458254383284371726445782097956308430",
                "159910511971333033566758213860967196512",
                "201484678545577974884801569265094402474",
                "314239145586635715283303191288890702114",
                "131866224847100076231229133690184537886",
                "228263589789356459203616837486561680683",
                "217238161929609083889251443669556717134"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26786-92dc631a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@aeb004c0cd6958e910123a1607634401009c9539",
            "target": {
              "file": "drivers/iommu/iommufd/io_pagetable.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "19831432324176695873212817247676582478",
                "224921852598938360363145857450429395824",
                "164827799417549146182651925841000997346",
                "161602890759434970869766824628746993082",
                "179120283953312801706277703873645903277",
                "324285172732592277567764857464951791259",
                "196081269515955809503122443260607269108",
                "55515225236211978657168594485867031465",
                "317345078107376572694386022386752631321",
                "128458254383284371726445782097956308430",
                "159910511971333033566758213860967196512",
                "201484678545577974884801569265094402474",
                "314239145586635715283303191288890702114",
                "131866224847100076231229133690184537886",
                "228263589789356459203616837486561680683",
                "217238161929609083889251443669556717134"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26786-c4cea83a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9526a46cc0c378d381560279bea9aa34c84298a0",
            "target": {
              "file": "drivers/iommu/iommufd/io_pagetable.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "9227da7816dd1a42e20d41e2244cb63c205477ca"
            },
            {
              "fixed": "f1fb745ee0a6fe43f1d84ec369c7e6af2310fda9"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "9227da7816dd1a42e20d41e2244cb63c205477ca"
            },
            {
              "fixed": "9526a46cc0c378d381560279bea9aa34c84298a0"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "9227da7816dd1a42e20d41e2244cb63c205477ca"
            },
            {
              "fixed": "aeb004c0cd6958e910123a1607634401009c9539"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.5",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.2",
        "v6.7.3",
        "v6.7.4",
        "v6.7.5",
        "v6.7.6",
        "v6.7.7",
        "v6.7.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26786.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.21"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.9"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\niommufd: Fix iopt_access_list_id overwrite bug\n\nSyzkaller reported the following WARN_ON:\n  WARNING: CPU: 1 PID: 4738 at drivers/iommu/iommufd/io_pagetable.c:1360\n\n  Call Trace:\n   iommufd_access_change_ioas+0x2fe/0x4e0\n   iommufd_access_destroy_object+0x50/0xb0\n   iommufd_object_remove+0x2a3/0x490\n   iommufd_object_destroy_user\n   iommufd_access_destroy+0x71/0xb0\n   iommufd_test_staccess_release+0x89/0xd0\n   __fput+0x272/0xb50\n   __fput_sync+0x4b/0x60\n   __do_sys_close\n   __se_sys_close\n   __x64_sys_close+0x8b/0x110\n   do_syscall_x64\n\nThe mismatch between the access pointer in the list and the passed-in\npointer is resulting from an overwrite of access->iopt_access_list_id, in\niopt_add_access(). Called from iommufd_access_change_ioas() when\nxa_alloc() succeeds but iopt_calculate_iova_alignment() fails.\n\nAdd a new_id in iopt_add_access() and only update iopt_access_list_id when\nreturning successfully.",
  "id": "CVE-2024-26786",
  "modified": "2025-10-15T08:52:06.549482Z",
  "published": "2024-04-04T08:20:19Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9526a46cc0c378d381560279bea9aa34c84298a0"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/aeb004c0cd6958e910123a1607634401009c9539"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f1fb745ee0a6fe43f1d84ec369c7e6af2310fda9"
    }
  ],
  "related": [
    "SUSE-SU-2024:2135-1",
    "SUSE-SU-2024:2203-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "iommufd: Fix iopt_access_list_id overwrite bug"
}