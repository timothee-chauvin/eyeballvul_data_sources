{"schema_version":"1.7.3","id":"CVE-2022-49227","published":"2025-02-26T01:55:56.202Z","modified":"2025-11-19T14:05:25.368886Z","related":["SUSE-SU-2025:1027-1","SUSE-SU-2025:1176-1","SUSE-SU-2025:1183-1","SUSE-SU-2025:1241-1"],"summary":"igc: avoid kernel warning when changing RX ring parameters","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nigc: avoid kernel warning when changing RX ring parameters\n\nCalling ethtool changing the RX ring parameters like this:\n\n  $ ethtool -G eth0 rx 1024\n\non igc triggers kernel warnings like this:\n\n[  225.198467] ------------[ cut here ]------------\n[  225.198473] Missing unregister, handled but fix driver\n[  225.198485] WARNING: CPU: 7 PID: 959 at net/core/xdp.c:168\nxdp_rxq_info_reg+0x79/0xd0\n[...]\n[  225.198601] Call Trace:\n[  225.198604]  <TASK>\n[  225.198609]  igc_setup_rx_resources+0x3f/0xe0 [igc]\n[  225.198617]  igc_ethtool_set_ringparam+0x30e/0x450 [igc]\n[  225.198626]  ethnl_set_rings+0x18a/0x250\n[  225.198631]  genl_family_rcv_msg_doit+0xca/0x110\n[  225.198637]  genl_rcv_msg+0xce/0x1c0\n[  225.198640]  ? rings_prepare_data+0x60/0x60\n[  225.198644]  ? genl_get_cmd+0xd0/0xd0\n[  225.198647]  netlink_rcv_skb+0x4e/0xf0\n[  225.198652]  genl_rcv+0x24/0x40\n[  225.198655]  netlink_unicast+0x20e/0x330\n[  225.198659]  netlink_sendmsg+0x23f/0x480\n[  225.198663]  sock_sendmsg+0x5b/0x60\n[  225.198667]  __sys_sendto+0xf0/0x160\n[  225.198671]  ? handle_mm_fault+0xb2/0x280\n[  225.198676]  ? do_user_addr_fault+0x1eb/0x690\n[  225.198680]  __x64_sys_sendto+0x20/0x30\n[  225.198683]  do_syscall_64+0x38/0x90\n[  225.198687]  entry_SYSCALL_64_after_hwframe+0x44/0xae\n[  225.198693] RIP: 0033:0x7f7ae38ac3aa\n\nigc_ethtool_set_ringparam() copies the igc_ring structure but neglects to\nreset the xdp_rxq_info member before calling igc_setup_rx_resources().\nThis in turn calls xdp_rxq_info_reg() with an already registered xdp_rxq_info.\n\nMake sure to unregister the xdp_rxq_info structure first in\nigc_setup_rx_resources.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"73f1071c1d2952b8c93cd6cd99744768c59ec840"},{"fixed":"ab8c107470d12e7ef99030bf0911a10cdef62d16"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"73f1071c1d2952b8c93cd6cd99744768c59ec840"},{"fixed":"3ddb49af08094ebee250b461172ee7b8e27a35d3"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"73f1071c1d2952b8c93cd6cd99744768c59ec840"},{"fixed":"65aebcf1e05bd97d2e7ffcdff36efea1757c9450"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"73f1071c1d2952b8c93cd6cd99744768c59ec840"},{"fixed":"453307b569a0d41bddd07f26bf41b784cd82a4c9"}]}],"versions":["v5.12","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.4","v5.15.5","v5.15.6","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.1","v5.16.10","v5.16.11","v5.16.12","v5.16.13","v5.16.14","v5.16.15","v5.16.16","v5.16.17","v5.16.18","v5.16.2","v5.16.3","v5.16.4","v5.16.5","v5.16.6","v5.16.7","v5.16.8","v5.16.9","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49227.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"183544990949811253973519268219230070400","length":1003},"id":"CVE-2022-49227-0147e5fd","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@453307b569a0d41bddd07f26bf41b784cd82a4c9","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c","function":"igc_setup_rx_resources"}},{"deprecated":false,"digest":{"function_hash":"183544990949811253973519268219230070400","length":1003},"id":"CVE-2022-49227-11af4411","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3ddb49af08094ebee250b461172ee7b8e27a35d3","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c","function":"igc_setup_rx_resources"}},{"deprecated":false,"digest":{"line_hashes":["170206393333115657030851295221723440934","182893994061722555953595540301375987050","183164719811295295211917460391916881701"],"threshold":0.9},"id":"CVE-2022-49227-329d26fd","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ab8c107470d12e7ef99030bf0911a10cdef62d16","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c"}},{"deprecated":false,"digest":{"line_hashes":["170206393333115657030851295221723440934","182893994061722555953595540301375987050","183164719811295295211917460391916881701"],"threshold":0.9},"id":"CVE-2022-49227-3cbac2bc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65aebcf1e05bd97d2e7ffcdff36efea1757c9450","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c"}},{"deprecated":false,"digest":{"line_hashes":["170206393333115657030851295221723440934","182893994061722555953595540301375987050","183164719811295295211917460391916881701"],"threshold":0.9},"id":"CVE-2022-49227-44b4f9ac","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3ddb49af08094ebee250b461172ee7b8e27a35d3","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c"}},{"deprecated":false,"digest":{"line_hashes":["170206393333115657030851295221723440934","182893994061722555953595540301375987050","183164719811295295211917460391916881701"],"threshold":0.9},"id":"CVE-2022-49227-98c3ca28","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@453307b569a0d41bddd07f26bf41b784cd82a4c9","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c"}},{"deprecated":false,"digest":{"function_hash":"183544990949811253973519268219230070400","length":1003},"id":"CVE-2022-49227-d891af70","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@65aebcf1e05bd97d2e7ffcdff36efea1757c9450","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c","function":"igc_setup_rx_resources"}},{"deprecated":false,"digest":{"function_hash":"183544990949811253973519268219230070400","length":1003},"id":"CVE-2022-49227-f112b290","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ab8c107470d12e7ef99030bf0911a10cdef62d16","target":{"file":"drivers/net/ethernet/intel/igc/igc_main.c","function":"igc_setup_rx_resources"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.13.0"},{"fixed":"5.15.33"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.16.19"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49227.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3ddb49af08094ebee250b461172ee7b8e27a35d3"},{"type":"WEB","url":"https://git.kernel.org/stable/c/453307b569a0d41bddd07f26bf41b784cd82a4c9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/65aebcf1e05bd97d2e7ffcdff36efea1757c9450"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ab8c107470d12e7ef99030bf0911a10cdef62d16"}]}