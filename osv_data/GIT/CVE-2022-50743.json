{"schema_version":"1.7.3","id":"CVE-2022-50743","published":"2025-12-24T13:05:40.297Z","modified":"2025-12-24T20:23:42.517283Z","summary":"erofs: Fix pcluster memleak when its block address is zero","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: Fix pcluster memleak when its block address is zero\n\nsyzkaller reported a memleak:\nhttps://syzkaller.appspot.com/bug?id=62f37ff612f0021641eda5b17f056f1668aa9aed\n\nunreferenced object 0xffff88811009c7f8 (size 136):\n  ...\n  backtrace:\n    [<ffffffff821db19b>] z_erofs_do_read_page+0x99b/0x1740\n    [<ffffffff821dee9e>] z_erofs_readahead+0x24e/0x580\n    [<ffffffff814bc0d6>] read_pages+0x86/0x3d0\n    ...\n\nsyzkaller constructed a case: in z_erofs_register_pcluster(),\nztailpacking = false and map->m_pa = zero. This makes pcl->obj.index be\nzero although pcl is not a inline pcluster.\n\nThen following path adds refcount for grp, but the refcount won't be put\nbecause pcl is inline.\n\nz_erofs_readahead()\n  z_erofs_do_read_page() # for another page\n    z_erofs_collector_begin()\n      erofs_find_workgroup()\n        erofs_workgroup_get()\n\nSince it's illegal for the block address of a non-inlined pcluster to\nbe zero, add check here to avoid registering the pcluster which would\nbe leaked.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"cecf864d3d76d50e3d9c58145e286a0b8c284e92"},{"fixed":"ac54c1f7b288d83b6ba1e320efff24ecc21309cd"},{"fixed":"618e712b99c78d1004b70a1a9ab0a4830d0b2673"},{"fixed":"c42c0ffe81176940bd5dead474216b7198d77675"}]}],"versions":["v5.16","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.10","v6.0.11","v6.0.12","v6.0.13","v6.0.14","v6.0.15","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.0.8","v6.0.9","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50743.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"6.0.16"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.1.0"},{"fixed":"6.1.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50743.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/618e712b99c78d1004b70a1a9ab0a4830d0b2673"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ac54c1f7b288d83b6ba1e320efff24ecc21309cd"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c42c0ffe81176940bd5dead474216b7198d77675"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50743.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-50743"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50743.json"}}