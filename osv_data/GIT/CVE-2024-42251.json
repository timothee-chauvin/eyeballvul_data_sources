{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42251.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "84732655154444916591161310308528565419",
              "length": 82.0
            },
            "id": "CVE-2024-42251-31df31de",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa2690af573dfefb47ba6eef888797a64b6b5f3c",
            "target": {
              "file": "include/linux/page_ref.h",
              "function": "folio_try_get_rcu"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "303353893801378924070155215148886090223",
              "length": 327.0
            },
            "id": "CVE-2024-42251-81c079a7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa2690af573dfefb47ba6eef888797a64b6b5f3c",
            "target": {
              "file": "include/linux/page_ref.h",
              "function": "folio_ref_try_add_rcu"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331892433885916781068869424735512656795",
                "303843078767003744265317305243648310781",
                "168548604641847081899515324928462220080",
                "125422161493659090962860704361481698972",
                "159493414846747695787981050467005128128",
                "194611114479259211185989119091499400710",
                "119935987017185210502588145543689283717",
                "125932574689895035024971870680087880918",
                "111471760203288395077268635013685102439",
                "94220959151185832155291661229139105063",
                "45959464637921669208091936149266046673",
                "95303011221536445280300307404998942651",
                "255674621039471277793960130798022010141",
                "50303777466078614287049194638510377076",
                "78416422213881917049128655916655160190",
                "23602990941571240223974936636878689810",
                "89949412325099426032242902284788119349",
                "1549342888056992251660704974026372358",
                "299785304734780165259244972542527955484",
                "265779787435244878579727500059644287659",
                "16013226406844189295242204124072890553"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42251-acd477a3",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa2690af573dfefb47ba6eef888797a64b6b5f3c",
            "target": {
              "file": "include/linux/page_ref.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "232155118108176185360744165772952525287",
                "200478579709783339264524250425078115016",
                "41230069838819090747482255489953544805",
                "335951009902914735187298558643475188304"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42251-c131ad44",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa2690af573dfefb47ba6eef888797a64b6b5f3c",
            "target": {
              "file": "mm/gup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "113803278395713516524820423026281972553",
                "305098932594354886113667098891881398215",
                "143578596438628857053807870547168428984",
                "42210911392474098409241232312069980899",
                "108850321390033136568155013581078362329",
                "7660730015472414489276287729978400651",
                "151260967305533195948145854787149101325",
                "48478595477187442322608858536588782600",
                "41795218751576222340323046034460979889",
                "248186599488224242441080645055131741518",
                "184619668681986318113867407191968585942",
                "297593565681542468104184810274546864372",
                "100563678885805737817787115761896078657",
                "217042930458180757231646472439090321685",
                "174089851487952564119274450727607184231",
                "297593565681542468104184810274546864372",
                "12307887831446350995869974229704026591",
                "644644660716226261710606907146508721",
                "89141309463478542516955609093022577633",
                "250265771112410225984794678196715791050"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42251-caab76ac",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fa2690af573dfefb47ba6eef888797a64b6b5f3c",
            "target": {
              "file": "mm/filemap.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "57edfcfd3419b4799353d8cbd6ce49da075cfdbd"
            },
            {
              "fixed": "16380f52b72166d6a33b508cc2509716f436253f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "57edfcfd3419b4799353d8cbd6ce49da075cfdbd"
            },
            {
              "fixed": "e7db2762ea3e69f215b3ec4db666006deccc37b4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "57edfcfd3419b4799353d8cbd6ce49da075cfdbd"
            },
            {
              "fixed": "fa2690af573dfefb47ba6eef888797a64b6b5f3c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.5",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.3",
        "v6.6.30",
        "v6.6.31",
        "v6.6.32",
        "v6.6.33",
        "v6.6.34",
        "v6.6.35",
        "v6.6.36",
        "v6.6.37",
        "v6.6.38",
        "v6.6.39",
        "v6.6.4",
        "v6.6.40",
        "v6.6.41",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7",
        "v6.9.1",
        "v6.9.10",
        "v6.9.2",
        "v6.9.3",
        "v6.9.4",
        "v6.9.5",
        "v6.9.6",
        "v6.9.7",
        "v6.9.8",
        "v6.9.9"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42251.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.42"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.9.11"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: page_ref: remove folio_try_get_rcu()\n\nThe below bug was reported on a non-SMP kernel:\n\n[  275.267158][ T4335] ------------[ cut here ]------------\n[  275.267949][ T4335] kernel BUG at include/linux/page_ref.h:275!\n[  275.268526][ T4335] invalid opcode: 0000 [#1] KASAN PTI\n[  275.269001][ T4335] CPU: 0 PID: 4335 Comm: trinity-c3 Not tainted 6.7.0-rc4-00061-gefa7df3e3bb5 #1\n[  275.269787][ T4335] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014\n[  275.270679][ T4335] RIP: 0010:try_get_folio (include/linux/page_ref.h:275 (discriminator 3) mm/gup.c:79 (discriminator 3))\n[  275.272813][ T4335] RSP: 0018:ffffc90005dcf650 EFLAGS: 00010202\n[  275.273346][ T4335] RAX: 0000000000000246 RBX: ffffea00066e0000 RCX: 0000000000000000\n[  275.274032][ T4335] RDX: fffff94000cdc007 RSI: 0000000000000004 RDI: ffffea00066e0034\n[  275.274719][ T4335] RBP: ffffea00066e0000 R08: 0000000000000000 R09: fffff94000cdc006\n[  275.275404][ T4335] R10: ffffea00066e0037 R11: 0000000000000000 R12: 0000000000000136\n[  275.276106][ T4335] R13: ffffea00066e0034 R14: dffffc0000000000 R15: ffffea00066e0008\n[  275.276790][ T4335] FS:  00007fa2f9b61740(0000) GS:ffffffff89d0d000(0000) knlGS:0000000000000000\n[  275.277570][ T4335] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[  275.278143][ T4335] CR2: 00007fa2f6c00000 CR3: 0000000134b04000 CR4: 00000000000406f0\n[  275.278833][ T4335] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n[  275.279521][ T4335] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n[  275.280201][ T4335] Call Trace:\n[  275.280499][ T4335]  <TASK>\n[ 275.280751][ T4335] ? die (arch/x86/kernel/dumpstack.c:421 arch/x86/kernel/dumpstack.c:434 arch/x86/kernel/dumpstack.c:447)\n[ 275.281087][ T4335] ? do_trap (arch/x86/kernel/traps.c:112 arch/x86/kernel/traps.c:153)\n[ 275.281463][ T4335] ? try_get_folio (include/linux/page_ref.h:275 (discriminator 3) mm/gup.c:79 (discriminator 3))\n[ 275.281884][ T4335] ? try_get_folio (include/linux/page_ref.h:275 (discriminator 3) mm/gup.c:79 (discriminator 3))\n[ 275.282300][ T4335] ? do_error_trap (arch/x86/kernel/traps.c:174)\n[ 275.282711][ T4335] ? try_get_folio (include/linux/page_ref.h:275 (discriminator 3) mm/gup.c:79 (discriminator 3))\n[ 275.283129][ T4335] ? handle_invalid_op (arch/x86/kernel/traps.c:212)\n[ 275.283561][ T4335] ? try_get_folio (include/linux/page_ref.h:275 (discriminator 3) mm/gup.c:79 (discriminator 3))\n[ 275.283990][ T4335] ? exc_invalid_op (arch/x86/kernel/traps.c:264)\n[ 275.284415][ T4335] ? asm_exc_invalid_op (arch/x86/include/asm/idtentry.h:568)\n[ 275.284859][ T4335] ? try_get_folio (include/linux/page_ref.h:275 (discriminator 3) mm/gup.c:79 (discriminator 3))\n[ 275.285278][ T4335] try_grab_folio (mm/gup.c:148)\n[ 275.285684][ T4335] __get_user_pages (mm/gup.c:1297 (discriminator 1))\n[ 275.286111][ T4335] ? __pfx___get_user_pages (mm/gup.c:1188)\n[ 275.286579][ T4335] ? __pfx_validate_chain (kernel/locking/lockdep.c:3825)\n[ 275.287034][ T4335] ? mark_lock (kernel/locking/lockdep.c:4656 (discriminator 1))\n[ 275.287416][ T4335] __gup_longterm_locked (mm/gup.c:1509 mm/gup.c:2209)\n[ 275.288192][ T4335] ? __pfx___gup_longterm_locked (mm/gup.c:2204)\n[ 275.288697][ T4335] ? __pfx_lock_acquire (kernel/locking/lockdep.c:5722)\n[ 275.289135][ T4335] ? __pfx___might_resched (kernel/sched/core.c:10106)\n[ 275.289595][ T4335] pin_user_pages_remote (mm/gup.c:3350)\n[ 275.290041][ T4335] ? __pfx_pin_user_pages_remote (mm/gup.c:3350)\n[ 275.290545][ T4335] ? find_held_lock (kernel/locking/lockdep.c:5244 (discriminator 1))\n[ 275.290961][ T4335] ? mm_access (kernel/fork.c:1573)\n[ 275.291353][ T4335] process_vm_rw_single_vec+0x142/0x360\n[ 275.291900][ T4335] ? __pfx_process_vm_rw_single_vec+0x10/0x10\n[ 275.292471][ T4335] ? mm_access (kernel/fork.c:1573)\n[ 275.292859][ T4335] process_vm_rw_core+0x272/0x4e0\n[ 275.293384][ T4335] ? hlock_class (a\n---truncated---",
  "id": "CVE-2024-42251",
  "modified": "2025-10-15T13:45:26.032932Z",
  "published": "2024-08-08T08:46:27Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/16380f52b72166d6a33b508cc2509716f436253f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e7db2762ea3e69f215b3ec4db666006deccc37b4"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/fa2690af573dfefb47ba6eef888797a64b6b5f3c"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "mm: page_ref: remove folio_try_get_rcu()"
}