{"schema_version":"1.7.3","id":"CVE-2022-49246","published":"2025-02-26T01:56:05Z","modified":"2025-10-21T09:43:29.025184Z","related":["SUSE-SU-2025:1027-1","SUSE-SU-2025:1176-1","SUSE-SU-2025:1183-1","SUSE-SU-2025:1241-1"],"summary":"ASoC: atmel: Fix error handling in snd_proto_probe","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nASoC: atmel: Fix error handling in snd_proto_probe\n\nThe device_node pointer is returned by of_parse_phandle()  with refcount\nincremented. We should use of_node_put() on it when done.\n\nThis function only calls of_node_put() in the regular path.\nAnd it will cause refcount leak in error paths.\nFix this by calling of_node_put() in error handling too.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a45f8853a5f95e3760dfbd7ba09d3d597d247040"},{"fixed":"f32ac9bf5e3f594ef9bfedb410aebc98cf784e69"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a45f8853a5f95e3760dfbd7ba09d3d597d247040"},{"fixed":"0f517480d5888cd54487c5662ce4da95b30ad798"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a45f8853a5f95e3760dfbd7ba09d3d597d247040"},{"fixed":"8fa969cd8485031294f91fc7184399000cae6355"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a45f8853a5f95e3760dfbd7ba09d3d597d247040"},{"fixed":"b0bfaf0544d08d093d6211d7ef8816fb0b5b6c75"}]}],"versions":["v4.19","v4.19-rc2","v4.19-rc3","v4.19-rc4","v4.19-rc5","v4.19-rc6","v4.19-rc7","v4.19-rc8","v4.20","v4.20-rc1","v4.20-rc2","v4.20-rc3","v4.20-rc4","v4.20-rc5","v4.20-rc6","v4.20-rc7","v5.0","v5.0-rc1","v5.0-rc2","v5.0-rc3","v5.0-rc4","v5.0-rc5","v5.0-rc6","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.4","v5.15.5","v5.15.6","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.1","v5.16.10","v5.16.11","v5.16.12","v5.16.13","v5.16.14","v5.16.15","v5.16.16","v5.16.17","v5.16.18","v5.16.2","v5.16.3","v5.16.4","v5.16.5","v5.16.6","v5.16.7","v5.16.8","v5.16.9","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49246.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["318576835073881061680663566872564435000","11085010514586477079723097296932975068","67877791793798996892195610557651081162","279994427168592680387062271814494279287","230418925092698995895536730673088552087","220323830990616507019603192378738948183","151781528005308051861068515760552206727","137361871190097994836211314982745509900","7515765812736828812304700296316034387","114328333079844628571393596985018891570","314914635260324550767412828991709012163","10103482182909934610081677664064483314","199671295148074607091268359679525817676","263867542636538346812795636142038158217","232947428832691835343344748055961208","53001164409698069866966163055765694944","275008882330204912123957282893840645018","258005054425949237025062697346544581749","221112965467793488144540929685445055144","321585666030159972746387558751339267782"],"threshold":0.9},"id":"CVE-2022-49246-12f3aa72","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f32ac9bf5e3f594ef9bfedb410aebc98cf784e69","target":{"file":"sound/soc/atmel/mikroe-proto.c"}},{"deprecated":false,"digest":{"line_hashes":["318576835073881061680663566872564435000","11085010514586477079723097296932975068","67877791793798996892195610557651081162","279994427168592680387062271814494279287","230418925092698995895536730673088552087","220323830990616507019603192378738948183","151781528005308051861068515760552206727","137361871190097994836211314982745509900","7515765812736828812304700296316034387","114328333079844628571393596985018891570","314914635260324550767412828991709012163","10103482182909934610081677664064483314","199671295148074607091268359679525817676","263867542636538346812795636142038158217","232947428832691835343344748055961208","53001164409698069866966163055765694944","275008882330204912123957282893840645018","258005054425949237025062697346544581749","221112965467793488144540929685445055144","321585666030159972746387558751339267782"],"threshold":0.9},"id":"CVE-2022-49246-222d6c26","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0f517480d5888cd54487c5662ce4da95b30ad798","target":{"file":"sound/soc/atmel/mikroe-proto.c"}},{"deprecated":false,"digest":{"function_hash":"301795832862646365384003352349930125376","length":1944},"id":"CVE-2022-49246-36356a4f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f32ac9bf5e3f594ef9bfedb410aebc98cf784e69","target":{"file":"sound/soc/atmel/mikroe-proto.c","function":"snd_proto_probe"}},{"deprecated":false,"digest":{"function_hash":"235578719709772837315515583709200628576","length":1944},"id":"CVE-2022-49246-82c5e0f8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0f517480d5888cd54487c5662ce4da95b30ad798","target":{"file":"sound/soc/atmel/mikroe-proto.c","function":"snd_proto_probe"}},{"deprecated":false,"digest":{"function_hash":"259470800083966214730080081291758370900","length":1915},"id":"CVE-2022-49246-91a51f05","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8fa969cd8485031294f91fc7184399000cae6355","target":{"file":"sound/soc/atmel/mikroe-proto.c","function":"snd_proto_probe"}},{"deprecated":false,"digest":{"line_hashes":["318576835073881061680663566872564435000","11085010514586477079723097296932975068","67877791793798996892195610557651081162","279994427168592680387062271814494279287","230418925092698995895536730673088552087","220323830990616507019603192378738948183","151781528005308051861068515760552206727","137361871190097994836211314982745509900","7515765812736828812304700296316034387","114328333079844628571393596985018891570","314914635260324550767412828991709012163","10103482182909934610081677664064483314","199671295148074607091268359679525817676","263867542636538346812795636142038158217","128456417573986905514560703376774951176","112202218730729759344245589124396691140","322043519850280022657297006809221035891","214684002307826044875813017605840618582","230419187085123461446761054776054509683","138464166617083044743236938335921218820"],"threshold":0.9},"id":"CVE-2022-49246-a7a17422","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8fa969cd8485031294f91fc7184399000cae6355","target":{"file":"sound/soc/atmel/mikroe-proto.c"}},{"deprecated":false,"digest":{"function_hash":"259470800083966214730080081291758370900","length":1915},"id":"CVE-2022-49246-fb4b9e88","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b0bfaf0544d08d093d6211d7ef8816fb0b5b6c75","target":{"file":"sound/soc/atmel/mikroe-proto.c","function":"snd_proto_probe"}},{"deprecated":false,"digest":{"line_hashes":["318576835073881061680663566872564435000","11085010514586477079723097296932975068","67877791793798996892195610557651081162","279994427168592680387062271814494279287","230418925092698995895536730673088552087","220323830990616507019603192378738948183","151781528005308051861068515760552206727","137361871190097994836211314982745509900","7515765812736828812304700296316034387","114328333079844628571393596985018891570","314914635260324550767412828991709012163","10103482182909934610081677664064483314","199671295148074607091268359679525817676","263867542636538346812795636142038158217","128456417573986905514560703376774951176","112202218730729759344245589124396691140","322043519850280022657297006809221035891","214684002307826044875813017605840618582","230419187085123461446761054776054509683","138464166617083044743236938335921218820"],"threshold":0.9},"id":"CVE-2022-49246-fe9b1f97","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b0bfaf0544d08d093d6211d7ef8816fb0b5b6c75","target":{"file":"sound/soc/atmel/mikroe-proto.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"4.20.0"},{"fixed":"5.15.33"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.16.19"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49246.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0f517480d5888cd54487c5662ce4da95b30ad798"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8fa969cd8485031294f91fc7184399000cae6355"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b0bfaf0544d08d093d6211d7ef8816fb0b5b6c75"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f32ac9bf5e3f594ef9bfedb410aebc98cf784e69"}]}