{"schema_version":"1.7.3","id":"CVE-2023-54276","published":"2025-12-30T12:16:05.020Z","modified":"2025-12-30T21:06:31.531887Z","summary":"nfsd: move init of percpu reply_cache_stats counters back to nfsd_init_net","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnfsd: move init of percpu reply_cache_stats counters back to nfsd_init_net\n\nCommit f5f9d4a314da (\"nfsd: move reply cache initialization into nfsd\nstartup\") moved the initialization of the reply cache into nfsd startup,\nbut didn't account for the stats counters, which can be accessed before\nnfsd is ever started. The result can be a NULL pointer dereference when\nsomeone accesses /proc/fs/nfsd/reply_cache_stats while nfsd is still\nshut down.\n\nThis is a regression and a user-triggerable oops in the right situation:\n\n- non-x86_64 arch\n- /proc/fs/nfsd is mounted in the namespace\n- nfsd is not started in the namespace\n- unprivileged user calls \"cat /proc/fs/nfsd/reply_cache_stats\"\n\nAlthough this is easy to trigger on some arches (like aarch64), on\nx86_64, calling this_cpu_ptr(NULL) evidently returns a pointer to the\nfixed_percpu_data. That struct looks just enough like a newly\ninitialized percpu var to allow nfsd_reply_cache_stats_show to access\nit without Oopsing.\n\nMove the initialization of the per-net+per-cpu reply-cache counters\nback into nfsd_init_net, while leaving the rest of the reply cache\nallocations to be done at nfsd startup time.\n\nKudos to Eirik who did most of the legwork to track this down.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4e18b58b106e34ac69d3052dd91f520bd83cf2fc"},{"fixed":"3025d489f9c8984d1bf5916c4a20097ed80fca5c"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"70fdee548c036c6bdb496f284c9e78f1654b6dd0"},{"fixed":"8549384d0f65981761fe2077d04fa2a8d37b54e0"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e7e571ed4ec7bb50136233d8e7b986efef2af8c1"},{"fixed":"66a178177b2b3bb1d71e854c5e7bbb320eb0e566"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f5f9d4a314da88c0a5faa6d168bf69081b7a25ae"},{"fixed":"768c408594b52d8531e1a8ab62e5620c19213e73"},{"fixed":"ed9ab7346e908496816cffdecd46932035f66e2e"}]}],"versions":["v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.4.1","v6.4.2","v6.4.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-54276.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.3.0"},{"fixed":"6.4.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-54276.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3025d489f9c8984d1bf5916c4a20097ed80fca5c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/66a178177b2b3bb1d71e854c5e7bbb320eb0e566"},{"type":"WEB","url":"https://git.kernel.org/stable/c/768c408594b52d8531e1a8ab62e5620c19213e73"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8549384d0f65981761fe2077d04fa2a8d37b54e0"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ed9ab7346e908496816cffdecd46932035f66e2e"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/54xxx/CVE-2023-54276.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2023-54276"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/54xxx/CVE-2023-54276.json"}}