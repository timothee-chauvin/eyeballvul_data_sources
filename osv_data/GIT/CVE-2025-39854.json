{"schema_version":"1.7.3","id":"CVE-2025-39854","published":"2025-09-19T15:26:25.989Z","modified":"2025-11-20T10:19:05.703177Z","related":["SUSE-SU-2025:3751-1","SUSE-SU-2025:4057-1"],"summary":"ice: fix NULL access of tx->in_use in ice_ll_ts_intr","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nice: fix NULL access of tx->in_use in ice_ll_ts_intr\n\nRecent versions of the E810 firmware have support for an extra interrupt to\nhandle report of the \"low latency\" Tx timestamps coming from the\nspecialized low latency firmware interface. Instead of polling the\nregisters, software can wait until the low latency interrupt is fired.\n\nThis logic makes use of the Tx timestamp tracking structure, ice_ptp_tx, as\nit uses the same \"ready\" bitmap to track which Tx timestamps complete.\n\nUnfortunately, the ice_ll_ts_intr() function does not check if the\ntracker is initialized before its first access. This results in NULL\ndereference or use-after-free bugs similar to the issues fixed in the\nice_ptp_ts_irq() function.\n\nFix this by only checking the in_use bitmap (and other fields) if the\ntracker is marked as initialized. The reset flow will clear the init field\nunder lock before it tears the tracker down, thus preventing any\nuse-after-free or NULL access.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"82e71b226e0ef770d7bc143701c8b4960b4eb3d5"},{"fixed":"2cde98a02da958357fe240a6ba269b69d913b6ba"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"82e71b226e0ef770d7bc143701c8b4960b4eb3d5"},{"fixed":"923c267bdbb64f65bc1149d184efcf8b047d7d64"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"82e71b226e0ef770d7bc143701c8b4960b4eb3d5"},{"fixed":"f6486338fde3f04ed0ec59fe67a69a208c32734f"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.31","v6.12.32","v6.12.33","v6.12.34","v6.12.35","v6.12.36","v6.12.37","v6.12.38","v6.12.39","v6.12.4","v6.12.40","v6.12.41","v6.12.42","v6.12.43","v6.12.44","v6.12.45","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.16.4","v6.16.5","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.7","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39854.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["142552029710501609564156562977235059439","191360673565770968948262505310939822713","176906201329566486190669219098037968304","162809397702338529375499372616239697207","107322870971735468494765712671216882728","135518599584127086400701229879505084813","158826987370096263955952005624630956271","136849991212119742876232137630012217249"],"threshold":0.9},"id":"CVE-2025-39854-2a6acaa7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923c267bdbb64f65bc1149d184efcf8b047d7d64","target":{"file":"drivers/net/ethernet/intel/ice/ice_main.c"}},{"deprecated":false,"digest":{"line_hashes":["142552029710501609564156562977235059439","191360673565770968948262505310939822713","176906201329566486190669219098037968304","162809397702338529375499372616239697207","107322870971735468494765712671216882728","135518599584127086400701229879505084813","158826987370096263955952005624630956271","136849991212119742876232137630012217249"],"threshold":0.9},"id":"CVE-2025-39854-2e8e24cf","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6486338fde3f04ed0ec59fe67a69a208c32734f","target":{"file":"drivers/net/ethernet/intel/ice/ice_main.c"}},{"deprecated":false,"digest":{"function_hash":"255371344894673580067243319365891731999","length":695},"id":"CVE-2025-39854-4d5a8ab0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6486338fde3f04ed0ec59fe67a69a208c32734f","target":{"file":"drivers/net/ethernet/intel/ice/ice_main.c","function":"ice_ll_ts_intr"}},{"deprecated":false,"digest":{"function_hash":"255371344894673580067243319365891731999","length":695},"id":"CVE-2025-39854-7d2fad32","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@923c267bdbb64f65bc1149d184efcf8b047d7d64","target":{"file":"drivers/net/ethernet/intel/ice/ice_main.c","function":"ice_ll_ts_intr"}},{"deprecated":false,"digest":{"function_hash":"255371344894673580067243319365891731999","length":695},"id":"CVE-2025-39854-7d52cfc4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2cde98a02da958357fe240a6ba269b69d913b6ba","target":{"file":"drivers/net/ethernet/intel/ice/ice_main.c","function":"ice_ll_ts_intr"}},{"deprecated":false,"digest":{"line_hashes":["142552029710501609564156562977235059439","191360673565770968948262505310939822713","176906201329566486190669219098037968304","162809397702338529375499372616239697207","107322870971735468494765712671216882728","135518599584127086400701229879505084813","158826987370096263955952005624630956271","136849991212119742876232137630012217249"],"threshold":0.9},"id":"CVE-2025-39854-c6db5ffb","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2cde98a02da958357fe240a6ba269b69d913b6ba","target":{"file":"drivers/net/ethernet/intel/ice/ice_main.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.12.46"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.16.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39854.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2cde98a02da958357fe240a6ba269b69d913b6ba"},{"type":"WEB","url":"https://git.kernel.org/stable/c/923c267bdbb64f65bc1149d184efcf8b047d7d64"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f6486338fde3f04ed0ec59fe67a69a208c32734f"}]}