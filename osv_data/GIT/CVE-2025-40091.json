{"schema_version":"1.7.3","id":"CVE-2025-40091","published":"2025-10-30T09:47:59Z","modified":"2025-10-30T20:04:43.114603Z","summary":"ixgbe: fix too early devlink_free() in ixgbe_remove()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nixgbe: fix too early devlink_free() in ixgbe_remove()\n\nSince ixgbe_adapter is embedded in devlink, calling devlink_free()\nprematurely in the ixgbe_remove() path can lead to UAF. Move devlink_free()\nto the end.\n\nKASAN report:\n\n BUG: KASAN: use-after-free in ixgbe_reset_interrupt_capability+0x140/0x180 [ixgbe]\n Read of size 8 at addr ffff0000adf813e0 by task bash/2095\n CPU: 1 UID: 0 PID: 2095 Comm: bash Tainted: G S  6.17.0-rc2-tnguy.net-queue+ #1 PREEMPT(full)\n [...]\n Call trace:\n  show_stack+0x30/0x90 (C)\n  dump_stack_lvl+0x9c/0xd0\n  print_address_description.constprop.0+0x90/0x310\n  print_report+0x104/0x1f0\n  kasan_report+0x88/0x180\n  __asan_report_load8_noabort+0x20/0x30\n  ixgbe_reset_interrupt_capability+0x140/0x180 [ixgbe]\n  ixgbe_clear_interrupt_scheme+0xf8/0x130 [ixgbe]\n  ixgbe_remove+0x2d0/0x8c0 [ixgbe]\n  pci_device_remove+0xa0/0x220\n  device_remove+0xb8/0x170\n  device_release_driver_internal+0x318/0x490\n  device_driver_detach+0x40/0x68\n  unbind_store+0xec/0x118\n  drv_attr_store+0x64/0xb8\n  sysfs_kf_write+0xcc/0x138\n  kernfs_fop_write_iter+0x294/0x440\n  new_sync_write+0x1fc/0x588\n  vfs_write+0x480/0x6a0\n  ksys_write+0xf0/0x1e0\n  __arm64_sys_write+0x70/0xc0\n  invoke_syscall.constprop.0+0xcc/0x280\n  el0_svc_common.constprop.0+0xa8/0x248\n  do_el0_svc+0x44/0x68\n  el0_svc+0x54/0x160\n  el0t_64_sync_handler+0xa0/0xe8\n  el0t_64_sync+0x1b0/0x1b8","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a0285236ab93fdfdd1008afaa04561d142d6c276"},{"fixed":"df445969aa727cd64f3f29dc1f85fb60aca238d1"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a0285236ab93fdfdd1008afaa04561d142d6c276"},{"fixed":"5feef67b646d8f5064bac288e22204ffba2b9a4a"}]}],"versions":["v6.15","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.17.3","v6.17.4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40091.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"317239187032405608314592137711123560767","length":1794},"id":"CVE-2025-40091-1090749d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5feef67b646d8f5064bac288e22204ffba2b9a4a","target":{"file":"drivers/net/ethernet/intel/ixgbe/ixgbe_main.c","function":"ixgbe_remove"}},{"deprecated":false,"digest":{"function_hash":"164409940668515926976273343170529838772","length":1767},"id":"CVE-2025-40091-9b441eae","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@df445969aa727cd64f3f29dc1f85fb60aca238d1","target":{"file":"drivers/net/ethernet/intel/ixgbe/ixgbe_main.c","function":"ixgbe_remove"}},{"deprecated":false,"digest":{"line_hashes":["56793915142209047582128001787812702564","28018563781812152528485077329435508082","197836945052386064850908089104070218851","329716273956857677571875096673263604417","161897730280381880148326779576344118356","226352887296896313370071123819762291126","66136638295472810631099543355017841309","50907831651379354390425958346146676052"],"threshold":0.9},"id":"CVE-2025-40091-a07f6779","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@df445969aa727cd64f3f29dc1f85fb60aca238d1","target":{"file":"drivers/net/ethernet/intel/ixgbe/ixgbe_main.c"}},{"deprecated":false,"digest":{"line_hashes":["56793915142209047582128001787812702564","28018563781812152528485077329435508082","197836945052386064850908089104070218851","329716273956857677571875096673263604417","161897730280381880148326779576344118356","226352887296896313370071123819762291126","66136638295472810631099543355017841309","50907831651379354390425958346146676052"],"threshold":0.9},"id":"CVE-2025-40091-ca277e15","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5feef67b646d8f5064bac288e22204ffba2b9a4a","target":{"file":"drivers/net/ethernet/intel/ixgbe/ixgbe_main.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.17.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40091.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/5feef67b646d8f5064bac288e22204ffba2b9a4a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/df445969aa727cd64f3f29dc1f85fb60aca238d1"}]}