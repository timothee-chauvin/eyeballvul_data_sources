{"schema_version":"1.7.3","id":"CVE-2023-40029","published":"2023-09-07T22:11:56Z","modified":"2025-11-04T20:12:14.790576Z","aliases":["BIT-argo-cd-2023-40029","GHSA-fwr2-64vr-xv9m","GO-2023-2049"],"summary":"Cluster secret might leak in cluster details page in Argo CD","details":"Argo CD is a declarative continuous deployment for Kubernetes. Argo CD Cluster secrets might be managed declaratively using Argo CD / kubectl apply. As a result, the full secret body is stored in`kubectl.kubernetes.io/last-applied-configuration` annotation. pull request #7139 introduced the ability to manage cluster labels and annotations. Since clusters are stored as secrets it also exposes the `kubectl.kubernetes.io/last-applied-configuration` annotation which includes full secret body. In order to view the cluster annotations via the Argo CD API, the user must have `clusters, get` RBAC access. **Note:** In many cases, cluster secrets do not contain any actually-secret information. But sometimes, as in bearer-token auth, the contents might be very sensitive. The bug has been patched in versions 2.8.3, 2.7.14, and 2.6.15. Users are advised to upgrade. Users unable to upgrade should update/deploy cluster secret with `server-side-apply` flag which does not use or rely on `kubectl.kubernetes.io/last-applied-configuration` annotation. Note: annotation for existing secrets will require manual removal.\n\n","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/argoproj/argo-cd","events":[{"introduced":"6da92a8e8103ce4145bb0fe2b7e952be79c9ff0a"},{"fixed":"2f7922be9c8f364fec435eec4860b49279be77da"}],"database_specific":{"versions":[{"introduced":"2.2.0"},{"fixed":"2.6.15"}]}},{"type":"GIT","repo":"https://github.com/argoproj/argo-cd","events":[{"introduced":"c592219140e5f48b6849f3f9a8f7aed6047d54fa"},{"fixed":"a40c95a6383baa0d9f670586a5c295021f59337c"}],"database_specific":{"versions":[{"introduced":"2.7.0"},{"fixed":"2.7.14"}]}},{"type":"GIT","repo":"https://github.com/argoproj/argo-cd","events":[{"introduced":"804d4b8ca6bc4c2cf02c5c971aa923ec5b8623f0"},{"fixed":"77556d9e64304c27c718bb0794676713628e435e"}],"database_specific":{"versions":[{"introduced":"2.8.0"},{"fixed":"2.8.3"}]}}],"versions":["v2.7.0","v2.7.1","v2.7.10","v2.7.11","v2.7.12","v2.7.13","v2.7.2","v2.7.3","v2.7.4","v2.7.5","v2.7.6","v2.7.7","v2.7.8","v2.7.9","v2.8.0","v2.8.1","v2.8.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-40029.json"}}],"references":[{"type":"FIX","url":"https://github.com/argoproj/argo-cd/commit/4b2e5b06bff2ffd8ed1970654ddd8e55fc4a41c4"},{"type":"FIX","url":"https://github.com/argoproj/argo-cd/pull/7139"},{"type":"ADVISORY","url":"https://github.com/argoproj/argo-cd/security/advisories/GHSA-fwr2-64vr-xv9m"}],"database_specific":{"cwe_ids":["CWE-200"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L"}]}