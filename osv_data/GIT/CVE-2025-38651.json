{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38651.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "120463826979811225554874912058835588405",
                "55237253425887115431034235158143886961",
                "170737811569694749490501757561171868935",
                "151762412986599155588439025506225310211",
                "330309097908778275542999951794379451115",
                "309810372831288358418862291905445053327",
                "322482919202615245163776103462261342459",
                "274306303754194715995379555467006261518",
                "188043627980335025746706138250016437331",
                "337545550370177154493684833097276138571",
                "168642734891731043542474117471699177102",
                "173656190465650855370165451599155155376",
                "227935083346833979549072723336433588241",
                "92357394893448850705663201477282752539",
                "280983904106056419028497172720505204710",
                "90809427411689465290343213294989227841",
                "67501361057452879237454207752180943411",
                "262312188514720742404205003955925466422",
                "310089179675092951704074028456283276935",
                "274334364732502970229936296688946511913",
                "174599028209380446263182052217811337046",
                "153567500720775570551925900960938924739",
                "147898514810461405655061912679758333177",
                "249159730150649677027435466066395232504",
                "322482919202615245163776103462261342459",
                "297530028941771048106319114223599072388",
                "194159393504104642271439618902879628594",
                "210162937348816763779622804307675426021",
                "181066643652245397585049696997537167599",
                "95547908865844582334395738827386229037",
                "227935083346833979549072723336433588241",
                "314570068288219818668668077906137868004",
                "82038469740804274287743223384741140839",
                "281916698310080466512244341371759861179",
                "100606547992179729448377527137378472841",
                "178660044690930818455277307223866690974",
                "174179816768826295436485073554308924479",
                "66042275458884124197781430511925035286",
                "309338616800984581633656526349812673954",
                "327600341292992650192215356566221707392",
                "244968710187194350961602452683583149753",
                "87411605518127754173871819304501676559",
                "238526199979257540331798810610878103087",
                "130751681724962647813512740405578966098",
                "209549017488526866516669087277040384220",
                "46135351097227755059726284373656323374",
                "297617213714536090788240560211190641589",
                "162249827478090246182314659420886309933",
                "284504333276325397151424323070483677538",
                "266866050865093399928428553942542065675",
                "86089177100481818828830287468697769728",
                "15989059466148664465665678380956380728",
                "326339139842752737348560440636990930096",
                "215363552100625812571322300095659021261",
                "227935083346833979549072723336433588241",
                "50891941683474880564730275931294957019",
                "6580879226202487295432787077891718709"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-38651-2000c31f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@127183361b69dbb7ac3246ad4726f93400481249",
            "target": {
              "file": "security/landlock/id.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "120463826979811225554874912058835588405",
                "55237253425887115431034235158143886961",
                "170737811569694749490501757561171868935",
                "151762412986599155588439025506225310211",
                "330309097908778275542999951794379451115",
                "309810372831288358418862291905445053327",
                "322482919202615245163776103462261342459",
                "274306303754194715995379555467006261518",
                "188043627980335025746706138250016437331",
                "337545550370177154493684833097276138571",
                "168642734891731043542474117471699177102",
                "173656190465650855370165451599155155376",
                "227935083346833979549072723336433588241",
                "92357394893448850705663201477282752539",
                "280983904106056419028497172720505204710",
                "90809427411689465290343213294989227841",
                "67501361057452879237454207752180943411",
                "262312188514720742404205003955925466422",
                "310089179675092951704074028456283276935",
                "274334364732502970229936296688946511913",
                "174599028209380446263182052217811337046",
                "153567500720775570551925900960938924739",
                "147898514810461405655061912679758333177",
                "249159730150649677027435466066395232504",
                "322482919202615245163776103462261342459",
                "297530028941771048106319114223599072388",
                "194159393504104642271439618902879628594",
                "210162937348816763779622804307675426021",
                "181066643652245397585049696997537167599",
                "95547908865844582334395738827386229037",
                "227935083346833979549072723336433588241",
                "314570068288219818668668077906137868004",
                "82038469740804274287743223384741140839",
                "281916698310080466512244341371759861179",
                "100606547992179729448377527137378472841",
                "178660044690930818455277307223866690974",
                "174179816768826295436485073554308924479",
                "66042275458884124197781430511925035286",
                "309338616800984581633656526349812673954",
                "327600341292992650192215356566221707392",
                "244968710187194350961602452683583149753",
                "87411605518127754173871819304501676559",
                "238526199979257540331798810610878103087",
                "130751681724962647813512740405578966098",
                "209549017488526866516669087277040384220",
                "46135351097227755059726284373656323374",
                "297617213714536090788240560211190641589",
                "162249827478090246182314659420886309933",
                "284504333276325397151424323070483677538",
                "266866050865093399928428553942542065675",
                "86089177100481818828830287468697769728",
                "15989059466148664465665678380956380728",
                "326339139842752737348560440636990930096",
                "215363552100625812571322300095659021261",
                "227935083346833979549072723336433588241",
                "50891941683474880564730275931294957019",
                "6580879226202487295432787077891718709"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-38651-237eade8",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7d9ec2cfe12dd0d7c1a58213b9bef1bec66a3189",
            "target": {
              "file": "security/landlock/id.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "120463826979811225554874912058835588405",
                "55237253425887115431034235158143886961",
                "170737811569694749490501757561171868935",
                "151762412986599155588439025506225310211",
                "330309097908778275542999951794379451115",
                "309810372831288358418862291905445053327",
                "322482919202615245163776103462261342459",
                "274306303754194715995379555467006261518",
                "188043627980335025746706138250016437331",
                "337545550370177154493684833097276138571",
                "168642734891731043542474117471699177102",
                "173656190465650855370165451599155155376",
                "227935083346833979549072723336433588241",
                "92357394893448850705663201477282752539",
                "280983904106056419028497172720505204710",
                "90809427411689465290343213294989227841",
                "67501361057452879237454207752180943411",
                "262312188514720742404205003955925466422",
                "310089179675092951704074028456283276935",
                "274334364732502970229936296688946511913",
                "174599028209380446263182052217811337046",
                "153567500720775570551925900960938924739",
                "147898514810461405655061912679758333177",
                "249159730150649677027435466066395232504",
                "322482919202615245163776103462261342459",
                "297530028941771048106319114223599072388",
                "194159393504104642271439618902879628594",
                "210162937348816763779622804307675426021",
                "181066643652245397585049696997537167599",
                "95547908865844582334395738827386229037",
                "227935083346833979549072723336433588241",
                "314570068288219818668668077906137868004",
                "82038469740804274287743223384741140839",
                "281916698310080466512244341371759861179",
                "100606547992179729448377527137378472841",
                "178660044690930818455277307223866690974",
                "174179816768826295436485073554308924479",
                "66042275458884124197781430511925035286",
                "309338616800984581633656526349812673954",
                "327600341292992650192215356566221707392",
                "244968710187194350961602452683583149753",
                "87411605518127754173871819304501676559",
                "238526199979257540331798810610878103087",
                "130751681724962647813512740405578966098",
                "209549017488526866516669087277040384220",
                "46135351097227755059726284373656323374",
                "297617213714536090788240560211190641589",
                "162249827478090246182314659420886309933",
                "284504333276325397151424323070483677538",
                "266866050865093399928428553942542065675",
                "86089177100481818828830287468697769728",
                "15989059466148664465665678380956380728",
                "326339139842752737348560440636990930096",
                "215363552100625812571322300095659021261",
                "227935083346833979549072723336433588241",
                "50891941683474880564730275931294957019",
                "6580879226202487295432787077891718709"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2025-38651-dfdb4f20",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e0a69cf2c03e61bd8069becb97f66c173d0d1fa1",
            "target": {
              "file": "security/landlock/id.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "d9d2a68ed44bbae598a81cb95e0746fa6b13b57f"
            },
            {
              "fixed": "127183361b69dbb7ac3246ad4726f93400481249"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "d9d2a68ed44bbae598a81cb95e0746fa6b13b57f"
            },
            {
              "fixed": "7d9ec2cfe12dd0d7c1a58213b9bef1bec66a3189"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "d9d2a68ed44bbae598a81cb95e0746fa6b13b57f"
            },
            {
              "fixed": "e0a69cf2c03e61bd8069becb97f66c173d0d1fa1"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.14",
        "v6.14-rc6",
        "v6.14-rc7",
        "v6.15",
        "v6.15-rc1",
        "v6.15-rc2",
        "v6.15-rc3",
        "v6.15-rc4",
        "v6.15-rc5",
        "v6.15-rc6",
        "v6.15-rc7",
        "v6.15.1",
        "v6.15.2",
        "v6.15.3",
        "v6.15.4",
        "v6.15.5",
        "v6.15.6",
        "v6.15.7",
        "v6.15.8",
        "v6.15.9",
        "v6.16",
        "v6.16-rc1",
        "v6.16-rc2",
        "v6.16-rc3",
        "v6.16-rc4",
        "v6.16-rc5",
        "v6.16-rc6",
        "v6.16-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38651.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.15.0"
            },
            {
              "fixed": "6.15.10"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.16.0"
            },
            {
              "fixed": "6.16.1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nlandlock: Fix warning from KUnit tests\n\nget_id_range() expects a positive value as first argument but\nget_random_u8() can return 0.  Fix this by clamping it.\n\nValidated by running the test in a for loop for 1000 times.\n\nNote that MAX() is wrong as it is only supposed to be used for\nconstants, but max() is good here.\n\n  [..]     ok 9 test_range2_rand1\n  [..]     ok 10 test_range2_rand2\n  [..]     ok 11 test_range2_rand15\n  [..] ------------[ cut here ]------------\n  [..] WARNING: CPU: 6 PID: 104 at security/landlock/id.c:99 test_range2_rand16 (security/landlock/id.c:99 (discriminator 1) security/landlock/id.c:234 (discriminator 1))\n  [..] Modules linked in:\n  [..] CPU: 6 UID: 0 PID: 104 Comm: kunit_try_catch Tainted: G                 N  6.16.0-rc1-dev-00001-g314a2f98b65f #1 PREEMPT(undef)\n  [..] Tainted: [N]=TEST\n  [..] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\n  [..] RIP: 0010:test_range2_rand16 (security/landlock/id.c:99 (discriminator 1) security/landlock/id.c:234 (discriminator 1))\n  [..] Code: 49 c7 c0 10 70 30 82 4c 89 ff 48 c7 c6 a0 63 1e 83 49 c7 45 a0 e0 63 1e 83 e8 3f 95 17 00 e9 1f ff ff ff 0f 0b e9 df fd ff ff <0f> 0b ba 01 00 00 00 e9 68 fe ff ff 49 89 45 a8 49 8d 4d a0 45 31\n\n  [..] RSP: 0000:ffff888104eb7c78 EFLAGS: 00010246\n  [..] RAX: 0000000000000000 RBX: 000000000870822c RCX: 0000000000000000\n            ^^^^^^^^^^^^^^^^\n  [..]\n  [..] Call Trace:\n  [..]\n  [..] ---[ end trace 0000000000000000 ]---\n  [..]     ok 12 test_range2_rand16\n  [..] # landlock_id: pass:12 fail:0 skip:0 total:12\n  [..] # Totals: pass:12 fail:0 skip:0 total:12\n  [..] ok 1 landlock_id\n\n[mic: Minor cosmetic improvements]",
  "id": "CVE-2025-38651",
  "modified": "2025-10-22T14:38:36.251248Z",
  "published": "2025-08-22T16:00:55Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/127183361b69dbb7ac3246ad4726f93400481249"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7d9ec2cfe12dd0d7c1a58213b9bef1bec66a3189"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e0a69cf2c03e61bd8069becb97f66c173d0d1fa1"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "landlock: Fix warning from KUnit tests"
}