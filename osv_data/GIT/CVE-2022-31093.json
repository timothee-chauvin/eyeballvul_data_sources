{"schema_version":"1.7.3","id":"CVE-2022-31093","published":"2022-06-27T21:30:20Z","modified":"2025-10-21T19:33:25Z","aliases":["GHSA-g5fm-jp9v-2432"],"summary":"Improper Handling of `callbackUrl` parameter in next-auth","details":"NextAuth.js is a complete open source authentication solution for Next.js applications. In affected versions an attacker can send a request to an app using NextAuth.js with an invalid `callbackUrl` query parameter, which internally is converted to a `URL` object. The URL instantiation would fail due to a malformed URL being passed into the constructor, causing it to throw an unhandled error which led to the **API route handler timing out and logging in to fail**. This has been remedied in versions 3.29.5 and 4.5.0. If for some reason you cannot upgrade, the workaround requires you to rely on Advanced Initialization. Please see the documentation for more.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/nextauthjs/next-auth","events":[{"introduced":"29b67b664785ba086008159e69c5e22969f69b48"},{"fixed":"8c5d9faad65931e478147412fd905bdd70aa0a4c"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-31093.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432"},{"type":"FIX","url":"https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85"},{"type":"FIX","url":"https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6"},{"type":"WEB","url":"https://next-auth.js.org/configuration/initialization#advanced-initialization"}],"database_specific":{"cwe_ids":["CWE-754"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}