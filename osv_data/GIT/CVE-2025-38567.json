{"schema_version":"1.7.3","id":"CVE-2025-38567","published":"2025-08-19T17:02:48.306Z","modified":"2025-11-20T09:35:20.186428Z","summary":"nfsd: avoid ref leak in nfsd_open_local_fh()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnfsd: avoid ref leak in nfsd_open_local_fh()\n\nIf two calls to nfsd_open_local_fh() race and both successfully call\nnfsd_file_acquire_local(), they will both get an extra reference to the\nnet to accompany the file reference stored in *pnf.\n\nOne of them will fail to store (using xchg()) the file reference in\n*pnf and will drop that reference but WON'T drop the accompanying\nreference to the net.  This leak means that when the nfs server is shut\ndown it will hang in nfsd_shutdown_net() waiting for\n&nn->nfsd_net_free_done.\n\nThis patch adds the missing nfsd_net_put().","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"986a21ace186433e0397a59491646edad8c8d636"},{"fixed":"fcb0a417fddb605530c4837e0996620f8ed38023"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e6f7e1487ab528a6c653bd0d42812ff2942846cd"},{"fixed":"c4bf8f26c51e51bbb840935659a7b3b65a802c07"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e6f7e1487ab528a6c653bd0d42812ff2942846cd"},{"fixed":"e5a73150776f18547ee685c9f6bfafe549714899"}]}],"versions":["v6.15","v6.15.3","v6.15.4","v6.15.5","v6.15.6","v6.15.7","v6.15.8","v6.15.9","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38567.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["90291735953083233393513918935433515529","12385058157798611532258842402798276664","19822856478404890597069123736318490530","211117914066836925030811061985798806599"],"threshold":0.9},"id":"CVE-2025-38567-4891e161","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcb0a417fddb605530c4837e0996620f8ed38023","target":{"file":"fs/nfsd/localio.c"}},{"deprecated":false,"digest":{"function_hash":"64759058064025113052291479695530852897","length":1346},"id":"CVE-2025-38567-51f1bb64","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e5a73150776f18547ee685c9f6bfafe549714899","target":{"file":"fs/nfsd/localio.c","function":"nfsd_open_local_fh"}},{"deprecated":false,"digest":{"line_hashes":["90291735953083233393513918935433515529","12385058157798611532258842402798276664","19822856478404890597069123736318490530","211117914066836925030811061985798806599"],"threshold":0.9},"id":"CVE-2025-38567-7b8bafa3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e5a73150776f18547ee685c9f6bfafe549714899","target":{"file":"fs/nfsd/localio.c"}},{"deprecated":false,"digest":{"function_hash":"64759058064025113052291479695530852897","length":1346},"id":"CVE-2025-38567-891d1bf4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@fcb0a417fddb605530c4837e0996620f8ed38023","target":{"file":"fs/nfsd/localio.c","function":"nfsd_open_local_fh"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.15.10"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.16.1"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38567.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c4bf8f26c51e51bbb840935659a7b3b65a802c07"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e5a73150776f18547ee685c9f6bfafe549714899"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fcb0a417fddb605530c4837e0996620f8ed38023"}]}