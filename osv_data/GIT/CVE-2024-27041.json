{"schema_version":"1.7.3","id":"CVE-2024-27041","published":"2024-05-01T12:54:04Z","modified":"2025-10-21T20:29:43.596651Z","related":["SUSE-SU-2024:1644-1","SUSE-SU-2024:1659-1","SUSE-SU-2024:1663-1"],"summary":"drm/amd/display: fix NULL checks for adev->dm.dc in amdgpu_dm_fini()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amd/display: fix NULL checks for adev->dm.dc in amdgpu_dm_fini()\n\nSince 'adev->dm.dc' in amdgpu_dm_fini() might turn out to be NULL\nbefore the call to dc_enable_dmub_notifications(), check\nbeforehand to ensure there will not be a possible NULL-ptr-deref\nthere.\n\nAlso, since commit 1e88eb1b2c25 (\"drm/amd/display: Drop\nCONFIG_DRM_AMD_DC_HDCP\") there are two separate checks for NULL in\n'adev->dm.dc' before dc_deinit_callbacks() and dc_dmub_srv_destroy().\nClean up by combining them all under one 'if'.\n\nFound by Linux Verification Center (linuxtesting.org) with static\nanalysis tool SVACE.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"81927e2808be5adace93c2012d45d6938d3a7aa0"},{"fixed":"e040f1fbe9abae91b12b074cfc3bbb5367b79811"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"81927e2808be5adace93c2012d45d6938d3a7aa0"},{"fixed":"ca2eb375db76fd50f31afdd67d6ca4f833254957"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"81927e2808be5adace93c2012d45d6938d3a7aa0"},{"fixed":"1c62697e4086de988b31124fb8c79c244ea05f2b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"81927e2808be5adace93c2012d45d6938d3a7aa0"},{"fixed":"2a3cfb9a24a28da9cc13d2c525a76548865e182c"}]}],"versions":["v5.12","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.3","v6.6.4","v6.6.5","v6.6.6","v6.6.7","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.7.1","v6.7.10","v6.7.2","v6.7.3","v6.7.4","v6.7.5","v6.7.6","v6.7.7","v6.7.8","v6.7.9","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.8.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27041.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"325260333657704817303350737487305860801","length":2117},"id":"CVE-2024-27041-12f4124e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2a3cfb9a24a28da9cc13d2c525a76548865e182c","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c","function":"amdgpu_dm_fini"}},{"deprecated":false,"digest":{"line_hashes":["253306377228785317201741430400349718719","244035775861787364360766342519372553138","92227694113106304840309798259673355774","266535364442538255534931127826590315499","142927587882935910892053931440000809523","267644886376965320705582120150004585230","159381240767019745872898500894997942957","170042385031794975728537227504306813531","71791350409166925135594851364482082847","201239699430663653521906656788999916325","279527112930576130651611943021558137545","150438655657348215389691868720879828041"],"threshold":0.9},"id":"CVE-2024-27041-2aacea78","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ca2eb375db76fd50f31afdd67d6ca4f833254957","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c"}},{"deprecated":false,"digest":{"function_hash":"325260333657704817303350737487305860801","length":2117},"id":"CVE-2024-27041-369f5daf","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ca2eb375db76fd50f31afdd67d6ca4f833254957","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c","function":"amdgpu_dm_fini"}},{"deprecated":false,"digest":{"function_hash":"296818637938111736544966053683672257279","length":2137},"id":"CVE-2024-27041-4b5c2e9a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c62697e4086de988b31124fb8c79c244ea05f2b","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c","function":"amdgpu_dm_fini"}},{"deprecated":false,"digest":{"line_hashes":["253306377228785317201741430400349718719","244035775861787364360766342519372553138","92227694113106304840309798259673355774","266535364442538255534931127826590315499","142927587882935910892053931440000809523","267644886376965320705582120150004585230","159381240767019745872898500894997942957","170042385031794975728537227504306813531","71791350409166925135594851364482082847","201239699430663653521906656788999916325","279527112930576130651611943021558137545","150438655657348215389691868720879828041"],"threshold":0.9},"id":"CVE-2024-27041-6765b3b6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2a3cfb9a24a28da9cc13d2c525a76548865e182c","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c"}},{"deprecated":false,"digest":{"line_hashes":["253306377228785317201741430400349718719","244035775861787364360766342519372553138","92227694113106304840309798259673355774","266535364442538255534931127826590315499","142927587882935910892053931440000809523","267644886376965320705582120150004585230","159381240767019745872898500894997942957","170042385031794975728537227504306813531","71791350409166925135594851364482082847","201239699430663653521906656788999916325","279527112930576130651611943021558137545","150438655657348215389691868720879828041"],"threshold":0.9},"id":"CVE-2024-27041-7983975d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e040f1fbe9abae91b12b074cfc3bbb5367b79811","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c"}},{"deprecated":false,"digest":{"line_hashes":["253306377228785317201741430400349718719","244035775861787364360766342519372553138","92227694113106304840309798259673355774","266535364442538255534931127826590315499","142927587882935910892053931440000809523","267644886376965320705582120150004585230","159381240767019745872898500894997942957","170042385031794975728537227504306813531","71791350409166925135594851364482082847","201239699430663653521906656788999916325","279527112930576130651611943021558137545","150438655657348215389691868720879828041"],"threshold":0.9},"id":"CVE-2024-27041-da7b76f1","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1c62697e4086de988b31124fb8c79c244ea05f2b","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c"}},{"deprecated":false,"digest":{"function_hash":"325260333657704817303350737487305860801","length":2117},"id":"CVE-2024-27041-ff87015f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e040f1fbe9abae91b12b074cfc3bbb5367b79811","target":{"file":"drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c","function":"amdgpu_dm_fini"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.14.0"},{"fixed":"6.6.23"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.7.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.8.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27041.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1c62697e4086de988b31124fb8c79c244ea05f2b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2a3cfb9a24a28da9cc13d2c525a76548865e182c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ca2eb375db76fd50f31afdd67d6ca4f833254957"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e040f1fbe9abae91b12b074cfc3bbb5367b79811"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}