{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27066.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "71829946791448367090746279378187527795",
              "length": 2684.0
            },
            "id": "CVE-2024-27066-01488c7d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@51bacd9d29bf98c3ebc65e4a0477bb86306b4140",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "virtqueue_add_indirect_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "71829946791448367090746279378187527795",
              "length": 2684.0
            },
            "id": "CVE-2024-27066-0b945a98",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d5c0ed17fea60cca9bc3bf1278b49ba79242bbcd",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "virtqueue_add_indirect_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "339596633029749655932058025881675999130",
                "17203958994190351722313077617563855415",
                "285583612751536254068160691787444730861",
                "334745877579348348367438895779716618478",
                "268378609346611359885301091376258517436",
                "277441548818140065125347502481147972544",
                "223944282765193062518697613519352444945",
                "150474774105695447911702629202024039428",
                "329688931314770791425706417645133332093",
                "329785554173428548153484240107863021655",
                "263788721602803074223913631750859477605",
                "52045156199426326465155419819530653745"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27066-1844d98a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d5c0ed17fea60cca9bc3bf1278b49ba79242bbcd",
            "target": {
              "file": "drivers/virtio/virtio_ring.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "261567477688692479740052905378930828421",
              "length": 942.0
            },
            "id": "CVE-2024-27066-22bb012d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e142169aca5546ae6619c39a575cda8105362100",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "detach_buf_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "88847965938049743274555965940710532401",
              "length": 3119.0
            },
            "id": "CVE-2024-27066-282e766c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e142169aca5546ae6619c39a575cda8105362100",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "virtqueue_add_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "339596633029749655932058025881675999130",
                "17203958994190351722313077617563855415",
                "285583612751536254068160691787444730861",
                "334745877579348348367438895779716618478",
                "268378609346611359885301091376258517436",
                "277441548818140065125347502481147972544",
                "223944282765193062518697613519352444945",
                "150474774105695447911702629202024039428",
                "329688931314770791425706417645133332093",
                "329785554173428548153484240107863021655",
                "263788721602803074223913631750859477605",
                "52045156199426326465155419819530653745"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27066-6ae82468",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@51bacd9d29bf98c3ebc65e4a0477bb86306b4140",
            "target": {
              "file": "drivers/virtio/virtio_ring.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "88847965938049743274555965940710532401",
              "length": 3119.0
            },
            "id": "CVE-2024-27066-6b87066e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d5c0ed17fea60cca9bc3bf1278b49ba79242bbcd",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "virtqueue_add_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "88847965938049743274555965940710532401",
              "length": 3119.0
            },
            "id": "CVE-2024-27066-8cd0f11b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@51bacd9d29bf98c3ebc65e4a0477bb86306b4140",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "virtqueue_add_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "261567477688692479740052905378930828421",
              "length": 942.0
            },
            "id": "CVE-2024-27066-92284701",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@51bacd9d29bf98c3ebc65e4a0477bb86306b4140",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "detach_buf_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "261567477688692479740052905378930828421",
              "length": 942.0
            },
            "id": "CVE-2024-27066-9b149c63",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d5c0ed17fea60cca9bc3bf1278b49ba79242bbcd",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "detach_buf_packed"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "339596633029749655932058025881675999130",
                "17203958994190351722313077617563855415",
                "285583612751536254068160691787444730861",
                "334745877579348348367438895779716618478",
                "268378609346611359885301091376258517436",
                "277441548818140065125347502481147972544",
                "223944282765193062518697613519352444945",
                "150474774105695447911702629202024039428",
                "329688931314770791425706417645133332093",
                "329785554173428548153484240107863021655",
                "263788721602803074223913631750859477605",
                "52045156199426326465155419819530653745"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-27066-bd13a0df",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e142169aca5546ae6619c39a575cda8105362100",
            "target": {
              "file": "drivers/virtio/virtio_ring.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "71829946791448367090746279378187527795",
              "length": 2684.0
            },
            "id": "CVE-2024-27066-d4bbafd7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e142169aca5546ae6619c39a575cda8105362100",
            "target": {
              "file": "drivers/virtio/virtio_ring.c",
              "function": "virtqueue_add_indirect_packed"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "b319940f83c21bb4c1fabffe68a862be879a6193"
            },
            {
              "fixed": "e142169aca5546ae6619c39a575cda8105362100"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "b319940f83c21bb4c1fabffe68a862be879a6193"
            },
            {
              "fixed": "75450ff8c6fe8755bf5b139b238eaf9739cfd64e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "b319940f83c21bb4c1fabffe68a862be879a6193"
            },
            {
              "fixed": "51bacd9d29bf98c3ebc65e4a0477bb86306b4140"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "b319940f83c21bb4c1fabffe68a862be879a6193"
            },
            {
              "fixed": "d5c0ed17fea60cca9bc3bf1278b49ba79242bbcd"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.10",
        "v6.7.2",
        "v6.7.3",
        "v6.7.4",
        "v6.7.5",
        "v6.7.6",
        "v6.7.7",
        "v6.7.8",
        "v6.7.9",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-27066.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.23"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.11"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.8.0"
            },
            {
              "fixed": "6.8.2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtio: packed: fix unmap leak for indirect desc table\n\nWhen use_dma_api and premapped are true, then the do_unmap is false.\n\nBecause the do_unmap is false, vring_unmap_extra_packed is not called by\ndetach_buf_packed.\n\n  if (unlikely(vq->do_unmap)) {\n                curr = id;\n                for (i = 0; i < state->num; i++) {\n                        vring_unmap_extra_packed(vq,\n                                                 &vq->packed.desc_extra[curr]);\n                        curr = vq->packed.desc_extra[curr].next;\n                }\n  }\n\nSo the indirect desc table is not unmapped. This causes the unmap leak.\n\nSo here, we check vq->use_dma_api instead. Synchronously, dma info is\nupdated based on use_dma_api judgment\n\nThis bug does not occur, because no driver use the premapped with\nindirect.",
  "id": "CVE-2024-27066",
  "modified": "2025-10-15T10:25:12.412673Z",
  "published": "2024-05-01T13:04:12Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/51bacd9d29bf98c3ebc65e4a0477bb86306b4140"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/75450ff8c6fe8755bf5b139b238eaf9739cfd64e"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d5c0ed17fea60cca9bc3bf1278b49ba79242bbcd"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e142169aca5546ae6619c39a575cda8105362100"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "virtio: packed: fix unmap leak for indirect desc table"
}