{"schema_version":"1.7.3","id":"CVE-2017-15924","published":"2017-10-27T16:29:00Z","modified":"2025-10-21T04:13:59.915029Z","related":["MGASA-2017-0436","openSUSE-SU-2024:11379-1"],"details":"In manager.c in ss-manager in shadowsocks-libev 3.1.0, improper parsing allows command injection via shell metacharacters in a JSON configuration request received via 127.0.0.1 UDP traffic, related to the add_server, build_config, and construct_command_line functions.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/shadowsocks/shadowsocks-libev","events":[{"introduced":"0"},{"fixed":"c67d275803dc6ea22c558d06b1f7ba9f94cd8de3"}]}],"versions":["v1.3","v1.3.2","v1.4.0","v1.4.1","v1.4.2","v1.4.3","v1.4.4","v1.4.5","v1.4.6","v1.4.7","v1.4.8","v1.5.0","v1.5.1","v1.5.2","v1.5.3","v1.6.1","v1.6.2","v1.6.3","v1.6.4","v2.0.1","v2.0.2","v2.0.3","v2.0.4","v2.0.5","v2.0.6","v2.0.7","v2.0.8","v2.1.0","v2.1.1","v2.1.2","v2.1.3","v2.1.4","v2.2.0","v2.2.1","v2.2.2","v2.2.3","v2.3.0","v2.3.1","v2.3.2","v2.3.3","v2.4.0","v2.4.1","v2.4.2","v2.4.3","v2.4.4","v2.4.5","v2.4.6","v2.4.7","v2.4.8","v2.5.0","v2.5.1","v2.5.2","v2.5.3","v2.5.4","v2.5.5","v2.5.6","v2.6.0","v2.6.1","v2.6.2","v2.6.3","v3.0.0","v3.0.1","v3.0.2","v3.0.3","v3.0.4","v3.0.5","v3.0.6","v3.0.7","v3.0.8","v3.1.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2017-15924.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"277076487168416077177268514653106974475","length":1080},"id":"CVE-2017-15924-738cd4f1","signature_type":"Function","signature_version":"v1","source":"https://github.com/shadowsocks/shadowsocks-libev/commit/c67d275803dc6ea22c558d06b1f7ba9f94cd8de3","target":{"file":"src/manager.c","function":"build_config"}},{"deprecated":false,"digest":{"function_hash":"51715648287725508804296421552476954729","length":2671},"id":"CVE-2017-15924-7e3eb6fc","signature_type":"Function","signature_version":"v1","source":"https://github.com/shadowsocks/shadowsocks-libev/commit/c67d275803dc6ea22c558d06b1f7ba9f94cd8de3","target":{"file":"src/manager.c","function":"construct_command_line"}},{"deprecated":false,"digest":{"line_hashes":["169837448405245710347467634324323478422","327659273079150167083867326886170459882","301484648099712372651071308334292968805","81374173212013676119655546543043961364","40156762308119617865492505593162385531","189886026585957659222601073739168781841","65991846492554056196821736162134505460","212907375527110548919205828182184045444","266748927104649670767550455357153502823","2561586973442348593906185680394902824","73857112924478152416306249729309578487","10983231780701925607823863281532833026","57259832225120913902268720118809065672","126842709979597372642403940724571959268","42157759316307733695178137402041078878","145036398007120937366813029069073129853","224591225731331742064323684188427633094","32278634827548368364613609433937393828","2653600847363017017969292359007098289","26085178480316581020662140927533394189","282584403883317560828349507996565172350","102608600048312645466792487933083938846","28508456101964790122671434748187555180","97940369526720310290924854467897825220"],"threshold":0.9},"id":"CVE-2017-15924-c25c1466","signature_type":"Line","signature_version":"v1","source":"https://github.com/shadowsocks/shadowsocks-libev/commit/c67d275803dc6ea22c558d06b1f7ba9f94cd8de3","target":{"file":"src/manager.c"}}]}}],"references":[{"type":"ARTICLE","url":"http://openwall.com/lists/oss-security/2017/10/13/2"},{"type":"ADVISORY","url":"http://www.debian.org/security/2017/dsa-4009"},{"type":"ADVISORY","url":"https://github.com/shadowsocks/shadowsocks-libev/commit/c67d275803dc6ea22c558d06b1f7ba9f94cd8de3"},{"type":"ADVISORY","url":"https://github.com/shadowsocks/shadowsocks-libev/issues/1734"},{"type":"EVIDENCE","url":"https://www.x41-dsec.de/lab/advisories/x41-2017-010-shadowsocks-libev/"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}]}