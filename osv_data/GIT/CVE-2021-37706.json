{"schema_version":"1.7.3","id":"CVE-2021-37706","published":"2021-12-22T18:15:07.487Z","modified":"2025-12-11T02:02:33.397972Z","related":["GHSA-2qpg-f6wf-w984","USN-6422-2"],"details":"PJSIP is a free and open source multimedia communication library written in C language implementing standard based protocols such as SIP, SDP, RTP, STUN, TURN, and ICE. In affected versions if the incoming STUN message contains an ERROR-CODE attribute, the header length is not checked before performing a subtraction operation, potentially resulting in an integer underflow scenario. This issue affects all users that use STUN. A malicious actor located within the victim’s network may forge and send a specially crafted UDP (STUN) message that could remotely execute arbitrary code on the victim’s machine. Users are advised to upgrade as soon as possible. There are no known workarounds.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/asterisk/asterisk","events":[{"introduced":"0"},{"fixed":"d436f568583184a13aa46349af5a3f0907087b44"}]}],"versions":["16.8.0-rc1","16.8.0-rc2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-37706.json"}},{"ranges":[{"type":"GIT","repo":"https://github.com/pjsip/pjproject","events":[{"introduced":"0"},{"fixed":"15663e3f37091069b8c98a7fce680dc04bc8e865"}]}],"versions":["2.10","2.11"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-37706.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["286375471227338908900759340395951320869","337170165584158815641361604078421931103","218425442522531084557250897674746904437","215575948014480304126719586812745130850"],"threshold":0.9},"id":"CVE-2021-37706-6c9a95f2","signature_type":"Line","signature_version":"v1","source":"https://github.com/pjsip/pjproject/commit/15663e3f37091069b8c98a7fce680dc04bc8e865","target":{"file":"pjnath/src/pjnath/stun_msg.c"}},{"deprecated":false,"digest":{"function_hash":"166111760674862860056573304105766004106","length":452},"id":"CVE-2021-37706-9e426c0f","signature_type":"Function","signature_version":"v1","source":"https://github.com/pjsip/pjproject/commit/15663e3f37091069b8c98a7fce680dc04bc8e865","target":{"file":"pjnath/src/pjnath/stun_msg.c","function":"decode_errcode_attr"}}]}}],"references":[{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2023/08/msg00038.html"},{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2024/09/msg00030.html"},{"type":"ADVISORY","url":"http://packetstormsecurity.com/files/166225/Asterisk-Project-Security-Advisory-AST-2022-004.html"},{"type":"ARTICLE","url":"http://seclists.org/fulldisclosure/2022/Mar/0"},{"type":"FIX","url":"https://github.com/pjsip/pjproject/commit/15663e3f37091069b8c98a7fce680dc04bc8e865"},{"type":"FIX","url":"https://github.com/pjsip/pjproject/security/advisories/GHSA-2qpg-f6wf-w984"},{"type":"ARTICLE","url":"https://lists.debian.org/debian-lts-announce/2022/03/msg00035.html"},{"type":"ARTICLE","url":"https://lists.debian.org/debian-lts-announce/2022/11/msg00021.html"},{"type":"ADVISORY","url":"https://security.gentoo.org/glsa/202210-37"},{"type":"ADVISORY","url":"https://www.debian.org/security/2022/dsa-5285"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}