{"schema_version":"1.7.3","id":"CVE-2024-49976","published":"2024-10-21T18:02:23.774Z","modified":"2025-11-20T06:50:51.634793Z","related":["MGASA-2024-0344","MGASA-2024-0345","SUSE-SU-2024:4314-1","SUSE-SU-2024:4316-1","SUSE-SU-2024:4318-1","SUSE-SU-2024:4387-1","USN-7276-1","USN-7277-1","openSUSE-SU-2024:14500-1","openSUSE-SU-2025:14705-1"],"summary":"tracing/timerlat: Drop interface_lock in stop_kthread()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ntracing/timerlat: Drop interface_lock in stop_kthread()\n\nstop_kthread() is the offline callback for \"trace/osnoise:online\", since\ncommit 5bfbcd1ee57b (\"tracing/timerlat: Add interface_lock around clearing\nof kthread in stop_kthread()\"), the following ABBA deadlock scenario is\nintroduced:\n\nT1                            | T2 [BP]               | T3 [AP]\nosnoise_hotplug_workfn()      | work_for_cpu_fn()     | cpuhp_thread_fun()\n                              |   _cpu_down()         |   osnoise_cpu_die()\n  mutex_lock(&interface_lock) |                       |     stop_kthread()\n                              |     cpus_write_lock() |       mutex_lock(&interface_lock)\n  cpus_read_lock()            |     cpuhp_kick_ap()   |\n\nAs the interface_lock here in just for protecting the \"kthread\" field of\nthe osn_var, use xchg() instead to fix this issue. Also use\nfor_each_online_cpu() back in stop_per_cpu_kthreads() as it can take\ncpu_read_lock() again.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4fdabffae14cca2c80d99bd81f3f27239ac7f5e"},{"fixed":"a4a05ceffe8fad68b45de38fe2311bda619e76e2"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4679272d5252720746fd9c5465352cbc5665f230"},{"fixed":"09cb44cc3d3df7ade2cebc939d6257a2fa8afc7a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5bfbcd1ee57b607fd29e4645c7f350dd385dd9ad"},{"fixed":"db8571a9a098086608c11a15856ff585789e67e8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5bfbcd1ee57b607fd29e4645c7f350dd385dd9ad"},{"fixed":"b484a02c9cedf8703eff8f0756f94618004bd165"}]}],"versions":["v6.10.10","v6.10.11","v6.10.12","v6.10.13","v6.11","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.12-rc1","v6.6.51","v6.6.52","v6.6.53","v6.6.54"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-49976.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"273019468839089125008702678892248274268","length":102},"id":"CVE-2024-49976-0feed0e1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@09cb44cc3d3df7ade2cebc939d6257a2fa8afc7a","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_per_cpu_kthreads"}},{"deprecated":false,"digest":{"function_hash":"190021531865813756446686171387660064469","length":709},"id":"CVE-2024-49976-1280b162","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b484a02c9cedf8703eff8f0756f94618004bd165","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_kthread"}},{"deprecated":false,"digest":{"line_hashes":["287087296263210165550439809481829846554","3105959329417466292565885938185342135","135916186936626655219203788407691483038","167581860214415103781238171364051891069","189405555443313408293235159550722546734","122561046196593665171748564125846074788","154355781674748219897777602198604609382","189523530503091302420885642013936905127","245936980629868858475925381527166649831","194161144732341633640981415493796483498","51379866352297675914478700991920881778","36851683316470279823756169767450316080","44168415518483509610958071001663666877","83921826443354288136729749453963187447","76373344076634528226404759206819664131","209130143449342575329626410629051153514","199762329549931621270416488023907632192"],"threshold":0.9},"id":"CVE-2024-49976-27420f77","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4a05ceffe8fad68b45de38fe2311bda619e76e2","target":{"file":"kernel/trace/trace_osnoise.c"}},{"deprecated":false,"digest":{"function_hash":"273019468839089125008702678892248274268","length":102},"id":"CVE-2024-49976-7508f178","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b484a02c9cedf8703eff8f0756f94618004bd165","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_per_cpu_kthreads"}},{"deprecated":false,"digest":{"line_hashes":["287087296263210165550439809481829846554","3105959329417466292565885938185342135","135916186936626655219203788407691483038","167581860214415103781238171364051891069","189405555443313408293235159550722546734","122561046196593665171748564125846074788","154355781674748219897777602198604609382","189523530503091302420885642013936905127","245936980629868858475925381527166649831","194161144732341633640981415493796483498","51379866352297675914478700991920881778","36851683316470279823756169767450316080","44168415518483509610958071001663666877","83921826443354288136729749453963187447","76373344076634528226404759206819664131","209130143449342575329626410629051153514","199762329549931621270416488023907632192"],"threshold":0.9},"id":"CVE-2024-49976-7ace24c2","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b484a02c9cedf8703eff8f0756f94618004bd165","target":{"file":"kernel/trace/trace_osnoise.c"}},{"deprecated":false,"digest":{"function_hash":"190021531865813756446686171387660064469","length":709},"id":"CVE-2024-49976-85dac9b4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4a05ceffe8fad68b45de38fe2311bda619e76e2","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_kthread"}},{"deprecated":false,"digest":{"line_hashes":["287087296263210165550439809481829846554","3105959329417466292565885938185342135","135916186936626655219203788407691483038","167581860214415103781238171364051891069","189405555443313408293235159550722546734","122561046196593665171748564125846074788","154355781674748219897777602198604609382","189523530503091302420885642013936905127","245936980629868858475925381527166649831","194161144732341633640981415493796483498","51379866352297675914478700991920881778","36851683316470279823756169767450316080","44168415518483509610958071001663666877","83921826443354288136729749453963187447","76373344076634528226404759206819664131","209130143449342575329626410629051153514","199762329549931621270416488023907632192"],"threshold":0.9},"id":"CVE-2024-49976-bd5d29e7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db8571a9a098086608c11a15856ff585789e67e8","target":{"file":"kernel/trace/trace_osnoise.c"}},{"deprecated":false,"digest":{"function_hash":"273019468839089125008702678892248274268","length":102},"id":"CVE-2024-49976-c0dcf265","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a4a05ceffe8fad68b45de38fe2311bda619e76e2","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_per_cpu_kthreads"}},{"deprecated":false,"digest":{"line_hashes":["287087296263210165550439809481829846554","3105959329417466292565885938185342135","135916186936626655219203788407691483038","167581860214415103781238171364051891069","189405555443313408293235159550722546734","122561046196593665171748564125846074788","154355781674748219897777602198604609382","189523530503091302420885642013936905127","245936980629868858475925381527166649831","194161144732341633640981415493796483498","51379866352297675914478700991920881778","36851683316470279823756169767450316080","44168415518483509610958071001663666877","83921826443354288136729749453963187447","76373344076634528226404759206819664131","209130143449342575329626410629051153514","199762329549931621270416488023907632192"],"threshold":0.9},"id":"CVE-2024-49976-e8ad02ea","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@09cb44cc3d3df7ade2cebc939d6257a2fa8afc7a","target":{"file":"kernel/trace/trace_osnoise.c"}},{"deprecated":false,"digest":{"function_hash":"190021531865813756446686171387660064469","length":709},"id":"CVE-2024-49976-ec9073ab","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db8571a9a098086608c11a15856ff585789e67e8","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_kthread"}},{"deprecated":false,"digest":{"function_hash":"190021531865813756446686171387660064469","length":709},"id":"CVE-2024-49976-ef4e66d9","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@09cb44cc3d3df7ade2cebc939d6257a2fa8afc7a","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_kthread"}},{"deprecated":false,"digest":{"function_hash":"273019468839089125008702678892248274268","length":102},"id":"CVE-2024-49976-fefcbed4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@db8571a9a098086608c11a15856ff585789e67e8","target":{"file":"kernel/trace/trace_osnoise.c","function":"stop_per_cpu_kthreads"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.6.55"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.10.14"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.11.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-49976.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/09cb44cc3d3df7ade2cebc939d6257a2fa8afc7a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a4a05ceffe8fad68b45de38fe2311bda619e76e2"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b484a02c9cedf8703eff8f0756f94618004bd165"},{"type":"WEB","url":"https://git.kernel.org/stable/c/db8571a9a098086608c11a15856ff585789e67e8"}]}