{"schema_version":"1.7.3","id":"CVE-2025-22065","published":"2025-04-16T14:12:19.492Z","modified":"2025-11-20T08:57:46.426314Z","related":["SUSE-SU-2025:01707-1","SUSE-SU-2025:01919-1","SUSE-SU-2025:01951-1","SUSE-SU-2025:01964-1","SUSE-SU-2025:01967-1"],"summary":"idpf: fix adapter NULL pointer dereference on reboot","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nidpf: fix adapter NULL pointer dereference on reboot\n\nWith SRIOV enabled, idpf ends up calling into idpf_remove() twice.\nFirst via idpf_shutdown() and then again when idpf_remove() calls into\nsriov_disable(), because the VF devices use the idpf driver, hence the\nsame remove routine. When that happens, it is possible for the adapter\nto be NULL from the first call to idpf_remove(), leading to a NULL\npointer dereference.\n\necho 1 > /sys/class/net/<netif>/device/sriov_numvfs\nreboot\n\nBUG: kernel NULL pointer dereference, address: 0000000000000020\n...\nRIP: 0010:idpf_remove+0x22/0x1f0 [idpf]\n...\n? idpf_remove+0x22/0x1f0 [idpf]\n? idpf_remove+0x1e4/0x1f0 [idpf]\npci_device_remove+0x3f/0xb0\ndevice_release_driver_internal+0x19f/0x200\npci_stop_bus_device+0x6d/0x90\npci_stop_and_remove_bus_device+0x12/0x20\npci_iov_remove_virtfn+0xbe/0x120\nsriov_disable+0x34/0xe0\nidpf_sriov_configure+0x58/0x140 [idpf]\nidpf_remove+0x1b9/0x1f0 [idpf]\nidpf_shutdown+0x12/0x30 [idpf]\npci_device_shutdown+0x35/0x60\ndevice_shutdown+0x156/0x200\n...\n\nReplace the direct idpf_remove() call in idpf_shutdown() with\nidpf_vc_core_deinit() and idpf_deinit_dflt_mbx(), which perform\nthe bulk of the cleanup, such as stopping the init task, freeing IRQs,\ndestroying the vports and freeing the mailbox. This avoids the calls to\nsriov_disable() in addition to a small netdev cleanup, and destroying\nworkqueues, which don't seem to be required on shutdown.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e850efed5e152e6bdd367d5b82019f21298c0653"},{"fixed":"79618e952ef4dfa1a17ee0631d5549603fab58d8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e850efed5e152e6bdd367d5b82019f21298c0653"},{"fixed":"88a6d562e92a295648f8636acf2a6aa714241771"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e850efed5e152e6bdd367d5b82019f21298c0653"},{"fixed":"9fc9b3dc0d0c189ed205acf1e5fbd73e0becc4d6"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e850efed5e152e6bdd367d5b82019f21298c0653"},{"fixed":"4c9106f4906a85f6b13542d862e423bcdc118cc3"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.10","v6.13.2","v6.13.3","v6.13.4","v6.13.5","v6.13.6","v6.13.7","v6.13.8","v6.13.9","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22065.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["107371688083608314318759431481441043014","305980819109471232124397621755530956971","305670084857889842841986195813251059272","172167460428578345405257982704306316608"],"threshold":0.9},"id":"CVE-2025-22065-145f8f76","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@79618e952ef4dfa1a17ee0631d5549603fab58d8","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c"}},{"deprecated":false,"digest":{"line_hashes":["107371688083608314318759431481441043014","305980819109471232124397621755530956971","305670084857889842841986195813251059272","172167460428578345405257982704306316608"],"threshold":0.9},"id":"CVE-2025-22065-41167a7c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@88a6d562e92a295648f8636acf2a6aa714241771","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c"}},{"deprecated":false,"digest":{"line_hashes":["107371688083608314318759431481441043014","305980819109471232124397621755530956971","305670084857889842841986195813251059272","172167460428578345405257982704306316608"],"threshold":0.9},"id":"CVE-2025-22065-61c15d83","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9fc9b3dc0d0c189ed205acf1e5fbd73e0becc4d6","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c"}},{"deprecated":false,"digest":{"function_hash":"38713489386375143151285520757911710294","length":137},"id":"CVE-2025-22065-877b9d75","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@88a6d562e92a295648f8636acf2a6aa714241771","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c","function":"idpf_shutdown"}},{"deprecated":false,"digest":{"line_hashes":["107371688083608314318759431481441043014","305980819109471232124397621755530956971","305670084857889842841986195813251059272","172167460428578345405257982704306316608"],"threshold":0.9},"id":"CVE-2025-22065-8bc254b9","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4c9106f4906a85f6b13542d862e423bcdc118cc3","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c"}},{"deprecated":false,"digest":{"function_hash":"38713489386375143151285520757911710294","length":137},"id":"CVE-2025-22065-a65b8247","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9fc9b3dc0d0c189ed205acf1e5fbd73e0becc4d6","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c","function":"idpf_shutdown"}},{"deprecated":false,"digest":{"function_hash":"38713489386375143151285520757911710294","length":137},"id":"CVE-2025-22065-d5c5b01e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4c9106f4906a85f6b13542d862e423bcdc118cc3","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c","function":"idpf_shutdown"}},{"deprecated":false,"digest":{"function_hash":"38713489386375143151285520757911710294","length":137},"id":"CVE-2025-22065-e9347bc6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@79618e952ef4dfa1a17ee0631d5549603fab58d8","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_main.c","function":"idpf_shutdown"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.23"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.14.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22065.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4c9106f4906a85f6b13542d862e423bcdc118cc3"},{"type":"WEB","url":"https://git.kernel.org/stable/c/79618e952ef4dfa1a17ee0631d5549603fab58d8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/88a6d562e92a295648f8636acf2a6aa714241771"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9fc9b3dc0d0c189ed205acf1e5fbd73e0becc4d6"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}