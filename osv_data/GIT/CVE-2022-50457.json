{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50457.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "289460169257150960862468606587619569412",
                "54759228129495336584508452046713888624",
                "251077936453990018361274693910735598264",
                "39767395649939038634488536361863587556",
                "313095207791198028755978367712013157850",
                "151255709174361742356072488964528149182",
                "36058943814533634714464378075444116169",
                "110038467190507475959400061462742680642",
                "309091512142087114066484015328270338891",
                "201140634030574491569603767946398781359",
                "94431796985180005044289808032813017147",
                "164137155040359006875572818139860780724"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50457-2a222570",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6016557f1ef7735963bd8691592d2797bbf91d2",
            "target": {
              "file": "drivers/mtd/mtdcore.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "128835027529042009927782460898091377664",
              "length": 780.0
            },
            "id": "CVE-2022-50457-995421cb",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@616dc895d982026f41f500c88d1bfea004938cc8",
            "target": {
              "file": "drivers/mtd/mtdcore.c",
              "function": "del_mtd_device"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "128835027529042009927782460898091377664",
              "length": 780.0
            },
            "id": "CVE-2022-50457-b8e3388a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f6016557f1ef7735963bd8691592d2797bbf91d2",
            "target": {
              "file": "drivers/mtd/mtdcore.c",
              "function": "del_mtd_device"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "289460169257150960862468606587619569412",
                "54759228129495336584508452046713888624",
                "251077936453990018361274693910735598264",
                "39767395649939038634488536361863587556",
                "313095207791198028755978367712013157850",
                "151255709174361742356072488964528149182",
                "36058943814533634714464378075444116169",
                "110038467190507475959400061462742680642",
                "309091512142087114066484015328270338891",
                "201140634030574491569603767946398781359",
                "94431796985180005044289808032813017147",
                "164137155040359006875572818139860780724"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50457-f8c60b37",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@616dc895d982026f41f500c88d1bfea004938cc8",
            "target": {
              "file": "drivers/mtd/mtdcore.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "00596576a05145a1b5672897a82ef87af00becf4"
            },
            {
              "fixed": "f6016557f1ef7735963bd8691592d2797bbf91d2"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "00596576a05145a1b5672897a82ef87af00becf4"
            },
            {
              "fixed": "616dc895d982026f41f500c88d1bfea004938cc8"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "00596576a05145a1b5672897a82ef87af00becf4"
            },
            {
              "fixed": "56570bdad5e31c5c538cd6efff5c4510256e1bb4"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.16",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.0.1",
        "v6.0.10",
        "v6.0.11",
        "v6.0.12",
        "v6.0.13",
        "v6.0.14",
        "v6.0.15",
        "v6.0.2",
        "v6.0.3",
        "v6.0.4",
        "v6.0.5",
        "v6.0.6",
        "v6.0.7",
        "v6.0.8",
        "v6.0.9",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50457.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.17.0"
            },
            {
              "fixed": "6.0.16"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.1.0"
            },
            {
              "fixed": "6.1.2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmtd: core: Fix refcount error in del_mtd_device()\n\ndel_mtd_device() will call of_node_put() to mtd_get_of_node(mtd), which\nis mtd->dev.of_node. However, memset(&mtd->dev, 0) is called before\nof_node_put(). As the result, of_node_put() won't do anything in\ndel_mtd_device(), and causes the refcount leak.\n\ndel_mtd_device()\n    memset(&mtd->dev, 0, sizeof(mtd->dev) # clear mtd->dev\n    of_node_put()\n        mtd_get_of_node(mtd) # mtd->dev is cleared, can't locate of_node\n                             # of_node_put(NULL) won't do anything\n\nFix the error by caching the pointer of the device_node.\n\nOF: ERROR: memory leak, expected refcount 1 instead of 2,\nof_node_get()/of_node_put() unbalanced - destroy cset entry: attach\noverlay node /spi/spi-sram@0\nCPU: 3 PID: 275 Comm: python3 Tainted: G N 6.1.0-rc3+ #54\n    0d8a1edddf51f172ff5226989a7565c6313b08e2\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nrel-1.15.0-0-g2dd4b9b3f840-prebuilt.qemu.org 04/01/2014\nCall Trace:\n<TASK>\n    dump_stack_lvl+0x67/0x83\n    kobject_get+0x155/0x160\n    of_node_get+0x1f/0x30\n    of_fwnode_get+0x43/0x70\n    fwnode_handle_get+0x54/0x80\n    fwnode_get_nth_parent+0xc9/0xe0\n    fwnode_full_name_string+0x3f/0xa0\n    device_node_string+0x30f/0x750\n    pointer+0x598/0x7a0\n    vsnprintf+0x62d/0x9b0\n    ...\n    cfs_overlay_release+0x30/0x90\n    config_item_release+0xbe/0x1a0\n    config_item_put+0x5e/0x80\n    configfs_rmdir+0x3bd/0x540\n    vfs_rmdir+0x18c/0x320\n    do_rmdir+0x198/0x330\n    __x64_sys_rmdir+0x2c/0x40\n    do_syscall_64+0x37/0x90\n    entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\n[<miquel.raynal@bootlin.com>: Light reword of the commit log]",
  "id": "CVE-2022-50457",
  "modified": "2025-10-15T02:35:20.286729Z",
  "published": "2025-10-01T11:45:30Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/56570bdad5e31c5c538cd6efff5c4510256e1bb4"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/616dc895d982026f41f500c88d1bfea004938cc8"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f6016557f1ef7735963bd8691592d2797bbf91d2"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "mtd: core: Fix refcount error in del_mtd_device()"
}