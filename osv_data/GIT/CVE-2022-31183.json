{"schema_version":"1.7.3","id":"CVE-2022-31183","published":"2022-08-01T19:50:11Z","modified":"2025-12-04T10:24:54.587077Z","aliases":["GHSA-2cpx-6pqp-wf35"],"summary":"mTLS client verification is skipped in fs2 on Node.js","details":"fs2 is a compositional, streaming I/O library for Scala. When establishing a server-mode `TLSSocket` using `fs2-io` on Node.js, the parameter `requestCert = true` is ignored, peer certificate verification is skipped, and the connection proceeds. The vulnerability is limited to: 1. `fs2-io` running on Node.js. The JVM TLS implementation is completely independent. 2. `TLSSocket`s in server-mode. Client-mode `TLSSocket`s are implemented via a different API. 3. mTLS as enabled via `requestCert = true` in `TLSParameters`. The default setting is `false` for server-mode `TLSSocket`s. It was introduced with the initial Node.js implementation of fs2-io in 3.1.0. A patch is released in v3.2.11. The requestCert = true parameter is respected and the peer certificate is verified. If verification fails, a SSLException is raised. If using an unpatched version on Node.js, do not use a server-mode TLSSocket with requestCert = true to establish a mTLS connection.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/typelevel/fs2","events":[{"introduced":"ad9cea3f0d9e15f2648d02b76615767fe60e1511"},{"fixed":"47bced431dcad2aa2efb5f60493b26a3aa05ca7e"}]}],"versions":["v3.1.0","v3.1.1","v3.1.2","v3.1.3","v3.1.4","v3.1.5","v3.1.6","v3.2.0","v3.2.1","v3.2.10","v3.2.2","v3.2.3","v3.2.4","v3.2.5","v3.2.6","v3.2.7","v3.2.8","v3.2.9"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-31183.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/31xxx/CVE-2022-31183.json"},{"type":"REPORT","url":"https://github.com/nodejs/node/issues/43994"},{"type":"FIX","url":"https://github.com/typelevel/fs2/commit/659824395826a314e0a4331535dbf1ef8bef8207"},{"type":"ADVISORY","url":"https://github.com/typelevel/fs2/security/advisories/GHSA-2cpx-6pqp-wf35"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-31183"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-295"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/31xxx/CVE-2022-31183.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"}]}