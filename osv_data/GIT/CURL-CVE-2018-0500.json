{
  "id": "CURL-CVE-2018-0500",
  "summary": "SMTP send heap buffer overflow",
  "details": "curl might overflow a heap based memory buffer when sending data over SMTP and\nusing a reduced read buffer.\n\nWhen sending data over SMTP, curl allocates a separate \"scratch area\" on the\nheap to be able to escape the uploaded data properly if the uploaded data\ncontains data that requires it.\n\nThe size of this temporary scratch area was mistakenly made to be `2 *\nsizeof(download_buffer)` when it should have been made `2 *\nsizeof(upload_buffer)`.\n\nThe upload and the download buffer sizes are identically sized by default\n(16KB) but since version 7.54.1, curl can resize the download buffer into a\nsmaller buffer (as well as larger). If the download buffer size is set to a\nvalue smaller than 10923, the `Curl_smtp_escape_eob()` function might overflow\nthe scratch buffer when sending contents of sufficient size and contents.\n\nThe curl command line tool lowers the buffer size when `--limit-rate` is set\nto a value smaller than 16KB.",
  "aliases": [
    "CVE-2018-0500"
  ],
  "modified": "2024-06-07T13:53:51Z",
  "published": "2018-07-11T08:00:00Z",
  "database_specific": {
    "CWE": {
      "id": "CWE-122",
      "desc": "Heap-based Buffer Overflow"
    },
    "package": "curl",
    "URL": "https://curl.se/docs/CVE-2018-0500.json",
    "severity": "High",
    "www": "https://curl.se/docs/CVE-2018-0500.html",
    "last_affected": "7.60.0"
  },
  "affected": [
    {
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "7.54.1"
            },
            {
              "fixed": "7.61.0"
            }
          ]
        },
        {
          "type": "GIT",
          "repo": "https://github.com/curl/curl.git",
          "events": [
            {
              "introduced": "e40e9d7f0decc799e3ccfe2c418632f8bb52031a"
            },
            {
              "fixed": "ba1dbd78e5f1ed67c1b8d37ac89d90e5e330b628"
            }
          ]
        }
      ],
      "versions": [
        "7.60.0",
        "7.59.0",
        "7.58.0",
        "7.57.0",
        "7.56.1",
        "7.56.0",
        "7.55.1",
        "7.55.0",
        "7.54.1"
      ],
      "database_specific": {
        "source": "https://curl.se/docs/CURL-CVE-2018-0500.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "credits": [
    {
      "name": "Peter Wu",
      "type": "FINDER"
    },
    {
      "name": "Daniel Stenberg",
      "type": "REMEDIATION_DEVELOPER"
    }
  ]
}