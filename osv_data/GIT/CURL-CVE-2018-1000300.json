{"schema_version":"1.7.3","id":"CURL-CVE-2018-1000300","published":"2018-05-16T08:00:00Z","modified":"2024-06-07T13:53:51Z","aliases":["CVE-2018-1000300"],"summary":"FTP shutdown response buffer overflow","details":"curl might overflow a heap based memory buffer when closing down an FTP\nconnection with very long server command replies.\n\nWhen doing FTP transfers, curl keeps a spare \"closure handle\" around\ninternally that is used when an FTP connection gets shut down since the\noriginal curl easy handle is then already removed.\n\nFTP server response data that gets cached from the original transfer might\nthen be larger than the default buffer size (16 KB) allocated in the \"closure\nhandle\", which can lead to a buffer overwrite. The contents and size of that\noverwrite is controllable by the server.\n\nThis situation was detected by an assert() in the code, but that was of course\nonly preventing bad stuff in debug builds. This bug is very unlikely to\ntrigger with non-malicious servers.","affected":[{"ranges":[{"type":"SEMVER","events":[{"introduced":"7.54.1"},{"fixed":"7.60.0"}]},{"type":"GIT","repo":"https://github.com/curl/curl.git","events":[{"introduced":"e40e9d7f0decc799e3ccfe2c418632f8bb52031a"},{"fixed":"583b42cb3b809b1bf597af160468ccba728c2248"}]}],"versions":["7.59.0","7.58.0","7.57.0","7.56.1","7.56.0","7.55.1","7.55.0","7.54.1"],"database_specific":{"source":"https://curl.se/docs/CURL-CVE-2018-1000300.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["229758711889692930654527470441779275027","220322334328261129743823848021469509886","296596693923419492886215170191994352530","36235404738579012465951377492501113291"],"threshold":0.9},"id":"CURL-CVE-2018-1000300-0a45ae05","signature_type":"Line","signature_version":"v1","source":"https://github.com/curl/curl.git/commit/583b42cb3b809b1bf597af160468ccba728c2248","target":{"file":"lib/pingpong.c"}},{"deprecated":false,"digest":{"function_hash":"213018455658973195550019192185324775648","length":3224},"id":"CURL-CVE-2018-1000300-80deae81","signature_type":"Function","signature_version":"v1","source":"https://github.com/curl/curl.git/commit/583b42cb3b809b1bf597af160468ccba728c2248","target":{"file":"lib/pingpong.c","function":"Curl_pp_readresp"}}]}}],"database_specific":{"CWE":{"desc":"Heap-based Buffer Overflow","id":"CWE-122"},"URL":"https://curl.se/docs/CVE-2018-1000300.json","affects":"both","last_affected":"7.59.0","package":"curl","severity":"High","www":"https://curl.se/docs/CVE-2018-1000300.html"},"credits":[{"name":"Dario Weisser","type":"FINDER"},{"name":"Daniel Stenberg","type":"REMEDIATION_DEVELOPER"}]}