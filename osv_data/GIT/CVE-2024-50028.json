{"schema_version":"1.7.3","id":"CVE-2024-50028","published":"2024-10-21T19:39:31.809Z","modified":"2025-11-20T06:29:07.434144Z","related":["SUSE-SU-2024:3983-1","SUSE-SU-2024:3984-1","SUSE-SU-2024:3985-1","SUSE-SU-2024:3986-1","SUSE-SU-2024:4318-1","SUSE-SU-2024:4364-1","SUSE-SU-2024:4387-1","USN-7276-1","USN-7277-1","openSUSE-SU-2024:14500-1","openSUSE-SU-2025:14705-1"],"summary":"thermal: core: Reference count the zone in thermal_zone_get_by_id()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nthermal: core: Reference count the zone in thermal_zone_get_by_id()\n\nThere are places in the thermal netlink code where nothing prevents\nthe thermal zone object from going away while being accessed after it\nhas been returned by thermal_zone_get_by_id().\n\nTo address this, make thermal_zone_get_by_id() get a reference on the\nthermal zone device object to be returned with the help of get_device(),\nunder thermal_list_lock, and adjust all of its callers to this change\nwith the help of the cleanup.h infrastructure.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1ce50e7d408ef2bdc8ca021363fd46d1b8bfad00"},{"fixed":"c95538b286efc6109c987e97a051bc7844ede802"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1ce50e7d408ef2bdc8ca021363fd46d1b8bfad00"},{"fixed":"a42a5839f400e929c489bb1b58f54596c4535167"}]}],"versions":["v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.8","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.11.3","v6.12-rc1","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50028.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"121309601178507088579033329358249983443","length":498},"id":"CVE-2024-50028-0ff2180a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a42a5839f400e929c489bb1b58f54596c4535167","target":{"file":"drivers/thermal/thermal_netlink.c","function":"thermal_genl_cmd_tz_get_temp"}},{"deprecated":false,"digest":{"line_hashes":["139108111851575937828372129194286343954","3784587562723327345620183838087584233","173812783674563500905888889249845163972"],"threshold":0.9},"id":"CVE-2024-50028-114a6c5d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a42a5839f400e929c489bb1b58f54596c4535167","target":{"file":"drivers/thermal/thermal_core.h"}},{"deprecated":false,"digest":{"function_hash":"154669523568932392856924075181656928533","length":522},"id":"CVE-2024-50028-13e52e67","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c95538b286efc6109c987e97a051bc7844ede802","target":{"file":"drivers/thermal/thermal_netlink.c","function":"thermal_genl_cmd_tz_get_gov"}},{"deprecated":false,"digest":{"line_hashes":["288749004010287226832106187714092858796","300307494211473752706968646358151517269","87711336673262729396672401736107690668","244702416799818048695011782703825267461","302425124253141122790633389868417092400","280885659518830833330621636236692900546","10497774482338222743793465942803207289","68675096025258352985708313089329212851","24187918316512114702061006041183786395","6321668226020476224843597191538024461","19468019389153866938526288410582970448","218494870668185867468960547932600283405","302425124253141122790633389868417092400","280885659518830833330621636236692900546","10497774482338222743793465942803207289","280104688208769490806823748889149953376","189794216374131854042205455766993817095","112255771832199545003460059931299638103","180402849736034135608331931571443448693","162051159647428038778177376638177588757","302425124253141122790633389868417092400","280885659518830833330621636236692900546","10497774482338222743793465942803207289","320844557372528251564561598789043328455"],"threshold":0.9},"id":"CVE-2024-50028-16692d8a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a42a5839f400e929c489bb1b58f54596c4535167","target":{"file":"drivers/thermal/thermal_netlink.c"}},{"deprecated":false,"digest":{"function_hash":"121309601178507088579033329358249983443","length":498},"id":"CVE-2024-50028-204c0fba","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c95538b286efc6109c987e97a051bc7844ede802","target":{"file":"drivers/thermal/thermal_netlink.c","function":"thermal_genl_cmd_tz_get_temp"}},{"deprecated":false,"digest":{"line_hashes":["136364384513772582328013027233739398465","314188013078359314734994000089051641811","234344561571056095179664615799034230342","72136625575902704775289207468994357045"],"threshold":0.9},"id":"CVE-2024-50028-4944e733","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c95538b286efc6109c987e97a051bc7844ede802","target":{"file":"drivers/thermal/thermal_core.c"}},{"deprecated":false,"digest":{"function_hash":"188125312093289037787852077732983576182","length":260},"id":"CVE-2024-50028-5df6f47c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a42a5839f400e929c489bb1b58f54596c4535167","target":{"file":"drivers/thermal/thermal_core.c","function":"thermal_zone_get_by_id"}},{"deprecated":false,"digest":{"function_hash":"186159317399085627562701204384490170689","length":958},"id":"CVE-2024-50028-870411a7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c95538b286efc6109c987e97a051bc7844ede802","target":{"file":"drivers/thermal/thermal_netlink.c","function":"thermal_genl_cmd_tz_get_trip"}},{"deprecated":false,"digest":{"function_hash":"188125312093289037787852077732983576182","length":260},"id":"CVE-2024-50028-89695a76","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c95538b286efc6109c987e97a051bc7844ede802","target":{"file":"drivers/thermal/thermal_core.c","function":"thermal_zone_get_by_id"}},{"deprecated":false,"digest":{"line_hashes":["288749004010287226832106187714092858796","300307494211473752706968646358151517269","87711336673262729396672401736107690668","244702416799818048695011782703825267461","302425124253141122790633389868417092400","280885659518830833330621636236692900546","10497774482338222743793465942803207289","68675096025258352985708313089329212851","24187918316512114702061006041183786395","6321668226020476224843597191538024461","19468019389153866938526288410582970448","218494870668185867468960547932600283405","302425124253141122790633389868417092400","280885659518830833330621636236692900546","10497774482338222743793465942803207289","280104688208769490806823748889149953376","189794216374131854042205455766993817095","112255771832199545003460059931299638103","180402849736034135608331931571443448693","162051159647428038778177376638177588757","302425124253141122790633389868417092400","280885659518830833330621636236692900546","10497774482338222743793465942803207289","320844557372528251564561598789043328455"],"threshold":0.9},"id":"CVE-2024-50028-89b27dd3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c95538b286efc6109c987e97a051bc7844ede802","target":{"file":"drivers/thermal/thermal_netlink.c"}},{"deprecated":false,"digest":{"function_hash":"154669523568932392856924075181656928533","length":522},"id":"CVE-2024-50028-922499a8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a42a5839f400e929c489bb1b58f54596c4535167","target":{"file":"drivers/thermal/thermal_netlink.c","function":"thermal_genl_cmd_tz_get_gov"}},{"deprecated":false,"digest":{"line_hashes":["139108111851575937828372129194286343954","3784587562723327345620183838087584233","173812783674563500905888889249845163972"],"threshold":0.9},"id":"CVE-2024-50028-c7e62b23","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c95538b286efc6109c987e97a051bc7844ede802","target":{"file":"drivers/thermal/thermal_core.h"}},{"deprecated":false,"digest":{"function_hash":"186159317399085627562701204384490170689","length":958},"id":"CVE-2024-50028-cf0b11bf","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a42a5839f400e929c489bb1b58f54596c4535167","target":{"file":"drivers/thermal/thermal_netlink.c","function":"thermal_genl_cmd_tz_get_trip"}},{"deprecated":false,"digest":{"line_hashes":["136364384513772582328013027233739398465","314188013078359314734994000089051641811","234344561571056095179664615799034230342","72136625575902704775289207468994357045"],"threshold":0.9},"id":"CVE-2024-50028-ff859814","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a42a5839f400e929c489bb1b58f54596c4535167","target":{"file":"drivers/thermal/thermal_core.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.9.0"},{"fixed":"6.11.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-50028.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a42a5839f400e929c489bb1b58f54596c4535167"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c95538b286efc6109c987e97a051bc7844ede802"}]}