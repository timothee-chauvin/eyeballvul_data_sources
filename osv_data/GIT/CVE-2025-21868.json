{"schema_version":"1.7.3","id":"CVE-2025-21868","published":"2025-03-27T13:38:21.586Z","modified":"2025-11-24T20:27:09.875950Z","related":["SUSE-SU-2025:02249-1","SUSE-SU-2025:02538-1","SUSE-SU-2025:02923-1","USN-7521-2"],"summary":"net: allow small head cache usage with large MAX_SKB_FRAGS values","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnet: allow small head cache usage with large MAX_SKB_FRAGS values\n\nSabrina reported the following splat:\n\n    WARNING: CPU: 0 PID: 1 at net/core/dev.c:6935 netif_napi_add_weight_locked+0x8f2/0xba0\n    Modules linked in:\n    CPU: 0 UID: 0 PID: 1 Comm: swapper/0 Not tainted 6.14.0-rc1-net-00092-g011b03359038 #996\n    Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Arch Linux 1.16.3-1-1 04/01/2014\n    RIP: 0010:netif_napi_add_weight_locked+0x8f2/0xba0\n    Code: e8 c3 e6 6a fe 48 83 c4 28 5b 5d 41 5c 41 5d 41 5e 41 5f c3 cc cc cc cc c7 44 24 10 ff ff ff ff e9 8f fb ff ff e8 9e e6 6a fe <0f> 0b e9 d3 fe ff ff e8 92 e6 6a fe 48 8b 04 24 be ff ff ff ff 48\n    RSP: 0000:ffffc9000001fc60 EFLAGS: 00010293\n    RAX: 0000000000000000 RBX: ffff88806ce48128 RCX: 1ffff11001664b9e\n    RDX: ffff888008f00040 RSI: ffffffff8317ca42 RDI: ffff88800b325cb6\n    RBP: ffff88800b325c40 R08: 0000000000000001 R09: ffffed100167502c\n    R10: ffff88800b3a8163 R11: 0000000000000000 R12: ffff88800ac1c168\n    R13: ffff88800ac1c168 R14: ffff88800ac1c168 R15: 0000000000000007\n    FS:  0000000000000000(0000) GS:ffff88806ce00000(0000) knlGS:0000000000000000\n    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n    CR2: ffff888008201000 CR3: 0000000004c94001 CR4: 0000000000370ef0\n    DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n    DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n    Call Trace:\n    <TASK>\n    gro_cells_init+0x1ba/0x270\n    xfrm_input_init+0x4b/0x2a0\n    xfrm_init+0x38/0x50\n    ip_rt_init+0x2d7/0x350\n    ip_init+0xf/0x20\n    inet_init+0x406/0x590\n    do_one_initcall+0x9d/0x2e0\n    do_initcalls+0x23b/0x280\n    kernel_init_freeable+0x445/0x490\n    kernel_init+0x20/0x1d0\n    ret_from_fork+0x46/0x80\n    ret_from_fork_asm+0x1a/0x30\n    </TASK>\n    irq event stamp: 584330\n    hardirqs last  enabled at (584338): [<ffffffff8168bf87>] __up_console_sem+0x77/0xb0\n    hardirqs last disabled at (584345): [<ffffffff8168bf6c>] __up_console_sem+0x5c/0xb0\n    softirqs last  enabled at (583242): [<ffffffff833ee96d>] netlink_insert+0x14d/0x470\n    softirqs last disabled at (583754): [<ffffffff8317c8cd>] netif_napi_add_weight_locked+0x77d/0xba0\n\non kernel built with MAX_SKB_FRAGS=45, where SKB_WITH_OVERHEAD(1024)\nis smaller than GRO_MAX_HEAD.\n\nSuch built additionally contains the revert of the single page frag cache\nso that napi_get_frags() ends up using the page frag allocator, triggering\nthe splat.\n\nNote that the underlying issue is independent from the mentioned\nrevert; address it ensuring that the small head cache will fit either TCP\nand GRO allocation and updating napi_alloc_skb() and __netdev_alloc_skb()\nto select kmalloc() usage for any allocation fitting such cache.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3948b05950fdd64002a5f182c65ba5cf2d53cf71"},{"fixed":"ed8a77fee4618facd2a539cad7b7366697b5a575"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3948b05950fdd64002a5f182c65ba5cf2d53cf71"},{"fixed":"ed0ca7d2127c63991cfaf1932b827e3f4f8ee480"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3948b05950fdd64002a5f182c65ba5cf2d53cf71"},{"fixed":"648e440c98e260dec835e48a5d7a9993477b1f9d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3948b05950fdd64002a5f182c65ba5cf2d53cf71"},{"fixed":"14ad6ed30a10afbe91b0749d6378285f4225d482"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.2","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.2","v6.13.3","v6.13.4","v6.14-rc1","v6.14-rc2","v6.3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.100","v6.6.101","v6.6.102","v6.6.103","v6.6.104","v6.6.105","v6.6.106","v6.6.107","v6.6.108","v6.6.109","v6.6.11","v6.6.110","v6.6.111","v6.6.112","v6.6.113","v6.6.114","v6.6.115","v6.6.116","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.85","v6.6.86","v6.6.87","v6.6.88","v6.6.89","v6.6.9","v6.6.90","v6.6.91","v6.6.92","v6.6.93","v6.6.94","v6.6.95","v6.6.96","v6.6.97","v6.6.98","v6.6.99","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21868.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["66464984044989641838692862360403415726","180888583535088193565948343615392379217","195638054748728715901254000117670395163","328146032499603225415236007666642122150","240720520783843070372696734223219747585","201888260171967772421503104049888788091","86771343988629436610937622428962589258","9625076923187086824300261750866780202","70725960238278772895498361913067660085","148922904552327208519747089385767836444","262621222475873452632041850023090208322","2933635983952471141210863673238851209","298592254438644683379576196464837891295","127770160938213801974918266971947434922","113621552025259168134338893621999799385"],"threshold":0.9},"id":"CVE-2025-21868-1eb83961","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@14ad6ed30a10afbe91b0749d6378285f4225d482","target":{"file":"net/core/skbuff.c"}},{"deprecated":false,"digest":{"function_hash":"147091746223922752751585636894341055539","length":1259},"id":"CVE-2025-21868-22baacc3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed0ca7d2127c63991cfaf1932b827e3f4f8ee480","target":{"file":"net/core/skbuff.c","function":"napi_alloc_skb"}},{"deprecated":false,"digest":{"function_hash":"145619947933174668484016292223129630357","length":1119},"id":"CVE-2025-21868-3162b51c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed0ca7d2127c63991cfaf1932b827e3f4f8ee480","target":{"file":"net/core/skbuff.c","function":"__netdev_alloc_skb"}},{"deprecated":false,"digest":{"function_hash":"62459630536879510741872536711247063749","length":1268},"id":"CVE-2025-21868-35509f82","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@648e440c98e260dec835e48a5d7a9993477b1f9d","target":{"file":"net/core/skbuff.c","function":"napi_alloc_skb"}},{"deprecated":false,"digest":{"line_hashes":["66464984044989641838692862360403415726","180888583535088193565948343615392379217","309205931425341100146748323113163554548","276776548743189730253112909823002968135","138596145347551239631073605504289115652","339419738521070213474354528857571479734","102565992020502548253842455047586468262","9625076923187086824300261750866780202","70725960238278772895498361913067660085","148922904552327208519747089385767836444","262621222475873452632041850023090208322","2933635983952471141210863673238851209","298592254438644683379576196464837891295","127770160938213801974918266971947434922","113621552025259168134338893621999799385"],"threshold":0.9},"id":"CVE-2025-21868-3e9a632f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed8a77fee4618facd2a539cad7b7366697b5a575","target":{"file":"net/core/skbuff.c"}},{"deprecated":false,"digest":{"function_hash":"62459630536879510741872536711247063749","length":1268},"id":"CVE-2025-21868-a92a2274","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@14ad6ed30a10afbe91b0749d6378285f4225d482","target":{"file":"net/core/skbuff.c","function":"napi_alloc_skb"}},{"deprecated":false,"digest":{"function_hash":"188862888238147059258238513271030177326","length":1031},"id":"CVE-2025-21868-c7e3bbed","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed8a77fee4618facd2a539cad7b7366697b5a575","target":{"file":"net/core/skbuff.c","function":"__netdev_alloc_skb"}},{"deprecated":false,"digest":{"line_hashes":["66464984044989641838692862360403415726","180888583535088193565948343615392379217","195638054748728715901254000117670395163","328146032499603225415236007666642122150","240720520783843070372696734223219747585","201888260171967772421503104049888788091","86771343988629436610937622428962589258","9625076923187086824300261750866780202","70725960238278772895498361913067660085","148922904552327208519747089385767836444","262621222475873452632041850023090208322","2933635983952471141210863673238851209","298592254438644683379576196464837891295","127770160938213801974918266971947434922","113621552025259168134338893621999799385"],"threshold":0.9},"id":"CVE-2025-21868-d7e649d2","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@648e440c98e260dec835e48a5d7a9993477b1f9d","target":{"file":"net/core/skbuff.c"}},{"deprecated":false,"digest":{"line_hashes":["66464984044989641838692862360403415726","180888583535088193565948343615392379217","195638054748728715901254000117670395163","328146032499603225415236007666642122150","240720520783843070372696734223219747585","201888260171967772421503104049888788091","86771343988629436610937622428962589258","9625076923187086824300261750866780202","70725960238278772895498361913067660085","148922904552327208519747089385767836444","262621222475873452632041850023090208322","2933635983952471141210863673238851209","298592254438644683379576196464837891295","127770160938213801974918266971947434922","113621552025259168134338893621999799385"],"threshold":0.9},"id":"CVE-2025-21868-dc212693","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed0ca7d2127c63991cfaf1932b827e3f4f8ee480","target":{"file":"net/core/skbuff.c"}},{"deprecated":false,"digest":{"function_hash":"280693020703617997276050610052239289296","length":1155},"id":"CVE-2025-21868-f3148a30","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ed8a77fee4618facd2a539cad7b7366697b5a575","target":{"file":"net/core/skbuff.c","function":"__napi_alloc_skb"}},{"deprecated":false,"digest":{"function_hash":"223075065904716880835322590748440820603","length":1131},"id":"CVE-2025-21868-fa27ec8b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@14ad6ed30a10afbe91b0749d6378285f4225d482","target":{"file":"net/core/skbuff.c","function":"__netdev_alloc_skb"}},{"deprecated":false,"digest":{"function_hash":"223075065904716880835322590748440820603","length":1131},"id":"CVE-2025-21868-ff4a1c36","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@648e440c98e260dec835e48a5d7a9993477b1f9d","target":{"file":"net/core/skbuff.c","function":"__netdev_alloc_skb"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.4.0"},{"fixed":"6.6.117"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.17"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21868.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/14ad6ed30a10afbe91b0749d6378285f4225d482"},{"type":"WEB","url":"https://git.kernel.org/stable/c/648e440c98e260dec835e48a5d7a9993477b1f9d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ed0ca7d2127c63991cfaf1932b827e3f4f8ee480"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ed8a77fee4618facd2a539cad7b7366697b5a575"}]}