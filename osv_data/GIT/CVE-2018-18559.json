{"schema_version":"1.7.3","id":"CVE-2018-18559","published":"2018-10-22T16:29:00.360Z","modified":"2025-11-28T11:34:47.070082Z","details":"In the Linux kernel through 4.19, a use-after-free can occur due to a race condition between fanout_add from setsockopt and bind on an AF_PACKET socket. This issue exists because of the 15fe076edea787807a7cdc168df832544b58eba6 incomplete fix for a race condition. The code mishandles a certain multithreaded case involving a packet_do_bind unregister action followed by a packet_notifier register action. Later, packet_release operates on only one of the two applicable linked lists. The attacker can achieve Program Counter control.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/torvalds/linux","events":[{"introduced":"0"},{"fixed":"6a13feb9c82803e2b815eca72fa7a9f5561d7861"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2018-18559.json"}},{"ranges":[{"type":"GIT","repo":"http://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git","events":[{"introduced":"0"},{"fixed":"1860e379875dfe7271c649058aeddffe5afd9d0d"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2018-18559.json"}}],"references":[{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHBA-2019:0327"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2019:0163"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2019:0188"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2019:1170"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2019:1190"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2019:3967"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2019:4159"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2020:0174"},{"type":"EVIDENCE","url":"https://blogs.securiteam.com/index.php/archives/3731"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}