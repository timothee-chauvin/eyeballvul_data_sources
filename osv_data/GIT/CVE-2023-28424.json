{"schema_version":"1.7.3","id":"CVE-2023-28424","published":"2023-03-20T12:47:13.250Z","modified":"2025-11-20T12:16:55.891507Z","aliases":["GHSA-gc2x-86p3-mxg2"],"summary":"Soko SQL Injection vulnerability","details":"Soko if the code that powers packages.gentoo.org. Prior to version 1.0.2, the two package search handlers, `Search` and `SearchFeed`, implemented in `pkg/app/handler/packages/search.go`, are affected by a SQL injection via the `q` parameter. As a result, unauthenticated attackers can execute arbitrary SQL queries on `https://packages.gentoo.org/`. It was also demonstrated that primitive was enough to gain code execution in the context of the PostgreSQL container. The issue was addressed in commit `4fa6e4b619c0362728955b6ec56eab0e0cbf1e23y` of version 1.0.2 using prepared statements to interpolate user-controlled data in SQL queries.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/gentoo/soko","events":[{"introduced":"0"},{"fixed":"d3516dc8fcefff629c5b196b8a4d4c4a21b6bc40"}]}],"versions":["v0.1.11","v0.1.12","v0.1.13","v0.1.14","v0.1.15","v0.1.16","v0.1.17","v0.1.18","v0.1.19","v0.1.20","v0.1.21","v0.1.22","v0.1.23","v0.2.0","v0.2.2","v0.2.3","v0.2.4","v0.2.5","v0.2.6","v1.0.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-28424.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/gentoo/soko/security/advisories/GHSA-gc2x-86p3-mxg2"},{"type":"WEB","url":"https://gitweb.gentoo.org/sites/soko.git/commit/?id=4fa6e4b619c0362728955b6ec56eab0e0cbf1e23"},{"type":"ARTICLE","url":"https://www.sonarsource.com/blog/why-orms-and-prepared-statements-cant-always-win"}],"database_specific":{"cwe_ids":["CWE-89"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H"}]}