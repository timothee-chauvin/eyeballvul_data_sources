{"schema_version":"1.7.3","id":"CVE-2022-48780","published":"2024-07-16T11:13:17Z","modified":"2025-10-21T08:14:06.975472Z","related":["SUSE-SU-2024:2894-1","SUSE-SU-2024:2902-1","SUSE-SU-2024:2929-1","SUSE-SU-2024:2939-1","SUSE-SU-2024:2947-1"],"summary":"net/smc: Avoid overwriting the copies of clcsock callback functions","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnet/smc: Avoid overwriting the copies of clcsock callback functions\n\nThe callback functions of clcsock will be saved and replaced during\nthe fallback. But if the fallback happens more than once, then the\ncopies of these callback functions will be overwritten incorrectly,\nresulting in a loop call issue:\n\nclcsk->sk_error_report\n |- smc_fback_error_report() <------------------------------|\n     |- smc_fback_forward_wakeup()                          | (loop)\n         |- clcsock_callback()  (incorrectly overwritten)   |\n             |- smc->clcsk_error_report() ------------------|\n\nSo this patch fixes the issue by saving these function pointers only\nonce in the fallback and avoiding overwriting.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0ef6049f664941bc0f75828b3a61877635048b27"},{"fixed":"7de7ba7a8bd4fde0141de8674c13514d0072f0e6"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"504078fbe9dd570d685361b57784a6050bc40aaa"},{"fixed":"f00b6c976ae0dfbd9b891175f713f59095d23842"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"341adeec9adad0874f29a0a1af35638207352a39"},{"fixed":"1de9770d121ee9294794cca0e0be8fbfa0134ee8"}]}],"versions":["v5.15.22","v5.15.23","v5.15.24","v5.16.10","v5.16.8","v5.16.9","v5.17-rc2","v5.17-rc3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48780.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"312862722644734456509820763395284750483","length":1197},"id":"CVE-2022-48780-0b82d4ab","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f00b6c976ae0dfbd9b891175f713f59095d23842","target":{"file":"net/smc/af_smc.c","function":"smc_switch_to_fallback"}},{"deprecated":false,"digest":{"function_hash":"277514690307747790470982246835440707082","length":1168},"id":"CVE-2022-48780-3c4274ec","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7de7ba7a8bd4fde0141de8674c13514d0072f0e6","target":{"file":"net/smc/af_smc.c","function":"smc_switch_to_fallback"}},{"deprecated":false,"digest":{"line_hashes":["167944346300054745282735736106077428949","52405173870688063298651228540148296891","64054446620057753046295662126998387234","6480936261941358984277808904722432220","5126352606281903128004075250628091176","275937257363092955009001316919977322815","313987029026646669074294026239426245457","114041996912457746558376769502518206670","321340123823187622476483179417174402089","70366721335734935448421416748959610346","158455778052937850841668383238229480247","246039312177377129672445545922069075733","162658445934824173732683495891855891534","42125653395252953916891423820540929739","334764714684719101552875090230438559717","118143521438112921130459211706756666930"],"threshold":0.9},"id":"CVE-2022-48780-4bad86bc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1de9770d121ee9294794cca0e0be8fbfa0134ee8","target":{"file":"net/smc/af_smc.c"}},{"deprecated":false,"digest":{"line_hashes":["167944346300054745282735736106077428949","52405173870688063298651228540148296891","64054446620057753046295662126998387234","6480936261941358984277808904722432220","5126352606281903128004075250628091176","275937257363092955009001316919977322815","313987029026646669074294026239426245457","114041996912457746558376769502518206670","321340123823187622476483179417174402089","70366721335734935448421416748959610346","158455778052937850841668383238229480247","246039312177377129672445545922069075733","162658445934824173732683495891855891534","42125653395252953916891423820540929739","334764714684719101552875090230438559717","118143521438112921130459211706756666930"],"threshold":0.9},"id":"CVE-2022-48780-5a5bdadc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7de7ba7a8bd4fde0141de8674c13514d0072f0e6","target":{"file":"net/smc/af_smc.c"}},{"deprecated":false,"digest":{"line_hashes":["167944346300054745282735736106077428949","52405173870688063298651228540148296891","64054446620057753046295662126998387234","6480936261941358984277808904722432220","5126352606281903128004075250628091176","275937257363092955009001316919977322815","313987029026646669074294026239426245457","114041996912457746558376769502518206670","321340123823187622476483179417174402089","70366721335734935448421416748959610346","158455778052937850841668383238229480247","246039312177377129672445545922069075733","162658445934824173732683495891855891534","42125653395252953916891423820540929739","334764714684719101552875090230438559717","118143521438112921130459211706756666930"],"threshold":0.9},"id":"CVE-2022-48780-c1ab21bd","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f00b6c976ae0dfbd9b891175f713f59095d23842","target":{"file":"net/smc/af_smc.c"}},{"deprecated":false,"digest":{"function_hash":"312862722644734456509820763395284750483","length":1197},"id":"CVE-2022-48780-cb1ace47","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1de9770d121ee9294794cca0e0be8fbfa0134ee8","target":{"file":"net/smc/af_smc.c","function":"smc_switch_to_fallback"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.15.22"},{"fixed":"5.15.25"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.8"},{"fixed":"5.16.11"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48780.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1de9770d121ee9294794cca0e0be8fbfa0134ee8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7de7ba7a8bd4fde0141de8674c13514d0072f0e6"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f00b6c976ae0dfbd9b891175f713f59095d23842"}]}