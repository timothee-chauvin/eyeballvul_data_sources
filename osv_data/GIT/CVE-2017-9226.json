{"schema_version":"1.7.3","id":"CVE-2017-9226","published":"2017-05-24T15:29:00Z","modified":"2025-10-25T12:04:17.716343Z","related":["MGASA-2017-0246","SUSE-SU-2017:1585-1","SUSE-SU-2017:1662-1","SUSE-SU-2017:1717-1"],"details":"An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A heap out-of-bounds write or read occurs in next_state_val() during regular expression compilation. Octal numbers larger than 0xff are not handled correctly in fetch_token() and fetch_token_in_cc(). A malformed regular expression containing an octal number in the form of '\\700' would produce an invalid code point value larger than 0xff in next_state_val(), resulting in an out-of-bounds write memory corruption.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/kkos/oniguruma","events":[{"introduced":"0"},{"fixed":"b4bf968ad52afe14e60a2dc8a95d3555c543353a"},{"fixed":"f015fbdd95f76438cd86366467bb2b39870dd7c6"}]}],"versions":["v5.9.6","v6.0.0","v6.1.0","v6.1.1","v6.1.2","v6.1.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2017-9226.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["340282246448782130687958519807593876335","19691577292326266259481888258337573200","285750249724714625561365284898613084533","290219382971341702585136164131101210587","216387815878479387550531275983473066368","174739561935101457874745057573467750982","311901103716194130129169947058170981802","290219382971341702585136164131101210587"],"threshold":0.9},"id":"CVE-2017-9226-03e1ab44","signature_type":"Line","signature_version":"v1","source":"https://github.com/kkos/oniguruma/commit/f015fbdd95f76438cd86366467bb2b39870dd7c6","target":{"file":"src/regparse.c"}},{"deprecated":false,"digest":{"line_hashes":["246829258880076191915156482018696757530","223947624233669634426607050500944957916","160761884261585877422819118548410376246","223713518639165331567966595224563676527"],"threshold":0.9},"id":"CVE-2017-9226-4c23b0ba","signature_type":"Line","signature_version":"v1","source":"https://github.com/kkos/oniguruma/commit/b4bf968ad52afe14e60a2dc8a95d3555c543353a","target":{"file":"src/regparse.c"}},{"deprecated":false,"digest":{"function_hash":"237816653384729961923500547356155140782","length":1647},"id":"CVE-2017-9226-af653b09","signature_type":"Function","signature_version":"v1","source":"https://github.com/kkos/oniguruma/commit/b4bf968ad52afe14e60a2dc8a95d3555c543353a","target":{"file":"src/regparse.c","function":"next_state_val"}}]}},{"ranges":[{"type":"GIT","repo":"https://github.com/php/php-src","events":[{"introduced":"0"},{"fixed":"de96a08a90e480f1afb655bcfeac8ac28a14228e"}]}],"versions":["NEWS","NEWS-cvs2svn","php-5.3.23RC1","php-5.3.29","php-5.3.29RC1","php-5.4.30RC1","php-5.4.32RC1","php-5.4.4RC2","php-5.5.24RC1","php-5.6.18RC1","php-5.6.19RC1","php-5.6.22RC1","php-5.6.23RC1","php-5.6.24RC1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2017-9226.json"}}],"references":[{"type":"ADVISORY","url":"http://www.securityfocus.com/bid/101244"},{"type":"ADVISORY","url":"https://access.redhat.com/errata/RHSA-2018:1296"},{"type":"FIX","url":"https://github.com/kkos/oniguruma/commit/b4bf968ad52afe14e60a2dc8a95d3555c543353a"},{"type":"FIX","url":"https://github.com/kkos/oniguruma/commit/f015fbdd95f76438cd86366467bb2b39870dd7c6"},{"type":"REPORT","url":"https://github.com/kkos/oniguruma/issues/55"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}