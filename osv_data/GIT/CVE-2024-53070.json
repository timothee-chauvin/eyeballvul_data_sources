{"schema_version":"1.7.3","id":"CVE-2024-53070","published":"2024-11-19T17:22:37.706Z","modified":"2025-11-20T07:26:39.060088Z","summary":"usb: dwc3: fix fault at system suspend if device was already runtime suspended","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nusb: dwc3: fix fault at system suspend if device was already runtime suspended\n\nIf the device was already runtime suspended then during system suspend\nwe cannot access the device registers else it will crash.\n\nAlso we cannot access any registers after dwc3_core_exit() on some\nplatforms so move the dwc3_enable_susphy() call to the top.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"073530898ebf44a9418434e899cfa9ca86945333"},{"fixed":"d9e65d461a9de037e7c9d584776d025cfce6d86d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"85ca88f93162acb94dbcb26d0ee2b145864d14a1"},{"fixed":"562804b1561cc248cc37746a1c96c83cab1d7209"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"4fad7370086797afe6471493e3a5f36add8c48a7"},{"fixed":"4abc5ee334fe4aba50461c45fdaaa4c5e5c57789"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a690a9e38e6ba819789074388de7cff06425ef5b"},{"fixed":"06b98197b69e2f2af9cb1991ee0b1c876edf7b86"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"705e3ce37bccdf2ed6f848356ff355f480d51a91"},{"fixed":"9cfb31e4c89d200d8ab7cb1e0bb9e6e8d621ca0b"}]}],"versions":["v5.15.170","v5.15.171","v6.1.115","v6.1.116","v6.11.5","v6.11.6","v6.11.7","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.6.59","v6.6.60"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-53070.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["234934459784192404252581047097950687724","127139664674326309260464615289691602469","31277242069927374899134751708978415710","71738948280618271436440978217374359459","10886827548196111897027755230175875975","175036605187339495674429358199995068122","161406479801455073152840099447628111734","262715510115842931639563917521846851958","19677845862915618503859464029699344611","99683114325861419735891452032208396402","73123272985033289918041052606503515519","19750739422058439909898940291701117976","259793734382735789922425634234757583630","172612620507036228801957186453488853550"],"threshold":0.9},"id":"CVE-2024-53070-134405f7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9cfb31e4c89d200d8ab7cb1e0bb9e6e8d621ca0b","target":{"file":"drivers/usb/dwc3/core.c"}},{"deprecated":false,"digest":{"function_hash":"281268315519800326385376666291089698458","length":1267},"id":"CVE-2024-53070-26606ecf","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4abc5ee334fe4aba50461c45fdaaa4c5e5c57789","target":{"file":"drivers/usb/dwc3/core.c","function":"dwc3_suspend_common"}},{"deprecated":false,"digest":{"line_hashes":["53472957655063577194572834501326746118","67089801618401680475054767267881190065","312463192174343702054443127842873007146","71738948280618271436440978217374359459","10886827548196111897027755230175875975","175036605187339495674429358199995068122","161406479801455073152840099447628111734","262715510115842931639563917521846851958","19677845862915618503859464029699344611","99683114325861419735891452032208396402","73123272985033289918041052606503515519","19750739422058439909898940291701117976","259793734382735789922425634234757583630","172612620507036228801957186453488853550"],"threshold":0.9},"id":"CVE-2024-53070-2ed75cca","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@562804b1561cc248cc37746a1c96c83cab1d7209","target":{"file":"drivers/usb/dwc3/core.c"}},{"deprecated":false,"digest":{"line_hashes":["53472957655063577194572834501326746118","67089801618401680475054767267881190065","312463192174343702054443127842873007146","71738948280618271436440978217374359459","10886827548196111897027755230175875975","175036605187339495674429358199995068122","161406479801455073152840099447628111734","262715510115842931639563917521846851958","19677845862915618503859464029699344611","99683114325861419735891452032208396402","73123272985033289918041052606503515519","19750739422058439909898940291701117976","259793734382735789922425634234757583630","172612620507036228801957186453488853550"],"threshold":0.9},"id":"CVE-2024-53070-3e95085b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4abc5ee334fe4aba50461c45fdaaa4c5e5c57789","target":{"file":"drivers/usb/dwc3/core.c"}},{"deprecated":false,"digest":{"line_hashes":["234934459784192404252581047097950687724","127139664674326309260464615289691602469","31277242069927374899134751708978415710","71738948280618271436440978217374359459","10886827548196111897027755230175875975","175036605187339495674429358199995068122","161406479801455073152840099447628111734","262715510115842931639563917521846851958","19677845862915618503859464029699344611","99683114325861419735891452032208396402","73123272985033289918041052606503515519","19750739422058439909898940291701117976","259793734382735789922425634234757583630","172612620507036228801957186453488853550"],"threshold":0.9},"id":"CVE-2024-53070-4935c8a4","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06b98197b69e2f2af9cb1991ee0b1c876edf7b86","target":{"file":"drivers/usb/dwc3/core.c"}},{"deprecated":false,"digest":{"function_hash":"274943449861648479910063737241603391456","length":1474},"id":"CVE-2024-53070-4df4ce04","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@06b98197b69e2f2af9cb1991ee0b1c876edf7b86","target":{"file":"drivers/usb/dwc3/core.c","function":"dwc3_suspend_common"}},{"deprecated":false,"digest":{"function_hash":"281268315519800326385376666291089698458","length":1267},"id":"CVE-2024-53070-5e6f091e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@562804b1561cc248cc37746a1c96c83cab1d7209","target":{"file":"drivers/usb/dwc3/core.c","function":"dwc3_suspend_common"}},{"deprecated":false,"digest":{"line_hashes":["53472957655063577194572834501326746118","67089801618401680475054767267881190065","312463192174343702054443127842873007146","71738948280618271436440978217374359459","10886827548196111897027755230175875975","175036605187339495674429358199995068122","161406479801455073152840099447628111734","262715510115842931639563917521846851958","19677845862915618503859464029699344611","99683114325861419735891452032208396402","73123272985033289918041052606503515519","19750739422058439909898940291701117976","259793734382735789922425634234757583630","172612620507036228801957186453488853550"],"threshold":0.9},"id":"CVE-2024-53070-adee0dcc","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d9e65d461a9de037e7c9d584776d025cfce6d86d","target":{"file":"drivers/usb/dwc3/core.c"}},{"deprecated":false,"digest":{"function_hash":"180128671509587666323857724442512590387","length":1236},"id":"CVE-2024-53070-c065b289","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d9e65d461a9de037e7c9d584776d025cfce6d86d","target":{"file":"drivers/usb/dwc3/core.c","function":"dwc3_suspend_common"}},{"deprecated":false,"digest":{"function_hash":"274943449861648479910063737241603391456","length":1474},"id":"CVE-2024-53070-d0855856","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9cfb31e4c89d200d8ab7cb1e0bb9e6e8d621ca0b","target":{"file":"drivers/usb/dwc3/core.c","function":"dwc3_suspend_common"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.15.170"},{"fixed":"5.15.172"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.1.115"},{"fixed":"6.1.117"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.6.59"},{"fixed":"6.6.61"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.11.5"},{"fixed":"6.11.8"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-53070.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/06b98197b69e2f2af9cb1991ee0b1c876edf7b86"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4abc5ee334fe4aba50461c45fdaaa4c5e5c57789"},{"type":"WEB","url":"https://git.kernel.org/stable/c/562804b1561cc248cc37746a1c96c83cab1d7209"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9cfb31e4c89d200d8ab7cb1e0bb9e6e8d621ca0b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d9e65d461a9de037e7c9d584776d025cfce6d86d"},{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}