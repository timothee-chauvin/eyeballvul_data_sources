{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42255.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "330559386909620614849006131443317143572",
              "length": 2914.0
            },
            "id": "CVE-2024-42255-2dacedf2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7dc357d343f134bf59815ff6098b93503ec8a23b",
            "target": {
              "file": "drivers/char/tpm/tpm2-sessions.c",
              "function": "tpm_buf_check_hmac_response"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "275439108711383552819123635987428199541",
                "39836838015670048934074447592023993083",
                "99252284515178845035220531785988342281",
                "131318224562656852388729918031893038671",
                "176290610628516141847512791013688113542",
                "207211183015008313855114162903248490620",
                "48052485520003613562689756668727871186",
                "74110799796669504891316248943460824574",
                "41478494632827092371700686026331684624",
                "41095982304806607020079922252397306925"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42255-acea2127",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7dc357d343f134bf59815ff6098b93503ec8a23b",
            "target": {
              "file": "drivers/char/tpm/tpm2-sessions.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "275439108711383552819123635987428199541",
                "39836838015670048934074447592023993083",
                "99252284515178845035220531785988342281",
                "131318224562656852388729918031893038671",
                "176290610628516141847512791013688113542",
                "207211183015008313855114162903248490620",
                "48052485520003613562689756668727871186",
                "74110799796669504891316248943460824574",
                "41478494632827092371700686026331684624",
                "41095982304806607020079922252397306925"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42255-b2640001",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b9afbb9a0c734197c59c43610071041044bf1562",
            "target": {
              "file": "drivers/char/tpm/tpm2-sessions.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "330559386909620614849006131443317143572",
              "length": 2914.0
            },
            "id": "CVE-2024-42255-ee7252c6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b9afbb9a0c734197c59c43610071041044bf1562",
            "target": {
              "file": "drivers/char/tpm/tpm2-sessions.c",
              "function": "tpm_buf_check_hmac_response"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "7ca110f2679b7d1f3ac1afc90e6ffbf0af3edf0d"
            },
            {
              "fixed": "b9afbb9a0c734197c59c43610071041044bf1562"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "7ca110f2679b7d1f3ac1afc90e6ffbf0af3edf0d"
            },
            {
              "fixed": "7dc357d343f134bf59815ff6098b93503ec8a23b"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10",
        "v6.10-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42255.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.10.0"
            },
            {
              "fixed": "6.10.1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ntpm: Use auth only after NULL check in tpm_buf_check_hmac_response()\n\nDereference auth after NULL check in tpm_buf_check_hmac_response().\nOtherwise, unless tpm2_sessions_init() was called, a call can cause NULL\ndereference, when TCG_TPM2_HMAC is enabled.\n\n[jarkko: adjusted the commit message.]",
  "id": "CVE-2024-42255",
  "modified": "2025-10-22T00:25:42.585620Z",
  "published": "2024-08-08T08:49:15Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7dc357d343f134bf59815ff6098b93503ec8a23b"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/b9afbb9a0c734197c59c43610071041044bf1562"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "tpm: Use auth only after NULL check in tpm_buf_check_hmac_response()"
}