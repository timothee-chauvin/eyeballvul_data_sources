{"schema_version":"1.7.3","id":"CVE-2022-50706","published":"2025-12-24T10:55:20.835Z","modified":"2025-12-24T21:04:06.374377Z","summary":"net/ieee802154: don't warn zero-sized raw_sendmsg()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnet/ieee802154: don't warn zero-sized raw_sendmsg()\n\nsyzbot is hitting skb_assert_len() warning at __dev_queue_xmit() [1],\nfor PF_IEEE802154 socket's zero-sized raw_sendmsg() request is hitting\n__dev_queue_xmit() with skb->len == 0.\n\nSince PF_IEEE802154 socket's zero-sized raw_sendmsg() request was\nable to return 0, don't call __dev_queue_xmit() if packet length is 0.\n\n  ----------\n  #include <sys/socket.h>\n  #include <netinet/in.h>\n\n  int main(int argc, char *argv[])\n  {\n    struct sockaddr_in addr = { .sin_family = AF_INET, .sin_addr.s_addr = htonl(INADDR_LOOPBACK) };\n    struct iovec iov = { };\n    struct msghdr hdr = { .msg_name = &addr, .msg_namelen = sizeof(addr), .msg_iov = &iov, .msg_iovlen = 1 };\n    sendmsg(socket(PF_IEEE802154, SOCK_RAW, 0), &hdr, 0);\n    return 0;\n  }\n  ----------\n\nNote that this might be a sign that commit fd1894224407c484 (\"bpf: Don't\nredirect packets with invalid pkt_len\") should be reverted, for\nskb->len == 0 was acceptable for at least PF_IEEE802154 socket.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8b68e53d56697a59b5c53893b53f508bbdf272a0"},{"fixed":"4a36de8947794fa21435d1e916e089095f3246a8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"6204bf78b2a903b96ba43afff6abc0b04d6e0462"},{"fixed":"791489a5c56396ddfed75fc525066d4738dace46"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a75987714bd2d8e59840667a28e15c1fa5c47554"},{"fixed":"34f31a2b667914ab701ca725554a0b447809d7ef"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"72f2dc8993f10262092745a88cb2dd0fef094f23"},{"fixed":"df0da3fc131132b6c32a15c4da4ffa3a5aea1af2"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"fd1894224407c484f652ad456e1ce423e89bb3eb"},{"fixed":"9974d220c5073d035b5469d1d8ecd71da86c7afd"},{"fixed":"b12e924a2f5b960373459c8f8a514f887adf5cac"}]}],"versions":["v5.10.141","v5.10.142","v5.10.143","v5.10.144","v5.10.145","v5.10.146","v5.10.147","v5.10.148","v5.10.149","v5.15.65","v5.15.66","v5.15.67","v5.15.68","v5.15.69","v5.15.70","v5.15.71","v5.15.72","v5.15.73","v5.15.74","v5.19","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.19.10","v5.19.11","v5.19.12","v5.19.13","v5.19.14","v5.19.15","v5.19.16","v5.19.7","v5.19.8","v5.19.9","v5.4.212","v5.4.213","v5.4.214","v5.4.215","v5.4.216","v5.4.217","v5.4.218","v5.4.219","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50706.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.4.220"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.5.0"},{"fixed":"5.10.150"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.11.0"},{"fixed":"5.15.75"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.19.17"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.20.0"},{"fixed":"6.0.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50706.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/34f31a2b667914ab701ca725554a0b447809d7ef"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4a36de8947794fa21435d1e916e089095f3246a8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/791489a5c56396ddfed75fc525066d4738dace46"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9974d220c5073d035b5469d1d8ecd71da86c7afd"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b12e924a2f5b960373459c8f8a514f887adf5cac"},{"type":"WEB","url":"https://git.kernel.org/stable/c/df0da3fc131132b6c32a15c4da4ffa3a5aea1af2"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50706.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-50706"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50706.json"}}