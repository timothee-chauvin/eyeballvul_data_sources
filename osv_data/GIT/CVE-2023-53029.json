{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53029.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "180216307134842886694760735474275332236",
                "73766870951184596162189131585467257738",
                "276154736603202248226885812527572249087",
                "302138788453522313351344653576620148404",
                "120167065127459444517910082478258242426"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53029-14a5e790",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55ba18dc62deff5910c0fa64486dea1ff20832ff",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "46203870725528048262521291233896244719",
              "length": 751.0
            },
            "id": "CVE-2023-53029-452f3232",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55ba18dc62deff5910c0fa64486dea1ff20832ff",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_pool_refill_task"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "162720610922771334184989391925643476931",
                "264778674184036028371811308252936262445",
                "157616157347591298529733864676610495477",
                "285319259176757935580237532246276841458",
                "290629332248977481608044023129319534996",
                "249884151540044385259222636892595590505",
                "164027980976133695205824592697125690073",
                "118125071581963578967397272017538416694",
                "270374587135269108840072380966154265374",
                "112728635514345889341677939728286232776",
                "273462732968119976802381864858116961295",
                "267813192304616549074914162872341395276",
                "183660800804357254881121579914702652136",
                "127376506023992377152049668983619574163",
                "98135601722605301404944427420983074532",
                "41780164687145270615236382328131373396",
                "16388829864833136734923325468099038755",
                "124690888505038174048177215258289233044",
                "176564619164250756809854026601987551198",
                "180233603617291384761990367155193994706",
                "116611432715365045169913150171823142451",
                "170399564376689379885466684278298749053",
                "315670181134482412750768425803470699229",
                "39184864846242535504813100298088261431",
                "140845289174719778707070715358557969878",
                "160408167133207267832755974967990932414",
                "305835127996705234460526506324522499667",
                "52622931572608389616961811712972720066",
                "315745102206753280539892084044488588933",
                "292441242241910570033993983003257403373",
                "182804587115187196819090791579178429782"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53029-6703d79e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@659518e013d6bd562bb0f1d2d9f99d0ac54720e2",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "78520111330014718882320739170594944014",
              "length": 1357.0
            },
            "id": "CVE-2023-53029-749096b8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55ba18dc62deff5910c0fa64486dea1ff20832ff",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_sq_aura_pool_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "180216307134842886694760735474275332236",
                "73766870951184596162189131585467257738",
                "276154736603202248226885812527572249087",
                "302138788453522313351344653576620148404",
                "120167065127459444517910082478258242426"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53029-75ee4c34",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29e9c67bf3271067735c188e95cf3631ecd64d58",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "268187038418160126476666220738034681316",
              "length": 1034.0
            },
            "id": "CVE-2023-53029-7fbaa814",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@659518e013d6bd562bb0f1d2d9f99d0ac54720e2",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_rq_aura_pool_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "162720610922771334184989391925643476931",
                "264778674184036028371811308252936262445",
                "157616157347591298529733864676610495477",
                "285319259176757935580237532246276841458",
                "290629332248977481608044023129319534996",
                "249884151540044385259222636892595590505",
                "164027980976133695205824592697125690073",
                "118125071581963578967397272017538416694",
                "270374587135269108840072380966154265374",
                "112728635514345889341677939728286232776",
                "273462732968119976802381864858116961295",
                "267813192304616549074914162872341395276",
                "183660800804357254881121579914702652136",
                "127376506023992377152049668983619574163",
                "98135601722605301404944427420983074532",
                "41780164687145270615236382328131373396",
                "16388829864833136734923325468099038755",
                "124690888505038174048177215258289233044",
                "176564619164250756809854026601987551198",
                "180233603617291384761990367155193994706",
                "116611432715365045169913150171823142451",
                "170399564376689379885466684278298749053",
                "315670181134482412750768425803470699229",
                "39184864846242535504813100298088261431",
                "140845289174719778707070715358557969878",
                "160408167133207267832755974967990932414",
                "305835127996705234460526506324522499667",
                "52622931572608389616961811712972720066",
                "315745102206753280539892084044488588933",
                "292441242241910570033993983003257403373",
                "182804587115187196819090791579178429782"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53029-8ebe63b7",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29e9c67bf3271067735c188e95cf3631ecd64d58",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "268187038418160126476666220738034681316",
              "length": 1034.0
            },
            "id": "CVE-2023-53029-ab71610b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29e9c67bf3271067735c188e95cf3631ecd64d58",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_rq_aura_pool_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "180216307134842886694760735474275332236",
                "73766870951184596162189131585467257738",
                "276154736603202248226885812527572249087",
                "302138788453522313351344653576620148404",
                "120167065127459444517910082478258242426"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53029-b6a4b292",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@659518e013d6bd562bb0f1d2d9f99d0ac54720e2",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "190272289396674518321199261150761998009",
              "length": 175.0
            },
            "id": "CVE-2023-53029-bc126023",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29e9c67bf3271067735c188e95cf3631ecd64d58",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.h",
              "function": "cn10k_aura_freeptr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "190272289396674518321199261150761998009",
              "length": 175.0
            },
            "id": "CVE-2023-53029-d2bc700e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55ba18dc62deff5910c0fa64486dea1ff20832ff",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.h",
              "function": "cn10k_aura_freeptr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "268187038418160126476666220738034681316",
              "length": 1034.0
            },
            "id": "CVE-2023-53029-d3ef3eaf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55ba18dc62deff5910c0fa64486dea1ff20832ff",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_rq_aura_pool_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "46203870725528048262521291233896244719",
              "length": 751.0
            },
            "id": "CVE-2023-53029-dabb52e8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29e9c67bf3271067735c188e95cf3631ecd64d58",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_pool_refill_task"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "46203870725528048262521291233896244719",
              "length": 751.0
            },
            "id": "CVE-2023-53029-df2ffcf6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@659518e013d6bd562bb0f1d2d9f99d0ac54720e2",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_pool_refill_task"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "219606042562827496164380052415873188473",
              "length": 1349.0
            },
            "id": "CVE-2023-53029-e33b2bca",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@29e9c67bf3271067735c188e95cf3631ecd64d58",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_sq_aura_pool_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "190272289396674518321199261150761998009",
              "length": 175.0
            },
            "id": "CVE-2023-53029-eed50328",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@659518e013d6bd562bb0f1d2d9f99d0ac54720e2",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.h",
              "function": "cn10k_aura_freeptr"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "78520111330014718882320739170594944014",
              "length": 1357.0
            },
            "id": "CVE-2023-53029-f9e52562",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@659518e013d6bd562bb0f1d2d9f99d0ac54720e2",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c",
              "function": "otx2_sq_aura_pool_init"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "162720610922771334184989391925643476931",
                "264778674184036028371811308252936262445",
                "157616157347591298529733864676610495477",
                "285319259176757935580237532246276841458",
                "290629332248977481608044023129319534996",
                "249884151540044385259222636892595590505",
                "164027980976133695205824592697125690073",
                "118125071581963578967397272017538416694",
                "270374587135269108840072380966154265374",
                "112728635514345889341677939728286232776",
                "273462732968119976802381864858116961295",
                "267813192304616549074914162872341395276",
                "183660800804357254881121579914702652136",
                "127376506023992377152049668983619574163",
                "98135601722605301404944427420983074532",
                "41780164687145270615236382328131373396",
                "16388829864833136734923325468099038755",
                "124690888505038174048177215258289233044",
                "176564619164250756809854026601987551198",
                "180233603617291384761990367155193994706",
                "116611432715365045169913150171823142451",
                "170399564376689379885466684278298749053",
                "315670181134482412750768425803470699229",
                "39184864846242535504813100298088261431",
                "140845289174719778707070715358557969878",
                "160408167133207267832755974967990932414",
                "305835127996705234460526506324522499667",
                "52622931572608389616961811712972720066",
                "315745102206753280539892084044488588933",
                "292441242241910570033993983003257403373",
                "182804587115187196819090791579178429782"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-53029-fdc691a0",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@55ba18dc62deff5910c0fa64486dea1ff20832ff",
            "target": {
              "file": "drivers/net/ethernet/marvell/octeontx2/nic/otx2_common.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6ea5273c71dd2d07c0a2459594eb34bc087939f7"
            },
            {
              "fixed": "29e9c67bf3271067735c188e95cf3631ecd64d58"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "667ce030bdfb62a86266444b2c3fd6ab98b9df9b"
            },
            {
              "fixed": "659518e013d6bd562bb0f1d2d9f99d0ac54720e2"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "4af1b64f80fbe1275fb02c5f1c0cef099a4a231f"
            },
            {
              "fixed": "55ba18dc62deff5910c0fa64486dea1ff20832ff"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "b754dc7c933dd9464223f64b10d33d68ab086cc6"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.15.87",
        "v5.15.88",
        "v5.15.89",
        "v5.15.90",
        "v6.0.19",
        "v6.1.5",
        "v6.1.6",
        "v6.1.7",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-53029.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.15.87"
            },
            {
              "fixed": "5.15.91"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.1.5"
            },
            {
              "fixed": "6.1.8"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nocteontx2-pf: Fix the use of GFP_KERNEL in atomic context on rt\n\nThe commit 4af1b64f80fb (\"octeontx2-pf: Fix lmtst ID used in aura\nfree\") uses the get/put_cpu() to protect the usage of percpu pointer\nin ->aura_freeptr() callback, but it also unnecessarily disable the\npreemption for the blockable memory allocation. The commit 87b93b678e95\n(\"octeontx2-pf: Avoid use of GFP_KERNEL in atomic context\") tried to\nfix these sleep inside atomic warnings. But it only fix the one for\nthe non-rt kernel. For the rt kernel, we still get the similar warnings\nlike below.\n  BUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:46\n  in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 1, name: swapper/0\n  preempt_count: 1, expected: 0\n  RCU nest depth: 0, expected: 0\n  3 locks held by swapper/0/1:\n   #0: ffff800009fc5fe8 (rtnl_mutex){+.+.}-{3:3}, at: rtnl_lock+0x24/0x30\n   #1: ffff000100c276c0 (&mbox->lock){+.+.}-{3:3}, at: otx2_init_hw_resources+0x8c/0x3a4\n   #2: ffffffbfef6537e0 (&cpu_rcache->lock){+.+.}-{2:2}, at: alloc_iova_fast+0x1ac/0x2ac\n  Preemption disabled at:\n  [<ffff800008b1908c>] otx2_rq_aura_pool_init+0x14c/0x284\n  CPU: 20 PID: 1 Comm: swapper/0 Tainted: G        W          6.2.0-rc3-rt1-yocto-preempt-rt #1\n  Hardware name: Marvell OcteonTX CN96XX board (DT)\n  Call trace:\n   dump_backtrace.part.0+0xe8/0xf4\n   show_stack+0x20/0x30\n   dump_stack_lvl+0x9c/0xd8\n   dump_stack+0x18/0x34\n   __might_resched+0x188/0x224\n   rt_spin_lock+0x64/0x110\n   alloc_iova_fast+0x1ac/0x2ac\n   iommu_dma_alloc_iova+0xd4/0x110\n   __iommu_dma_map+0x80/0x144\n   iommu_dma_map_page+0xe8/0x260\n   dma_map_page_attrs+0xb4/0xc0\n   __otx2_alloc_rbuf+0x90/0x150\n   otx2_rq_aura_pool_init+0x1c8/0x284\n   otx2_init_hw_resources+0xe4/0x3a4\n   otx2_open+0xf0/0x610\n   __dev_open+0x104/0x224\n   __dev_change_flags+0x1e4/0x274\n   dev_change_flags+0x2c/0x7c\n   ic_open_devs+0x124/0x2f8\n   ip_auto_config+0x180/0x42c\n   do_one_initcall+0x90/0x4dc\n   do_basic_setup+0x10c/0x14c\n   kernel_init_freeable+0x10c/0x13c\n   kernel_init+0x2c/0x140\n   ret_from_fork+0x10/0x20\n\nOf course, we can shuffle the get/put_cpu() to only wrap the invocation\nof ->aura_freeptr() as what commit 87b93b678e95 does. But there are only\ntwo ->aura_freeptr() callbacks, otx2_aura_freeptr() and\ncn10k_aura_freeptr(). There is no usage of perpcu variable in the\notx2_aura_freeptr() at all, so the get/put_cpu() seems redundant to it.\nWe can move the get/put_cpu() into the corresponding callback which\nreally has the percpu variable usage and avoid the sprinkling of\nget/put_cpu() in several places.",
  "id": "CVE-2023-53029",
  "modified": "2025-10-15T05:06:41.954026Z",
  "published": "2025-03-27T16:43:58Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/29e9c67bf3271067735c188e95cf3631ecd64d58"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/55ba18dc62deff5910c0fa64486dea1ff20832ff"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/659518e013d6bd562bb0f1d2d9f99d0ac54720e2"
    }
  ],
  "related": [
    "SUSE-SU-2025:1176-1",
    "SUSE-SU-2025:1183-1",
    "SUSE-SU-2025:1195-1",
    "SUSE-SU-2025:1241-1"
  ],
  "schema_version": "1.7.3",
  "summary": "octeontx2-pf: Fix the use of GFP_KERNEL in atomic context on rt"
}