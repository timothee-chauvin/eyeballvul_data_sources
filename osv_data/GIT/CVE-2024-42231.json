{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42231.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "111570144147256242034325936683787484027",
              "length": 689.0
            },
            "id": "CVE-2024-42231-86ff2c4b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@64d2c847ba380e07b9072d65a50aa6469d2aa43f",
            "target": {
              "file": "fs/btrfs/space-info.c",
              "function": "calc_available_free_space"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "264896501254534420060854194846358495698",
                "273945088907208304172681797415345522148",
                "202880255307875286303159967565411961936",
                "215660131205248125487102136420637474896",
                "263590013630866355677375942412011642846",
                "136991707268335943792921444503042678127",
                "221565812803549751044773682956720389434",
                "16175307409547202757341904625058581057",
                "81656005573639338683559473854351339942",
                "197414405891962085248153945342564385049",
                "281197924023161341594435156172358271297"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42231-af74f527",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8548903b1999bba02a2b894ad750ab8eb1f40307",
            "target": {
              "file": "fs/btrfs/space-info.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "111570144147256242034325936683787484027",
              "length": 689.0
            },
            "id": "CVE-2024-42231-c3b254f4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8548903b1999bba02a2b894ad750ab8eb1f40307",
            "target": {
              "file": "fs/btrfs/space-info.c",
              "function": "calc_available_free_space"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "264896501254534420060854194846358495698",
                "273945088907208304172681797415345522148",
                "202880255307875286303159967565411961936",
                "215660131205248125487102136420637474896",
                "263590013630866355677375942412011642846",
                "136991707268335943792921444503042678127",
                "221565812803549751044773682956720389434",
                "16175307409547202757341904625058581057",
                "81656005573639338683559473854351339942",
                "197414405891962085248153945342564385049",
                "281197924023161341594435156172358271297"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42231-dcbcae6e",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@64d2c847ba380e07b9072d65a50aa6469d2aa43f",
            "target": {
              "file": "fs/btrfs/space-info.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "cb6cbab79055ca207ad88bc54226b48ececdcef0"
            },
            {
              "fixed": "8548903b1999bba02a2b894ad750ab8eb1f40307"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "cb6cbab79055ca207ad88bc54226b48ececdcef0"
            },
            {
              "fixed": "64d2c847ba380e07b9072d65a50aa6469d2aa43f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.6",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7",
        "v6.9.1",
        "v6.9.2",
        "v6.9.3",
        "v6.9.4",
        "v6.9.5",
        "v6.9.6",
        "v6.9.7",
        "v6.9.8"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42231.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.9.9"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: zoned: fix calc_available_free_space() for zoned mode\n\ncalc_available_free_space() returns the total size of metadata (or\nsystem) block groups, which can be allocated from unallocated disk\nspace. The logic is wrong on zoned mode in two places.\n\nFirst, the calculation of data_chunk_size is wrong. We always allocate\none zone as one chunk, and no partial allocation of a zone. So, we\nshould use zone_size (= data_sinfo->chunk_size) as it is.\n\nSecond, the result \"avail\" may not be zone aligned. Since we always\nallocate one zone as one chunk on zoned mode, returning non-zone size\naligned bytes will result in less pressure on the async metadata reclaim\nprocess.\n\nThis is serious for the nearly full state with a large zone size device.\nAllowing over-commit too much will result in less async reclaim work and\nend up in ENOSPC. We can align down to the zone size to avoid that.",
  "id": "CVE-2024-42231",
  "modified": "2025-10-15T12:56:45.983201Z",
  "published": "2024-07-30T07:47:11Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/64d2c847ba380e07b9072d65a50aa6469d2aa43f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8548903b1999bba02a2b894ad750ab8eb1f40307"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "btrfs: zoned: fix calc_available_free_space() for zoned mode"
}