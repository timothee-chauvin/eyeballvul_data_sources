{"schema_version":"1.7.3","id":"CVE-2025-39840","published":"2025-09-19T15:26:15.596Z","modified":"2025-11-20T10:18:36.370435Z","summary":"audit: fix out-of-bounds read in audit_compare_dname_path()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\naudit: fix out-of-bounds read in audit_compare_dname_path()\n\nWhen a watch on dir=/ is combined with an fsnotify event for a\nsingle-character name directly under / (e.g., creating /a), an\nout-of-bounds read can occur in audit_compare_dname_path().\n\nThe helper parent_len() returns 1 for \"/\". In audit_compare_dname_path(),\nwhen parentlen equals the full path length (1), the code sets p = path + 1\nand pathlen = 1 - 1 = 0. The subsequent loop then dereferences\np[pathlen - 1] (i.e., p[-1]), causing an out-of-bounds read.\n\nFix this by adding a pathlen > 0 check to the while loop condition\nto prevent the out-of-bounds access.\n\n[PM: subject tweak, sign-off email fixes]","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e92eebb0d6116f942ab25dfb1a41905aa59472a8"},{"fixed":"9735a9dcc307427e7d6336c54171682f1bac9789"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"e92eebb0d6116f942ab25dfb1a41905aa59472a8"},{"fixed":"4540f1d23e7f387880ce46d11b5cd3f27248bf8d"}]}],"versions":["v6.13","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.16.2","v6.16.3","v6.16.4","v6.16.5","v6.17-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39840.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["96692580629798573454633274034291333684","152099902894371534829727487830655890809","85571996574643361132254346196756861992","131322665195200399924308810355938342441"],"threshold":0.9},"id":"CVE-2025-39840-17a09e91","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9735a9dcc307427e7d6336c54171682f1bac9789","target":{"file":"kernel/auditfilter.c"}},{"deprecated":false,"digest":{"function_hash":"304950747395841280818791968589251641975","length":409},"id":"CVE-2025-39840-1dc2e463","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9735a9dcc307427e7d6336c54171682f1bac9789","target":{"file":"kernel/auditfilter.c","function":"audit_compare_dname_path"}},{"deprecated":false,"digest":{"function_hash":"304950747395841280818791968589251641975","length":409},"id":"CVE-2025-39840-489e302a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4540f1d23e7f387880ce46d11b5cd3f27248bf8d","target":{"file":"kernel/auditfilter.c","function":"audit_compare_dname_path"}},{"deprecated":false,"digest":{"line_hashes":["96692580629798573454633274034291333684","152099902894371534829727487830655890809","85571996574643361132254346196756861992","131322665195200399924308810355938342441"],"threshold":0.9},"id":"CVE-2025-39840-ad4a9b10","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4540f1d23e7f387880ce46d11b5cd3f27248bf8d","target":{"file":"kernel/auditfilter.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.16.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39840.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4540f1d23e7f387880ce46d11b5cd3f27248bf8d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9735a9dcc307427e7d6336c54171682f1bac9789"}]}