{"schema_version":"1.7.3","id":"CVE-2024-58087","published":"2025-03-12T07:28:09.114Z","modified":"2025-11-20T08:21:32.606820Z","related":["USN-7379-2","USN-7380-1"],"summary":"ksmbd: fix racy issue from session lookup and expire","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nksmbd: fix racy issue from session lookup and expire\n\nIncrement the session reference count within the lock for lookup to avoid\nracy issue with session expire.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0626e6641f6b467447c81dd7678a69c66f7746cf"},{"fixed":"2107ab40629aeabbec369cf34b8cf0f288c3eb1b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0626e6641f6b467447c81dd7678a69c66f7746cf"},{"fixed":"37a0e2b362b3150317fb6e2139de67b1e29ae5ff"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0626e6641f6b467447c81dd7678a69c66f7746cf"},{"fixed":"450a844c045ff0895d41b05a1cbe8febd1acfcfd"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0626e6641f6b467447c81dd7678a69c66f7746cf"},{"fixed":"a39e31e22a535d47b14656a7d6a893c7f6cf758c"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0626e6641f6b467447c81dd7678a69c66f7746cf"},{"fixed":"b95629435b84b9ecc0c765995204a4d8a913ed52"}]}],"versions":["v5.13","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.100","v5.15.101","v5.15.102","v5.15.103","v5.15.104","v5.15.105","v5.15.106","v5.15.107","v5.15.108","v5.15.109","v5.15.11","v5.15.110","v5.15.111","v5.15.112","v5.15.113","v5.15.114","v5.15.115","v5.15.116","v5.15.117","v5.15.118","v5.15.119","v5.15.12","v5.15.120","v5.15.121","v5.15.122","v5.15.123","v5.15.124","v5.15.125","v5.15.126","v5.15.127","v5.15.128","v5.15.129","v5.15.13","v5.15.130","v5.15.131","v5.15.132","v5.15.133","v5.15.134","v5.15.135","v5.15.136","v5.15.137","v5.15.138","v5.15.139","v5.15.14","v5.15.140","v5.15.141","v5.15.142","v5.15.143","v5.15.144","v5.15.145","v5.15.146","v5.15.147","v5.15.148","v5.15.149","v5.15.15","v5.15.150","v5.15.151","v5.15.152","v5.15.153","v5.15.154","v5.15.155","v5.15.156","v5.15.157","v5.15.158","v5.15.159","v5.15.16","v5.15.160","v5.15.161","v5.15.162","v5.15.163","v5.15.164","v5.15.165","v5.15.166","v5.15.167","v5.15.168","v5.15.169","v5.15.17","v5.15.170","v5.15.171","v5.15.172","v5.15.173","v5.15.174","v5.15.175","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.34","v5.15.35","v5.15.36","v5.15.37","v5.15.38","v5.15.39","v5.15.4","v5.15.40","v5.15.41","v5.15.42","v5.15.43","v5.15.44","v5.15.45","v5.15.46","v5.15.47","v5.15.48","v5.15.49","v5.15.5","v5.15.50","v5.15.51","v5.15.52","v5.15.53","v5.15.54","v5.15.55","v5.15.56","v5.15.57","v5.15.58","v5.15.59","v5.15.6","v5.15.60","v5.15.61","v5.15.62","v5.15.63","v5.15.64","v5.15.65","v5.15.66","v5.15.67","v5.15.68","v5.15.69","v5.15.7","v5.15.70","v5.15.71","v5.15.72","v5.15.73","v5.15.74","v5.15.75","v5.15.76","v5.15.77","v5.15.78","v5.15.79","v5.15.8","v5.15.80","v5.15.81","v5.15.82","v5.15.83","v5.15.84","v5.15.85","v5.15.86","v5.15.87","v5.15.88","v5.15.89","v5.15.9","v5.15.90","v5.15.91","v5.15.92","v5.15.93","v5.15.94","v5.15.95","v5.15.96","v5.15.97","v5.15.98","v5.15.99","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1","v6.1.10","v6.1.100","v6.1.101","v6.1.102","v6.1.103","v6.1.104","v6.1.105","v6.1.106","v6.1.107","v6.1.108","v6.1.109","v6.1.11","v6.1.110","v6.1.111","v6.1.112","v6.1.113","v6.1.114","v6.1.115","v6.1.116","v6.1.117","v6.1.118","v6.1.119","v6.1.12","v6.1.120","v6.1.13","v6.1.14","v6.1.15","v6.1.16","v6.1.17","v6.1.18","v6.1.19","v6.1.2","v6.1.20","v6.1.21","v6.1.22","v6.1.23","v6.1.24","v6.1.25","v6.1.26","v6.1.27","v6.1.28","v6.1.29","v6.1.3","v6.1.30","v6.1.31","v6.1.32","v6.1.33","v6.1.34","v6.1.35","v6.1.36","v6.1.37","v6.1.38","v6.1.39","v6.1.4","v6.1.40","v6.1.41","v6.1.42","v6.1.43","v6.1.44","v6.1.45","v6.1.46","v6.1.47","v6.1.48","v6.1.49","v6.1.5","v6.1.50","v6.1.51","v6.1.52","v6.1.53","v6.1.54","v6.1.55","v6.1.56","v6.1.57","v6.1.58","v6.1.59","v6.1.6","v6.1.60","v6.1.61","v6.1.62","v6.1.63","v6.1.64","v6.1.65","v6.1.66","v6.1.67","v6.1.68","v6.1.69","v6.1.7","v6.1.70","v6.1.71","v6.1.72","v6.1.73","v6.1.74","v6.1.75","v6.1.76","v6.1.77","v6.1.78","v6.1.79","v6.1.8","v6.1.80","v6.1.81","v6.1.82","v6.1.83","v6.1.84","v6.1.85","v6.1.86","v6.1.87","v6.1.88","v6.1.89","v6.1.9","v6.1.90","v6.1.91","v6.1.92","v6.1.93","v6.1.94","v6.1.95","v6.1.96","v6.1.97","v6.1.98","v6.1.99","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.2","v6.12.3","v6.12.4","v6.12.5","v6.13-rc1","v6.13-rc2","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.7","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-58087.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["174642087773597100680714116701243832494","143339783025284997501755949666624927224","243683150127734130175893312788044640945","141383703571940648893017343758063603694","7728336243601854232981882993151655621","142949104169179428300703286977629526513","31715953891863727478331590336904418460","290455627063893070404479078058197514577","146414869685380641261771601353903995138","245919472972405690904125963632943225788","102480430537368423485582374885332295836","301514083477634257403870746536423369263","19467393402695991178277707575615214747","268894035716584692193609268681795203523","57399262971957800705321710468392278013","330767205700684621049023592391170131378","245687328402431530328460079173235911454","224622890390430060108729835901401340063","19397045877107483767260159651516773647","227729455024122255717371692208195664720","141516277958507884354814751205491647862","286129156294973275882629386250308612113","226224344890267145276046164506560679661","132669016333126207976429743716781112206","176534853098058582977909141256704486802","131924218232077902451147216535724164149","221508784194576064310286011230999907395","117230250801240981805114192223423399353","124278523587697175523723822462728123947","205180521123260592209781109370107084495","123834680742059524783470598306375022737","251547459790379208650686119784372980105","196393185365983682794551680291440084456","175378836097225633359412194338712708945","56377740256740628979626817008067083579","221245546900411080336184660517301629335","188811786055320355280300826307054755425","293607827523871760687897473569453197259","163425371243343973055363240971340732144","197943729362135893841170435299435778661","194475586344890225181023592141006783761","328234551439663263138940137106865203445","202825267509434996239517142113698485775","261681320328612676448743698841532741227","331118526189517536588369555819057682566","161848087973550529106598217968568720540","51920475094000228797723674284291007031","43763420537849356443780711612586049637","274423480090084470069106233033246377543","326342051785340969771210937198439838539","63789397427050102418369569366185748280","194538722289599268189544930190355517871","192576731787869396472634049496233745732","86507289596464032453782177218337839560","198098697568802883068491721997367081699","309096824089028798291407357298319530749","181025575976500425989531053422445751615","288640530444553181628684153894853752660","39511710857153370475534787440216150593","28241794017138465021996585294024840827","274064964948063331118059345771021302872","62677376756460240060394440975751244257"],"threshold":0.9},"id":"CVE-2024-58087-06295987","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/smb2pdu.c"}},{"deprecated":false,"digest":{"function_hash":"169411064796528775850528319091579232202","length":892},"id":"CVE-2024-58087-09506036","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/smb2pdu.c","function":"smb2_check_user_session"}},{"deprecated":false,"digest":{"function_hash":"144164714351379928249845061112142250253","length":1031},"id":"CVE-2024-58087-1268e39f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/smb2pdu.c","function":"smb3_decrypt_req"}},{"deprecated":false,"digest":{"function_hash":"35024357104007170870884786102527908746","length":358},"id":"CVE-2024-58087-1d55de5a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/auth.c","function":"ksmbd_get_encryption_key"}},{"deprecated":false,"digest":{"function_hash":"55743829864281990652054753530223997491","length":257},"id":"CVE-2024-58087-23ff8159","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/mgmt/user_session.c","function":"ksmbd_session_lookup"}},{"deprecated":false,"digest":{"function_hash":"144164714351379928249845061112142250253","length":1031},"id":"CVE-2024-58087-25116e15","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb3_decrypt_req"}},{"deprecated":false,"digest":{"line_hashes":["50145395095520479051165984129813571705","211240636184216723410926954686972417912","276137605182258420829419670086777432264","243133989298982705667831527200678559839","304451057462061790599911560880459246152","20883261350145643671032930948743968916","288655322289476774481450745656184726127","9480718050152096671732160312250899686","331441415066238784382458217214190532718","331438199291617672061814731276768997564","19682445500633870231190456373918582553"],"threshold":0.9},"id":"CVE-2024-58087-25d66b0c","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/server.c"}},{"deprecated":false,"digest":{"function_hash":"144276890568872793469491478727165974704","length":2039},"id":"CVE-2024-58087-2a62a16d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/server.c","function":"__handle_ksmbd_work"}},{"deprecated":false,"digest":{"function_hash":"56913468066250782592744527043711424616","length":259},"id":"CVE-2024-58087-2d519d43","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/smb2pdu.c","function":"check_session_id"}},{"deprecated":false,"digest":{"line_hashes":["238875805608573796041362291415612894602","4902916830674556141807930881300263528","330642515916893901418844261897041205796","262830708983016940161496300555615583158","124409882092993324922720890826465959935","65138640076093619701431867397749485010","279709033624589385100362482193940020929","259052351039729454834193316700775469682","195802863569068386847545497729875489250"],"threshold":0.9},"id":"CVE-2024-58087-2d89c3c5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/mgmt/user_session.c"}},{"deprecated":false,"digest":{"line_hashes":["238875805608573796041362291415612894602","4902916830674556141807930881300263528","330642515916893901418844261897041205796","262830708983016940161496300555615583158","124409882092993324922720890826465959935","65138640076093619701431867397749485010","279709033624589385100362482193940020929","259052351039729454834193316700775469682","195802863569068386847545497729875489250"],"threshold":0.9},"id":"CVE-2024-58087-36088e4b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/mgmt/user_session.c"}},{"deprecated":false,"digest":{"line_hashes":["319755128993669630158387146934047335932","135679763955642429815951725146087914547","88430974490489384905893759731672032208","41402532679882996103354764037338214708"],"threshold":0.9},"id":"CVE-2024-58087-3faa962a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/auth.c"}},{"deprecated":false,"digest":{"line_hashes":["238875805608573796041362291415612894602","4902916830674556141807930881300263528","330642515916893901418844261897041205796","262830708983016940161496300555615583158","124409882092993324922720890826465959935","65138640076093619701431867397749485010","279709033624589385100362482193940020929","259052351039729454834193316700775469682","195802863569068386847545497729875489250"],"threshold":0.9},"id":"CVE-2024-58087-3fc1a886","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/mgmt/user_session.c"}},{"deprecated":false,"digest":{"line_hashes":["238875805608573796041362291415612894602","4902916830674556141807930881300263528","330642515916893901418844261897041205796","262830708983016940161496300555615583158","124409882092993324922720890826465959935","65138640076093619701431867397749485010","279709033624589385100362482193940020929","259052351039729454834193316700775469682","195802863569068386847545497729875489250"],"threshold":0.9},"id":"CVE-2024-58087-4238a2af","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/mgmt/user_session.c"}},{"deprecated":false,"digest":{"function_hash":"331897635588216772363443266387369826781","length":5333},"id":"CVE-2024-58087-4acd806a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/smb2pdu.c","function":"smb2_sess_setup"}},{"deprecated":false,"digest":{"function_hash":"125600793689711807849573752219944845370","length":1180},"id":"CVE-2024-58087-51b3dfc6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_session_logoff"}},{"deprecated":false,"digest":{"function_hash":"35024357104007170870884786102527908746","length":358},"id":"CVE-2024-58087-5c8f6b70","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/auth.c","function":"ksmbd_get_encryption_key"}},{"deprecated":false,"digest":{"function_hash":"35024357104007170870884786102527908746","length":358},"id":"CVE-2024-58087-679707d7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/auth.c","function":"ksmbd_get_encryption_key"}},{"deprecated":false,"digest":{"function_hash":"144164714351379928249845061112142250253","length":1031},"id":"CVE-2024-58087-69d954a6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb3_decrypt_req"}},{"deprecated":false,"digest":{"function_hash":"55743829864281990652054753530223997491","length":257},"id":"CVE-2024-58087-6d0a10e7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/mgmt/user_session.c","function":"ksmbd_session_lookup"}},{"deprecated":false,"digest":{"function_hash":"169411064796528775850528319091579232202","length":892},"id":"CVE-2024-58087-707394e2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_check_user_session"}},{"deprecated":false,"digest":{"function_hash":"169411064796528775850528319091579232202","length":892},"id":"CVE-2024-58087-72bb73d6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_check_user_session"}},{"deprecated":false,"digest":{"line_hashes":["174642087773597100680714116701243832494","143339783025284997501755949666624927224","243683150127734130175893312788044640945","141383703571940648893017343758063603694","7728336243601854232981882993151655621","142949104169179428300703286977629526513","31715953891863727478331590336904418460","290455627063893070404479078058197514577","146414869685380641261771601353903995138","245919472972405690904125963632943225788","102480430537368423485582374885332295836","301514083477634257403870746536423369263","19467393402695991178277707575615214747","268894035716584692193609268681795203523","57399262971957800705321710468392278013","330767205700684621049023592391170131378","245687328402431530328460079173235911454","224622890390430060108729835901401340063","19397045877107483767260159651516773647","227729455024122255717371692208195664720","141516277958507884354814751205491647862","286129156294973275882629386250308612113","226224344890267145276046164506560679661","132669016333126207976429743716781112206","176534853098058582977909141256704486802","131924218232077902451147216535724164149","221508784194576064310286011230999907395","117230250801240981805114192223423399353","124278523587697175523723822462728123947","205180521123260592209781109370107084495","123834680742059524783470598306375022737","251547459790379208650686119784372980105","196393185365983682794551680291440084456","175378836097225633359412194338712708945","56377740256740628979626817008067083579","221245546900411080336184660517301629335","188811786055320355280300826307054755425","293607827523871760687897473569453197259","163425371243343973055363240971340732144","197943729362135893841170435299435778661","194475586344890225181023592141006783761","328234551439663263138940137106865203445","202825267509434996239517142113698485775","261681320328612676448743698841532741227","331118526189517536588369555819057682566","161848087973550529106598217968568720540","51920475094000228797723674284291007031","43763420537849356443780711612586049637","274423480090084470069106233033246377543","326342051785340969771210937198439838539","63789397427050102418369569366185748280","194538722289599268189544930190355517871","192576731787869396472634049496233745732","86507289596464032453782177218337839560","188179595903200274094855687410868731721","69988685392542928445196775584576966261","109870208987812375221921761922602387509","288640530444553181628684153894853752660","39511710857153370475534787440216150593","28241794017138465021996585294024840827","274064964948063331118059345771021302872","62677376756460240060394440975751244257"],"threshold":0.9},"id":"CVE-2024-58087-7a2a1889","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/smb2pdu.c"}},{"deprecated":false,"digest":{"function_hash":"292927040301255048746112949969027981137","length":173},"id":"CVE-2024-58087-7aee9d2b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/mgmt/user_session.c","function":"ksmbd_session_lookup_slowpath"}},{"deprecated":false,"digest":{"function_hash":"292927040301255048746112949969027981137","length":173},"id":"CVE-2024-58087-7b48702a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/mgmt/user_session.c","function":"ksmbd_session_lookup_slowpath"}},{"deprecated":false,"digest":{"function_hash":"331897635588216772363443266387369826781","length":5333},"id":"CVE-2024-58087-8149ecb4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_sess_setup"}},{"deprecated":false,"digest":{"line_hashes":["319755128993669630158387146934047335932","135679763955642429815951725146087914547","88430974490489384905893759731672032208","41402532679882996103354764037338214708"],"threshold":0.9},"id":"CVE-2024-58087-81cbc986","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/auth.c"}},{"deprecated":false,"digest":{"line_hashes":["319755128993669630158387146934047335932","135679763955642429815951725146087914547","88430974490489384905893759731672032208","41402532679882996103354764037338214708"],"threshold":0.9},"id":"CVE-2024-58087-85d156eb","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/auth.c"}},{"deprecated":false,"digest":{"function_hash":"144276890568872793469491478727165974704","length":2039},"id":"CVE-2024-58087-880538ac","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/server.c","function":"__handle_ksmbd_work"}},{"deprecated":false,"digest":{"function_hash":"116126644538666366034878623035185574234","length":1186},"id":"CVE-2024-58087-887b5a0d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/smb2pdu.c","function":"smb2_session_logoff"}},{"deprecated":false,"digest":{"function_hash":"331897635588216772363443266387369826781","length":5333},"id":"CVE-2024-58087-975fc15d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_sess_setup"}},{"deprecated":false,"digest":{"function_hash":"125600793689711807849573752219944845370","length":1180},"id":"CVE-2024-58087-a15cdb63","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_session_logoff"}},{"deprecated":false,"digest":{"function_hash":"55743829864281990652054753530223997491","length":257},"id":"CVE-2024-58087-acd7ac41","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/mgmt/user_session.c","function":"ksmbd_session_lookup"}},{"deprecated":false,"digest":{"function_hash":"144276890568872793469491478727165974704","length":2039},"id":"CVE-2024-58087-b36fff44","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/server.c","function":"__handle_ksmbd_work"}},{"deprecated":false,"digest":{"function_hash":"56913468066250782592744527043711424616","length":259},"id":"CVE-2024-58087-b90069cd","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/smb2pdu.c","function":"check_session_id"}},{"deprecated":false,"digest":{"function_hash":"292927040301255048746112949969027981137","length":173},"id":"CVE-2024-58087-bbdc2f5f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/mgmt/user_session.c","function":"ksmbd_session_lookup_slowpath"}},{"deprecated":false,"digest":{"function_hash":"331897635588216772363443266387369826781","length":5333},"id":"CVE-2024-58087-bcb6e67d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_sess_setup"}},{"deprecated":false,"digest":{"function_hash":"144164714351379928249845061112142250253","length":1031},"id":"CVE-2024-58087-c4226e35","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb3_decrypt_req"}},{"deprecated":false,"digest":{"function_hash":"35024357104007170870884786102527908746","length":358},"id":"CVE-2024-58087-c57e76c7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/auth.c","function":"ksmbd_get_encryption_key"}},{"deprecated":false,"digest":{"line_hashes":["50145395095520479051165984129813571705","211240636184216723410926954686972417912","276137605182258420829419670086777432264","243133989298982705667831527200678559839","304451057462061790599911560880459246152","20883261350145643671032930948743968916","288655322289476774481450745656184726127","9480718050152096671732160312250899686","331441415066238784382458217214190532718","331438199291617672061814731276768997564","19682445500633870231190456373918582553"],"threshold":0.9},"id":"CVE-2024-58087-c91934f0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/server.c"}},{"deprecated":false,"digest":{"function_hash":"116126644538666366034878623035185574234","length":1186},"id":"CVE-2024-58087-cc401887","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_session_logoff"}},{"deprecated":false,"digest":{"line_hashes":["319755128993669630158387146934047335932","135679763955642429815951725146087914547","88430974490489384905893759731672032208","41402532679882996103354764037338214708"],"threshold":0.9},"id":"CVE-2024-58087-d120eba7","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/auth.c"}},{"deprecated":false,"digest":{"line_hashes":["174642087773597100680714116701243832494","143339783025284997501755949666624927224","243683150127734130175893312788044640945","141383703571940648893017343758063603694","7728336243601854232981882993151655621","142949104169179428300703286977629526513","31715953891863727478331590336904418460","290455627063893070404479078058197514577","146414869685380641261771601353903995138","245919472972405690904125963632943225788","102480430537368423485582374885332295836","301514083477634257403870746536423369263","19467393402695991178277707575615214747","268894035716584692193609268681795203523","57399262971957800705321710468392278013","330767205700684621049023592391170131378","245687328402431530328460079173235911454","224622890390430060108729835901401340063","19397045877107483767260159651516773647","227729455024122255717371692208195664720","141516277958507884354814751205491647862","286129156294973275882629386250308612113","226224344890267145276046164506560679661","132669016333126207976429743716781112206","176534853098058582977909141256704486802","131924218232077902451147216535724164149","221508784194576064310286011230999907395","117230250801240981805114192223423399353","124278523587697175523723822462728123947","205180521123260592209781109370107084495","123834680742059524783470598306375022737","251547459790379208650686119784372980105","196393185365983682794551680291440084456","175378836097225633359412194338712708945","56377740256740628979626817008067083579","221245546900411080336184660517301629335","188811786055320355280300826307054755425","293607827523871760687897473569453197259","163425371243343973055363240971340732144","197943729362135893841170435299435778661","194475586344890225181023592141006783761","328234551439663263138940137106865203445","202825267509434996239517142113698485775","261681320328612676448743698841532741227","331118526189517536588369555819057682566","161848087973550529106598217968568720540","51920475094000228797723674284291007031","43763420537849356443780711612586049637","274423480090084470069106233033246377543","326342051785340969771210937198439838539","63789397427050102418369569366185748280","194538722289599268189544930190355517871","192576731787869396472634049496233745732","86507289596464032453782177218337839560","198098697568802883068491721997367081699","309096824089028798291407357298319530749","181025575976500425989531053422445751615","288640530444553181628684153894853752660","39511710857153370475534787440216150593","28241794017138465021996585294024840827","274064964948063331118059345771021302872","62677376756460240060394440975751244257"],"threshold":0.9},"id":"CVE-2024-58087-d45d1f78","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/smb2pdu.c"}},{"deprecated":false,"digest":{"function_hash":"169411064796528775850528319091579232202","length":892},"id":"CVE-2024-58087-d5e508d3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/smb2pdu.c","function":"smb2_check_user_session"}},{"deprecated":false,"digest":{"line_hashes":["50145395095520479051165984129813571705","211240636184216723410926954686972417912","276137605182258420829419670086777432264","243133989298982705667831527200678559839","304451057462061790599911560880459246152","20883261350145643671032930948743968916","288655322289476774481450745656184726127","9480718050152096671732160312250899686","331441415066238784382458217214190532718","331438199291617672061814731276768997564","19682445500633870231190456373918582553"],"threshold":0.9},"id":"CVE-2024-58087-e05ed72d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/server.c"}},{"deprecated":false,"digest":{"function_hash":"55743829864281990652054753530223997491","length":257},"id":"CVE-2024-58087-e350d6c1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/mgmt/user_session.c","function":"ksmbd_session_lookup"}},{"deprecated":false,"digest":{"function_hash":"56913468066250782592744527043711424616","length":259},"id":"CVE-2024-58087-e3a199ae","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@450a844c045ff0895d41b05a1cbe8febd1acfcfd","target":{"file":"fs/smb/server/smb2pdu.c","function":"check_session_id"}},{"deprecated":false,"digest":{"function_hash":"292927040301255048746112949969027981137","length":173},"id":"CVE-2024-58087-e62579f1","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/mgmt/user_session.c","function":"ksmbd_session_lookup_slowpath"}},{"deprecated":false,"digest":{"line_hashes":["174642087773597100680714116701243832494","143339783025284997501755949666624927224","243683150127734130175893312788044640945","141383703571940648893017343758063603694","7728336243601854232981882993151655621","142949104169179428300703286977629526513","31715953891863727478331590336904418460","290455627063893070404479078058197514577","146414869685380641261771601353903995138","245919472972405690904125963632943225788","102480430537368423485582374885332295836","301514083477634257403870746536423369263","19467393402695991178277707575615214747","268894035716584692193609268681795203523","57399262971957800705321710468392278013","330767205700684621049023592391170131378","245687328402431530328460079173235911454","224622890390430060108729835901401340063","19397045877107483767260159651516773647","227729455024122255717371692208195664720","141516277958507884354814751205491647862","286129156294973275882629386250308612113","226224344890267145276046164506560679661","132669016333126207976429743716781112206","176534853098058582977909141256704486802","131924218232077902451147216535724164149","221508784194576064310286011230999907395","117230250801240981805114192223423399353","124278523587697175523723822462728123947","205180521123260592209781109370107084495","123834680742059524783470598306375022737","251547459790379208650686119784372980105","196393185365983682794551680291440084456","175378836097225633359412194338712708945","56377740256740628979626817008067083579","221245546900411080336184660517301629335","188811786055320355280300826307054755425","293607827523871760687897473569453197259","163425371243343973055363240971340732144","197943729362135893841170435299435778661","194475586344890225181023592141006783761","328234551439663263138940137106865203445","202825267509434996239517142113698485775","261681320328612676448743698841532741227","331118526189517536588369555819057682566","161848087973550529106598217968568720540","51920475094000228797723674284291007031","43763420537849356443780711612586049637","274423480090084470069106233033246377543","326342051785340969771210937198439838539","63789397427050102418369569366185748280","194538722289599268189544930190355517871","192576731787869396472634049496233745732","86507289596464032453782177218337839560","188179595903200274094855687410868731721","69988685392542928445196775584576966261","109870208987812375221921761922602387509","288640530444553181628684153894853752660","39511710857153370475534787440216150593","28241794017138465021996585294024840827","274064964948063331118059345771021302872","62677376756460240060394440975751244257"],"threshold":0.9},"id":"CVE-2024-58087-f2fa79e5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/smb2pdu.c"}},{"deprecated":false,"digest":{"function_hash":"56913468066250782592744527043711424616","length":259},"id":"CVE-2024-58087-f7f8ddc8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a39e31e22a535d47b14656a7d6a893c7f6cf758c","target":{"file":"fs/smb/server/smb2pdu.c","function":"check_session_id"}},{"deprecated":false,"digest":{"line_hashes":["50145395095520479051165984129813571705","211240636184216723410926954686972417912","276137605182258420829419670086777432264","243133989298982705667831527200678559839","304451057462061790599911560880459246152","20883261350145643671032930948743968916","288655322289476774481450745656184726127","9480718050152096671732160312250899686","331441415066238784382458217214190532718","331438199291617672061814731276768997564","19682445500633870231190456373918582553"],"threshold":0.9},"id":"CVE-2024-58087-faaaed6a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2107ab40629aeabbec369cf34b8cf0f288c3eb1b","target":{"file":"fs/ksmbd/server.c"}},{"deprecated":false,"digest":{"function_hash":"144276890568872793469491478727165974704","length":2039},"id":"CVE-2024-58087-fcd4516f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@37a0e2b362b3150317fb6e2139de67b1e29ae5ff","target":{"file":"fs/smb/server/server.c","function":"__handle_ksmbd_work"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.15.0"},{"fixed":"5.15.176"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"6.1.121"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.67"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-58087.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2107ab40629aeabbec369cf34b8cf0f288c3eb1b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/37a0e2b362b3150317fb6e2139de67b1e29ae5ff"},{"type":"WEB","url":"https://git.kernel.org/stable/c/450a844c045ff0895d41b05a1cbe8febd1acfcfd"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a39e31e22a535d47b14656a7d6a893c7f6cf758c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b95629435b84b9ecc0c765995204a4d8a913ed52"},{"type":"ADVISORY","url":"https://www.zerodayinitiative.com/advisories/ZDI-25-100/"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}