{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-44943.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "105388473705378612208241885926441027912",
                "222068017173196717689506641345138254764",
                "84246035007616769859986959864640345590",
                "113270078462729240511229593070177024521",
                "105388473705378612208241885926441027912",
                "222068017173196717689506641345138254764",
                "84246035007616769859986959864640345590",
                "113270078462729240511229593070177024521",
                "267584096075035546830582049166932694231",
                "193683721559754854173610560081066077320",
                "115565369235831448360813574336506204466",
                "161207962310420079171569704170343566577"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-44943-0068636c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/huge_memory.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "182318675254465805004141011861545058559",
              "length": 728.0
            },
            "id": "CVE-2024-44943-06033daf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/gup.c",
              "function": "__gup_device_huge"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "13431429088154014414484160871638977172",
              "length": 915.0
            },
            "id": "CVE-2024-44943-0762b742",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "gup_hugepte"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "228014182851822775592186016909775891123",
              "length": 2234.0
            },
            "id": "CVE-2024-44943-27b16d92",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "__get_user_pages"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "105388473705378612208241885926441027912",
                "222068017173196717689506641345138254764",
                "84246035007616769859986959864640345590",
                "113270078462729240511229593070177024521"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-44943-2ce039fd",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/huge_memory.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "175213574796388636122195668871520583133",
                "338819611113867789463633538641696667690",
                "236643594709120001319572722831582649843",
                "118665234894585507000261390992598421732"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-44943-2cf432da",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/hugetlb.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "105234193725551536739133821214684178681",
                "296669816122867861428388387870892787967",
                "96583377056720107688709504847825778579",
                "72354617625212437454165683272841689964",
                "15537414461300215656383211478194996256",
                "210091874483811180300593447355782667693",
                "258948143335311969046614420195054146854",
                "112934687599225470980736739669880054360",
                "58596866830811563280600440883643722680",
                "252792251407046483045616935060189075518",
                "37072799601807604246049180181009915743",
                "92348630402596743451624282598986343882",
                "72600928013124927678527284984406352708",
                "78296227223900364478506826122731119860",
                "42921652010628308869554284329843117340",
                "333941416042975432688762806793304504547",
                "165587056345920090533898044425958688577",
                "3385538468422971702171480516643494584",
                "93638995124060081765637545601644574153",
                "173529162945356846675904797996237083882",
                "177127020168927239499703367077971312716",
                "72541520649976410092331551734657190687",
                "75375671270667114388090281964753676855",
                "133993674985337635339291291802485570833",
                "52196643559013936796576552387241116542",
                "20011424731723428113821244443567718618",
                "880220817439639225745844045185169649",
                "201660155623043981722478268718269214091",
                "195941412634753955257212319857790526452",
                "262400013148064241290675216712791369858",
                "188510604704994663822519576749363772571",
                "263226645692114878764702329651658373737",
                "82560967895146142263758936946887441005",
                "108099369810701060025098122627511713757",
                "274243505320942467022187945976049576602",
                "262822864877118324562444870217276785307",
                "185176501823767628885927180822873909039",
                "68754541256362677374782681271014260227",
                "222607525754094057356853241779742124128",
                "284268375269565365782690566392243077228",
                "23256852166440999607055045887904332056",
                "163114847834545905344247735230868032123",
                "180850686577268256954108126952777106784",
                "175699750406162468768542330017962347141",
                "41662837261231228267874347777869221224",
                "142558130802614535512186263147100609565",
                "305987672854903914614799224214601852604",
                "256511187283436827760900210679210662150",
                "82624737372852975150322897117792389640",
                "158541895814975336109418975555049740812",
                "131957199424564132945497232126465259646",
                "312177133664656923358921623005947289447",
                "277556613646062604656942233626722317049",
                "238874599161690262936484964022189193725",
                "310820506571488622388401628613284206077",
                "319973597664007851293192313024618928795",
                "132174173632822686108048582333561164172",
                "94920671813569462366846821214189102137",
                "34854368903935672187087286586135027063",
                "59061521829540946702490535387800850660",
                "204534637832113608233489073649709818362",
                "171601407707169866719101811416071821080",
                "82914308936553117569469839636381271827",
                "252628326857997928072054579747832127098",
                "219639844585620733418021157786902268389",
                "259054422277484197352934705879649400969",
                "220110281989742019057985408907353915758",
                "311033164124988614774801423080236190348",
                "191622375851133048877497358720084751334",
                "47959091149468262108748396409845498067",
                "216318936818533818236481327018938052959",
                "34063256312648060723100681534021654669",
                "101478454221529261030480615817047780714",
                "166569099926602188814001447752608354305",
                "79507125623343869828982277861824228323",
                "320676470773962527452947181091568762614",
                "191862765178118492189736782929221199435",
                "76479424823698170671128690380417386127",
                "49706753158861381676749050286299876968",
                "57246058380116653280831442711735934126",
                "205522998103729641935037099463239423895",
                "47959091149468262108748396409845498067",
                "309922334417353912178548470050448626896",
                "212880551836037403410871170104904421502",
                "131875529043338280842934266525924451769",
                "118533164576662059131225318139810710685",
                "179819597611136747463813004352947813624",
                "340164603693505713205137684368550140314",
                "267584096075035546830582049166932694231",
                "193683721559754854173610560081066077320",
                "115565369235831448360813574336506204466",
                "63993469553825629427982521521501112963",
                "91241027678772227416337594264232154387",
                "116121813557185887815878101269317259011",
                "50960449654547140625478272119973099726",
                "63940921586875181753184739586294444735",
                "233883966089922512309615794624078175777",
                "104035986669076567455624924950252833180",
                "262489909234841911940371298918214400431",
                "301860324931795137376838191627358298724",
                "106612214076149256503182811325285230206",
                "309080763416518091317478190512763956240",
                "52459264161714389992654756228058525550",
                "257766001288599854179507845740393381794",
                "242699076283481274692448326658420469253",
                "124514621543563036829578981010606629731",
                "13505864649077308542367101313679458887",
                "326500139186745983278246491770560658465",
                "96047575769500884583805356518494642078",
                "27895743818610304482073488473461241397",
                "156704162878434795989219156766449898881",
                "117211968508960916914080531374433826083",
                "94426464050847757596022007115616808212",
                "118277849511203950400807931497067953546",
                "223298500321136185137417142817413099220",
                "104740493380164574063146049873214161776",
                "306955387937682145811670886292058824888",
                "46219020411605761150724374599326135473",
                "196576302813975691038875146078054870659",
                "319938186469511513929220603941488147001",
                "221424054122957725455990430623652652425",
                "40078186380864295610172595846313522758",
                "8665031185114714582688760613979415930",
                "41446645746205559081033693610710489989",
                "107976790050589006477576049322802937285",
                "74247698134849635903148566058677149264",
                "335181170971549609063031008279546634543",
                "6807840553272138982718068964931522574",
                "138823143223534676641922775587322881788",
                "190689971047220578667441857502694518284",
                "92424274738990069808619801792192357519",
                "135181713626063593703492048111009201952",
                "209525156846981836218250331633629816405",
                "69479054837651216104384624201635981015",
                "229420746237145719161181908837495882604",
                "17376668512268432857634952089696641831",
                "18834287769983490453742483283903229659",
                "318760190350533833655109683548888549692",
                "274154150592099539061717301884654518580",
                "329738358091121854539598620175288702429",
                "326224331535828508260773371816134168549",
                "48971221666298147999115455323492027855",
                "83295808735105698131189507311252688713",
                "171974791282290083580879162122911711484",
                "151949678862850201445790576392580252777",
                "88441386838750826544512811322259588977",
                "115257023414285844422020200402625975798"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-44943-31a17b2a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "192647162345522202830838983849772792809",
              "length": 788.0
            },
            "id": "CVE-2024-44943-32321ce4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "follow_devmap_pud"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "177386623404661557321425812685824131078",
              "length": 558.0
            },
            "id": "CVE-2024-44943-3dd2238b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/gup.c",
              "function": "try_grab_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "105234193725551536739133821214684178681",
                "296669816122867861428388387870892787967",
                "96583377056720107688709504847825778579",
                "72354617625212437454165683272841689964",
                "15537414461300215656383211478194996256",
                "210091874483811180300593447355782667693",
                "258948143335311969046614420195054146854",
                "112934687599225470980736739669880054360",
                "58596866830811563280600440883643722680",
                "252792251407046483045616935060189075518",
                "37072799601807604246049180181009915743",
                "92348630402596743451624282598986343882",
                "72600928013124927678527284984406352708",
                "78296227223900364478506826122731119860",
                "42921652010628308869554284329843117340",
                "333941416042975432688762806793304504547",
                "176205230644578558153638758089023599476",
                "332818565164911582233810750286515036824",
                "285334402212132625858290244785239857045",
                "32893229730647097388997111203904961446",
                "177127020168927239499703367077971312716",
                "72541520649976410092331551734657190687",
                "75375671270667114388090281964753676855",
                "133993674985337635339291291802485570833",
                "52196643559013936796576552387241116542",
                "20011424731723428113821244443567718618",
                "880220817439639225745844045185169649",
                "201660155623043981722478268718269214091",
                "195941412634753955257212319857790526452",
                "262400013148064241290675216712791369858",
                "188510604704994663822519576749363772571",
                "263226645692114878764702329651658373737",
                "105963821293807514438324835156114773121",
                "108099369810701060025098122627511713757",
                "274243505320942467022187945976049576602",
                "262822864877118324562444870217276785307",
                "185176501823767628885927180822873909039",
                "68754541256362677374782681271014260227",
                "222607525754094057356853241779742124128",
                "284268375269565365782690566392243077228",
                "23256852166440999607055045887904332056",
                "163114847834545905344247735230868032123",
                "180850686577268256954108126952777106784",
                "175699750406162468768542330017962347141",
                "41662837261231228267874347777869221224",
                "142558130802614535512186263147100609565",
                "305987672854903914614799224214601852604",
                "256511187283436827760900210679210662150",
                "82624737372852975150322897117792389640",
                "158541895814975336109418975555049740812",
                "131957199424564132945497232126465259646",
                "312177133664656923358921623005947289447",
                "277556613646062604656942233626722317049",
                "238874599161690262936484964022189193725",
                "91241027678772227416337594264232154387",
                "116121813557185887815878101269317259011",
                "50960449654547140625478272119973099726",
                "63940921586875181753184739586294444735",
                "233883966089922512309615794624078175777",
                "104035986669076567455624924950252833180",
                "262489909234841911940371298918214400431",
                "301860324931795137376838191627358298724",
                "106612214076149256503182811325285230206",
                "309080763416518091317478190512763956240",
                "52459264161714389992654756228058525550",
                "257766001288599854179507845740393381794",
                "242699076283481274692448326658420469253",
                "124514621543563036829578981010606629731",
                "13505864649077308542367101313679458887",
                "326500139186745983278246491770560658465",
                "84124977024104368485086964695920888302",
                "235456925226151343697203428331048411534",
                "174129362211865548024725213186787080281",
                "117211968508960916914080531374433826083",
                "94426464050847757596022007115616808212",
                "118277849511203950400807931497067953546",
                "282466714861053862295100052861765305487",
                "111604997527881705211805272337959211994",
                "4525063423262956848432511722700638446",
                "85041232631170944109312033527743963997",
                "335034190613750734094172615978041379225",
                "264611837649465921134177521954447465210",
                "115492855116670920556953216752196380911",
                "237383971241988511265563950575293857885",
                "259054422277484197352934705879649400969",
                "277657933153018913033280181874024216136",
                "112446653307054850164606254152952577521",
                "237383971241988511265563950575293857885",
                "8665031185114714582688760613979415930",
                "339331610367924314012654538235909649225",
                "219869350413264342446119648780636385465",
                "237383971241988511265563950575293857885",
                "335181170971549609063031008279546634543",
                "78290403047044619918124496409672499325",
                "211513898425695311678971414722190912398",
                "237383971241988511265563950575293857885",
                "92424274738990069808619801792192357519"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-44943-3e01c444",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/gup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "177386623404661557321425812685824131078",
              "length": 558.0
            },
            "id": "CVE-2024-44943-3f883a0d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "try_grab_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "198463678172229901233520134209683652777",
              "length": 788.0
            },
            "id": "CVE-2024-44943-42ba7737",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "follow_devmap_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "76625685366977635224399058106570352330",
              "length": 999.0
            },
            "id": "CVE-2024-44943-433c32dc",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "follow_trans_huge_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "8664466033227282193454953963437144834",
              "length": 1070.0
            },
            "id": "CVE-2024-44943-52cd51f8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/hugetlb.c",
              "function": "hugetlb_follow_page_mask"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "20106115042616580203137724357854108760",
              "length": 847.0
            },
            "id": "CVE-2024-44943-554446d7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "gup_fast_pmd_range"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "195273727894082834806923128195259029869",
              "length": 827.0
            },
            "id": "CVE-2024-44943-6147ab65",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "gup_fast_pud_range"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "83113678386041380227758648198808876772",
              "length": 1869.0
            },
            "id": "CVE-2024-44943-65bc80fb",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/gup.c",
              "function": "follow_page_pte"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "63509635901827159581537449593026701894",
              "length": 201.0
            },
            "id": "CVE-2024-44943-8517a9d3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "gup_hugepd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "129687872039755900821978038980743046949",
              "length": 1885.0
            },
            "id": "CVE-2024-44943-a4137d7c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "follow_page_pte"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "187902759457768624284574973030946523381",
              "length": 1130.0
            },
            "id": "CVE-2024-44943-a5e5be8f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "get_gate_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "141070382350462885464709984681603948271",
              "length": 781.0
            },
            "id": "CVE-2024-44943-b2ea354e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "try_grab_folio"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "84795022547680091707204298913011116490",
              "length": 1046.0
            },
            "id": "CVE-2024-44943-ba140919",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "follow_huge_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "322011657617864082373294696030148483516",
              "length": 765.0
            },
            "id": "CVE-2024-44943-c49c3dca",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "gup_fast_pgd_range"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "198463678172229901233520134209683652777",
              "length": 788.0
            },
            "id": "CVE-2024-44943-caec6df3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/huge_memory.c",
              "function": "follow_devmap_pmd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "228014182851822775592186016909775891123",
              "length": 2234.0
            },
            "id": "CVE-2024-44943-cf1c2e47",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/gup.c",
              "function": "__get_user_pages"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "235169248097672968429795012653193309693",
              "length": 719.0
            },
            "id": "CVE-2024-44943-d2f35990",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "gup_fast_p4d_range"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "314914058378071827922171140660811869790",
                "159246531640100566932703151302011371214",
                "146887367353427557811184500496198224619",
                "101167586644986236919675542089340551483",
                "63421465135931466033573387511262325767"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-44943-dca13376",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/internal.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "115563779657981630902610489297013626408",
              "length": 663.0
            },
            "id": "CVE-2024-44943-e1007864",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "follow_hugepd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "187902759457768624284574973030946523381",
              "length": 1130.0
            },
            "id": "CVE-2024-44943-e2811e4d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/gup.c",
              "function": "get_gate_page"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "53230042317549570639903334349938519821",
              "length": 539.0
            },
            "id": "CVE-2024-44943-e6adc89c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "gup_hugepd"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "54875494636997405023004584404665795165",
              "length": 792.0
            },
            "id": "CVE-2024-44943-ee7907d9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/gup.c",
              "function": "try_grab_folio"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "88016446635305925266199491248507694568",
                "337710852752421449104069061785510179334",
                "298408258661135568872252680231506819902",
                "200787659682939545919326957001599816795",
                "291524408036723132524577105184051762597"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-44943-f689cbb4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@26273f5f4cf68b29414e403837093408a9c98e1f",
            "target": {
              "file": "mm/internal.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "26930596266583239612008518042789735993",
              "length": 1045.0
            },
            "id": "CVE-2024-44943-fd0d2138",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f442fa6141379a20b48ae3efabee827a3d260787",
            "target": {
              "file": "mm/gup.c",
              "function": "follow_huge_pud"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "57edfcfd3419b4799353d8cbd6ce49da075cfdbd"
            },
            {
              "fixed": "26273f5f4cf68b29414e403837093408a9c98e1f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "57edfcfd3419b4799353d8cbd6ce49da075cfdbd"
            },
            {
              "fixed": "f442fa6141379a20b48ae3efabee827a3d260787"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.5",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.3",
        "v6.6.30",
        "v6.6.31",
        "v6.6.32",
        "v6.6.33",
        "v6.6.34",
        "v6.6.35",
        "v6.6.36",
        "v6.6.37",
        "v6.6.38",
        "v6.6.39",
        "v6.6.4",
        "v6.6.40",
        "v6.6.41",
        "v6.6.42",
        "v6.6.43",
        "v6.6.44",
        "v6.6.45",
        "v6.6.46",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-44943.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.47"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: gup: stop abusing try_grab_folio\n\nA kernel warning was reported when pinning folio in CMA memory when\nlaunching SEV virtual machine.  The splat looks like:\n\n[  464.325306] WARNING: CPU: 13 PID: 6734 at mm/gup.c:1313 __get_user_pages+0x423/0x520\n[  464.325464] CPU: 13 PID: 6734 Comm: qemu-kvm Kdump: loaded Not tainted 6.6.33+ #6\n[  464.325477] RIP: 0010:__get_user_pages+0x423/0x520\n[  464.325515] Call Trace:\n[  464.325520]  <TASK>\n[  464.325523]  ? __get_user_pages+0x423/0x520\n[  464.325528]  ? __warn+0x81/0x130\n[  464.325536]  ? __get_user_pages+0x423/0x520\n[  464.325541]  ? report_bug+0x171/0x1a0\n[  464.325549]  ? handle_bug+0x3c/0x70\n[  464.325554]  ? exc_invalid_op+0x17/0x70\n[  464.325558]  ? asm_exc_invalid_op+0x1a/0x20\n[  464.325567]  ? __get_user_pages+0x423/0x520\n[  464.325575]  __gup_longterm_locked+0x212/0x7a0\n[  464.325583]  internal_get_user_pages_fast+0xfb/0x190\n[  464.325590]  pin_user_pages_fast+0x47/0x60\n[  464.325598]  sev_pin_memory+0xca/0x170 [kvm_amd]\n[  464.325616]  sev_mem_enc_register_region+0x81/0x130 [kvm_amd]\n\nPer the analysis done by yangge, when starting the SEV virtual machine, it\nwill call pin_user_pages_fast(..., FOLL_LONGTERM, ...) to pin the memory. \nBut the page is in CMA area, so fast GUP will fail then fallback to the\nslow path due to the longterm pinnalbe check in try_grab_folio().\n\nThe slow path will try to pin the pages then migrate them out of CMA area.\nBut the slow path also uses try_grab_folio() to pin the page, it will\nalso fail due to the same check then the above warning is triggered.\n\nIn addition, the try_grab_folio() is supposed to be used in fast path and\nit elevates folio refcount by using add ref unless zero.  We are guaranteed\nto have at least one stable reference in slow path, so the simple atomic add\ncould be used.  The performance difference should be trivial, but the\nmisuse may be confusing and misleading.\n\nRedefined try_grab_folio() to try_grab_folio_fast(), and try_grab_page()\nto try_grab_folio(), and use them in the proper paths.  This solves both\nthe abuse and the kernel warning.\n\nThe proper naming makes their usecase more clear and should prevent from\nabusing in the future.\n\npeterx said:\n\n: The user will see the pin fails, for gpu-slow it further triggers the WARN\n: right below that failure (as in the original report):\n: \n:         folio = try_grab_folio(page, page_increm - 1,\n:                                 foll_flags);\n:         if (WARN_ON_ONCE(!folio)) { <------------------------ here\n:                 /*\n:                         * Release the 1st page ref if the\n:                         * folio is problematic, fail hard.\n:                         */\n:                 gup_put_folio(page_folio(page), 1,\n:                                 foll_flags);\n:                 ret = -EFAULT;\n:                 goto out;\n:         }\n\n[1] https://lore.kernel.org/linux-mm/1719478388-31917-1-git-send-email-yangge1116@126.com/\n\n[shy828301@gmail.com: fix implicit declaration of function try_grab_folio_fast]",
  "id": "CVE-2024-44943",
  "modified": "2025-10-15T13:50:47.712067Z",
  "published": "2024-08-28T07:11:49Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/26273f5f4cf68b29414e403837093408a9c98e1f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f442fa6141379a20b48ae3efabee827a3d260787"
    }
  ],
  "related": [
    "MGASA-2024-0309",
    "MGASA-2024-0310"
  ],
  "schema_version": "1.7.3",
  "summary": "mm: gup: stop abusing try_grab_folio"
}