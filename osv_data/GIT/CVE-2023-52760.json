{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52760.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "278308507089940730593232754682463784165",
                "8936263579053668531674532880342887852",
                "6338268984860898412696139944164580781",
                "163844715431531164940467161006017136999",
                "278468334258534109248512470901270514985",
                "151919122470480983750783304494415393034",
                "240690350737989742586634241472713535146",
                "143891450042513675320683814283821304592",
                "4920259589311349790910898792569402166",
                "2908747547497868486815667984184568963"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52760-52f5a61c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bdcb8aa434c6d36b5c215d02a9ef07551be25a37",
            "target": {
              "file": "fs/gfs2/super.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "68456095205412216686194098411996926415",
              "length": 1454.0
            },
            "id": "CVE-2023-52760-64ba34d7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@bdcb8aa434c6d36b5c215d02a9ef07551be25a37",
            "target": {
              "file": "fs/gfs2/super.c",
              "function": "gfs2_put_super"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "68456095205412216686194098411996926415",
              "length": 1454.0
            },
            "id": "CVE-2023-52760-6abb615f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@08a28272faa750d4357ea2cb48d2baefd778ea81",
            "target": {
              "file": "fs/gfs2/super.c",
              "function": "gfs2_put_super"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "278308507089940730593232754682463784165",
                "8936263579053668531674532880342887852",
                "6338268984860898412696139944164580781",
                "163844715431531164940467161006017136999",
                "278468334258534109248512470901270514985",
                "151919122470480983750783304494415393034",
                "240690350737989742586634241472713535146",
                "143891450042513675320683814283821304592",
                "4920259589311349790910898792569402166",
                "2908747547497868486815667984184568963"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52760-d2826b10",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@08a28272faa750d4357ea2cb48d2baefd778ea81",
            "target": {
              "file": "fs/gfs2/super.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f66af88e33212b57ea86da2c5d66c0d9d5c46344"
            },
            {
              "fixed": "08a28272faa750d4357ea2cb48d2baefd778ea81"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f66af88e33212b57ea86da2c5d66c0d9d5c46344"
            },
            {
              "fixed": "bdcb8aa434c6d36b5c215d02a9ef07551be25a37"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52760.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ngfs2: Fix slab-use-after-free in gfs2_qd_dealloc\n\nIn gfs2_put_super(), whether withdrawn or not, the quota should\nbe cleaned up by gfs2_quota_cleanup().\n\nOtherwise, struct gfs2_sbd will be freed before gfs2_qd_dealloc (rcu\ncallback) has run for all gfs2_quota_data objects, resulting in\nuse-after-free.\n\nAlso, gfs2_destroy_threads() and gfs2_quota_cleanup() is already called\nby gfs2_make_fs_ro(), so in gfs2_put_super(), after calling\ngfs2_make_fs_ro(), there is no need to call them again.",
  "id": "CVE-2023-52760",
  "modified": "2025-10-21T14:25:52.884501Z",
  "published": "2024-05-21T15:30:46Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/08a28272faa750d4357ea2cb48d2baefd778ea81"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7ad4e0a4f61c57c3ca291ee010a9d677d0199fba"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/bdcb8aa434c6d36b5c215d02a9ef07551be25a37"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "gfs2: Fix slab-use-after-free in gfs2_qd_dealloc"
}