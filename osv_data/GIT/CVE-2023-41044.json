{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-41044.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "70256955351377477919280827333027420862",
                "292262297788691812278574794541374497895",
                "106307221637994360390091635786135046452",
                "134204264829701155805993988795382602995",
                "247279736174318038547158979211834974098",
                "66841291639969851647860515879240642211",
                "273798647946820550901213529945487007090",
                "220880292058044484741278901184809109646",
                "111174138464093579373312548569750770664",
                "10211165300061249293048354595435895853",
                "235992106366017173485612159423606578996",
                "116328795327727658011500339151571725839",
                "134581210358128579765930601476039745342"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-41044-3cb9b4f0",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/02b8792e6f4b829f0c1d87fcbf2d58b73458b938",
            "target": {
              "file": "graylog2-server/src/test/java/org/graylog2/rest/resources/system/debug/bundle/SupportBundleServiceTest.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "46502622889968411497843509285920645541",
              "length": 294.0
            },
            "id": "CVE-2023-41044-80c61a24",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/02b8792e6f4b829f0c1d87fcbf2d58b73458b938",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/system/debug/bundle/SupportBundleService.java",
              "function": "downloadBundle"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "274682291381846210576362795088684953114",
                "4912375466620177352013754945321162014",
                "199828672621419249080722169927341150685",
                "214074433438554664540563190369140615527",
                "192445275917232575279840210741098665944",
                "235891785736014968819047140599371751306",
                "96114107004436095478691628866346831087",
                "117524725672071953639242364879202811170",
                "162215568750971545971205375836482227930",
                "321375172756485706144881505338753644266",
                "185881761571402693058497097037303327216",
                "232912438836808081488994152593089198741",
                "130401978935503470416135282925002956428",
                "289146353117212676166335945139391066128"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-41044-97dae2c6",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/02b8792e6f4b829f0c1d87fcbf2d58b73458b938",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/system/debug/bundle/SupportBundleService.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "151733301905723480361695033992741855605",
              "length": 207.0
            },
            "id": "CVE-2023-41044-b9e96003",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/02b8792e6f4b829f0c1d87fcbf2d58b73458b938",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/system/debug/bundle/SupportBundleService.java",
              "function": "ensureFileWithinBundleDir"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "301672472425978241079190163390096451324",
              "length": 152.0
            },
            "id": "CVE-2023-41044-d7b40b52",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/02b8792e6f4b829f0c1d87fcbf2d58b73458b938",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/system/debug/bundle/SupportBundleService.java",
              "function": "deleteBundle"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "02b8792e6f4b829f0c1d87fcbf2d58b73458b938"
            }
          ],
          "repo": "https://github.com/graylog2/graylog2-server",
          "type": "GIT"
        }
      ],
      "versions": [
        "0.10.0",
        "0.10.0-preview.2",
        "0.10.0-rc.1",
        "0.10.0-rc.2",
        "0.10.0-rc.3",
        "0.10.0-rc.4",
        "0.11.0",
        "0.20.0",
        "0.20.0-preview.1",
        "0.20.0-preview.2",
        "0.20.0-preview.3",
        "0.20.0-preview.4",
        "0.20.0-preview.5",
        "0.20.0-preview.6",
        "0.20.0-preview.7",
        "0.20.0-preview.8",
        "0.20.0-rc.1",
        "0.20.0-rc.1-1",
        "0.20.0-rc.2",
        "0.20.0-rc.3",
        "0.20.1",
        "0.20.2-rc.1",
        "0.20.2-snapshot",
        "0.20.2-snapshot.2",
        "0.21.0-beta1",
        "0.21.0-beta2",
        "0.21.0-beta3",
        "0.21.0-beta4",
        "0.21.0-rc.1",
        "0.9",
        "0.9.1",
        "0.9.2",
        "0.9.3",
        "0.9.4",
        "0.9.4p1",
        "0.9.5",
        "0.9.5p1",
        "0.9.6",
        "0.9.6-PREVIEW",
        "0.9.6-PREVIEW.2",
        "0.9.6-PREVIEW.3",
        "0.9.6-beta",
        "0.9.7-preview.1",
        "1.0.0",
        "1.0.0-beta.1",
        "1.0.0-beta.2",
        "1.0.0-beta.3",
        "1.0.0-rc.1",
        "1.0.0-rc.2",
        "1.0.0-rc.3",
        "1.0.0-rc.4",
        "1.0.1",
        "1.1.0",
        "1.1.0-beta.1",
        "1.1.0-beta.2",
        "1.1.0-beta.3",
        "1.1.0-rc.1",
        "1.1.0-rc.2",
        "1.1.0-rc.3",
        "1.1.1",
        "1.1.2",
        "1.2.0",
        "1.2.0-rc.1",
        "1.2.0-rc.2",
        "1.2.0-rc.3",
        "1.2.0-rc.4",
        "2.0.0-alpha.1",
        "2.0.0-alpha.2",
        "2.0.0-alpha.3",
        "2.0.0-alpha.4",
        "2.0.0-alpha.5",
        "2.0.0-beta.1",
        "2.0.0-beta.2",
        "2.0.0-beta.3",
        "2.0.0-rc.1",
        "2.1.0-alpha.1",
        "2.1.0-alpha.2",
        "2.1.0-beta.1",
        "2.1.0-beta.2",
        "2.1.0-beta.3",
        "2.1.0-beta.4",
        "2.1.0-rc.1",
        "2.2.0",
        "2.2.0-alpha.1",
        "2.2.0-alpha.2",
        "2.2.0-alpha.3",
        "2.2.0-alpha.4",
        "2.2.0-beta.1",
        "2.2.0-beta.2",
        "2.2.0-beta.3",
        "2.2.0-beta.4",
        "2.2.0-beta.5",
        "2.2.0-beta.6",
        "2.2.0-rc.1",
        "2.3.0-alpha.1",
        "2.3.0-alpha.2",
        "2.3.0-alpha.3",
        "2.3.0-beta.1",
        "2.3.0-rc.1",
        "2.4.0-alpha.1",
        "2.4.0-alpha.2",
        "2.4.0-alpha.3",
        "3.0.0-alpha.0",
        "3.0.0-alpha.1",
        "3.0.0-alpha.2",
        "3.0.0-alpha.3",
        "3.0.0-alpha.4",
        "3.0.0-alpha.5",
        "3.0.0-beta.1",
        "3.1.0",
        "3.1.0-beta.1",
        "3.1.0-beta.2",
        "3.1.0-beta.3",
        "3.1.0-rc.1",
        "3.1.0-rc.2",
        "3.2.0-beta.1",
        "3.2.0-beta.2",
        "3.2.0-beta.3",
        "3.2.0-beta.4",
        "3.2.0-rc.1",
        "3.3.0-beta.1",
        "3.3.0-beta.2",
        "3.3.0-beta.3",
        "3.3.0-rc.1",
        "4.0.0",
        "4.0.0-beta.1",
        "4.0.0-beta.2",
        "4.0.0-beta.3",
        "4.0.0-beta.4",
        "4.0.0-rc.1",
        "4.0.0-rc.2",
        "4.0.1",
        "4.1.0",
        "4.1.0-beta.1",
        "4.1.0-beta.2",
        "4.1.0-rc.1",
        "4.2.0-beta.1",
        "4.3.0-beta.1",
        "4.3.0-beta.2",
        "4.3.0-beta.3",
        "4.3.0-rc.1",
        "5.0.0-alpha.1",
        "5.0.0-beta.1",
        "5.0.0-beta.2",
        "5.0.0-beta.3",
        "5.0.0-beta.4",
        "5.0.0-beta.5",
        "5.0.0-rc.1",
        "5.1.0",
        "5.1.0-beta.1",
        "5.1.0-beta.2",
        "5.1.0-beta.3",
        "5.1.0-rc.1",
        "5.1.0-rc.2",
        "5.1.1",
        "5.1.2",
        "v0.20.0-preview.1",
        "v0.20.0-rc.1-1"
      ]
    }
  ],
  "aliases": [
    "GHSA-2q4p-f6gf-mqr5"
  ],
  "details": "Graylog is a free and open log management platform. A partial path traversal vulnerability exists in Graylog's `Support Bundle` feature. The vulnerability is caused by incorrect user input validation in an HTTP API resource. Graylog's Support Bundle feature allows an attacker with valid Admin role credentials to download or delete files in sibling directories of the support bundle directory. The default `data_dir` in operating system packages (DEB, RPM) is set to `/var/lib/graylog-server`. The data directory for the Support Bundle feature is always `<data_dir>/support-bundle`. Due to the partial path traversal vulnerability, an attacker with valid Admin role credentials can read or delete files in directories that start with a `/var/lib/graylog-server/support-bundle` directory name. The vulnerability would allow the download or deletion of files in the following example directories: `/var/lib/graylog-server/support-bundle-test` and `/var/lib/graylog-server/support-bundlesdirectory`. For the Graylog Docker images, the `data_dir` is set to `/usr/share/graylog/data` by default. This vulnerability is fixed in Graylog version 5.1.3 and later. Users are advised to upgrade. Users unable to upgrade should block all HTTP requests to the following HTTP API endpoints by using a reverse proxy server in front of Graylog. `GET /api/system/debug/support/bundle/download/{filename}` and `DELETE /api/system/debug/support/bundle/{filename}`.\n",
  "id": "CVE-2023-41044",
  "modified": "2025-10-10T04:37:01.427413Z",
  "published": "2023-08-31T18:15:09Z",
  "references": [
    {
      "type": "EVIDENCE",
      "url": "https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-2q4p-f6gf-mqr5"
    },
    {
      "type": "FIX",
      "url": "https://github.com/Graylog2/graylog2-server/commit/02b8792e6f4b829f0c1d87fcbf2d58b73458b938"
    },
    {
      "type": "WEB",
      "url": "https://go2docs.graylog.org/5-1/making_sense_of_your_log_data/cluster_support_bundle.htm"
    }
  ],
  "related": [
    "GHSA-2q4p-f6gf-mqr5"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N",
      "type": "CVSS_V3"
    }
  ]
}