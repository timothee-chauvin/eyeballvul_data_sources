{"schema_version":"1.7.3","id":"CVE-2023-30547","published":"2023-04-17T21:42:10Z","modified":"2025-10-22T18:36:47.783682Z","aliases":["GHSA-ch3r-j5x3-6q2m"],"summary":"Sandbox Escape in vm2","details":"vm2 is a sandbox that can run untrusted code with whitelisted Node's built-in modules. There exists a vulnerability in exception sanitization of vm2 for versions up to 3.9.16, allowing attackers to raise an unsanitized host exception inside `handleException()` which can be used to escape the sandbox and run arbitrary code in host context. This vulnerability was patched in the release of version `3.9.17` of `vm2`. There are no known workarounds for this vulnerability. Users are advised to upgrade.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/patriksimek/vm2","events":[{"introduced":"0"},{"fixed":"4f63dc23fecabc79ee1501fde6e9e83c524d6466"}]}],"versions":["3.9.10","3.9.11","3.9.12","3.9.13","3.9.14","3.9.15","3.9.16","3.9.3","3.9.4","3.9.5","3.9.6","3.9.7","3.9.8","3.9.9","v3.9.0","v3.9.1","v3.9.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-30547.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/patriksimek/vm2/security/advisories/GHSA-ch3r-j5x3-6q2m"},{"type":"FIX","url":"https://github.com/patriksimek/vm2/commit/4b22e87b102d97d45d112a0931dba1aef7eea049"},{"type":"FIX","url":"https://github.com/patriksimek/vm2/commit/f3db4dee4d76b19869df05ba7880d638a880edd5"},{"type":"WEB","url":"https://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244"}],"database_specific":{"cwe_ids":["CWE-74"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}