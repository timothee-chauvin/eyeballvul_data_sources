{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42300.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "108978852701272451048608562048460200739",
                "298112330797154487509789938223972899308",
                "70410416010405796262433015007846196517",
                "224986597673737483816509716180572359559",
                "284120211269900550241258648545544558631",
                "184680417295952977480474000000428461627",
                "277574384879326563849397068914869540616",
                "53822500290427378848324833967113864231",
                "138523237332768482743749901170128592919",
                "305056288708992690693971755080361734212",
                "143533666675487598680272115075168681469"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42300-87108a79",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7dc5537c3f8be87e005f0844a7626c987914f8fd",
            "target": {
              "file": "fs/erofs/zutil.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "108978852701272451048608562048460200739",
                "298112330797154487509789938223972899308",
                "70410416010405796262433015007846196517",
                "224986597673737483816509716180572359559",
                "284120211269900550241258648545544558631",
                "184680417295952977480474000000428461627",
                "277574384879326563849397068914869540616",
                "53822500290427378848324833967113864231",
                "138523237332768482743749901170128592919",
                "305056288708992690693971755080361734212",
                "143533666675487598680272115075168681469"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-42300-a43ed670",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@49b22e06a947727a6d1c802d2d9ad92420b90fc5",
            "target": {
              "file": "fs/erofs/zutil.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "f36f3010f67611a45d66e773bc91e4c66a9abab5"
            },
            {
              "fixed": "49b22e06a947727a6d1c802d2d9ad92420b90fc5"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "f36f3010f67611a45d66e773bc91e4c66a9abab5"
            },
            {
              "fixed": "7dc5537c3f8be87e005f0844a7626c987914f8fd"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.10.1",
        "v6.10.2",
        "v6.9"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-42300.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.10.0"
            },
            {
              "fixed": "6.10.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: fix race in z_erofs_get_gbuf()\n\nIn z_erofs_get_gbuf(), the current task may be migrated to another\nCPU between `z_erofs_gbuf_id()` and `spin_lock(&gbuf->lock)`.\n\nTherefore, z_erofs_put_gbuf() will trigger the following issue\nwhich was found by stress test:\n\n<2>[772156.434168] kernel BUG at fs/erofs/zutil.c:58!\n..\n<4>[772156.435007]\n<4>[772156.439237] CPU: 0 PID: 3078 Comm: stress Kdump: loaded Tainted: G            E      6.10.0-rc7+ #2\n<4>[772156.439239] Hardware name: Alibaba Cloud Alibaba Cloud ECS, BIOS 1.0.0 01/01/2017\n<4>[772156.439241] pstate: 83400005 (Nzcv daif +PAN -UAO +TCO +DIT -SSBS BTYPE=--)\n<4>[772156.439243] pc : z_erofs_put_gbuf+0x64/0x70 [erofs]\n<4>[772156.439252] lr : z_erofs_lz4_decompress+0x600/0x6a0 [erofs]\n..\n<6>[772156.445958] stress (3127): drop_caches: 1\n<4>[772156.446120] Call trace:\n<4>[772156.446121]  z_erofs_put_gbuf+0x64/0x70 [erofs]\n<4>[772156.446761]  z_erofs_lz4_decompress+0x600/0x6a0 [erofs]\n<4>[772156.446897]  z_erofs_decompress_queue+0x740/0xa10 [erofs]\n<4>[772156.447036]  z_erofs_runqueue+0x428/0x8c0 [erofs]\n<4>[772156.447160]  z_erofs_readahead+0x224/0x390 [erofs]\n..",
  "id": "CVE-2024-42300",
  "modified": "2025-10-15T13:23:38.800523Z",
  "published": "2024-08-17T09:09:07Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/49b22e06a947727a6d1c802d2d9ad92420b90fc5"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7dc5537c3f8be87e005f0844a7626c987914f8fd"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "erofs: fix race in z_erofs_get_gbuf()"
}