{"schema_version":"1.7.3","id":"CVE-2023-54107","published":"2025-12-24T13:06:31.505Z","modified":"2026-01-05T21:10:42.869327Z","summary":"blk-cgroup: dropping parent refcount after pd_free_fn() is done","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nblk-cgroup: dropping parent refcount after pd_free_fn() is done\n\nSome cgroup policies will access parent pd through child pd even\nafter pd_offline_fn() is done. If pd_free_fn() for parent is called\nbefore child, then UAF can be triggered. Hence it's better to guarantee\nthe order of pd_free_fn().\n\nCurrently refcount of parent blkg is dropped in __blkg_release(), which\nis before pd_free_fn() is called in blkg_free_work_fn() while\nblkg_free_work_fn() is called asynchronously.\n\nThis patch make sure pd_free_fn() called from removing cgroup is ordered\nby delaying dropping parent refcount after calling pd_free_fn() for\nchild.\n\nBTW, pd_free_fn() will also be called from blkcg_deactivate_policy()\nfrom deleting device, and following patches will guarantee the order.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d578c770c85233af592e54537f93f3831bde7e9a"},{"fixed":"c7241babf0855d8a6180cd1743ff0ec34de40b4e"}]}],"versions":["v5.17","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-54107.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"67172724618575465487732848208919025467","length":283},"id":"CVE-2023-54107-17bfe414","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c7241babf0855d8a6180cd1743ff0ec34de40b4e","target":{"file":"block/blk-cgroup.c","function":"__blkg_release"}},{"deprecated":false,"digest":{"function_hash":"200186883369170518240738153774639123029","length":397},"id":"CVE-2023-54107-7011e94f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c7241babf0855d8a6180cd1743ff0ec34de40b4e","target":{"file":"block/blk-cgroup.c","function":"blkg_free_workfn"}},{"deprecated":false,"digest":{"line_hashes":["4988935689754887389331331750316911996","98002396530071391025572883287810551177","141204743315839806093186370520416731629","139216398823198552658306909401603756299","292078462098062965547420795992669211509","175408663656895402505989086499873826232","132489402297869546735564834849348014670","293414004345354603215609366070639846000"],"threshold":0.9},"id":"CVE-2023-54107-cb5e8d3b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c7241babf0855d8a6180cd1743ff0ec34de40b4e","target":{"file":"block/blk-cgroup.c"}}]}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c7241babf0855d8a6180cd1743ff0ec34de40b4e"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/54xxx/CVE-2023-54107.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2023-54107"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2023/54xxx/CVE-2023-54107.json"}}