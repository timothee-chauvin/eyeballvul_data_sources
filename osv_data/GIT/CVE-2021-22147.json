{"schema_version":"1.7.3","id":"CVE-2021-22147","published":"2021-09-15T12:15:08Z","modified":"2025-10-21T02:36:13Z","aliases":["BIT-elasticsearch-2021-22147","GHSA-45h5-r968-5xr7"],"details":"Elasticsearch before 7.14.0 did not apply document and field level security to searchable snapshots. This could lead to an authenticated user gaining access to information that they are unauthorized to view.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/elastic/elasticsearch","events":[{"introduced":"8ced7813d6f16d2ef30792e2fcde3e755795ee04"},{"fixed":"dd5a0a2acaa2045ff9624f3729fc8a6f40835aa1"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2021-22147.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["225934378297096443205996319287508664581","305324889570165299639096032500322130374","170310029445315469861065754189361442532","107750926380225791637906031407774933414"],"threshold":0.9},"id":"CVE-2021-22147-83e15f25","signature_type":"Line","signature_version":"v1","source":"https://github.com/elastic/elasticsearch/commit/dd5a0a2acaa2045ff9624f3729fc8a6f40835aa1","target":{"file":"server/src/main/java/org/elasticsearch/snapshots/RestoreService.java"}},{"deprecated":false,"digest":{"function_hash":"291430067966160489700298674970247889651","length":580},"id":"CVE-2021-22147-938f76b3","signature_type":"Function","signature_version":"v1","source":"https://github.com/elastic/elasticsearch/commit/dd5a0a2acaa2045ff9624f3729fc8a6f40835aa1","target":{"file":"server/src/main/java/org/elasticsearch/snapshots/RestoreService.java","function":"updateDataStream"}}]}}],"references":[{"type":"ADVISORY","url":"https://discuss.elastic.co/t/elastic-stack-7-14-0-security-update/280344"},{"type":"ADVISORY","url":"https://security.netapp.com/advisory/ntap-20211008-0002/"},{"type":"ADVISORY","url":"https://www.elastic.co/community/security/"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"}]}