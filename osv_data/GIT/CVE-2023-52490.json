{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52490.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "327771945486888673206216079296223177186",
              "length": 190.0
            },
            "id": "CVE-2023-52490-0fdb6578",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9128bfbc5c80d8f4874dd0a0424d1f5fb010df1b",
            "target": {
              "file": "mm/migrate.c",
              "function": "__migrate_folio_record"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "281631471942746030198431989134168584762",
                "31255834303807260844188611912980510879",
                "167476381615096386056536818513774793117",
                "20703865464871355515992947548909310887",
                "132740303713618063752246342237135042989",
                "239821691007101497786876187924235255646",
                "82654394333844535084786981026261251806",
                "305547633316345027726469388751015564167",
                "160839187895288394324707986148559110489",
                "304152245974324368732015698401541623070",
                "262974967384232365049960675478355968943",
                "230713778551265905685716283569413257308",
                "142738161136239508216568473787935342650",
                "200721114461257213782383432922183581139",
                "220359395018477721872737975056266928555",
                "130984122989044393581266140191196505361",
                "36272936615205700222985037365758574217",
                "64439537039620291174561255292956781479",
                "325947497995624937647818669315987337439",
                "339723693978622599605864778060784455573",
                "1221902670361636338039013515338274469",
                "87484001438157650554117279416407867947",
                "181714107654518573146495336379775192408",
                "302253262622750154621618720007717467988",
                "28744096390661078406087401280566260322",
                "285347413724301161103505580755668701981",
                "253692789007600038124579942270287836959"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52490-1bcbd05b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d1adb25df7111de83b64655a80b5a135adbded61",
            "target": {
              "file": "mm/migrate.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "327771945486888673206216079296223177186",
              "length": 190.0
            },
            "id": "CVE-2023-52490-386d20e9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d1adb25df7111de83b64655a80b5a135adbded61",
            "target": {
              "file": "mm/migrate.c",
              "function": "__migrate_folio_record"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "129799043851124087969297490806869456057",
              "length": 251.0
            },
            "id": "CVE-2023-52490-7762585f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9128bfbc5c80d8f4874dd0a0424d1f5fb010df1b",
            "target": {
              "file": "mm/migrate.c",
              "function": "__migrate_folio_extract"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "327771945486888673206216079296223177186",
              "length": 190.0
            },
            "id": "CVE-2023-52490-9b67c1a4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3889a418b6eb9a1113fb989aaadecf2f64964767",
            "target": {
              "file": "mm/migrate.c",
              "function": "__migrate_folio_record"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "281631471942746030198431989134168584762",
                "31255834303807260844188611912980510879",
                "167476381615096386056536818513774793117",
                "20703865464871355515992947548909310887",
                "132740303713618063752246342237135042989",
                "239821691007101497786876187924235255646",
                "82654394333844535084786981026261251806",
                "305547633316345027726469388751015564167",
                "160839187895288394324707986148559110489",
                "304152245974324368732015698401541623070",
                "262974967384232365049960675478355968943",
                "230713778551265905685716283569413257308",
                "142738161136239508216568473787935342650",
                "200721114461257213782383432922183581139",
                "220359395018477721872737975056266928555",
                "130984122989044393581266140191196505361",
                "36272936615205700222985037365758574217",
                "64439537039620291174561255292956781479",
                "325947497995624937647818669315987337439",
                "339723693978622599605864778060784455573",
                "1221902670361636338039013515338274469",
                "87484001438157650554117279416407867947",
                "181714107654518573146495336379775192408",
                "302253262622750154621618720007717467988",
                "28744096390661078406087401280566260322",
                "285347413724301161103505580755668701981",
                "253692789007600038124579942270287836959"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52490-9b7fdd84",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9128bfbc5c80d8f4874dd0a0424d1f5fb010df1b",
            "target": {
              "file": "mm/migrate.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "129799043851124087969297490806869456057",
              "length": 251.0
            },
            "id": "CVE-2023-52490-9e45a617",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d1adb25df7111de83b64655a80b5a135adbded61",
            "target": {
              "file": "mm/migrate.c",
              "function": "__migrate_folio_extract"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "281631471942746030198431989134168584762",
                "31255834303807260844188611912980510879",
                "167476381615096386056536818513774793117",
                "20703865464871355515992947548909310887",
                "132740303713618063752246342237135042989",
                "239821691007101497786876187924235255646",
                "82654394333844535084786981026261251806",
                "305547633316345027726469388751015564167",
                "160839187895288394324707986148559110489",
                "304152245974324368732015698401541623070",
                "262974967384232365049960675478355968943",
                "230713778551265905685716283569413257308",
                "142738161136239508216568473787935342650",
                "200721114461257213782383432922183581139",
                "220359395018477721872737975056266928555",
                "130984122989044393581266140191196505361",
                "36272936615205700222985037365758574217",
                "64439537039620291174561255292956781479",
                "325947497995624937647818669315987337439",
                "339723693978622599605864778060784455573",
                "1221902670361636338039013515338274469",
                "87484001438157650554117279416407867947",
                "181714107654518573146495336379775192408",
                "302253262622750154621618720007717467988",
                "28744096390661078406087401280566260322",
                "285347413724301161103505580755668701981",
                "253692789007600038124579942270287836959"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52490-bd6d16ff",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3889a418b6eb9a1113fb989aaadecf2f64964767",
            "target": {
              "file": "mm/migrate.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "129799043851124087969297490806869456057",
              "length": 251.0
            },
            "id": "CVE-2023-52490-ee1f4de6",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3889a418b6eb9a1113fb989aaadecf2f64964767",
            "target": {
              "file": "mm/migrate.c",
              "function": "__migrate_folio_extract"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "64c8902ed4418317cd416c566f896bd4a92b2efc"
            },
            {
              "fixed": "9128bfbc5c80d8f4874dd0a0424d1f5fb010df1b"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "64c8902ed4418317cd416c566f896bd4a92b2efc"
            },
            {
              "fixed": "3889a418b6eb9a1113fb989aaadecf2f64964767"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "64c8902ed4418317cd416c566f896bd4a92b2efc"
            },
            {
              "fixed": "d1adb25df7111de83b64655a80b5a135adbded61"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "8ca5f0ea52e1eef5e7dcbdff1d1afe602764ea93"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.1.116",
        "v6.1.117",
        "v6.1.118",
        "v6.1.119",
        "v6.1.120",
        "v6.1.121",
        "v6.1.122",
        "v6.1.123",
        "v6.1.124",
        "v6.1.125",
        "v6.1.126",
        "v6.1.127",
        "v6.1.128",
        "v6.1.129",
        "v6.1.130",
        "v6.1.131",
        "v6.1.132",
        "v6.1.133",
        "v6.1.134",
        "v6.1.135",
        "v6.1.136",
        "v6.1.137",
        "v6.1.138",
        "v6.1.139",
        "v6.1.140",
        "v6.1.141",
        "v6.1.142",
        "v6.1.143",
        "v6.1.144",
        "v6.1.145",
        "v6.1.146",
        "v6.1.147",
        "v6.1.148",
        "v6.1.149",
        "v6.1.150",
        "v6.1.151",
        "v6.1.152",
        "v6.1.153",
        "v6.1.154",
        "v6.1.155",
        "v6.2",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.2",
        "v6.6.3",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52490.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.3.0"
            },
            {
              "fixed": "6.6.15"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: migrate: fix getting incorrect page mapping during page migration\n\nWhen running stress-ng testing, we found below kernel crash after a few hours:\n\nUnable to handle kernel NULL pointer dereference at virtual address 0000000000000000\npc : dentry_name+0xd8/0x224\nlr : pointer+0x22c/0x370\nsp : ffff800025f134c0\n......\nCall trace:\n  dentry_name+0xd8/0x224\n  pointer+0x22c/0x370\n  vsnprintf+0x1ec/0x730\n  vscnprintf+0x2c/0x60\n  vprintk_store+0x70/0x234\n  vprintk_emit+0xe0/0x24c\n  vprintk_default+0x3c/0x44\n  vprintk_func+0x84/0x2d0\n  printk+0x64/0x88\n  __dump_page+0x52c/0x530\n  dump_page+0x14/0x20\n  set_migratetype_isolate+0x110/0x224\n  start_isolate_page_range+0xc4/0x20c\n  offline_pages+0x124/0x474\n  memory_block_offline+0x44/0xf4\n  memory_subsys_offline+0x3c/0x70\n  device_offline+0xf0/0x120\n  ......\n\nAfter analyzing the vmcore, I found this issue is caused by page migration.\nThe scenario is that, one thread is doing page migration, and we will use the\ntarget page's ->mapping field to save 'anon_vma' pointer between page unmap and\npage move, and now the target page is locked and refcount is 1.\n\nCurrently, there is another stress-ng thread performing memory hotplug,\nattempting to offline the target page that is being migrated. It discovers that\nthe refcount of this target page is 1, preventing the offline operation, thus\nproceeding to dump the page. However, page_mapping() of the target page may\nreturn an incorrect file mapping to crash the system in dump_mapping(), since\nthe target page->mapping only saves 'anon_vma' pointer without setting\nPAGE_MAPPING_ANON flag.\n\nThere are seveval ways to fix this issue:\n(1) Setting the PAGE_MAPPING_ANON flag for target page's ->mapping when saving\n'anon_vma', but this can confuse PageAnon() for PFN walkers, since the target\npage has not built mappings yet.\n(2) Getting the page lock to call page_mapping() in __dump_page() to avoid crashing\nthe system, however, there are still some PFN walkers that call page_mapping()\nwithout holding the page lock, such as compaction.\n(3) Using target page->private field to save the 'anon_vma' pointer and 2 bits\npage state, just as page->mapping records an anonymous page, which can remove\nthe page_mapping() impact for PFN walkers and also seems a simple way.\n\nSo I choose option 3 to fix this issue, and this can also fix other potential\nissues for PFN walkers, such as compaction.",
  "id": "CVE-2023-52490",
  "modified": "2025-10-15T03:26:47.509257Z",
  "published": "2024-02-29T15:52:09Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/3889a418b6eb9a1113fb989aaadecf2f64964767"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9128bfbc5c80d8f4874dd0a0424d1f5fb010df1b"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d1adb25df7111de83b64655a80b5a135adbded61"
    }
  ],
  "related": [
    "ALSA-2025:1659",
    "USN-6765-1",
    "USN-6818-2",
    "USN-6819-2"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "mm: migrate: fix getting incorrect page mapping during page migration"
}