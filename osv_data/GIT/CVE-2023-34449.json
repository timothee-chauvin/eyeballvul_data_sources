{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34449.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "ad4f5e579e39926704e182736af4fa945982ac2b"
            },
            {
              "fixed": "1b2e7cfe24ee2844804e77fad601b996641fe6f1"
            }
          ],
          "repo": "https://github.com/paritytech/ink",
          "type": "GIT"
        }
      ],
      "versions": [
        "v4.0.0",
        "v4.0.1",
        "v4.1.0",
        "v4.2.0"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34449.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "f1407ee9f87e5f64d467a22d26ee88f61db7f3db"
            }
          ],
          "repo": "https://github.com/use-ink/ink",
          "type": "GIT"
        }
      ],
      "versions": [
        "latest-v2",
        "v2.0.0",
        "v2.1.0",
        "v3.0.0",
        "v3.0.0-rc1",
        "v3.0.0-rc2",
        "v3.0.0-rc3",
        "v3.0.0-rc4",
        "v3.0.0-rc5",
        "v3.0.0-rc6",
        "v3.0.0-rc7",
        "v3.0.0-rc8",
        "v3.0.0-rc9",
        "v3.0.1",
        "v3.1.0",
        "v3.2.0",
        "v4.0.0",
        "v4.0.0-alpha.1",
        "v4.0.0-alpha.3",
        "v4.0.0-beta",
        "v4.0.0-beta.1",
        "v4.0.0-rc",
        "v4.0.1",
        "v4.1.0",
        "v4.2.0"
      ]
    }
  ],
  "aliases": [
    "GHSA-853p-5678-hv8f"
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-253",
      "CWE-754"
    ]
  },
  "details": "ink! is an embedded domain specific language to write smart contracts in Rust for blockchains built on the Substrate framework. Starting in version 4.0.0 and prior to version 4.2.1, the return value when using delegate call mechanics, either through `CallBuilder::delegate` or `ink_env::invoke_contract_delegate`, is decoded incorrectly. This bug was related to the mechanics around decoding a call's return buffer, which was changed as part of pull request 1450. Since this feature was only released in ink! 4.0.0, no previous versions are affected. Users who have an ink! 4.x series contract should upgrade to 4.2.1 to receive a patch.",
  "id": "CVE-2023-34449",
  "modified": "2025-10-24T04:19:00.991598Z",
  "published": "2023-06-14T20:10:54Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/paritytech/ink/security/advisories/GHSA-853p-5678-hv8f"
    },
    {
      "type": "FIX",
      "url": "https://github.com/paritytech/ink/commit/f1407ee9f87e5f64d467a22d26ee88f61db7f3db"
    },
    {
      "type": "FIX",
      "url": "https://github.com/paritytech/ink/pull/1450"
    },
    {
      "type": "WEB",
      "url": "https://docs.rs/ink_env/4.2.0/ink_env/call/struct.CallBuilder.html#method.delegate"
    },
    {
      "type": "WEB",
      "url": "https://docs.rs/ink_env/4.2.0/ink_env/fn.invoke_contract_delegate.html"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
      "type": "CVSS_V3"
    }
  ],
  "summary": "ink! vulnerable to incorrect decoding of storage value when using `DelegateCall`"
}