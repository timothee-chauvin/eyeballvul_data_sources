{"schema_version":"1.7.3","id":"CVE-2025-38284","published":"2025-07-10T07:42:01.667Z","modified":"2025-11-20T09:25:59.083300Z","summary":"wifi: rtw89: pci: configure manual DAC mode via PCI config API only","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: rtw89: pci: configure manual DAC mode via PCI config API only\n\nTo support 36-bit DMA, configure chip proprietary bit via PCI config API\nor chip DBI interface. However, the PCI device mmap isn't set yet and\nthe DBI is also inaccessible via mmap, so only if the bit can be accessible\nvia PCI config API, chip can support 36-bit DMA. Otherwise, fallback to\n32-bit DMA.\n\nWith NULL mmap address, kernel throws trace:\n\n  BUG: unable to handle page fault for address: 0000000000001090\n  #PF: supervisor write access in kernel mode\n  #PF: error_code(0x0002) - not-present page\n  PGD 0 P4D 0\n  Oops: Oops: 0002 [#1] PREEMPT SMP PTI\n  CPU: 1 UID: 0 PID: 71 Comm: irq/26-pciehp Tainted: G           OE      6.14.2-061402-generic #202504101348\n  Tainted: [O]=OOT_MODULE, [E]=UNSIGNED_MODULE\n  RIP: 0010:rtw89_pci_ops_write16+0x12/0x30 [rtw89_pci]\n  RSP: 0018:ffffb0ffc0acf9d8 EFLAGS: 00010206\n  RAX: ffffffffc158f9c0 RBX: ffff94865e702020 RCX: 0000000000000000\n  RDX: 0000000000000718 RSI: 0000000000001090 RDI: ffff94865e702020\n  RBP: ffffb0ffc0acf9d8 R08: 0000000000000000 R09: 0000000000000000\n  R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000015\n  R13: 0000000000000719 R14: ffffb0ffc0acfa1f R15: ffffffffc1813060\n  FS:  0000000000000000(0000) GS:ffff9486f3480000(0000) knlGS:0000000000000000\n  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n  CR2: 0000000000001090 CR3: 0000000090440001 CR4: 00000000000626f0\n  Call Trace:\n   <TASK>\n   rtw89_pci_read_config_byte+0x6d/0x120 [rtw89_pci]\n   rtw89_pci_cfg_dac+0x5b/0xb0 [rtw89_pci]\n   rtw89_pci_probe+0xa96/0xbd0 [rtw89_pci]\n   ? __pfx___device_attach_driver+0x10/0x10\n   ? __pfx___device_attach_driver+0x10/0x10\n   local_pci_probe+0x47/0xa0\n   pci_call_probe+0x5d/0x190\n   pci_device_probe+0xa7/0x160\n   really_probe+0xf9/0x370\n   ? pm_runtime_barrier+0x55/0xa0\n   __driver_probe_device+0x8c/0x140\n   driver_probe_device+0x24/0xd0\n   __device_attach_driver+0xcd/0x170\n   bus_for_each_drv+0x99/0x100\n   __device_attach+0xb4/0x1d0\n   device_attach+0x10/0x20\n   pci_bus_add_device+0x59/0x90\n   pci_bus_add_devices+0x31/0x80\n   pciehp_configure_device+0xaa/0x170\n   pciehp_enable_slot+0xd6/0x240\n   pciehp_handle_presence_or_link_change+0xf1/0x180\n   pciehp_ist+0x162/0x1c0\n   irq_thread_fn+0x24/0x70\n   irq_thread+0xef/0x1c0\n   ? __pfx_irq_thread_fn+0x10/0x10\n   ? __pfx_irq_thread_dtor+0x10/0x10\n   ? __pfx_irq_thread+0x10/0x10\n   kthread+0xfc/0x230\n   ? __pfx_kthread+0x10/0x10\n   ret_from_fork+0x47/0x70\n   ? __pfx_kthread+0x10/0x10\n   ret_from_fork_asm+0x1a/0x30\n   </TASK>","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1fd4b3fe52efd5ad1647966f619c10988e7a4457"},{"fixed":"e1e0f046041474004dc6ebce5ce1d3e86556291d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1fd4b3fe52efd5ad1647966f619c10988e7a4457"},{"fixed":"a70cf04b08f44f41bce14659aa7012674b15d9de"}]}],"versions":["v6.10","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38284.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"11056160029500029012843563553300556252","length":227},"id":"CVE-2025-38284-0a42184d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e1e0f046041474004dc6ebce5ce1d3e86556291d","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c","function":"rtw89_pci_cfg_dac"}},{"deprecated":false,"digest":{"function_hash":"38709308791910510395669561283011266679","length":189},"id":"CVE-2025-38284-29280e03","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e1e0f046041474004dc6ebce5ce1d3e86556291d","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c","function":"rtw89_pci_basic_cfg"}},{"deprecated":false,"digest":{"function_hash":"11056160029500029012843563553300556252","length":227},"id":"CVE-2025-38284-3f4caa2a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a70cf04b08f44f41bce14659aa7012674b15d9de","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c","function":"rtw89_pci_cfg_dac"}},{"deprecated":false,"digest":{"line_hashes":["85140922657872454952861941165864403605","280961824008712425220024940182778726739","4447949721033460476111584013877680302","319422485680812721078470757878472825669","43267162229496436281834501985432679011","49358493200015324088304455870781620114","160836392935319936487269260104779912352","291893374006609058692182545758668733033","127019630335053709631004586179738577442","209052801083130636095702608143898169471","300423590415393722635340584467157806421","244865053059354986383066666830510311043","306638339643821185016783920436110858115","192266861790928588308349004081046155283","36883596030518982222777208121150857985","301948375358978120335164305458060245717","195354518221289393353215047189175493046","158991675920704348627691714617412482509","336418396275113650164059972340372810386","188490220912623963897071454653072618835","225131994782957172510556380116575938121","217684690554109302543362875397646655874","122251228521878591854486715406269373512","250015814621843351506243966264185231890","313596471338816424572440113969961280991","68856132437574049966576322624696827527","222580179787230847977242164512705380222","315429495140120183855333346203236641293"],"threshold":0.9},"id":"CVE-2025-38284-82be9e69","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e1e0f046041474004dc6ebce5ce1d3e86556291d","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c"}},{"deprecated":false,"digest":{"function_hash":"339006434195826720673499025059510751949","length":897},"id":"CVE-2025-38284-87775b5f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a70cf04b08f44f41bce14659aa7012674b15d9de","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c","function":"rtw89_pci_setup_mapping"}},{"deprecated":false,"digest":{"function_hash":"38709308791910510395669561283011266679","length":189},"id":"CVE-2025-38284-898ce305","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a70cf04b08f44f41bce14659aa7012674b15d9de","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c","function":"rtw89_pci_basic_cfg"}},{"deprecated":false,"digest":{"line_hashes":["85140922657872454952861941165864403605","280961824008712425220024940182778726739","4447949721033460476111584013877680302","319422485680812721078470757878472825669","43267162229496436281834501985432679011","49358493200015324088304455870781620114","160836392935319936487269260104779912352","291893374006609058692182545758668733033","127019630335053709631004586179738577442","209052801083130636095702608143898169471","300423590415393722635340584467157806421","244865053059354986383066666830510311043","306638339643821185016783920436110858115","192266861790928588308349004081046155283","36883596030518982222777208121150857985","301948375358978120335164305458060245717","195354518221289393353215047189175493046","158991675920704348627691714617412482509","336418396275113650164059972340372810386","188490220912623963897071454653072618835","225131994782957172510556380116575938121","217684690554109302543362875397646655874","122251228521878591854486715406269373512","250015814621843351506243966264185231890","313596471338816424572440113969961280991","68856132437574049966576322624696827527","222580179787230847977242164512705380222","315429495140120183855333346203236641293"],"threshold":0.9},"id":"CVE-2025-38284-a2b75c44","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a70cf04b08f44f41bce14659aa7012674b15d9de","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c"}},{"deprecated":false,"digest":{"function_hash":"339006434195826720673499025059510751949","length":897},"id":"CVE-2025-38284-f5aca376","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e1e0f046041474004dc6ebce5ce1d3e86556291d","target":{"file":"drivers/net/wireless/realtek/rtw89/pci.c","function":"rtw89_pci_setup_mapping"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.15.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38284.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a70cf04b08f44f41bce14659aa7012674b15d9de"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e1e0f046041474004dc6ebce5ce1d3e86556291d"}]}