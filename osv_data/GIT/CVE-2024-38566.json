{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-38566.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320793509880639464480666771355344970433",
              "length": 2994.0
            },
            "id": "CVE-2024-38566-1068c566",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "check_ptr_to_btf_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "115571514967321429506267838252348362123",
                "153810382600586906634120864045299104550",
                "246953112429577927322758074671410531556",
                "206655105806903677000293499644836518283",
                "333800100341218567191773069548698781697",
                "198863282800430541868534220342464585660",
                "36424425859599341081404642487073434241",
                "243844656766750059171741907091000373372",
                "186888603384770764222444300568737444608",
                "225105461984420310733196985237860569192"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-1ab1f8ae",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/bench_local_storage_create.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "211016658753474306742127067237860891883",
                "46431376976561209316536107559219648897",
                "94681970775370478308216847197247310010",
                "145595150335228974542241635177464097372",
                "302160829755266391447298969702668010962",
                "321736015982632473461117953182826589904",
                "68831706913422934152936017159338217029",
                "228997451779016325946963061472484206981",
                "256338952855869690762258138353301563700",
                "106371211734284087982209798951793423797",
                "21576583655568845650951349260474503261",
                "313098994643857257336913682802529198391",
                "5852366911306155193493063144734300855",
                "249212957436479430695261376434242935063",
                "228775123335603286458146192717393828675",
                "106371211734284087982209798951793423797",
                "21576583655568845650951349260474503261",
                "212061375095982944246502807006237691909",
                "240852880011259833525537645849184553136",
                "254072088953283727389928779750098255567",
                "55073234002209330344907550378101105562",
                "281438603103263520824713541232666286734",
                "271998494265315025049571262680625329229",
                "68015279013678822306357896061852268075",
                "46431376976561209316536107559219648897",
                "94681970775370478308216847197247310010",
                "333410222574480901260933391293932024927",
                "329534199459661694584646740236697566794",
                "6870400644675655964977310978753612271",
                "269713440997487375837115517047214194579"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-2d379fb1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "30930286359314648800747150355174142413",
              "length": 554.0
            },
            "id": "CVE-2024-38566-3050df20",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "type_is_trusted"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "292242583666842272437860844138666217062",
              "length": 364.0
            },
            "id": "CVE-2024-38566-31de315f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "mark_btf_ld_reg"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "335464805627553523429680373148833432976",
                "183451088001844727826939329089333282875",
                "48149207602471054086752038899879727051",
                "285752785121370674924591554173117162508",
                "287107313803550511487880016454652637500",
                "259738505107361151140977339332971337853",
                "237320084722506693297605832640578019035"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-32780a53",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/lsm_cgroup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "333621734296372369350518434345138436181",
              "length": 344.0
            },
            "id": "CVE-2024-38566-36181a6f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/lsm_cgroup.c",
              "function": "real_bind"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "95479559444490573652785700374295547187",
              "length": 373.0
            },
            "id": "CVE-2024-38566-36ca4559",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/bench_local_storage_create.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "232224794978431366602167157216363906696",
              "length": 250.0
            },
            "id": "CVE-2024-38566-3a53d147",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "is_trusted_reg"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "137090401332406319805092309671099805767",
              "length": 1270.0
            },
            "id": "CVE-2024-38566-3cf22560",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "check_map_kptr_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331324614404273268580369261002501212663",
                "78955722595270032604518343598500927018",
                "153101659486605479940760928043604843972",
                "194372010508284006963823855365511444034",
                "200229222694090491550529310891642495878",
                "200375082322130906301980050743351587521",
                "314652805851420649521200899923060567448",
                "216755707474367339542779780968502714543",
                "171475354500276733939362522692332743879",
                "145983974408190430749684188392432487913",
                "282168587108649890001989024043057108496",
                "215663014995586123950191280689142594530",
                "52582972702604719810060713698434520890",
                "258463879479010684041317808804114015869",
                "175560636797070507846484569381032529121",
                "79572485946326529835067260051239873115",
                "174659032830199349947820976509042303674",
                "199114078596992784403372147786908753690",
                "96059121247500532979196005219339584215",
                "238296592975125328841681258546192718083",
                "237364678454702451517865603596580549026",
                "167708979484771955622606745657997840897",
                "218081664239063974305818065183824092868",
                "92058488793164802546844570264511954134",
                "3164808605359826970640156701459498235",
                "317718772483002601489668067307036122510",
                "62345974896292543388445048014263857618",
                "94680917247437247958776592940542161300",
                "252775180235753392788975711529765127234"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-3fe3685b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "kernel/bpf/verifier.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "292242583666842272437860844138666217062",
              "length": 364.0
            },
            "id": "CVE-2024-38566-4387f413",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "mark_btf_ld_reg"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "149343152635228081851353430707268569628",
              "length": 803.0
            },
            "id": "CVE-2024-38566-4ce157b4",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "115571514967321429506267838252348362123",
                "153810382600586906634120864045299104550",
                "246953112429577927322758074671410531556",
                "206655105806903677000293499644836518283",
                "333800100341218567191773069548698781697",
                "198863282800430541868534220342464585660",
                "36424425859599341081404642487073434241",
                "243844656766750059171741907091000373372",
                "186888603384770764222444300568737444608",
                "225105461984420310733196985237860569192"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-5320b011",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/bench_local_storage_create.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "335464805627553523429680373148833432976",
                "183451088001844727826939329089333282875",
                "48149207602471054086752038899879727051",
                "285752785121370674924591554173117162508",
                "287107313803550511487880016454652637500",
                "259738505107361151140977339332971337853",
                "237320084722506693297605832640578019035"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-534d93e5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/lsm_cgroup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "149343152635228081851353430707268569628",
              "length": 803.0
            },
            "id": "CVE-2024-38566-56bbbdf8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "157737696723560908881555070572282131005",
              "length": 347.0
            },
            "id": "CVE-2024-38566-6736281b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "30930286359314648800747150355174142413",
              "length": 554.0
            },
            "id": "CVE-2024-38566-6f134c06",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "type_is_trusted"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "333621734296372369350518434345138436181",
              "length": 344.0
            },
            "id": "CVE-2024-38566-7099413f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/lsm_cgroup.c",
              "function": "real_bind"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "211016658753474306742127067237860891883",
                "46431376976561209316536107559219648897",
                "94681970775370478308216847197247310010",
                "145595150335228974542241635177464097372",
                "302160829755266391447298969702668010962",
                "321736015982632473461117953182826589904",
                "68831706913422934152936017159338217029",
                "228997451779016325946963061472484206981",
                "256338952855869690762258138353301563700",
                "106371211734284087982209798951793423797",
                "21576583655568845650951349260474503261",
                "313098994643857257336913682802529198391",
                "5852366911306155193493063144734300855",
                "249212957436479430695261376434242935063",
                "228775123335603286458146192717393828675",
                "106371211734284087982209798951793423797",
                "21576583655568845650951349260474503261",
                "212061375095982944246502807006237691909",
                "240852880011259833525537645849184553136",
                "254072088953283727389928779750098255567",
                "55073234002209330344907550378101105562",
                "281438603103263520824713541232666286734",
                "271998494265315025049571262680625329229",
                "68015279013678822306357896061852268075",
                "46431376976561209316536107559219648897",
                "94681970775370478308216847197247310010",
                "333410222574480901260933391293932024927",
                "329534199459661694584646740236697566794",
                "6870400644675655964977310978753612271",
                "269713440997487375837115517047214194579"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-71c2c332",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "95479559444490573652785700374295547187",
              "length": 373.0
            },
            "id": "CVE-2024-38566-7df5bb1f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/bench_local_storage_create.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "333621734296372369350518434345138436181",
              "length": 344.0
            },
            "id": "CVE-2024-38566-94941574",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/lsm_cgroup.c",
              "function": "real_bind"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "232224794978431366602167157216363906696",
              "length": 250.0
            },
            "id": "CVE-2024-38566-a1ecf1ec",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "is_trusted_reg"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "206565853147559957542866315087730051099",
              "length": 1236.0
            },
            "id": "CVE-2024-38566-a4dd6a06",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "check_map_kptr_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "157737696723560908881555070572282131005",
              "length": 347.0
            },
            "id": "CVE-2024-38566-aa11536f",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "292242583666842272437860844138666217062",
              "length": 364.0
            },
            "id": "CVE-2024-38566-ab624235",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "mark_btf_ld_reg"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331324614404273268580369261002501212663",
                "78955722595270032604518343598500927018",
                "153101659486605479940760928043604843972",
                "194372010508284006963823855365511444034",
                "256219213297952047791955650497724512615",
                "159903219748435878189621930635995985354",
                "312639188495126220671737296257411947875",
                "216755707474367339542779780968502714543",
                "171475354500276733939362522692332743879",
                "145983974408190430749684188392432487913",
                "282168587108649890001989024043057108496",
                "215663014995586123950191280689142594530",
                "52582972702604719810060713698434520890",
                "258463879479010684041317808804114015869",
                "175560636797070507846484569381032529121",
                "79572485946326529835067260051239873115",
                "174659032830199349947820976509042303674",
                "199114078596992784403372147786908753690",
                "96059121247500532979196005219339584215",
                "238296592975125328841681258546192718083",
                "237364678454702451517865603596580549026",
                "167708979484771955622606745657997840897",
                "218081664239063974305818065183824092868",
                "92058488793164802546844570264511954134",
                "3164808605359826970640156701459498235",
                "317718772483002601489668067307036122510",
                "62345974896292543388445048014263857618",
                "94680917247437247958776592940542161300",
                "252775180235753392788975711529765127234"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-b789672f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "kernel/bpf/verifier.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "157737696723560908881555070572282131005",
              "length": 347.0
            },
            "id": "CVE-2024-38566-be069421",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "211016658753474306742127067237860891883",
                "46431376976561209316536107559219648897",
                "94681970775370478308216847197247310010",
                "145595150335228974542241635177464097372",
                "302160829755266391447298969702668010962",
                "321736015982632473461117953182826589904",
                "68831706913422934152936017159338217029",
                "228997451779016325946963061472484206981",
                "256338952855869690762258138353301563700",
                "106371211734284087982209798951793423797",
                "21576583655568845650951349260474503261",
                "313098994643857257336913682802529198391",
                "5852366911306155193493063144734300855",
                "249212957436479430695261376434242935063",
                "228775123335603286458146192717393828675",
                "106371211734284087982209798951793423797",
                "21576583655568845650951349260474503261",
                "212061375095982944246502807006237691909",
                "240852880011259833525537645849184553136",
                "254072088953283727389928779750098255567",
                "55073234002209330344907550378101105562",
                "281438603103263520824713541232666286734",
                "271998494265315025049571262680625329229",
                "68015279013678822306357896061852268075",
                "46431376976561209316536107559219648897",
                "94681970775370478308216847197247310010",
                "333410222574480901260933391293932024927",
                "329534199459661694584646740236697566794",
                "6870400644675655964977310978753612271",
                "269713440997487375837115517047214194579"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-bfd53940",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "335464805627553523429680373148833432976",
                "183451088001844727826939329089333282875",
                "48149207602471054086752038899879727051",
                "285752785121370674924591554173117162508",
                "287107313803550511487880016454652637500",
                "259738505107361151140977339332971337853",
                "237320084722506693297605832640578019035"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-c0ba2501",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/lsm_cgroup.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "331324614404273268580369261002501212663",
                "78955722595270032604518343598500927018",
                "153101659486605479940760928043604843972",
                "194372010508284006963823855365511444034",
                "256219213297952047791955650497724512615",
                "159903219748435878189621930635995985354",
                "312639188495126220671737296257411947875",
                "216755707474367339542779780968502714543",
                "171475354500276733939362522692332743879",
                "145983974408190430749684188392432487913",
                "282168587108649890001989024043057108496",
                "215663014995586123950191280689142594530",
                "52582972702604719810060713698434520890",
                "258463879479010684041317808804114015869",
                "175560636797070507846484569381032529121",
                "79572485946326529835067260051239873115",
                "174659032830199349947820976509042303674",
                "199114078596992784403372147786908753690",
                "96059121247500532979196005219339584215",
                "238296592975125328841681258546192718083",
                "237364678454702451517865603596580549026",
                "167708979484771955622606745657997840897",
                "218081664239063974305818065183824092868",
                "92058488793164802546844570264511954134",
                "3164808605359826970640156701459498235",
                "317718772483002601489668067307036122510",
                "62345974896292543388445048014263857618",
                "94680917247437247958776592940542161300",
                "252775180235753392788975711529765127234"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-d23dc941",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "kernel/bpf/verifier.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "51889001619753983726516444051513207091",
              "length": 2963.0
            },
            "id": "CVE-2024-38566-d3652d08",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "check_ptr_to_btf_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "115571514967321429506267838252348362123",
                "153810382600586906634120864045299104550",
                "246953112429577927322758074671410531556",
                "206655105806903677000293499644836518283",
                "333800100341218567191773069548698781697",
                "198863282800430541868534220342464585660",
                "36424425859599341081404642487073434241",
                "243844656766750059171741907091000373372",
                "186888603384770764222444300568737444608",
                "225105461984420310733196985237860569192"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-38566-d51c2bae",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/bench_local_storage_create.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "320793509880639464480666771355344970433",
              "length": 2994.0
            },
            "id": "CVE-2024-38566-e6df430d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "check_ptr_to_btf_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "149343152635228081851353430707268569628",
              "length": 803.0
            },
            "id": "CVE-2024-38566-e803d3de",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/local_storage.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "206565853147559957542866315087730051099",
              "length": 1236.0
            },
            "id": "CVE-2024-38566-e95aac1d",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0db63c0b86e981a1e97d2596d64ceceba1a5470e",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "check_map_kptr_access"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "95479559444490573652785700374295547187",
              "length": 373.0
            },
            "id": "CVE-2024-38566-fa48d783",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@39f8a29330f433000e716eefc4b9abda05b71a82",
            "target": {
              "file": "tools/testing/selftests/bpf/progs/bench_local_storage_create.c",
              "function": "BPF_PROG"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "232224794978431366602167157216363906696",
              "length": 250.0
            },
            "id": "CVE-2024-38566-fa9c84ae",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "is_trusted_reg"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "30930286359314648800747150355174142413",
              "length": 554.0
            },
            "id": "CVE-2024-38566-fe86e36a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@6f5ae91172a93abac9720ba94edf3ec8f4d7f24f",
            "target": {
              "file": "kernel/bpf/verifier.c",
              "function": "type_is_trusted"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6fcd486b3a0a628c41f12b3a7329a18a2c74b351"
            },
            {
              "fixed": "39f8a29330f433000e716eefc4b9abda05b71a82"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6fcd486b3a0a628c41f12b3a7329a18a2c74b351"
            },
            {
              "fixed": "6f5ae91172a93abac9720ba94edf3ec8f4d7f24f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6fcd486b3a0a628c41f12b3a7329a18a2c74b351"
            },
            {
              "fixed": "c58ccdd2483a1d990748cdaf94206b5d5986a001"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "6fcd486b3a0a628c41f12b3a7329a18a2c74b351"
            },
            {
              "fixed": "0db63c0b86e981a1e97d2596d64ceceba1a5470e"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.3",
        "v6.6.30",
        "v6.6.31",
        "v6.6.32",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.10",
        "v6.8.11",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4",
        "v6.8.5",
        "v6.8.6",
        "v6.8.7",
        "v6.8.8",
        "v6.8.9",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7",
        "v6.9.1",
        "v6.9.2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-38566.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.4.0"
            },
            {
              "fixed": "6.6.33"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.8.12"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.9.0"
            },
            {
              "fixed": "6.9.3"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix verifier assumptions about socket->sk\n\nThe verifier assumes that 'sk' field in 'struct socket' is valid\nand non-NULL when 'socket' pointer itself is trusted and non-NULL.\nThat may not be the case when socket was just created and\npassed to LSM socket_accept hook.\nFix this verifier assumption and adjust tests.",
  "id": "CVE-2024-38566",
  "modified": "2025-10-15T12:23:09.969519Z",
  "published": "2024-06-19T13:35:33Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0db63c0b86e981a1e97d2596d64ceceba1a5470e"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/39f8a29330f433000e716eefc4b9abda05b71a82"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6f5ae91172a93abac9720ba94edf3ec8f4d7f24f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c58ccdd2483a1d990748cdaf94206b5d5986a001"
    }
  ],
  "related": [
    "MGASA-2024-0263",
    "MGASA-2024-0266",
    "SUSE-SU-2024:2571-1",
    "SUSE-SU-2024:2896-1",
    "SUSE-SU-2024:2973-1"
  ],
  "schema_version": "1.7.3",
  "summary": "bpf: Fix verifier assumptions about socket->sk"
}