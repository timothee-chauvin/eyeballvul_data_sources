{"schema_version":"1.7.3","id":"CVE-2025-38447","published":"2025-07-25T15:27:29.360Z","modified":"2025-11-20T09:27:24.767685Z","summary":"mm/rmap: fix potential out-of-bounds page table access during batched unmap","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmm/rmap: fix potential out-of-bounds page table access during batched unmap\n\nAs pointed out by David[1], the batched unmap logic in\ntry_to_unmap_one() may read past the end of a PTE table when a large\nfolio's PTE mappings are not fully contained within a single page\ntable.\n\nWhile this scenario might be rare, an issue triggerable from userspace\nmust be fixed regardless of its likelihood.  This patch fixes the\nout-of-bounds access by refactoring the logic into a new helper,\nfolio_unmap_pte_batch().\n\nThe new helper correctly calculates the safe batch size by capping the\nscan at both the VMA and PMD boundaries.  To simplify the code, it also\nsupports partial batching (i.e., any number of pages from 1 up to the\ncalculated safe maximum), as there is no strong reason to special-case\nfor fully mapped folios.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"354dffd29575cdf13154e8fb787322354aa9efc4"},{"fixed":"510fe9c15d07e765d96be9a9dc37e5057c6c09f4"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"354dffd29575cdf13154e8fb787322354aa9efc4"},{"fixed":"ddd05742b45b083975a0855ef6ebbf88cf1f532a"}]}],"versions":["v6.14","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.15.1","v6.15.2","v6.15.3","v6.15.4","v6.15.5","v6.15.6","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38447.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"70520059946295256295123337410770077193","length":471},"id":"CVE-2025-38447-57b06603","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@510fe9c15d07e765d96be9a9dc37e5057c6c09f4","target":{"file":"mm/rmap.c","function":"can_batch_unmap_folio_ptes"}},{"deprecated":false,"digest":{"line_hashes":["309133853745019212672801186829153999017","260945907664023131579505118130604177754","188736618778071654746103008054021780023","183304094436319544680845955445210914864","191511147448372230885281674292840436076","329255399250866773940509811770567048233","148011657451900813741195159696213425259","174512108387589021329166460987119307786","288416877787765970528867742996496924998","174014982176384975556399613146280749056","217664294764986611540192788272103581262","230193932933977499332157315962488634999","313539172515691183411203931886796089640","205819411182460437626248678107187515478","152501559986303102974808921798579198033","24103930277275481483633975450829430616","313304402481886280925029743473296099264","59479316291221112026786431829185124175","275010894024776949749807393221829788983","133011734629348450290721818327559590208","100700699685054491462730026198398028682","314297380718500967331448133402140979392","245758648502420955039041694003726321730","338082812174305730236081010526490744584","306085013418453371030969388673830116872","258637134254408309548816947609776388791","99083930973206020144804607213113483397","177138461577411525715350772994822381863","230373330938710386662560814030265433159","135814747170399565749949987029959243386","325135593457585351243945471914766015140","175993402953773067843289717229569336298"],"threshold":0.9},"id":"CVE-2025-38447-71173c4e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@510fe9c15d07e765d96be9a9dc37e5057c6c09f4","target":{"file":"mm/rmap.c"}},{"deprecated":false,"digest":{"function_hash":"70520059946295256295123337410770077193","length":471},"id":"CVE-2025-38447-7d794470","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ddd05742b45b083975a0855ef6ebbf88cf1f532a","target":{"file":"mm/rmap.c","function":"can_batch_unmap_folio_ptes"}},{"deprecated":false,"digest":{"line_hashes":["309133853745019212672801186829153999017","260945907664023131579505118130604177754","188736618778071654746103008054021780023","183304094436319544680845955445210914864","191511147448372230885281674292840436076","329255399250866773940509811770567048233","148011657451900813741195159696213425259","174512108387589021329166460987119307786","288416877787765970528867742996496924998","174014982176384975556399613146280749056","217664294764986611540192788272103581262","230193932933977499332157315962488634999","313539172515691183411203931886796089640","205819411182460437626248678107187515478","152501559986303102974808921798579198033","24103930277275481483633975450829430616","313304402481886280925029743473296099264","59479316291221112026786431829185124175","275010894024776949749807393221829788983","133011734629348450290721818327559590208","100700699685054491462730026198398028682","314297380718500967331448133402140979392","245758648502420955039041694003726321730","338082812174305730236081010526490744584","306085013418453371030969388673830116872","258637134254408309548816947609776388791","99083930973206020144804607213113483397","177138461577411525715350772994822381863","230373330938710386662560814030265433159","135814747170399565749949987029959243386","325135593457585351243945471914766015140","175993402953773067843289717229569336298"],"threshold":0.9},"id":"CVE-2025-38447-c6fba0a6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ddd05742b45b083975a0855ef6ebbf88cf1f532a","target":{"file":"mm/rmap.c"}},{"deprecated":false,"digest":{"function_hash":"228911805450161685008942726151048505759","length":5067},"id":"CVE-2025-38447-e1cb4397","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@510fe9c15d07e765d96be9a9dc37e5057c6c09f4","target":{"file":"mm/rmap.c","function":"try_to_unmap_one"}},{"deprecated":false,"digest":{"function_hash":"330226066039957668000071930526237195665","length":5059},"id":"CVE-2025-38447-e7cfd284","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ddd05742b45b083975a0855ef6ebbf88cf1f532a","target":{"file":"mm/rmap.c","function":"try_to_unmap_one"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.15.0"},{"fixed":"6.15.7"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38447.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/510fe9c15d07e765d96be9a9dc37e5057c6c09f4"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ddd05742b45b083975a0855ef6ebbf88cf1f532a"}]}