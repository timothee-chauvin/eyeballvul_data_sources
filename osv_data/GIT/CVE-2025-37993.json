{"schema_version":"1.7.3","id":"CVE-2025-37993","published":"2025-05-29T13:15:52.811Z","modified":"2025-11-20T09:01:41.760259Z","summary":"can: m_can: m_can_class_allocate_dev(): initialize spin lock on device probe","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ncan: m_can: m_can_class_allocate_dev(): initialize spin lock on device probe\n\nThe spin lock tx_handling_spinlock in struct m_can_classdev is not\nbeing initialized. This leads the following spinlock bad magic\ncomplaint from the kernel, eg. when trying to send CAN frames with\ncansend from can-utils:\n\n| BUG: spinlock bad magic on CPU#0, cansend/95\n|  lock: 0xff60000002ec1010, .magic: 00000000, .owner: <none>/-1, .owner_cpu: 0\n| CPU: 0 UID: 0 PID: 95 Comm: cansend Not tainted 6.15.0-rc3-00032-ga79be02bba5c #5 NONE\n| Hardware name: MachineWare SIM-V (DT)\n| Call Trace:\n| [<ffffffff800133e0>] dump_backtrace+0x1c/0x24\n| [<ffffffff800022f2>] show_stack+0x28/0x34\n| [<ffffffff8000de3e>] dump_stack_lvl+0x4a/0x68\n| [<ffffffff8000de70>] dump_stack+0x14/0x1c\n| [<ffffffff80003134>] spin_dump+0x62/0x6e\n| [<ffffffff800883ba>] do_raw_spin_lock+0xd0/0x142\n| [<ffffffff807a6fcc>] _raw_spin_lock_irqsave+0x20/0x2c\n| [<ffffffff80536dba>] m_can_start_xmit+0x90/0x34a\n| [<ffffffff806148b0>] dev_hard_start_xmit+0xa6/0xee\n| [<ffffffff8065b730>] sch_direct_xmit+0x114/0x292\n| [<ffffffff80614e2a>] __dev_queue_xmit+0x3b0/0xaa8\n| [<ffffffff8073b8fa>] can_send+0xc6/0x242\n| [<ffffffff8073d1c0>] raw_sendmsg+0x1a8/0x36c\n| [<ffffffff805ebf06>] sock_write_iter+0x9a/0xee\n| [<ffffffff801d06ea>] vfs_write+0x184/0x3a6\n| [<ffffffff801d0a88>] ksys_write+0xa0/0xc0\n| [<ffffffff801d0abc>] __riscv_sys_write+0x14/0x1c\n| [<ffffffff8079ebf8>] do_trap_ecall_u+0x168/0x212\n| [<ffffffff807a830a>] handle_exception+0x146/0x152\n\nInitializing the spin lock in m_can_class_allocate_dev solves that\nproblem.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1fa80e23c15051edc1c594270517de3517ded798"},{"fixed":"2ecce25ea296f328d79070ee36229a15aeeb7aca"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1fa80e23c15051edc1c594270517de3517ded798"},{"fixed":"7d5379cfecfdd665e4206bc4f19824656388779f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"1fa80e23c15051edc1c594270517de3517ded798"},{"fixed":"dcaeeb8ae84c5506ebc574732838264f3887738c"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.14.6","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.8","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37993.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"184214439273571309156312661762815057493","length":590},"id":"CVE-2025-37993-40115521","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7d5379cfecfdd665e4206bc4f19824656388779f","target":{"file":"drivers/net/can/m_can/m_can.c","function":"m_can_class_allocate_dev"}},{"deprecated":false,"digest":{"line_hashes":["27801823157933206941628010395947161318","118644752678161354249964507519382017299","230941096655503022820365466588078567956","148494551570396577120450342456645769574"],"threshold":0.9},"id":"CVE-2025-37993-a50eb447","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7d5379cfecfdd665e4206bc4f19824656388779f","target":{"file":"drivers/net/can/m_can/m_can.c"}},{"deprecated":false,"digest":{"function_hash":"184214439273571309156312661762815057493","length":590},"id":"CVE-2025-37993-ab6b5b8b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2ecce25ea296f328d79070ee36229a15aeeb7aca","target":{"file":"drivers/net/can/m_can/m_can.c","function":"m_can_class_allocate_dev"}},{"deprecated":false,"digest":{"line_hashes":["27801823157933206941628010395947161318","118644752678161354249964507519382017299","230941096655503022820365466588078567956","148494551570396577120450342456645769574"],"threshold":0.9},"id":"CVE-2025-37993-b6d890cd","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2ecce25ea296f328d79070ee36229a15aeeb7aca","target":{"file":"drivers/net/can/m_can/m_can.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.9.0"},{"fixed":"6.12.29"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.14.7"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-37993.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2ecce25ea296f328d79070ee36229a15aeeb7aca"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7d5379cfecfdd665e4206bc4f19824656388779f"},{"type":"WEB","url":"https://git.kernel.org/stable/c/dcaeeb8ae84c5506ebc574732838264f3887738c"}]}