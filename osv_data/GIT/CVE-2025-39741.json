{"schema_version":"1.7.3","id":"CVE-2025-39741","published":"2025-09-11T16:52:15.353Z","modified":"2025-11-20T09:48:45.770654Z","summary":"drm/xe/migrate: don't overflow max copy size","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/xe/migrate: don't overflow max copy size\n\nWith non-page aligned copy, we need to use 4 byte aligned pitch, however\nthe size itself might still be close to our maximum of ~8M, and so the\ndimensions of the copy can easily exceed the S16_MAX limit of the copy\ncommand leading to the following assert:\n\nxe 0000:03:00.0: [drm] Assertion `size / pitch <= ((s16)(((u16)~0U) >> 1))` failed!\nplatform: BATTLEMAGE subplatform: 1\ngraphics: Xe2_HPG 20.01 step A0\nmedia: Xe2_HPM 13.01 step A1\ntile: 0 VRAM 10.0 GiB\nGT: 0 type 1\n\nWARNING: CPU: 23 PID: 10605 at drivers/gpu/drm/xe/xe_migrate.c:673 emit_copy+0x4b5/0x4e0 [xe]\n\nTo fix this account for the pitch when calculating the number of current\nbytes to copy.\n\n(cherry picked from commit 8c2d61e0e916e077fda7e7b8e67f25ffe0f361fc)","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"270172f64b114451876c1b68912653e72ab99f38"},{"fixed":"7257cc6644d540130a46a61531a07a0517cace89"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"270172f64b114451876c1b68912653e72ab99f38"},{"fixed":"4126cb327a2e3273c81fcef1c594c5b7b645c44c"}]}],"versions":["v6.15","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.16.1","v6.17-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39741.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"102981419614672599548037754159458530991","length":2268},"id":"CVE-2025-39741-d865f11f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4126cb327a2e3273c81fcef1c594c5b7b645c44c","target":{"file":"drivers/gpu/drm/xe/xe_migrate.c","function":"xe_migrate_access_memory"}},{"deprecated":false,"digest":{"line_hashes":["60048689393623532040733308774160786919","30046458820725420440981890120223574747","158067431877885263587071777968302776677"],"threshold":0.9},"id":"CVE-2025-39741-f1b3b917","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@4126cb327a2e3273c81fcef1c594c5b7b645c44c","target":{"file":"drivers/gpu/drm/xe/xe_migrate.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.16.0"},{"fixed":"6.16.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-39741.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4126cb327a2e3273c81fcef1c594c5b7b645c44c"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7257cc6644d540130a46a61531a07a0517cace89"}]}