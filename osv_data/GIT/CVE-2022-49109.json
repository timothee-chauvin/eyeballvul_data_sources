{"schema_version":"1.7.3","id":"CVE-2022-49109","published":"2025-02-26T01:54:55Z","modified":"2025-10-21T09:30:06.733883Z","related":["SUSE-SU-2025:1027-1","SUSE-SU-2025:1176-1","SUSE-SU-2025:1183-1","SUSE-SU-2025:1241-1","SUSE-SU-2025:1293-1"],"summary":"ceph: fix inode reference leakage in ceph_get_snapdir()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nceph: fix inode reference leakage in ceph_get_snapdir()\n\nThe ceph_get_inode() will search for or insert a new inode into the\nhash for the given vino, and return a reference to it. If new is\nnon-NULL, its reference is consumed.\n\nWe should release the reference when in error handing cases.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"9030aaf9bf0a1eee47a154c316c789e959638b0f"},{"fixed":"3ae7163598c611a8892698e0c056fe794e52b44b"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"9030aaf9bf0a1eee47a154c316c789e959638b0f"},{"fixed":"9cd21981dedfb4fe9f344529e4be35727cb10940"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"9030aaf9bf0a1eee47a154c316c789e959638b0f"},{"fixed":"b2d9bb3f06abddefdfa740b0a604575b6797e1bf"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"9030aaf9bf0a1eee47a154c316c789e959638b0f"},{"fixed":"322794d3355c33adcc4feace0045d85a8e4ed813"}]}],"versions":["v2.6.32","v2.6.32-rc3","v2.6.32-rc4","v2.6.32-rc5","v2.6.32-rc6","v2.6.32-rc7","v2.6.32-rc8","v2.6.33","v2.6.33-rc1","v2.6.33-rc2","v2.6.33-rc3","v2.6.33-rc4","v2.6.33-rc5","v2.6.33-rc6","v2.6.33-rc7","v2.6.33-rc8","v2.6.34","v2.6.34-rc1","v2.6.34-rc2","v2.6.34-rc3","v2.6.34-rc4","v2.6.34-rc5","v2.6.34-rc6","v2.6.34-rc7","v2.6.35","v2.6.35-rc1","v2.6.35-rc2","v2.6.35-rc3","v2.6.35-rc4","v2.6.35-rc5","v2.6.35-rc6","v2.6.36","v2.6.36-rc1","v2.6.36-rc2","v2.6.36-rc3","v2.6.36-rc4","v2.6.36-rc5","v2.6.36-rc6","v2.6.36-rc7","v2.6.36-rc8","v2.6.37","v2.6.37-rc1","v2.6.37-rc2","v2.6.37-rc3","v2.6.37-rc4","v2.6.37-rc5","v2.6.37-rc6","v2.6.37-rc7","v2.6.37-rc8","v2.6.38","v2.6.38-rc1","v2.6.38-rc2","v2.6.38-rc3","v2.6.38-rc4","v2.6.38-rc5","v2.6.38-rc6","v2.6.38-rc7","v2.6.38-rc8","v2.6.39","v2.6.39-rc1","v2.6.39-rc2","v2.6.39-rc3","v2.6.39-rc4","v2.6.39-rc5","v2.6.39-rc6","v2.6.39-rc7","v3.0","v3.0-rc1","v3.0-rc2","v3.0-rc3","v3.0-rc4","v3.0-rc5","v3.0-rc6","v3.0-rc7","v3.1","v3.1-rc1","v3.1-rc10","v3.1-rc2","v3.1-rc3","v3.1-rc4","v3.1-rc5","v3.1-rc6","v3.1-rc7","v3.1-rc8","v3.1-rc9","v3.10","v3.10-rc1","v3.10-rc2","v3.10-rc3","v3.10-rc4","v3.10-rc5","v3.10-rc6","v3.10-rc7","v3.11","v3.11-rc1","v3.11-rc2","v3.11-rc3","v3.11-rc4","v3.11-rc5","v3.11-rc6","v3.11-rc7","v3.12","v3.12-rc1","v3.12-rc2","v3.12-rc3","v3.12-rc4","v3.12-rc5","v3.12-rc6","v3.12-rc7","v3.13","v3.13-rc1","v3.13-rc2","v3.13-rc3","v3.13-rc4","v3.13-rc5","v3.13-rc6","v3.13-rc7","v3.13-rc8","v3.14","v3.14-rc1","v3.14-rc2","v3.14-rc3","v3.14-rc4","v3.14-rc5","v3.14-rc6","v3.14-rc7","v3.14-rc8","v3.15","v3.15-rc1","v3.15-rc2","v3.15-rc3","v3.15-rc4","v3.15-rc5","v3.15-rc6","v3.15-rc7","v3.15-rc8","v3.16","v3.16-rc1","v3.16-rc2","v3.16-rc3","v3.16-rc4","v3.16-rc5","v3.16-rc6","v3.16-rc7","v3.17","v3.17-rc1","v3.17-rc2","v3.17-rc3","v3.17-rc4","v3.17-rc5","v3.17-rc6","v3.17-rc7","v3.18","v3.18-rc1","v3.18-rc2","v3.18-rc3","v3.18-rc4","v3.18-rc5","v3.18-rc6","v3.18-rc7","v3.19","v3.19-rc1","v3.19-rc2","v3.19-rc3","v3.19-rc4","v3.19-rc5","v3.19-rc6","v3.19-rc7","v3.2","v3.2-rc1","v3.2-rc2","v3.2-rc3","v3.2-rc4","v3.2-rc5","v3.2-rc6","v3.2-rc7","v3.3","v3.3-rc1","v3.3-rc2","v3.3-rc3","v3.3-rc4","v3.3-rc5","v3.3-rc6","v3.3-rc7","v3.4","v3.4-rc1","v3.4-rc2","v3.4-rc3","v3.4-rc4","v3.4-rc5","v3.4-rc6","v3.4-rc7","v3.5","v3.5-rc1","v3.5-rc2","v3.5-rc3","v3.5-rc4","v3.5-rc5","v3.5-rc6","v3.5-rc7","v3.6","v3.6-rc1","v3.6-rc2","v3.6-rc3","v3.6-rc4","v3.6-rc5","v3.6-rc6","v3.6-rc7","v3.7","v3.7-rc1","v3.7-rc2","v3.7-rc3","v3.7-rc4","v3.7-rc5","v3.7-rc6","v3.7-rc7","v3.7-rc8","v3.8","v3.8-rc1","v3.8-rc2","v3.8-rc3","v3.8-rc4","v3.8-rc5","v3.8-rc6","v3.8-rc7","v3.9","v3.9-rc1","v3.9-rc2","v3.9-rc3","v3.9-rc4","v3.9-rc5","v3.9-rc6","v3.9-rc7","v3.9-rc8","v4.0","v4.0-rc1","v4.0-rc2","v4.0-rc3","v4.0-rc4","v4.0-rc5","v4.0-rc6","v4.0-rc7","v4.1","v4.1-rc1","v4.1-rc2","v4.1-rc3","v4.1-rc4","v4.1-rc5","v4.1-rc6","v4.1-rc7","v4.1-rc8","v4.10","v4.10-rc1","v4.10-rc2","v4.10-rc3","v4.10-rc4","v4.10-rc5","v4.10-rc6","v4.10-rc7","v4.10-rc8","v4.11","v4.11-rc1","v4.11-rc2","v4.11-rc3","v4.11-rc4","v4.11-rc5","v4.11-rc6","v4.11-rc7","v4.11-rc8","v4.12","v4.12-rc1","v4.12-rc2","v4.12-rc3","v4.12-rc4","v4.12-rc5","v4.12-rc6","v4.12-rc7","v4.13","v4.13-rc1","v4.13-rc2","v4.13-rc3","v4.13-rc4","v4.13-rc5","v4.13-rc6","v4.13-rc7","v4.14","v4.14-rc1","v4.14-rc2","v4.14-rc3","v4.14-rc4","v4.14-rc5","v4.14-rc6","v4.14-rc7","v4.14-rc8","v4.15","v4.15-rc1","v4.15-rc2","v4.15-rc3","v4.15-rc4","v4.15-rc5","v4.15-rc6","v4.15-rc7","v4.15-rc8","v4.15-rc9","v4.16","v4.16-rc1","v4.16-rc2","v4.16-rc3","v4.16-rc4","v4.16-rc5","v4.16-rc6","v4.16-rc7","v4.17","v4.17-rc1","v4.17-rc2","v4.17-rc3","v4.17-rc4","v4.17-rc5","v4.17-rc6","v4.17-rc7","v4.18","v4.18-rc1","v4.18-rc2","v4.18-rc3","v4.18-rc4","v4.18-rc5","v4.18-rc6","v4.18-rc7","v4.18-rc8","v4.19","v4.19-rc1","v4.19-rc2","v4.19-rc3","v4.19-rc4","v4.19-rc5","v4.19-rc6","v4.19-rc7","v4.19-rc8","v4.2","v4.2-rc1","v4.2-rc2","v4.2-rc3","v4.2-rc4","v4.2-rc5","v4.2-rc6","v4.2-rc7","v4.2-rc8","v4.20","v4.20-rc1","v4.20-rc2","v4.20-rc3","v4.20-rc4","v4.20-rc5","v4.20-rc6","v4.20-rc7","v4.3","v4.3-rc1","v4.3-rc2","v4.3-rc3","v4.3-rc4","v4.3-rc5","v4.3-rc6","v4.3-rc7","v4.4","v4.4-rc1","v4.4-rc2","v4.4-rc3","v4.4-rc4","v4.4-rc5","v4.4-rc6","v4.4-rc7","v4.4-rc8","v4.5","v4.5-rc1","v4.5-rc2","v4.5-rc3","v4.5-rc4","v4.5-rc5","v4.5-rc6","v4.5-rc7","v4.6","v4.6-rc1","v4.6-rc2","v4.6-rc3","v4.6-rc4","v4.6-rc5","v4.6-rc6","v4.6-rc7","v4.7","v4.7-rc1","v4.7-rc2","v4.7-rc3","v4.7-rc4","v4.7-rc5","v4.7-rc6","v4.7-rc7","v4.8","v4.8-rc1","v4.8-rc2","v4.8-rc3","v4.8-rc4","v4.8-rc5","v4.8-rc6","v4.8-rc7","v4.8-rc8","v4.9","v4.9-rc1","v4.9-rc2","v4.9-rc3","v4.9-rc4","v4.9-rc5","v4.9-rc6","v4.9-rc7","v4.9-rc8","v5.0","v5.0-rc1","v5.0-rc2","v5.0-rc3","v5.0-rc4","v5.0-rc5","v5.0-rc6","v5.0-rc7","v5.0-rc8","v5.1","v5.1-rc1","v5.1-rc2","v5.1-rc3","v5.1-rc4","v5.1-rc5","v5.1-rc6","v5.1-rc7","v5.10","v5.10-rc1","v5.10-rc2","v5.10-rc3","v5.10-rc4","v5.10-rc5","v5.10-rc6","v5.10-rc7","v5.11","v5.11-rc1","v5.11-rc2","v5.11-rc3","v5.11-rc4","v5.11-rc5","v5.11-rc6","v5.11-rc7","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.4","v5.15.5","v5.15.6","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.16.1","v5.16.10","v5.16.11","v5.16.12","v5.16.13","v5.16.14","v5.16.15","v5.16.16","v5.16.17","v5.16.18","v5.16.19","v5.16.2","v5.16.3","v5.16.4","v5.16.5","v5.16.6","v5.16.7","v5.16.8","v5.16.9","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.17.1","v5.17.2","v5.2","v5.2-rc1","v5.2-rc2","v5.2-rc3","v5.2-rc4","v5.2-rc5","v5.2-rc6","v5.2-rc7","v5.3","v5.3-rc1","v5.3-rc2","v5.3-rc3","v5.3-rc4","v5.3-rc5","v5.3-rc6","v5.3-rc7","v5.3-rc8","v5.4","v5.4-rc1","v5.4-rc2","v5.4-rc3","v5.4-rc4","v5.4-rc5","v5.4-rc6","v5.4-rc7","v5.4-rc8","v5.5","v5.5-rc1","v5.5-rc2","v5.5-rc3","v5.5-rc4","v5.5-rc5","v5.5-rc6","v5.5-rc7","v5.6","v5.6-rc1","v5.6-rc2","v5.6-rc3","v5.6-rc4","v5.6-rc5","v5.6-rc6","v5.6-rc7","v5.7","v5.7-rc1","v5.7-rc2","v5.7-rc3","v5.7-rc4","v5.7-rc5","v5.7-rc6","v5.7-rc7","v5.8","v5.8-rc1","v5.8-rc2","v5.8-rc3","v5.8-rc4","v5.8-rc5","v5.8-rc6","v5.8-rc7","v5.9","v5.9-rc1","v5.9-rc2","v5.9-rc3","v5.9-rc4","v5.9-rc5","v5.9-rc6","v5.9-rc7","v5.9-rc8"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49109.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["178430424591595131208597849401663690223","153790245164847354731488668458641499486","316046587749750889714824760275840176907","60620017906473480069683328130861124251","258546188182844119893270450032839218525","276371295226653225579357261623248901849","109478855126725923653638827127565707219","242045128158939912028207798832851468038","300498771439064115331475271372815496932","313314076708261257333451405501698500193","318615214345002219485247528402468930889","122875869360822382833333971791369657276","84340912010081374774571095130931118454"],"threshold":0.9},"id":"CVE-2022-49109-1a935eb8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2d9bb3f06abddefdfa740b0a604575b6797e1bf","target":{"file":"fs/ceph/inode.c"}},{"deprecated":false,"digest":{"function_hash":"227967929393801788852282062776486251036","length":999},"id":"CVE-2022-49109-1bd3048a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3ae7163598c611a8892698e0c056fe794e52b44b","target":{"file":"fs/ceph/inode.c","function":"ceph_get_snapdir"}},{"deprecated":false,"digest":{"line_hashes":["178430424591595131208597849401663690223","153790245164847354731488668458641499486","316046587749750889714824760275840176907","60620017906473480069683328130861124251","258546188182844119893270450032839218525","276371295226653225579357261623248901849","109478855126725923653638827127565707219","242045128158939912028207798832851468038","300498771439064115331475271372815496932","313314076708261257333451405501698500193","318615214345002219485247528402468930889","122875869360822382833333971791369657276","84340912010081374774571095130931118454"],"threshold":0.9},"id":"CVE-2022-49109-283624ba","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9cd21981dedfb4fe9f344529e4be35727cb10940","target":{"file":"fs/ceph/inode.c"}},{"deprecated":false,"digest":{"function_hash":"227967929393801788852282062776486251036","length":999},"id":"CVE-2022-49109-503353cb","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@322794d3355c33adcc4feace0045d85a8e4ed813","target":{"file":"fs/ceph/inode.c","function":"ceph_get_snapdir"}},{"deprecated":false,"digest":{"function_hash":"227967929393801788852282062776486251036","length":999},"id":"CVE-2022-49109-67c28ac4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9cd21981dedfb4fe9f344529e4be35727cb10940","target":{"file":"fs/ceph/inode.c","function":"ceph_get_snapdir"}},{"deprecated":false,"digest":{"line_hashes":["178430424591595131208597849401663690223","153790245164847354731488668458641499486","316046587749750889714824760275840176907","60620017906473480069683328130861124251","258546188182844119893270450032839218525","276371295226653225579357261623248901849","109478855126725923653638827127565707219","242045128158939912028207798832851468038","300498771439064115331475271372815496932","313314076708261257333451405501698500193","318615214345002219485247528402468930889","122875869360822382833333971791369657276","84340912010081374774571095130931118454"],"threshold":0.9},"id":"CVE-2022-49109-6fab4f8a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@322794d3355c33adcc4feace0045d85a8e4ed813","target":{"file":"fs/ceph/inode.c"}},{"deprecated":false,"digest":{"function_hash":"227967929393801788852282062776486251036","length":999},"id":"CVE-2022-49109-75842290","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@b2d9bb3f06abddefdfa740b0a604575b6797e1bf","target":{"file":"fs/ceph/inode.c","function":"ceph_get_snapdir"}},{"deprecated":false,"digest":{"line_hashes":["178430424591595131208597849401663690223","153790245164847354731488668458641499486","316046587749750889714824760275840176907","60620017906473480069683328130861124251","258546188182844119893270450032839218525","276371295226653225579357261623248901849","109478855126725923653638827127565707219","242045128158939912028207798832851468038","300498771439064115331475271372815496932","313314076708261257333451405501698500193","318615214345002219485247528402468930889","122875869360822382833333971791369657276","84340912010081374774571095130931118454"],"threshold":0.9},"id":"CVE-2022-49109-d611f691","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@3ae7163598c611a8892698e0c056fe794e52b44b","target":{"file":"fs/ceph/inode.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"2.6.34"},{"fixed":"5.15.34"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.16.20"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.17.0"},{"fixed":"5.17.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49109.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/322794d3355c33adcc4feace0045d85a8e4ed813"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3ae7163598c611a8892698e0c056fe794e52b44b"},{"type":"WEB","url":"https://git.kernel.org/stable/c/9cd21981dedfb4fe9f344529e4be35727cb10940"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b2d9bb3f06abddefdfa740b0a604575b6797e1bf"}]}