{"schema_version":"1.7.3","id":"CVE-2025-22116","published":"2025-04-16T14:13:02.008Z","modified":"2025-11-20T08:29:03.212884Z","related":["SUSE-SU-2025:01707-1","SUSE-SU-2025:01919-1","SUSE-SU-2025:01951-1","SUSE-SU-2025:01964-1","SUSE-SU-2025:01967-1"],"summary":"idpf: check error for register_netdev() on init","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nidpf: check error for register_netdev() on init\n\nCurrent init logic ignores the error code from register_netdev(),\nwhich will cause WARN_ON() on attempt to unregister it, if there was one,\nand there is no info for the user that the creation of the netdev failed.\n\nWARNING: CPU: 89 PID: 6902 at net/core/dev.c:11512 unregister_netdevice_many_notify+0x211/0x1a10\n...\n[ 3707.563641]  unregister_netdev+0x1c/0x30\n[ 3707.563656]  idpf_vport_dealloc+0x5cf/0xce0 [idpf]\n[ 3707.563684]  idpf_deinit_task+0xef/0x160 [idpf]\n[ 3707.563712]  idpf_vc_core_deinit+0x84/0x320 [idpf]\n[ 3707.563739]  idpf_remove+0xbf/0x780 [idpf]\n[ 3707.563769]  pci_device_remove+0xab/0x1e0\n[ 3707.563786]  device_release_driver_internal+0x371/0x530\n[ 3707.563803]  driver_detach+0xbf/0x180\n[ 3707.563816]  bus_remove_driver+0x11b/0x2a0\n[ 3707.563829]  pci_unregister_driver+0x2a/0x250\n\nIntroduce an error check and log the vport number and error code.\nOn removal make sure to check VPORT_REG_NETDEV flag prior to calling\nunregister and free on the netdev.\n\nAdd local variables for idx, vport_config and netdev for readability.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0fe45467a1041ea3657a7fa3a791c84c104fbd34"},{"fixed":"89768e33752211b2240ec4c34138170c95f11f97"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"0fe45467a1041ea3657a7fa3a791c84c104fbd34"},{"fixed":"680811c67906191b237bbafe7dabbbad64649b39"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22116.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["309413888225122320489411100128694991540","73073908758121953356327062372197991590","203136063751891084680316690201306954563","329761361123868577464403189272994249592","284776239478777330711621852684648383671","96148162751296586604249041417970458274","115849374646836159931812070903650087174","24809834292149453106706068942776123334","339076070712242158473624862432444688533","92983815970689806185303058281741546249","42723964989419176247211271796251885853","101921149242837646267612149496109424255","137079451445548488885418726235335697660","18182013777994171232904150173291861316","289295379093561246362130829065396099815","148202429465308569623767128967952018916","269483211985653082200040902170371994538","314952836094423643965539942826710437","305707500638629808467409861550647492099","320522005510587938466783585704051310488"],"threshold":0.9},"id":"CVE-2025-22116-0bebf02f","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@680811c67906191b237bbafe7dabbbad64649b39","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_lib.c"}},{"deprecated":false,"digest":{"function_hash":"165734163191095256761946296776821608924","length":270},"id":"CVE-2025-22116-1a60f65c","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@680811c67906191b237bbafe7dabbbad64649b39","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_lib.c","function":"idpf_decfg_netdev"}},{"deprecated":false,"digest":{"line_hashes":["309413888225122320489411100128694991540","73073908758121953356327062372197991590","203136063751891084680316690201306954563","329761361123868577464403189272994249592","284776239478777330711621852684648383671","96148162751296586604249041417970458274","115849374646836159931812070903650087174","24809834292149453106706068942776123334","339076070712242158473624862432444688533","92983815970689806185303058281741546249","42723964989419176247211271796251885853","101921149242837646267612149496109424255","137079451445548488885418726235335697660","18182013777994171232904150173291861316","289295379093561246362130829065396099815","148202429465308569623767128967952018916","269483211985653082200040902170371994538","314952836094423643965539942826710437","305707500638629808467409861550647492099","320522005510587938466783585704051310488"],"threshold":0.9},"id":"CVE-2025-22116-2c233b1d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89768e33752211b2240ec4c34138170c95f11f97","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_lib.c"}},{"deprecated":false,"digest":{"function_hash":"176916229099829472209508332845480947783","length":2117},"id":"CVE-2025-22116-49f36005","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@680811c67906191b237bbafe7dabbbad64649b39","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_lib.c","function":"idpf_init_task"}},{"deprecated":false,"digest":{"function_hash":"165734163191095256761946296776821608924","length":270},"id":"CVE-2025-22116-76562f8d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89768e33752211b2240ec4c34138170c95f11f97","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_lib.c","function":"idpf_decfg_netdev"}},{"deprecated":false,"digest":{"function_hash":"176916229099829472209508332845480947783","length":2117},"id":"CVE-2025-22116-98c1e84e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89768e33752211b2240ec4c34138170c95f11f97","target":{"file":"drivers/net/ethernet/intel/idpf/idpf_lib.c","function":"idpf_init_task"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.14.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22116.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/680811c67906191b237bbafe7dabbbad64649b39"},{"type":"WEB","url":"https://git.kernel.org/stable/c/89768e33752211b2240ec4c34138170c95f11f97"}]}