{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49228.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "282245618439142570150482338490851855704",
              "length": 836.0
            },
            "id": "CVE-2022-49228-158adcb9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d7e7b42f4f956f2c68ad8cda87d750093dbba737",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_resolve_valid"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "42429056196222038552852630409356545218",
                "16595680612624130933872660299106376467",
                "30520815949157312519596597491672467111",
                "151257162851826652225896689344085208065",
                "211448485814763461284495817262528017739",
                "259793880049926723702656371718539915856",
                "199169775940266729830202447437882205116",
                "9232661567255614512891359871305175757",
                "46030796238560719013477312150105289874",
                "163599358968626333887492013175075008087",
                "42645477801938339956456817610321702445",
                "232910667214368970327359441979016176784",
                "274723970004803015367989485914662596919",
                "99610829553585845873168031111637587001",
                "41729311059895807023193128623593902967",
                "318124289595981885880775098546193809466",
                "39107519167525213467000280845006588338",
                "285327332314433206232007724152749551398",
                "195839842271466117806800077138837333762",
                "109565082945577552818846661384946139333",
                "34266241565009435615189447381375881964",
                "172937833590211761818670882034995908140",
                "78828392896317485488953111243907561258",
                "22442300463467650316698611349993398415",
                "267868390585593816517915983992887850017"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49228-1d52f34a",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3bcd2110c087bc62e90fddd4a93237b049d6e68",
            "target": {
              "file": "kernel/bpf/btf.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "41702494909957422039670722089885933506",
              "length": 660.0
            },
            "id": "CVE-2022-49228-39199a9e",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@796d5666f6422ddadc938fb888044fcc16f2dbe3",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_check_all_types"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "4483805485853739636700364236323056496",
              "length": 209.0
            },
            "id": "CVE-2022-49228-67fa6079",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d7e7b42f4f956f2c68ad8cda87d750093dbba737",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_type_needs_resolve"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "41702494909957422039670722089885933506",
              "length": 660.0
            },
            "id": "CVE-2022-49228-6a399174",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d7e7b42f4f956f2c68ad8cda87d750093dbba737",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_check_all_types"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "282245618439142570150482338490851855704",
              "length": 836.0
            },
            "id": "CVE-2022-49228-833f8233",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3bcd2110c087bc62e90fddd4a93237b049d6e68",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_resolve_valid"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "4483805485853739636700364236323056496",
              "length": 209.0
            },
            "id": "CVE-2022-49228-a5bade41",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@796d5666f6422ddadc938fb888044fcc16f2dbe3",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_type_needs_resolve"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "41702494909957422039670722089885933506",
              "length": 660.0
            },
            "id": "CVE-2022-49228-a7ef4242",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3bcd2110c087bc62e90fddd4a93237b049d6e68",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_check_all_types"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "42429056196222038552852630409356545218",
                "16595680612624130933872660299106376467",
                "30520815949157312519596597491672467111",
                "151257162851826652225896689344085208065",
                "211448485814763461284495817262528017739",
                "259793880049926723702656371718539915856",
                "199169775940266729830202447437882205116",
                "9232661567255614512891359871305175757",
                "46030796238560719013477312150105289874",
                "163599358968626333887492013175075008087",
                "42645477801938339956456817610321702445",
                "232910667214368970327359441979016176784",
                "274723970004803015367989485914662596919",
                "99610829553585845873168031111637587001",
                "41729311059895807023193128623593902967",
                "318124289595981885880775098546193809466",
                "39107519167525213467000280845006588338",
                "285327332314433206232007724152749551398",
                "195839842271466117806800077138837333762",
                "109565082945577552818846661384946139333",
                "34266241565009435615189447381375881964",
                "172937833590211761818670882034995908140",
                "78828392896317485488953111243907561258",
                "22442300463467650316698611349993398415",
                "267868390585593816517915983992887850017"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49228-ae28f11b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d7e7b42f4f956f2c68ad8cda87d750093dbba737",
            "target": {
              "file": "kernel/bpf/btf.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "42429056196222038552852630409356545218",
                "16595680612624130933872660299106376467",
                "30520815949157312519596597491672467111",
                "151257162851826652225896689344085208065",
                "211448485814763461284495817262528017739",
                "259793880049926723702656371718539915856",
                "199169775940266729830202447437882205116",
                "9232661567255614512891359871305175757",
                "46030796238560719013477312150105289874",
                "163599358968626333887492013175075008087",
                "42645477801938339956456817610321702445",
                "232910667214368970327359441979016176784",
                "274723970004803015367989485914662596919",
                "99610829553585845873168031111637587001",
                "41729311059895807023193128623593902967",
                "318124289595981885880775098546193809466",
                "39107519167525213467000280845006588338",
                "285327332314433206232007724152749551398",
                "195839842271466117806800077138837333762",
                "109565082945577552818846661384946139333",
                "34266241565009435615189447381375881964",
                "172937833590211761818670882034995908140",
                "78828392896317485488953111243907561258",
                "22442300463467650316698611349993398415",
                "267868390585593816517915983992887850017"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-49228-cd075549",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@796d5666f6422ddadc938fb888044fcc16f2dbe3",
            "target": {
              "file": "kernel/bpf/btf.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "4483805485853739636700364236323056496",
              "length": 209.0
            },
            "id": "CVE-2022-49228-dbc9b7ab",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a3bcd2110c087bc62e90fddd4a93237b049d6e68",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_type_needs_resolve"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "282245618439142570150482338490851855704",
              "length": 836.0
            },
            "id": "CVE-2022-49228-e6f0a65b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@796d5666f6422ddadc938fb888044fcc16f2dbe3",
            "target": {
              "file": "kernel/bpf/btf.c",
              "function": "btf_resolve_valid"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "b5ea834dde6b6e7f75e51d5f66dac8cd7c97b5ef"
            },
            {
              "fixed": "a3bcd2110c087bc62e90fddd4a93237b049d6e68"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "b5ea834dde6b6e7f75e51d5f66dac8cd7c97b5ef"
            },
            {
              "fixed": "796d5666f6422ddadc938fb888044fcc16f2dbe3"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "b5ea834dde6b6e7f75e51d5f66dac8cd7c97b5ef"
            },
            {
              "fixed": "d7e7b42f4f956f2c68ad8cda87d750093dbba737"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.16.1",
        "v5.16.10",
        "v5.16.11",
        "v5.16.12",
        "v5.16.13",
        "v5.16.14",
        "v5.16.15",
        "v5.16.16",
        "v5.16.17",
        "v5.16.18",
        "v5.16.2",
        "v5.16.3",
        "v5.16.4",
        "v5.16.5",
        "v5.16.6",
        "v5.16.7",
        "v5.16.8",
        "v5.16.9",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.17.1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49228.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.16.19"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.17.0"
            },
            {
              "fixed": "5.17.2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix a btf decl_tag bug when tagging a function\n\nsyzbot reported a btf decl_tag bug with stack trace below:\n\n  general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN\n  KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]\n  CPU: 0 PID: 3592 Comm: syz-executor914 Not tainted 5.16.0-syzkaller-11424-gb7892f7d5cb2 #0\n  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011\n  RIP: 0010:btf_type_vlen include/linux/btf.h:231 [inline]\n  RIP: 0010:btf_decl_tag_resolve+0x83e/0xaa0 kernel/bpf/btf.c:3910\n  ...\n  Call Trace:\n   <TASK>\n   btf_resolve+0x251/0x1020 kernel/bpf/btf.c:4198\n   btf_check_all_types kernel/bpf/btf.c:4239 [inline]\n   btf_parse_type_sec kernel/bpf/btf.c:4280 [inline]\n   btf_parse kernel/bpf/btf.c:4513 [inline]\n   btf_new_fd+0x19fe/0x2370 kernel/bpf/btf.c:6047\n   bpf_btf_load kernel/bpf/syscall.c:4039 [inline]\n   __sys_bpf+0x1cbb/0x5970 kernel/bpf/syscall.c:4679\n   __do_sys_bpf kernel/bpf/syscall.c:4738 [inline]\n   __se_sys_bpf kernel/bpf/syscall.c:4736 [inline]\n   __x64_sys_bpf+0x75/0xb0 kernel/bpf/syscall.c:4736\n   do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n   do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80\n   entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nThe kasan error is triggered with an illegal BTF like below:\n   type 0: void\n   type 1: int\n   type 2: decl_tag to func type 3\n   type 3: func to func_proto type 8\nThe total number of types is 4 and the type 3 is illegal\nsince its func_proto type is out of range.\n\nCurrently, the target type of decl_tag can be struct/union, var or func.\nBoth struct/union and var implemented their own 'resolve' callback functions\nand hence handled properly in kernel.\nBut func type doesn't have 'resolve' callback function. When\nbtf_decl_tag_resolve() tries to check func type, it tries to get\nvlen of its func_proto type, which triggered the above kasan error.\n\nTo fix the issue, btf_decl_tag_resolve() needs to do btf_func_check()\nbefore trying to accessing func_proto type.\nIn the current implementation, func type is checked with\nbtf_func_check() in the main checking function btf_check_all_types().\nTo fix the above kasan issue, let us implement 'resolve' callback\nfunc type properly. The 'resolve' callback will be also called\nin btf_check_all_types() for func types.",
  "id": "CVE-2022-49228",
  "modified": "2025-10-21T09:27:43.747104Z",
  "published": "2025-02-26T01:55:56Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/796d5666f6422ddadc938fb888044fcc16f2dbe3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/a3bcd2110c087bc62e90fddd4a93237b049d6e68"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/d7e7b42f4f956f2c68ad8cda87d750093dbba737"
    }
  ],
  "related": [
    "SUSE-SU-2025:1176-1",
    "SUSE-SU-2025:1241-1"
  ],
  "schema_version": "1.7.3",
  "summary": "bpf: Fix a btf decl_tag bug when tagging a function"
}