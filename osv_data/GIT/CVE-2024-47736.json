{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-47736.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "148699806677410103451741670929616376039",
              "length": 1583.0
            },
            "id": "CVE-2024-47736-49735641",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1bf7e414cac303c9aec1be67872e19be8b64980c",
            "target": {
              "file": "fs/erofs/zdata.c",
              "function": "pickup_page_for_submission"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "206909247131029278104366617424991192827",
                "226635816002565545747016174878402405491",
                "96722092138586739726735699490089806863",
                "146387176581071460524447371111795227121",
                "162850167513741184388908650590556258772",
                "181756089577256917396363020502831616120",
                "124548527223501106887112831810203979500",
                "208478664587068996586002980814323589114",
                "83018978049742920578628568085191878205",
                "70434222523192614210723641751428864725",
                "208749194806004208740045048834451769808",
                "89339728146368966417938151543824853832",
                "122637253683348411204585586889146905665",
                "46936465492969817031679437121921876488",
                "158062292939347180726973239762115570412",
                "116881499821789683196869049241010271518",
                "88767533299452639157994938637924362407",
                "300066745529070077280362505168954460391",
                "220740064279868224118709711480155397080",
                "254327074028402992541828861207847566253",
                "180170212313615012297958817660153819673",
                "114131802571006606065011832359028346050",
                "192598438858333522035388091783933562686",
                "316236151262645109597012494799278899109",
                "215914157997172992402297950140889638456",
                "189076203498129378777551613537669659346",
                "48558617194864598643822863361575960312",
                "235879421360553692798228701017387741337",
                "272074231445428356681780693978813899130",
                "78778398263498638506792685033051167538",
                "250170883483316620816696261981503491901",
                "192644180686061312161617965589203834886",
                "91231086599816843297547418272393544323",
                "66936400451482815454858293414774306362",
                "277763731943280370956112477572355147087",
                "308015975487088901528219083923561500811"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-47736-6e1e6b54",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1bf7e414cac303c9aec1be67872e19be8b64980c",
            "target": {
              "file": "fs/erofs/zdata.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "44809453839963341055699748427151620057",
              "length": 2220.0
            },
            "id": "CVE-2024-47736-cb1b34e9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1bf7e414cac303c9aec1be67872e19be8b64980c",
            "target": {
              "file": "fs/erofs/zdata.c",
              "function": "z_erofs_submit_queue"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "8e6c8fa9f2e95c88a642521a5da19a8e31748846"
            },
            {
              "fixed": "1bf7e414cac303c9aec1be67872e19be8b64980c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "8e6c8fa9f2e95c88a642521a5da19a8e31748846"
            },
            {
              "fixed": "b9b30af0e86ffb485301ecd83b9129c9dfb7ebf8"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "8e6c8fa9f2e95c88a642521a5da19a8e31748846"
            },
            {
              "fixed": "9cfa199bcbbbba31cbf97b2786f44f4464f3f29a"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "8e6c8fa9f2e95c88a642521a5da19a8e31748846"
            },
            {
              "fixed": "9e2f9d34dd12e6e5b244ec488bcebd0c2d566c50"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.12",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.10",
        "v6.10-rc1",
        "v6.10-rc2",
        "v6.10-rc3",
        "v6.10-rc4",
        "v6.10-rc5",
        "v6.10-rc6",
        "v6.10-rc7",
        "v6.10.1",
        "v6.10.10",
        "v6.10.11",
        "v6.10.12",
        "v6.10.2",
        "v6.10.3",
        "v6.10.4",
        "v6.10.5",
        "v6.10.6",
        "v6.10.7",
        "v6.10.8",
        "v6.10.9",
        "v6.11",
        "v6.11-rc1",
        "v6.11-rc2",
        "v6.11-rc3",
        "v6.11-rc4",
        "v6.11-rc5",
        "v6.11-rc6",
        "v6.11-rc7",
        "v6.11.1",
        "v6.2",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6",
        "v6.2-rc7",
        "v6.2-rc8",
        "v6.3",
        "v6.3-rc1",
        "v6.3-rc2",
        "v6.3-rc3",
        "v6.3-rc4",
        "v6.3-rc5",
        "v6.3-rc6",
        "v6.3-rc7",
        "v6.4",
        "v6.4-rc1",
        "v6.4-rc2",
        "v6.4-rc3",
        "v6.4-rc4",
        "v6.4-rc5",
        "v6.4-rc6",
        "v6.4-rc7",
        "v6.5",
        "v6.5-rc1",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.3",
        "v6.6.30",
        "v6.6.31",
        "v6.6.32",
        "v6.6.33",
        "v6.6.34",
        "v6.6.35",
        "v6.6.36",
        "v6.6.37",
        "v6.6.38",
        "v6.6.39",
        "v6.6.4",
        "v6.6.40",
        "v6.6.41",
        "v6.6.42",
        "v6.6.43",
        "v6.6.44",
        "v6.6.45",
        "v6.6.46",
        "v6.6.47",
        "v6.6.48",
        "v6.6.49",
        "v6.6.5",
        "v6.6.50",
        "v6.6.51",
        "v6.6.52",
        "v6.6.53",
        "v6.6.54",
        "v6.6.55",
        "v6.6.56",
        "v6.6.57",
        "v6.6.58",
        "v6.6.59",
        "v6.6.6",
        "v6.6.60",
        "v6.6.61",
        "v6.6.62",
        "v6.6.63",
        "v6.6.64",
        "v6.6.65",
        "v6.6.66",
        "v6.6.67",
        "v6.6.68",
        "v6.6.69",
        "v6.6.7",
        "v6.6.70",
        "v6.6.71",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5",
        "v6.9-rc6",
        "v6.9-rc7"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-47736.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.13.0"
            },
            {
              "fixed": "6.6.72"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.10.13"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.11.0"
            },
            {
              "fixed": "6.11.2"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: handle overlapped pclusters out of crafted images properly\n\nsyzbot reported a task hang issue due to a deadlock case where it is\nwaiting for the folio lock of a cached folio that will be used for\ncache I/Os.\n\nAfter looking into the crafted fuzzed image, I found it's formed with\nseveral overlapped big pclusters as below:\n\n Ext:   logical offset   |  length :     physical offset    |  length\n   0:        0..   16384 |   16384 :     151552..    167936 |   16384\n   1:    16384..   32768 |   16384 :     155648..    172032 |   16384\n   2:    32768..   49152 |   16384 :  537223168.. 537239552 |   16384\n...\n\nHere, extent 0/1 are physically overlapped although it's entirely\n_impossible_ for normal filesystem images generated by mkfs.\n\nFirst, managed folios containing compressed data will be marked as\nup-to-date and then unlocked immediately (unlike in-place folios) when\ncompressed I/Os are complete.  If physical blocks are not submitted in\nthe incremental order, there should be separate BIOs to avoid dependency\nissues.  However, the current code mis-arranges z_erofs_fill_bio_vec()\nand BIO submission which causes unexpected BIO waits.\n\nSecond, managed folios will be connected to their own pclusters for\nefficient inter-queries.  However, this is somewhat hard to implement\neasily if overlapped big pclusters exist.  Again, these only appear in\nfuzzed images so let's simply fall back to temporary short-lived pages\nfor correctness.\n\nAdditionally, it justifies that referenced managed folios cannot be\ntruncated for now and reverts part of commit 2080ca1ed3e4 (\"erofs: tidy\nup `struct z_erofs_bvec`\") for simplicity although it shouldn't be any\ndifference.",
  "id": "CVE-2024-47736",
  "modified": "2025-10-15T16:02:46.390282Z",
  "published": "2024-10-21T12:14:06Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1bf7e414cac303c9aec1be67872e19be8b64980c"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9cfa199bcbbbba31cbf97b2786f44f4464f3f29a"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9e2f9d34dd12e6e5b244ec488bcebd0c2d566c50"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/b9b30af0e86ffb485301ecd83b9129c9dfb7ebf8"
    }
  ],
  "related": [
    "USN-7276-1",
    "USN-7277-1",
    "openSUSE-SU-2024:14500-1",
    "openSUSE-SU-2025:14705-1"
  ],
  "schema_version": "1.7.3",
  "summary": "erofs: handle overlapped pclusters out of crafted images properly"
}