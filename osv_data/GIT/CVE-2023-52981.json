{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52981.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "213877585799649718431122023333478217449",
                "283667191032190850140673263449026649329",
                "45095856839133773205432673905795280724",
                "135255465944307931840922703200526435261",
                "177005634418111526204619522903139347067"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-083de123",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_context.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "313820073841962819717315547036755589142",
              "length": 449.0
            },
            "id": "CVE-2023-52981-23e42ebf",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_context.c",
              "function": "intel_context_find_active_request"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "229238008962813934752135368219621778165",
                "159908720060175112084126871463645121815",
                "16927957210438164909327994183941230672",
                "202911478758953578661235418421837456097",
                "168463484821009080718422911015334053573",
                "310066860619931420533714633945826273893",
                "211586764276594697641038885168304166680",
                "142595800185809359155579150024473446124"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-2921d47b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_context.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "259138149131288514580063463995493636002",
                "169853647339392869614489528304865488638",
                "4390143549137228886397042656766800062",
                "137603646917182942303328238260443947473",
                "55103454167670462029937728242171913081",
                "13722784504735307798946318700023614325",
                "284326255895414424353024806926554067579",
                "336035178351276090972290191533620935169"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-4102eb1b",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "57630661792073866962520274669685383696",
              "length": 514.0
            },
            "id": "CVE-2023-52981-4c2770e2",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_engine_cs.c",
              "function": "engine_dump_active_requests"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "229238008962813934752135368219621778165",
                "159908720060175112084126871463645121815",
                "16927957210438164909327994183941230672",
                "202911478758953578661235418421837456097",
                "168463484821009080718422911015334053573",
                "310066860619931420533714633945826273893",
                "211586764276594697641038885168304166680",
                "142595800185809359155579150024473446124"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-5a714ba1",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_context.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "213877585799649718431122023333478217449",
                "283667191032190850140673263449026649329",
                "45095856839133773205432673905795280724",
                "135255465944307931840922703200526435261",
                "177005634418111526204619522903139347067"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-631c3894",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_context.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "314791657516501993344285999549360964746",
                "160284804905236809375545270801354987435",
                "145326802355629552914481593243918286397",
                "145982776544246463464996538106762410865",
                "1041727489894655527527788498729213914",
                "56612156366510119383683906893509295243",
                "315211082543938008528240859821749009177",
                "79932962465371556591527197290137862618",
                "31634623377942072840022834257864286671",
                "195055003465128126792102693566230208025"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-6af81297",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_engine_cs.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "102026266945460930335825600573808152598",
              "length": 966.0
            },
            "id": "CVE-2023-52981-88d764af",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/i915_gpu_error.c",
              "function": "capture_engine"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "257541754205403229983906798123890093690",
                "174716026869473410872636665908171934342",
                "214951682477086499663775066079110817582",
                "299434782294920514360426924944596664401",
                "57444990608352075293505974547314918957",
                "224459227174770815105486122832030411408",
                "78340458342334081595427752946116712926",
                "141758101602362504713671558595842404823",
                "258521642748842903646679892461617546890",
                "323764014261035292547991627166426916436",
                "300897689322227730295304797824320295208",
                "338599809245537180827892815956215975886",
                "55440586338964282862041361962738642912",
                "99938291990802934165386516235085405212",
                "280079259585634990871122039255430816099",
                "87095383703986513537575545734410887358",
                "273155277291716409631667767049039455011",
                "162077543405459555025573309187011711063",
                "280268636404354947925464199582812759986",
                "20402406213976405606807175398176449495",
                "320558277580674688609526917835151744105",
                "2909099302907494711923030817744858732",
                "8244017365356167894133154522575978665",
                "119599562987182006551041085856991858443",
                "231070961669883590806809965992258528757"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-8f5c5102",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/i915_gpu_error.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "314791657516501993344285999549360964746",
                "160284804905236809375545270801354987435",
                "145326802355629552914481593243918286397",
                "145982776544246463464996538106762410865",
                "1041727489894655527527788498729213914",
                "56612156366510119383683906893509295243",
                "315211082543938008528240859821749009177",
                "79932962465371556591527197290137862618",
                "31634623377942072840022834257864286671",
                "195055003465128126792102693566230208025"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-9fe1fc8c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_engine_cs.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "259138149131288514580063463995493636002",
                "169853647339392869614489528304865488638",
                "4390143549137228886397042656766800062",
                "137603646917182942303328238260443947473",
                "55103454167670462029937728242171913081",
                "13722784504735307798946318700023614325",
                "284326255895414424353024806926554067579",
                "336035178351276090972290191533620935169"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-a067bcfc",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "102026266945460930335825600573808152598",
              "length": 966.0
            },
            "id": "CVE-2023-52981-a49844d0",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/i915_gpu_error.c",
              "function": "capture_engine"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45290425475588233096808553340907366278",
              "length": 908.0
            },
            "id": "CVE-2023-52981-b67186e3",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c",
              "function": "__guc_reset_context"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "257541754205403229983906798123890093690",
                "174716026869473410872636665908171934342",
                "214951682477086499663775066079110817582",
                "299434782294920514360426924944596664401",
                "57444990608352075293505974547314918957",
                "224459227174770815105486122832030411408",
                "78340458342334081595427752946116712926",
                "141758101602362504713671558595842404823",
                "258521642748842903646679892461617546890",
                "323764014261035292547991627166426916436",
                "300897689322227730295304797824320295208",
                "338599809245537180827892815956215975886",
                "55440586338964282862041361962738642912",
                "99938291990802934165386516235085405212",
                "280079259585634990871122039255430816099",
                "87095383703986513537575545734410887358",
                "273155277291716409631667767049039455011",
                "162077543405459555025573309187011711063",
                "280268636404354947925464199582812759986",
                "20402406213976405606807175398176449495",
                "320558277580674688609526917835151744105",
                "2909099302907494711923030817744858732",
                "8244017365356167894133154522575978665",
                "119599562987182006551041085856991858443",
                "231070961669883590806809965992258528757"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-52981-bac169e2",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@86d8ddc74124c3fdfc139f246ba6da15e45e86e3",
            "target": {
              "file": "drivers/gpu/drm/i915/i915_gpu_error.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "45290425475588233096808553340907366278",
              "length": 908.0
            },
            "id": "CVE-2023-52981-bea9fda1",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c",
              "function": "__guc_reset_context"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "313820073841962819717315547036755589142",
              "length": 449.0
            },
            "id": "CVE-2023-52981-e683dcd9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_context.c",
              "function": "intel_context_find_active_request"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "57630661792073866962520274669685383696",
              "length": 514.0
            },
            "id": "CVE-2023-52981-efcd2d49",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9467397f417dd7b5d0db91452f0474e79716a527",
            "target": {
              "file": "drivers/gpu/drm/i915/gt/intel_engine_cs.c",
              "function": "engine_dump_active_requests"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "573ba126aef37c8315e5bb68d2dad515efa96994"
            },
            {
              "fixed": "9467397f417dd7b5d0db91452f0474e79716a527"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "573ba126aef37c8315e5bb68d2dad515efa96994"
            },
            {
              "fixed": "86d8ddc74124c3fdfc139f246ba6da15e45e86e3"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.14",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v6.0",
        "v6.0-rc1",
        "v6.0-rc2",
        "v6.0-rc3",
        "v6.0-rc4",
        "v6.0-rc5",
        "v6.0-rc6",
        "v6.0-rc7",
        "v6.1",
        "v6.1-rc1",
        "v6.1-rc2",
        "v6.1-rc3",
        "v6.1-rc4",
        "v6.1-rc5",
        "v6.1-rc6",
        "v6.1-rc7",
        "v6.1-rc8",
        "v6.1.1",
        "v6.1.10",
        "v6.1.2",
        "v6.1.3",
        "v6.1.4",
        "v6.1.5",
        "v6.1.6",
        "v6.1.7",
        "v6.1.8",
        "v6.1.9",
        "v6.2-rc1",
        "v6.2-rc2",
        "v6.2-rc3",
        "v6.2-rc4",
        "v6.2-rc5",
        "v6.2-rc6"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-52981.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.15.0"
            },
            {
              "fixed": "6.1.11"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/i915: Fix request ref counting during error capture & debugfs dump\n\nWhen GuC support was added to error capture, the reference counting\naround the request object was broken. Fix it up.\n\nThe context based search manages the spinlocking around the search\ninternally. So it needs to grab the reference count internally as\nwell. The execlist only request based search relies on external\nlocking, so it needs an external reference count but within the\nspinlock not outside it.\n\nThe only other caller of the context based search is the code for\ndumping engine state to debugfs. That code wasn't previously getting\nan explicit reference at all as it does everything while holding the\nexeclist specific spinlock. So, that needs updaing as well as that\nspinlock doesn't help when using GuC submission. Rather than trying to\nconditionally get/put depending on submission model, just change it to\nalways do the get/put.\n\nv2: Explicitly document adding an extra blank line in some dense code\n(Andy Shevchenko). Fix multiple potential null pointer derefs in case\nof no request found (some spotted by Tvrtko, but there was more!).\nAlso fix a leaked request in case of !started and another in\n__guc_reset_context now that intel_context_find_active_request is\nactually reference counting the returned request.\nv3: Add a _get suffix to intel_context_find_active_request now that it\ngrabs a reference (Daniele).\nv4: Split the intel_guc_find_hung_context change to a separate patch\nand rename intel_context_find_active_request_get to\nintel_context_get_active_request (Tvrtko).\nv5: s/locking/reference counting/ in commit message (Tvrtko)\n\n(cherry picked from commit 3700e353781e27f1bc7222f51f2cc36cbeb9b4ec)",
  "id": "CVE-2023-52981",
  "modified": "2025-10-15T05:00:56.012824Z",
  "published": "2025-03-27T16:43:20Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/86d8ddc74124c3fdfc139f246ba6da15e45e86e3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9467397f417dd7b5d0db91452f0474e79716a527"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "drm/i915: Fix request ref counting during error capture & debugfs dump"
}