{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50000.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "85366624623935242999205263762005783532",
                "318004872406028171222300736446657206554",
                "82186474439784697500198397987098636539",
                "274320860309312681616328964581576707467"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-0b3fbbb9",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89e135a36a9eb81412b5459df94a80995ce62eef",
            "target": {
              "file": "include/net/netfilter/nf_flow_table.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "281373254034432900350595223253852366661",
              "length": 346.0
            },
            "id": "CVE-2022-50000-2e4e5c18",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8fbdec08dbf7d7ab8e35bdc65eb4394bc82d1e26",
            "target": {
              "file": "net/netfilter/nf_flow_table_core.c",
              "function": "nf_flow_table_free"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "85366624623935242999205263762005783532",
                "318004872406028171222300736446657206554",
                "82186474439784697500198397987098636539",
                "274320860309312681616328964581576707467"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-4055cbf5",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8fbdec08dbf7d7ab8e35bdc65eb4394bc82d1e26",
            "target": {
              "file": "include/net/netfilter/nf_flow_table.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "114751246830435082708110488123622877414",
                "95834422570841452535572842513596711736",
                "120443758790231434291273836977181794879",
                "53799696330955737385516270641755735067",
                "189978142510366619273815873562551497050",
                "273780067294213805647459748505439130615",
                "96801969381951491273380751330647915268",
                "291731587088027163759056791141653445405",
                "121841679109623143566969996365634274527"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-4d697aba",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89e135a36a9eb81412b5459df94a80995ce62eef",
            "target": {
              "file": "net/netfilter/nf_flow_table_core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "108864716891692588999073565978623843247",
                "299523844711810150368211271439907511182",
                "306703195081225718760004151205177565832"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-65c335af",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9afb4b27349a499483ae0134282cefd0c90f480f",
            "target": {
              "file": "net/netfilter/nf_flow_table_offload.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "108864716891692588999073565978623843247",
                "299523844711810150368211271439907511182",
                "306703195081225718760004151205177565832"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-785dc10f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8fbdec08dbf7d7ab8e35bdc65eb4394bc82d1e26",
            "target": {
              "file": "net/netfilter/nf_flow_table_offload.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "85366624623935242999205263762005783532",
                "318004872406028171222300736446657206554",
                "82186474439784697500198397987098636539",
                "274320860309312681616328964581576707467"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-78680622",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9afb4b27349a499483ae0134282cefd0c90f480f",
            "target": {
              "file": "include/net/netfilter/nf_flow_table.h"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "114751246830435082708110488123622877414",
                "95834422570841452535572842513596711736",
                "120443758790231434291273836977181794879",
                "53799696330955737385516270641755735067",
                "189978142510366619273815873562551497050",
                "273780067294213805647459748505439130615",
                "96801969381951491273380751330647915268",
                "291731587088027163759056791141653445405",
                "121841679109623143566969996365634274527"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-8f034fdc",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8fbdec08dbf7d7ab8e35bdc65eb4394bc82d1e26",
            "target": {
              "file": "net/netfilter/nf_flow_table_core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "114751246830435082708110488123622877414",
                "95834422570841452535572842513596711736",
                "120443758790231434291273836977181794879",
                "53799696330955737385516270641755735067",
                "189978142510366619273815873562551497050",
                "273780067294213805647459748505439130615",
                "96801969381951491273380751330647915268",
                "291731587088027163759056791141653445405",
                "121841679109623143566969996365634274527"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-99c5a4d7",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9afb4b27349a499483ae0134282cefd0c90f480f",
            "target": {
              "file": "net/netfilter/nf_flow_table_core.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "281373254034432900350595223253852366661",
              "length": 346.0
            },
            "id": "CVE-2022-50000-b4f81aa9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89e135a36a9eb81412b5459df94a80995ce62eef",
            "target": {
              "file": "net/netfilter/nf_flow_table_core.c",
              "function": "nf_flow_table_free"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "108864716891692588999073565978623843247",
                "299523844711810150368211271439907511182",
                "306703195081225718760004151205177565832"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2022-50000-c7b88581",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@89e135a36a9eb81412b5459df94a80995ce62eef",
            "target": {
              "file": "net/netfilter/nf_flow_table_offload.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "281373254034432900350595223253852366661",
              "length": 346.0
            },
            "id": "CVE-2022-50000-f138fec9",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@9afb4b27349a499483ae0134282cefd0c90f480f",
            "target": {
              "file": "net/netfilter/nf_flow_table_core.c",
              "function": "nf_flow_table_free"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "c29f74e0df7a02b8303bcdce93a7c0132d62577a"
            },
            {
              "fixed": "8fbdec08dbf7d7ab8e35bdc65eb4394bc82d1e26"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "c29f74e0df7a02b8303bcdce93a7c0132d62577a"
            },
            {
              "fixed": "89e135a36a9eb81412b5459df94a80995ce62eef"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "c29f74e0df7a02b8303bcdce93a7c0132d62577a"
            },
            {
              "fixed": "9afb4b27349a499483ae0134282cefd0c90f480f"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v5.10",
        "v5.10-rc1",
        "v5.10-rc2",
        "v5.10-rc3",
        "v5.10-rc4",
        "v5.10-rc5",
        "v5.10-rc6",
        "v5.10-rc7",
        "v5.11",
        "v5.11-rc1",
        "v5.11-rc2",
        "v5.11-rc3",
        "v5.11-rc4",
        "v5.11-rc5",
        "v5.11-rc6",
        "v5.11-rc7",
        "v5.12",
        "v5.12-rc1",
        "v5.12-rc1-dontuse",
        "v5.12-rc2",
        "v5.12-rc3",
        "v5.12-rc4",
        "v5.12-rc5",
        "v5.12-rc6",
        "v5.12-rc7",
        "v5.12-rc8",
        "v5.13",
        "v5.13-rc1",
        "v5.13-rc2",
        "v5.13-rc3",
        "v5.13-rc4",
        "v5.13-rc5",
        "v5.13-rc6",
        "v5.13-rc7",
        "v5.14",
        "v5.14-rc1",
        "v5.14-rc2",
        "v5.14-rc3",
        "v5.14-rc4",
        "v5.14-rc5",
        "v5.14-rc6",
        "v5.14-rc7",
        "v5.15",
        "v5.15-rc1",
        "v5.15-rc2",
        "v5.15-rc3",
        "v5.15-rc4",
        "v5.15-rc5",
        "v5.15-rc6",
        "v5.15-rc7",
        "v5.15.1",
        "v5.15.10",
        "v5.15.11",
        "v5.15.12",
        "v5.15.13",
        "v5.15.14",
        "v5.15.15",
        "v5.15.16",
        "v5.15.17",
        "v5.15.18",
        "v5.15.19",
        "v5.15.2",
        "v5.15.20",
        "v5.15.21",
        "v5.15.22",
        "v5.15.23",
        "v5.15.24",
        "v5.15.25",
        "v5.15.26",
        "v5.15.27",
        "v5.15.28",
        "v5.15.29",
        "v5.15.3",
        "v5.15.30",
        "v5.15.31",
        "v5.15.32",
        "v5.15.33",
        "v5.15.34",
        "v5.15.35",
        "v5.15.36",
        "v5.15.37",
        "v5.15.38",
        "v5.15.39",
        "v5.15.4",
        "v5.15.40",
        "v5.15.41",
        "v5.15.42",
        "v5.15.43",
        "v5.15.44",
        "v5.15.45",
        "v5.15.46",
        "v5.15.47",
        "v5.15.48",
        "v5.15.49",
        "v5.15.5",
        "v5.15.50",
        "v5.15.51",
        "v5.15.52",
        "v5.15.53",
        "v5.15.54",
        "v5.15.55",
        "v5.15.56",
        "v5.15.57",
        "v5.15.58",
        "v5.15.59",
        "v5.15.6",
        "v5.15.60",
        "v5.15.61",
        "v5.15.62",
        "v5.15.63",
        "v5.15.7",
        "v5.15.8",
        "v5.15.9",
        "v5.16",
        "v5.16-rc1",
        "v5.16-rc2",
        "v5.16-rc3",
        "v5.16-rc4",
        "v5.16-rc5",
        "v5.16-rc6",
        "v5.16-rc7",
        "v5.16-rc8",
        "v5.17",
        "v5.17-rc1",
        "v5.17-rc2",
        "v5.17-rc3",
        "v5.17-rc4",
        "v5.17-rc5",
        "v5.17-rc6",
        "v5.17-rc7",
        "v5.17-rc8",
        "v5.18",
        "v5.18-rc1",
        "v5.18-rc2",
        "v5.18-rc3",
        "v5.18-rc4",
        "v5.18-rc5",
        "v5.18-rc6",
        "v5.18-rc7",
        "v5.19",
        "v5.19-rc1",
        "v5.19-rc2",
        "v5.19-rc3",
        "v5.19-rc4",
        "v5.19-rc5",
        "v5.19-rc6",
        "v5.19-rc7",
        "v5.19-rc8",
        "v5.19.1",
        "v5.19.2",
        "v5.19.3",
        "v5.19.4",
        "v5.19.5",
        "v5.4",
        "v5.4-rc7",
        "v5.4-rc8",
        "v5.5",
        "v5.5-rc1",
        "v5.5-rc2",
        "v5.5-rc3",
        "v5.5-rc4",
        "v5.5-rc5",
        "v5.5-rc6",
        "v5.5-rc7",
        "v5.6",
        "v5.6-rc1",
        "v5.6-rc2",
        "v5.6-rc3",
        "v5.6-rc4",
        "v5.6-rc5",
        "v5.6-rc6",
        "v5.6-rc7",
        "v5.7",
        "v5.7-rc1",
        "v5.7-rc2",
        "v5.7-rc3",
        "v5.7-rc4",
        "v5.7-rc5",
        "v5.7-rc6",
        "v5.7-rc7",
        "v5.8",
        "v5.8-rc1",
        "v5.8-rc2",
        "v5.8-rc3",
        "v5.8-rc4",
        "v5.8-rc5",
        "v5.8-rc6",
        "v5.8-rc7",
        "v5.9",
        "v5.9-rc1",
        "v5.9-rc2",
        "v5.9-rc3",
        "v5.9-rc4",
        "v5.9-rc5",
        "v5.9-rc6",
        "v5.9-rc7",
        "v5.9-rc8",
        "v6.0-rc1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50000.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "5.5.0"
            },
            {
              "fixed": "5.15.64"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "5.16.0"
            },
            {
              "fixed": "5.19.6"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: flowtable: fix stuck flows on cleanup due to pending work\n\nTo clear the flow table on flow table free, the following sequence\nnormally happens in order:\n\n  1) gc_step work is stopped to disable any further stats/del requests.\n  2) All flow table entries are set to teardown state.\n  3) Run gc_step which will queue HW del work for each flow table entry.\n  4) Waiting for the above del work to finish (flush).\n  5) Run gc_step again, deleting all entries from the flow table.\n  6) Flow table is freed.\n\nBut if a flow table entry already has pending HW stats or HW add work\nstep 3 will not queue HW del work (it will be skipped), step 4 will wait\nfor the pending add/stats to finish, and step 5 will queue HW del work\nwhich might execute after freeing of the flow table.\n\nTo fix the above, this patch flushes the pending work, then it sets the\nteardown flag to all flows in the flowtable and it forces a garbage\ncollector run to queue work to remove the flows from hardware, then it\nflushes this new pending work and (finally) it forces another garbage\ncollector run to remove the entry from the software flowtable.\n\nStack trace:\n[47773.882335] BUG: KASAN: use-after-free in down_read+0x99/0x460\n[47773.883634] Write of size 8 at addr ffff888103b45aa8 by task kworker/u20:6/543704\n[47773.885634] CPU: 3 PID: 543704 Comm: kworker/u20:6 Not tainted 5.12.0-rc7+ #2\n[47773.886745] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009)\n[47773.888438] Workqueue: nf_ft_offload_del flow_offload_work_handler [nf_flow_table]\n[47773.889727] Call Trace:\n[47773.890214]  dump_stack+0xbb/0x107\n[47773.890818]  print_address_description.constprop.0+0x18/0x140\n[47773.892990]  kasan_report.cold+0x7c/0xd8\n[47773.894459]  kasan_check_range+0x145/0x1a0\n[47773.895174]  down_read+0x99/0x460\n[47773.899706]  nf_flow_offload_tuple+0x24f/0x3c0 [nf_flow_table]\n[47773.907137]  flow_offload_work_handler+0x72d/0xbe0 [nf_flow_table]\n[47773.913372]  process_one_work+0x8ac/0x14e0\n[47773.921325]\n[47773.921325] Allocated by task 592159:\n[47773.922031]  kasan_save_stack+0x1b/0x40\n[47773.922730]  __kasan_kmalloc+0x7a/0x90\n[47773.923411]  tcf_ct_flow_table_get+0x3cb/0x1230 [act_ct]\n[47773.924363]  tcf_ct_init+0x71c/0x1156 [act_ct]\n[47773.925207]  tcf_action_init_1+0x45b/0x700\n[47773.925987]  tcf_action_init+0x453/0x6b0\n[47773.926692]  tcf_exts_validate+0x3d0/0x600\n[47773.927419]  fl_change+0x757/0x4a51 [cls_flower]\n[47773.928227]  tc_new_tfilter+0x89a/0x2070\n[47773.936652]\n[47773.936652] Freed by task 543704:\n[47773.937303]  kasan_save_stack+0x1b/0x40\n[47773.938039]  kasan_set_track+0x1c/0x30\n[47773.938731]  kasan_set_free_info+0x20/0x30\n[47773.939467]  __kasan_slab_free+0xe7/0x120\n[47773.940194]  slab_free_freelist_hook+0x86/0x190\n[47773.941038]  kfree+0xce/0x3a0\n[47773.941644]  tcf_ct_flow_table_cleanup_work\n\nOriginal patch description and stack trace by Paul Blakey.",
  "id": "CVE-2022-50000",
  "modified": "2025-10-15T00:55:11.832966Z",
  "published": "2025-06-18T11:00:59Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/89e135a36a9eb81412b5459df94a80995ce62eef"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8fbdec08dbf7d7ab8e35bdc65eb4394bc82d1e26"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9afb4b27349a499483ae0134282cefd0c90f480f"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "netfilter: flowtable: fix stuck flows on cleanup due to pending work"
}