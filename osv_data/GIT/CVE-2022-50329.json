{"schema_version":"1.7.3","id":"CVE-2022-50329","published":"2025-09-15T14:49:32Z","modified":"2025-10-21T12:54:46.158072Z","related":["SUSE-SU-2025:03615-1","SUSE-SU-2025:03628-1"],"summary":"block, bfq: fix uaf for bfqq in bfq_exit_icq_bfqq","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nblock, bfq: fix uaf for bfqq in bfq_exit_icq_bfqq\n\nCommit 64dc8c732f5c (\"block, bfq: fix possible uaf for 'bfqq->bic'\")\nwill access 'bic->bfqq' in bic_set_bfqq(), however, bfq_exit_icq_bfqq()\ncan free bfqq first, and then call bic_set_bfqq(), which will cause uaf.\n\nFix the problem by moving bfq_exit_bfqq() behind bic_set_bfqq().","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5533742c7cb1bc9b1f0bf401cc397d44a3a9e07a"},{"fixed":"1425f1bb5df5239021fd09ebc2a5e8070e705d36"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"094f3d9314d67691cb21ba091c1b528f6e3c4893"},{"fixed":"7949b0df3dd9f4817ed4a4e989fa9ee81df6205f"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b22fd72bfebda3956efc4431b60ddfc0a51e03e0"},{"fixed":"cfe5b38c37720313eff0dec5517442c7ab3c9a20"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"761564d93c8265f65543acf0a576b32d66bfa26a"},{"fixed":"1ed959fef5b1c6f1a7a3fbea543698c30ebd6678"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"64dc8c732f5c2b406cc752e6aaa1bd5471159cab"},{"fixed":"246cf66e300b76099b5dbd3fdd39e9a5dbc53f02"}]}],"versions":["v5.15.86","v6.0.16","v6.1.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50329.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["264925483130729804988661743719821444216","276934674898010721540910938740930637515","171363601504248423864369642120041351394","284894497607264516466241581172835541067","33674535368786234788998284944232476022"],"threshold":0.9},"id":"CVE-2022-50329-39d83c4d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1ed959fef5b1c6f1a7a3fbea543698c30ebd6678","target":{"file":"block/bfq-iosched.c"}},{"deprecated":false,"digest":{"function_hash":"50031814096427565455412696443263302897","length":318},"id":"CVE-2022-50329-48d4a9ef","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cfe5b38c37720313eff0dec5517442c7ab3c9a20","target":{"file":"block/bfq-iosched.c","function":"bfq_exit_icq_bfqq"}},{"deprecated":false,"digest":{"function_hash":"50031814096427565455412696443263302897","length":318},"id":"CVE-2022-50329-4d3b2610","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@246cf66e300b76099b5dbd3fdd39e9a5dbc53f02","target":{"file":"block/bfq-iosched.c","function":"bfq_exit_icq_bfqq"}},{"deprecated":false,"digest":{"line_hashes":["264925483130729804988661743719821444216","276934674898010721540910938740930637515","171363601504248423864369642120041351394","284894497607264516466241581172835541067","33674535368786234788998284944232476022"],"threshold":0.9},"id":"CVE-2022-50329-84b4c0e3","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7949b0df3dd9f4817ed4a4e989fa9ee81df6205f","target":{"file":"block/bfq-iosched.c"}},{"deprecated":false,"digest":{"function_hash":"50031814096427565455412696443263302897","length":318},"id":"CVE-2022-50329-8e046f84","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1ed959fef5b1c6f1a7a3fbea543698c30ebd6678","target":{"file":"block/bfq-iosched.c","function":"bfq_exit_icq_bfqq"}},{"deprecated":false,"digest":{"line_hashes":["264925483130729804988661743719821444216","276934674898010721540910938740930637515","171363601504248423864369642120041351394","284894497607264516466241581172835541067","33674535368786234788998284944232476022"],"threshold":0.9},"id":"CVE-2022-50329-9fb82598","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@cfe5b38c37720313eff0dec5517442c7ab3c9a20","target":{"file":"block/bfq-iosched.c"}},{"deprecated":false,"digest":{"line_hashes":["264925483130729804988661743719821444216","276934674898010721540910938740930637515","171363601504248423864369642120041351394","284894497607264516466241581172835541067","33674535368786234788998284944232476022"],"threshold":0.9},"id":"CVE-2022-50329-ab561a6e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1425f1bb5df5239021fd09ebc2a5e8070e705d36","target":{"file":"block/bfq-iosched.c"}},{"deprecated":false,"digest":{"function_hash":"50031814096427565455412696443263302897","length":318},"id":"CVE-2022-50329-be9b84ac","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7949b0df3dd9f4817ed4a4e989fa9ee81df6205f","target":{"file":"block/bfq-iosched.c","function":"bfq_exit_icq_bfqq"}},{"deprecated":false,"digest":{"line_hashes":["264925483130729804988661743719821444216","276934674898010721540910938740930637515","171363601504248423864369642120041351394","284894497607264516466241581172835541067","33674535368786234788998284944232476022"],"threshold":0.9},"id":"CVE-2022-50329-daee2de5","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@246cf66e300b76099b5dbd3fdd39e9a5dbc53f02","target":{"file":"block/bfq-iosched.c"}},{"deprecated":false,"digest":{"function_hash":"50031814096427565455412696443263302897","length":318},"id":"CVE-2022-50329-ea5e6716","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@1425f1bb5df5239021fd09ebc2a5e8070e705d36","target":{"file":"block/bfq-iosched.c","function":"bfq_exit_icq_bfqq"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.15.86"},{"fixed":"5.15.87"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.0.16"},{"fixed":"6.0.17"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.1.2"},{"fixed":"6.1.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50329.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1425f1bb5df5239021fd09ebc2a5e8070e705d36"},{"type":"WEB","url":"https://git.kernel.org/stable/c/1ed959fef5b1c6f1a7a3fbea543698c30ebd6678"},{"type":"WEB","url":"https://git.kernel.org/stable/c/246cf66e300b76099b5dbd3fdd39e9a5dbc53f02"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7949b0df3dd9f4817ed4a4e989fa9ee81df6205f"},{"type":"WEB","url":"https://git.kernel.org/stable/c/cfe5b38c37720313eff0dec5517442c7ab3c9a20"}]}