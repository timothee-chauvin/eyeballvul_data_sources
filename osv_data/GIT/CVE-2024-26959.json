{"schema_version":"1.7.3","id":"CVE-2024-26959","published":"2024-05-01T05:19:08.184Z","modified":"2025-11-20T04:02:57.948278Z","summary":"Bluetooth: btnxpuart: Fix btnxpuart_close","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: btnxpuart: Fix btnxpuart_close\n\nFix scheduling while atomic BUG in btnxpuart_close(), properly\npurge the transmit queue and free the receive skb.\n\n[   10.973809] BUG: scheduling while atomic: kworker/u9:0/80/0x00000002\n...\n[   10.980740] CPU: 3 PID: 80 Comm: kworker/u9:0 Not tainted 6.8.0-rc7-0.0.0-devel-00005-g61fdfceacf09 #1\n[   10.980751] Hardware name: Toradex Verdin AM62 WB on Dahlia Board (DT)\n[   10.980760] Workqueue: hci0 hci_power_off [bluetooth]\n[   10.981169] Call trace:\n...\n[   10.981363]  uart_update_mctrl+0x58/0x78\n[   10.981373]  uart_dtr_rts+0x104/0x114\n[   10.981381]  tty_port_shutdown+0xd4/0xdc\n[   10.981396]  tty_port_close+0x40/0xbc\n[   10.981407]  uart_close+0x34/0x9c\n[   10.981414]  ttyport_close+0x50/0x94\n[   10.981430]  serdev_device_close+0x40/0x50\n[   10.981442]  btnxpuart_close+0x24/0x98 [btnxpuart]\n[   10.981469]  hci_dev_close_sync+0x2d8/0x718 [bluetooth]\n[   10.981728]  hci_dev_do_close+0x2c/0x70 [bluetooth]\n[   10.981862]  hci_power_off+0x20/0x64 [bluetooth]","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"689ca16e523278470c38832a3010645a78c544d8"},{"fixed":"d4e2365b07f1ae1f811a915b514caef5b2d6581e"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"689ca16e523278470c38832a3010645a78c544d8"},{"fixed":"586e099c93fe26b7bd40593979532f507ed9f6a4"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"689ca16e523278470c38832a3010645a78c544d8"},{"fixed":"74bcf708775c405f7fb6ed776ccd3e1957f38a52"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"689ca16e523278470c38832a3010645a78c544d8"},{"fixed":"664130c0b0309b360bc5bdd40a30604a9387bde8"}]}],"versions":["v6.3","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.3","v6.6.4","v6.6.5","v6.6.6","v6.6.7","v6.6.8","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.7.1","v6.7.10","v6.7.11","v6.7.2","v6.7.3","v6.7.4","v6.7.5","v6.7.6","v6.7.7","v6.7.8","v6.7.9","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.8.1","v6.8.2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26959.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["117664402757238887516442083393045586607","328449518638716877842275720420767107934","323654124434007270006628248751712260341","303487160405238344234401364463678746335"],"threshold":0.9},"id":"CVE-2024-26959-14adbe4e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@664130c0b0309b360bc5bdd40a30604a9387bde8","target":{"file":"drivers/bluetooth/btnxpuart.c"}},{"deprecated":false,"digest":{"function_hash":"28309390120124833743713011838144878463","length":194},"id":"CVE-2024-26959-180b7cf4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@74bcf708775c405f7fb6ed776ccd3e1957f38a52","target":{"file":"drivers/bluetooth/btnxpuart.c","function":"btnxpuart_close"}},{"deprecated":false,"digest":{"function_hash":"28309390120124833743713011838144878463","length":194},"id":"CVE-2024-26959-2ccc5631","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@664130c0b0309b360bc5bdd40a30604a9387bde8","target":{"file":"drivers/bluetooth/btnxpuart.c","function":"btnxpuart_close"}},{"deprecated":false,"digest":{"line_hashes":["117664402757238887516442083393045586607","328449518638716877842275720420767107934","323654124434007270006628248751712260341","303487160405238344234401364463678746335"],"threshold":0.9},"id":"CVE-2024-26959-608891fe","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@586e099c93fe26b7bd40593979532f507ed9f6a4","target":{"file":"drivers/bluetooth/btnxpuart.c"}},{"deprecated":false,"digest":{"function_hash":"28309390120124833743713011838144878463","length":194},"id":"CVE-2024-26959-7df581a2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d4e2365b07f1ae1f811a915b514caef5b2d6581e","target":{"file":"drivers/bluetooth/btnxpuart.c","function":"btnxpuart_close"}},{"deprecated":false,"digest":{"line_hashes":["117664402757238887516442083393045586607","328449518638716877842275720420767107934","323654124434007270006628248751712260341","303487160405238344234401364463678746335"],"threshold":0.9},"id":"CVE-2024-26959-a06aadb6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@74bcf708775c405f7fb6ed776ccd3e1957f38a52","target":{"file":"drivers/bluetooth/btnxpuart.c"}},{"deprecated":false,"digest":{"function_hash":"28309390120124833743713011838144878463","length":194},"id":"CVE-2024-26959-ac4ea780","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@586e099c93fe26b7bd40593979532f507ed9f6a4","target":{"file":"drivers/bluetooth/btnxpuart.c","function":"btnxpuart_close"}},{"deprecated":false,"digest":{"line_hashes":["117664402757238887516442083393045586607","328449518638716877842275720420767107934","323654124434007270006628248751712260341","303487160405238344234401364463678746335"],"threshold":0.9},"id":"CVE-2024-26959-efd461e8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d4e2365b07f1ae1f811a915b514caef5b2d6581e","target":{"file":"drivers/bluetooth/btnxpuart.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.4.0"},{"fixed":"6.6.24"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.7.12"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.8.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26959.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/586e099c93fe26b7bd40593979532f507ed9f6a4"},{"type":"WEB","url":"https://git.kernel.org/stable/c/664130c0b0309b360bc5bdd40a30604a9387bde8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/74bcf708775c405f7fb6ed776ccd3e1957f38a52"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d4e2365b07f1ae1f811a915b514caef5b2d6581e"}]}