{"schema_version":"1.7.3","id":"CVE-2024-49876","published":"2024-10-21T18:01:16.098Z","modified":"2025-11-20T06:26:12.960787Z","related":["USN-7276-1","USN-7277-1","openSUSE-SU-2024:14500-1","openSUSE-SU-2025:14705-1"],"summary":"drm/xe: fix UAF around queue destruction","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/xe: fix UAF around queue destruction\n\nWe currently do stuff like queuing the final destruction step on a\nrandom system wq, which will outlive the driver instance. With bad\ntiming we can teardown the driver with one or more work workqueue still\nbeing alive leading to various UAF splats. Add a fini step to ensure\nuser queues are properly torn down. At this point GuC should already be\nnuked so queue itself should no longer be referenced from hw pov.\n\nv2 (Matt B)\n - Looks much safer to use a waitqueue and then just wait for the\n   xa_array to become empty before triggering the drain.\n\n(cherry picked from commit 861108666cc0e999cffeab6aff17b662e68774e3)","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"dd08ebf6c3525a7ea2186e636df064ea47281987"},{"fixed":"272b0e78874586d6ccae04079d75b27b47705544"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"dd08ebf6c3525a7ea2186e636df064ea47281987"},{"fixed":"421c74670b0f9d5c007f1276d3647aa58f407fde"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"dd08ebf6c3525a7ea2186e636df064ea47281987"},{"fixed":"2d2be279f1ca9e7288282d4214f16eea8a727cdb"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.10.1","v6.10.10","v6.10.11","v6.10.12","v6.10.13","v6.10.2","v6.10.3","v6.10.4","v6.10.5","v6.10.6","v6.10.7","v6.10.8","v6.10.9","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.11.1","v6.11.2","v6.12-rc1","v6.7","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-49876.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["229313393182954588127360556199496023490","44187482653517617551161435707293115168","147856209761929731569282142790168104550"],"threshold":0.9},"id":"CVE-2024-49876-03b60d8a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_device_types.h"}},{"deprecated":false,"digest":{"function_hash":"252360772611356119250411352635203483549","length":312},"id":"CVE-2024-49876-0db6c312","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_device.c","function":"xe_device_destroy"}},{"deprecated":false,"digest":{"function_hash":"252360772611356119250411352635203483549","length":312},"id":"CVE-2024-49876-0f09e2a7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_device.c","function":"xe_device_destroy"}},{"deprecated":false,"digest":{"line_hashes":["229313393182954588127360556199496023490","44187482653517617551161435707293115168","147856209761929731569282142790168104550"],"threshold":0.9},"id":"CVE-2024-49876-118eb3f4","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_device_types.h"}},{"deprecated":false,"digest":{"function_hash":"130204983332805102309474537037965727861","length":355},"id":"CVE-2024-49876-158f5786","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"__release_guc_id"}},{"deprecated":false,"digest":{"line_hashes":["229313393182954588127360556199496023490","44187482653517617551161435707293115168","147856209761929731569282142790168104550"],"threshold":0.9},"id":"CVE-2024-49876-21bf2458","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_device_types.h"}},{"deprecated":false,"digest":{"function_hash":"120157468171004814685281163257394607913","length":161},"id":"CVE-2024-49876-2f7c2ef5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"guc_submit_fini"}},{"deprecated":false,"digest":{"function_hash":"120157468171004814685281163257394607913","length":161},"id":"CVE-2024-49876-35c8da42","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"guc_submit_fini"}},{"deprecated":false,"digest":{"line_hashes":["6178918576831645275546326307933565292","300196245759237777262776056976350670360","310412297402638683528805095119462727316","227358437752975662489092978396099002240","200827304514655820560777547427320393777","275146377105477465940869945345037329606","5712538802989190556217177877169277366","240195246613729196228293162406411808508","100476484747465019235203854833491550226"],"threshold":0.9},"id":"CVE-2024-49876-37c6dd5a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_device.c"}},{"deprecated":false,"digest":{"function_hash":"130204983332805102309474537037965727861","length":355},"id":"CVE-2024-49876-3ba9a197","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"__release_guc_id"}},{"deprecated":false,"digest":{"function_hash":"253125825527963275402963852178085767952","length":253},"id":"CVE-2024-49876-44df463d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"guc_exec_queue_fini_async"}},{"deprecated":false,"digest":{"line_hashes":["116969875287112380963272467336652234665","163709626930714505538950316713169414241","195750033162835446843277237050433972699","170506106601570928460562311441590733595"],"threshold":0.9},"id":"CVE-2024-49876-98fec595","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_guc_types.h"}},{"deprecated":false,"digest":{"function_hash":"22143445969415940078248631350657998761","length":1912},"id":"CVE-2024-49876-9a9bb2e2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_device.c","function":"xe_device_create"}},{"deprecated":false,"digest":{"line_hashes":["118733561261462442185791354937295779248","338433410407181769479376821936576120533","131519134632561094582858427574409479812","132696353516414400650924701062666081415","232736537773802112976387526522578496008","334077483159769592602565798384535222075","158440994588893393375377222199626653503","125174844401738326470292301696653069257","26179004700535206919969544992833686252","331054266827078278558018834909612912882","304762429293417953629668195468366548820","6639447413234388212267393487810731806","260617902589862617992058746357003652405","307010232660304550379309446117608254846","76497583951555109962717887947922059594","200647321598343585807904689615456638686","76731372761286054339116524457038597359","108962821274597934712046358610942008041","228207886949340891850650730964251160338","117163883103849432700010249663879476944","109638591977120850738964420317759735418","241335725475847014620421782508422393199"],"threshold":0.9},"id":"CVE-2024-49876-a6002086","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c"}},{"deprecated":false,"digest":{"line_hashes":["118733561261462442185791354937295779248","338433410407181769479376821936576120533","131519134632561094582858427574409479812","132696353516414400650924701062666081415","232736537773802112976387526522578496008","334077483159769592602565798384535222075","158440994588893393375377222199626653503","125174844401738326470292301696653069257","26179004700535206919969544992833686252","331054266827078278558018834909612912882","304762429293417953629668195468366548820","6639447413234388212267393487810731806","260617902589862617992058746357003652405","307010232660304550379309446117608254846","76497583951555109962717887947922059594","219182375586775164467802388409209533194","157421307777053303652040389094190973734","217369410036673847820698941607957786465","77840601849242754711608627062250711442","117163883103849432700010249663879476944","109638591977120850738964420317759735418","241335725475847014620421782508422393199"],"threshold":0.9},"id":"CVE-2024-49876-a64582ea","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c"}},{"deprecated":false,"digest":{"function_hash":"141475387734134178534602992568728063940","length":1940},"id":"CVE-2024-49876-accc85c8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_device.c","function":"xe_device_create"}},{"deprecated":false,"digest":{"line_hashes":["6178918576831645275546326307933565292","300196245759237777262776056976350670360","310412297402638683528805095119462727316","227358437752975662489092978396099002240","200827304514655820560777547427320393777","275146377105477465940869945345037329606","5712538802989190556217177877169277366","240195246613729196228293162406411808508","100476484747465019235203854833491550226"],"threshold":0.9},"id":"CVE-2024-49876-b729b824","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_device.c"}},{"deprecated":false,"digest":{"function_hash":"273575260221655897583340477083661804316","length":566},"id":"CVE-2024-49876-bc07ec8e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"xe_guc_submit_init"}},{"deprecated":false,"digest":{"function_hash":"141475387734134178534602992568728063940","length":1940},"id":"CVE-2024-49876-bf1b3941","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_device.c","function":"xe_device_create"}},{"deprecated":false,"digest":{"function_hash":"273575260221655897583340477083661804316","length":566},"id":"CVE-2024-49876-cf54896f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"xe_guc_submit_init"}},{"deprecated":false,"digest":{"line_hashes":["116969875287112380963272467336652234665","163709626930714505538950316713169414241","195750033162835446843277237050433972699","170506106601570928460562311441590733595"],"threshold":0.9},"id":"CVE-2024-49876-e2cfef80","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_guc_types.h"}},{"deprecated":false,"digest":{"function_hash":"130204983332805102309474537037965727861","length":355},"id":"CVE-2024-49876-e5e765a2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"__release_guc_id"}},{"deprecated":false,"digest":{"function_hash":"252360772611356119250411352635203483549","length":312},"id":"CVE-2024-49876-e90d084f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_device.c","function":"xe_device_destroy"}},{"deprecated":false,"digest":{"line_hashes":["118733561261462442185791354937295779248","338433410407181769479376821936576120533","131519134632561094582858427574409479812","132696353516414400650924701062666081415","232736537773802112976387526522578496008","334077483159769592602565798384535222075","158440994588893393375377222199626653503","125174844401738326470292301696653069257","26179004700535206919969544992833686252","331054266827078278558018834909612912882","304762429293417953629668195468366548820","6639447413234388212267393487810731806","260617902589862617992058746357003652405","307010232660304550379309446117608254846","76497583951555109962717887947922059594","219182375586775164467802388409209533194","157421307777053303652040389094190973734","217369410036673847820698941607957786465","77840601849242754711608627062250711442","117163883103849432700010249663879476944","109638591977120850738964420317759735418","241335725475847014620421782508422393199"],"threshold":0.9},"id":"CVE-2024-49876-ee4a6de6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c"}},{"deprecated":false,"digest":{"function_hash":"328214861768990244637892432828075121093","length":540},"id":"CVE-2024-49876-f584f8e6","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@272b0e78874586d6ccae04079d75b27b47705544","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"xe_guc_submit_init"}},{"deprecated":false,"digest":{"line_hashes":["116969875287112380963272467336652234665","163709626930714505538950316713169414241","195750033162835446843277237050433972699","170506106601570928460562311441590733595"],"threshold":0.9},"id":"CVE-2024-49876-f5d1bc67","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@421c74670b0f9d5c007f1276d3647aa58f407fde","target":{"file":"drivers/gpu/drm/xe/xe_guc_types.h"}},{"deprecated":false,"digest":{"function_hash":"120157468171004814685281163257394607913","length":161},"id":"CVE-2024-49876-fad535d9","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_guc_submit.c","function":"guc_submit_fini"}},{"deprecated":false,"digest":{"line_hashes":["6178918576831645275546326307933565292","300196245759237777262776056976350670360","310412297402638683528805095119462727316","227358437752975662489092978396099002240","200827304514655820560777547427320393777","275146377105477465940869945345037329606","5712538802989190556217177877169277366","240195246613729196228293162406411808508","100476484747465019235203854833491550226"],"threshold":0.9},"id":"CVE-2024-49876-fd79d58b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2d2be279f1ca9e7288282d4214f16eea8a727cdb","target":{"file":"drivers/gpu/drm/xe/xe_device.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.8.0"},{"fixed":"6.10.14"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.11.0"},{"fixed":"6.11.3"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-49876.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/272b0e78874586d6ccae04079d75b27b47705544"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2d2be279f1ca9e7288282d4214f16eea8a727cdb"},{"type":"WEB","url":"https://git.kernel.org/stable/c/421c74670b0f9d5c007f1276d3647aa58f407fde"}]}