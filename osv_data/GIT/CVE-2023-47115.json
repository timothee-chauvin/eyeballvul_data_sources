{"schema_version":"1.7.3","id":"CVE-2023-47115","published":"2024-01-23T22:49:03Z","modified":"2025-10-22T18:40:58.190590Z","aliases":["GHSA-q68h-xwq5-mm7x","PYSEC-2024-126"],"summary":"Label Studio XSS Vulnerability on Avatar Upload","details":"Label Studio is an a popular open source data labeling tool. Versions prior to 1.9.2 have a cross-site scripting (XSS) vulnerability that could be exploited when an authenticated user uploads a crafted image file for their avatar that gets rendered as a HTML file on the website. Executing arbitrary JavaScript could result in an attacker performing malicious actions on Label Studio users if they visit the crafted avatar image. For an example, an attacker can craft a JavaScript payload that adds a new Django Super Administrator user if a Django administrator visits the image.\n\nThe file `users/functions.py` lines 18-49 show that the only verification check is that the file is an image by extracting the dimensions from the file. Label Studio serves avatar images using Django's built-in `serve` view, which is not secure for production use according to Django's documentation. The issue with the Django `serve` view is that it determines the `Content-Type` of the response by the file extension in the URL path. Therefore, an attacker can upload an image that contains malicious HTML code and name the file with a `.html` extension to be rendered as a HTML page. The only file extension validation is performed on the client-side, which can be easily bypassed.\n\nVersion 1.9.2 fixes this issue. Other remediation strategies include validating the file extension on the server side, not in client-side code; removing the use of Django's `serve` view and implement a secure controller for viewing uploaded avatar images; saving file content in the database rather than on the filesystem to mitigate against other file related vulnerabilities; and avoiding trusting user controlled inputs.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/humansignal/label-studio","events":[{"introduced":"0"},{"fixed":"de252f58c9f3ef76e907a5f181c49948a6b0362f"}]}],"versions":["v.0.1.0","v.0.1.1","v.0.1.2","v.0.1.4","v.0.1.5","v.0.1.6","v.0.2.0","v.0.2.1-2","v.0.2.1-3","v.0.2.1-4","v.0.2.1-5","v.0.2.1-8","v0.2.2","v0.3.0","v0.4.0","v0.4.4","v0.4.5","v0.4.6","v0.4.7","v0.4.8","v0.5.0","v0.5.1","v0.6.0","v0.6.1","v0.7.0","v0.7.1","v0.7.2","v0.7.3","v0.7.5.post0","v0.8.0","v0.8.1","v0.8.2","v0.9.0","v0.9.0.post3","v0.9.0.post4","v0.9.0.post5","v0.9.1.post0","v0.9.1.post1","v1.0.0","v1.0.1","v1.0.2","v1.1.0","v1.1.1","v1.2.0","v1.3.0","v1.4.0","v1.4.1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-47115.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/HumanSignal/label-studio/security/advisories/GHSA-q68h-xwq5-mm7x"},{"type":"FIX","url":"https://github.com/HumanSignal/label-studio/commit/a7a71e594f32ec4af8f3f800d5ccb8662e275da3"},{"type":"WEB","url":"https://docs.djangoproject.com/en/4.2/ref/views/#serving-files-in-development"},{"type":"WEB","url":"https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/users/functions.py#L18-L49"},{"type":"WEB","url":"https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/users/urls.py#L25-L26"}],"database_specific":{"cwe_ids":["CWE-79"]},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L"}]}