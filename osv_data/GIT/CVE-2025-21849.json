{"schema_version":"1.7.3","id":"CVE-2025-21849","published":"2025-03-12T09:42:04.946Z","modified":"2025-11-20T08:22:03.156017Z","related":["USN-7521-2"],"summary":"drm/i915/gt: Use spin_lock_irqsave() in interruptible context","details":"In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/i915/gt: Use spin_lock_irqsave() in interruptible context\n\nspin_lock/unlock() functions used in interrupt contexts could\nresult in a deadlock, as seen in GitLab issue #13399,\nwhich occurs when interrupt comes in while holding a lock.\n\nTry to remedy the problem by saving irq state before spin lock\nacquisition.\n\nv2: add irqs' state save/restore calls to all locks/unlocks in\n signal_irq_work() execution (Maciej)\n\nv3: use with spin_lock_irqsave() in guc_lrc_desc_unpin() instead\n of other lock/unlock calls and add Fixes and Cc tags (Tvrtko);\n change title and commit message\n\n(cherry picked from commit c088387ddd6482b40f21ccf23db1125e8fa4af7e)","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"2f2cc53b5fe7022f3ae602eb24573d52f8740959"},{"fixed":"2bf1f4c129db7a10920655b000f0292f1ee509c2"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"2f2cc53b5fe7022f3ae602eb24573d52f8740959"},{"fixed":"47ae46ac5407646420e06b78e0dad331e56a4bb4"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"2f2cc53b5fe7022f3ae602eb24573d52f8740959"},{"fixed":"e49477f7f78598295551d486ecc7f020d796432e"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.2","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.2","v6.13.3","v6.13.4","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.6","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21849.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"2552705147665992214020771833775695274","length":891},"id":"CVE-2025-21849-0ab42be3","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e49477f7f78598295551d486ecc7f020d796432e","target":{"file":"drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c","function":"guc_lrc_desc_unpin"}},{"deprecated":false,"digest":{"line_hashes":["304626580477997910867598480318604954183","230620090048967612655584053522791335294","1386433087626214713701061957806985623","66210537535128035773562925321104040331","213422577715041520757785614279361108753","305775402304507955950609233060814482928","316099871696978457774975476066769405697"],"threshold":0.9},"id":"CVE-2025-21849-12551b4b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@47ae46ac5407646420e06b78e0dad331e56a4bb4","target":{"file":"drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c"}},{"deprecated":false,"digest":{"line_hashes":["304626580477997910867598480318604954183","230620090048967612655584053522791335294","1386433087626214713701061957806985623","66210537535128035773562925321104040331","213422577715041520757785614279361108753","305775402304507955950609233060814482928","316099871696978457774975476066769405697"],"threshold":0.9},"id":"CVE-2025-21849-210aa37b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2bf1f4c129db7a10920655b000f0292f1ee509c2","target":{"file":"drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c"}},{"deprecated":false,"digest":{"function_hash":"2552705147665992214020771833775695274","length":891},"id":"CVE-2025-21849-57e495be","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@47ae46ac5407646420e06b78e0dad331e56a4bb4","target":{"file":"drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c","function":"guc_lrc_desc_unpin"}},{"deprecated":false,"digest":{"function_hash":"2552705147665992214020771833775695274","length":891},"id":"CVE-2025-21849-b51d9d27","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@2bf1f4c129db7a10920655b000f0292f1ee509c2","target":{"file":"drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c","function":"guc_lrc_desc_unpin"}},{"deprecated":false,"digest":{"line_hashes":["304626580477997910867598480318604954183","230620090048967612655584053522791335294","1386433087626214713701061957806985623","66210537535128035773562925321104040331","213422577715041520757785614279361108753","305775402304507955950609233060814482928","316099871696978457774975476066769405697"],"threshold":0.9},"id":"CVE-2025-21849-ccf081ba","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e49477f7f78598295551d486ecc7f020d796432e","target":{"file":"drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.9.0"},{"fixed":"6.12.17"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21849.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2bf1f4c129db7a10920655b000f0292f1ee509c2"},{"type":"WEB","url":"https://git.kernel.org/stable/c/47ae46ac5407646420e06b78e0dad331e56a4bb4"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e49477f7f78598295551d486ecc7f020d796432e"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}