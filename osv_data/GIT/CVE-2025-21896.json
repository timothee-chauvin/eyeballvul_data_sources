{"schema_version":"1.7.3","id":"CVE-2025-21896","published":"2025-04-01T15:26:49.200Z","modified":"2025-11-20T08:09:24.726696Z","summary":"fuse: revert back to __readahead_folio() for readahead","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nfuse: revert back to __readahead_folio() for readahead\n\nIn commit 3eab9d7bc2f4 (\"fuse: convert readahead to use folios\"), the\nlogic was converted to using the new folio readahead code, which drops\nthe reference on the folio once it is locked, using an inferred\nreference on the folio. Previously we held a reference on the folio for\nthe entire duration of the readpages call.\n\nThis is fine, however for the case for splice pipe responses where we\nwill remove the old folio and splice in the new folio (see\nfuse_try_move_page()), we assume that there is a reference held on the\nfolio for ap->folios, which is no longer the case.\n\nTo fix this, revert back to __readahead_folio() which allows us to hold\nthe reference on the folio for the duration of readpages until either we\ndrop the reference ourselves in fuse_readpages_end() or the reference is\ndropped after it's replaced in the page cache in the splice case.\nThis will fix the UAF bug that was reported.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3eab9d7bc2f4ae7f3f9c9c7852ff61600df79856"},{"fixed":"60db11f1b7fba4a66b117ea998d965818784a98d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3eab9d7bc2f4ae7f3f9c9c7852ff61600df79856"},{"fixed":"0c67c37e1710b2a8f61c8a02db95a51fe577e2c1"}]}],"versions":["v6.12","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.13.1","v6.13.2","v6.13.3","v6.13.4","v6.13.5","v6.14-rc1","v6.14-rc2"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21896.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"271188223241264192352534822993702692536","length":704},"id":"CVE-2025-21896-22ddeacf","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60db11f1b7fba4a66b117ea998d965818784a98d","target":{"file":"fs/fuse/file.c","function":"fuse_readpages_end"}},{"deprecated":false,"digest":{"line_hashes":["77449568383616994146728759414577509136","123979203620201212751065854356461367867","290700374777333884325703416775727535148","12572375994736348089320549726579633384","303518844452896779363619977247176855910","58328178049106882764624601460836610988","209735949278892994222423124174040735848","248860932400679795367687920445371518772","119103839714995056754647544731717811847"],"threshold":0.9},"id":"CVE-2025-21896-89109c35","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@60db11f1b7fba4a66b117ea998d965818784a98d","target":{"file":"fs/fuse/file.c"}},{"deprecated":false,"digest":{"line_hashes":["77449568383616994146728759414577509136","123979203620201212751065854356461367867","290700374777333884325703416775727535148","12572375994736348089320549726579633384","303518844452896779363619977247176855910","58328178049106882764624601460836610988","209735949278892994222423124174040735848","248860932400679795367687920445371518772","119103839714995056754647544731717811847"],"threshold":0.9},"id":"CVE-2025-21896-f6323ab8","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0c67c37e1710b2a8f61c8a02db95a51fe577e2c1","target":{"file":"fs/fuse/file.c"}},{"deprecated":false,"digest":{"function_hash":"271188223241264192352534822993702692536","length":704},"id":"CVE-2025-21896-f7a4ac6f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0c67c37e1710b2a8f61c8a02db95a51fe577e2c1","target":{"file":"fs/fuse/file.c","function":"fuse_readpages_end"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21896.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/0c67c37e1710b2a8f61c8a02db95a51fe577e2c1"},{"type":"WEB","url":"https://git.kernel.org/stable/c/60db11f1b7fba4a66b117ea998d965818784a98d"}]}