{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-34108.json"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "490d553dfc661dd72b546e3a038366e79adf49b6"
            }
          ],
          "repo": "https://github.com/mailcow/mailcow-dockerized",
          "type": "GIT"
        }
      ],
      "versions": [
        "2022-01",
        "2022-01a",
        "2022-03",
        "2022-03a",
        "2022-04",
        "2022-05",
        "2022-05a",
        "2022-05b",
        "2022-05c",
        "2022-05d",
        "2022-06",
        "2022-06a",
        "2022-06b",
        "2022-07",
        "2022-07a",
        "2022-08",
        "2022-08a",
        "2022-08b",
        "2022-09",
        "2022-09a",
        "2022-10",
        "2022-10a",
        "2022-11",
        "2022-11a",
        "2022-11b",
        "2022-12",
        "2022-12a",
        "2022-12b",
        "2023-01",
        "2023-01a",
        "2023-02",
        "2023-02a",
        "2023-03",
        "2023-04",
        "2023-04a",
        "2023-04b",
        "2023-05"
      ]
    }
  ],
  "aliases": [
    "GHSA-mhh4-qchc-pv22"
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-78"
    ]
  },
  "details": "mailcow is a mail server suite based on Dovecot, Postfix and other open source software, that provides a modern web UI for user/server administration. A vulnerability has been discovered in mailcow which allows an attacker to manipulate internal Dovecot variables by using specially crafted passwords during the authentication process. The issue arises from the behavior of the `passwd-verify.lua` script, which is responsible for verifying user passwords during login attempts. Upon a successful login, the script returns a response in the format of \"password=<valid-password>\", indicating the successful authentication. By crafting a password with additional key-value pairs appended to it, an attacker can manipulate the returned string and influence the internal behavior of Dovecot. For example, using the password \"123 mail_crypt_save_version=0\" would cause the `passwd-verify.lua` script to return the string \"password=123 mail_crypt_save_version=0\". Consequently, Dovecot will interpret this string and set the internal variables accordingly, leading to unintended consequences. This vulnerability can be exploited by an authenticated attacker who has the ability to set their own password. Successful exploitation of this vulnerability could result in unauthorized access to user accounts, bypassing security controls, or other malicious activities. This issue has been patched in version `2023-05a`. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
  "id": "CVE-2023-34108",
  "modified": "2025-10-22T18:38:13.964002Z",
  "published": "2023-06-07T17:16:54Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/mailcow/mailcow-dockerized/security/advisories/GHSA-mhh4-qchc-pv22"
    },
    {
      "type": "FIX",
      "url": "https://github.com/mailcow/mailcow-dockerized/commit/f80940efdccd393bf5fccec2886795372a38c445"
    },
    {
      "type": "WEB",
      "url": "https://github.com/VladimirBorisov/CVE_proposal/blob/main/MailcowUserPassword.md"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ],
  "summary": "Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords"
}