{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2023-41041.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "104366035911502071488774517190567043941",
                "10302218223875858298584828605686550796",
                "80799890251929797104605726268086622726",
                "327326906645320380261826494927220765199",
                "220132483746852187569510542094837116627",
                "138189119651509801568791625329561528139",
                "196223973972400463372136169227783562118",
                "207650754846889873780312014459349619927",
                "63092294391150819172464191247334809899",
                "4981820818341895007081702721072379802",
                "280262375600128463429585744742209713172",
                "6266954555349894817259985576090320007",
                "205395180128814164177110764490586588370",
                "313788295127889786071737163983928045493",
                "320434137281464770739116989960466269206",
                "68213603608308858539474009861493954278",
                "69350927495594500998213099466995059691",
                "255025063426640171957900705664507184144",
                "69475541070614915424191008435418223775",
                "80847184872677717843977019136272036005",
                "120887317900432590373440955907810427923",
                "147192216173356402653409339669768764729"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-41041-01cf3da6",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/test/java/org/graylog2/rest/resources/users/UsersResourceTest.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "168889537364823972410660972428330601962",
              "length": 450.0
            },
            "id": "CVE-2023-41041-0cdda49b",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/security/UserSessionTerminationService.java",
              "function": "terminateSessionsForUser"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "220224392687603130865239745957054874146",
                "320340982756201098657657647055594144697",
                "280199227320524677678949130461855568148",
                "326078736352782358783860888561171450344",
                "213717638586383833298475933553856206497",
                "198078566469729278690732909234874918340",
                "80645555391520238137831331104818281464",
                "217538670170395588527696819508456393956",
                "117635177222154105988326446508515466228"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-41041-272d47e4",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/security/MongoDbSessionDAO.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "116610081280714488325722465136390330695",
              "length": 302.0
            },
            "id": "CVE-2023-41041-2d007481",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/users/UsersResource.java",
              "function": "UsersResource"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "269855666546277453860987971672211045629",
                "14953421807910422798822437856277871443",
                "149703554692272448407363533566978008425",
                "93950414491931178860396434465752359174",
                "185648135209247273877741211944099295231",
                "96344121109017416817458502552466018180",
                "179270653013154652390064569227071702798",
                "14828851360723319587973152258814157115",
                "88374675710457348913432818808181809639",
                "82692370647836342134577323820228935740",
                "83066966047253642990827324113063275814",
                "246580733880527314560249553371498880949",
                "1266117672455019565952039992995185221",
                "143806323393895803812213858339371142396",
                "141629574778996514718476473832541567449",
                "253457231558868968839758768230203246080",
                "136816711798442011813169196291659859013",
                "266053429033002234981439473229337469824",
                "160590179806193623276002984097864975817",
                "49660512826604250183037087466146336709",
                "326025282130988755087310401991905741859",
                "13090437933858557488746686174099606464",
                "133995938310453952769298371508373222277",
                "221467214779256542375681451100952686043",
                "51157506064965884345101857078975938871",
                "78911244742079891473232338270664188047",
                "23058513923448211856174518103042399951",
                "328694362652164004540307153865818121845",
                "52749979178949894269775129169391010513",
                "206479926625931210069027564385361133643",
                "32220774014505876216279768418515723839",
                "157824126330838634185702484753505507349",
                "241463350041978859077254885445030660546",
                "331832340811196468863179950627479780669",
                "274333718280684449049167483390069704544",
                "231495313596198604940087928609764636839",
                "299828806294940831099119952458268889255",
                "91730165467037632379310836622450102113",
                "5871383959288084056436691047325105253",
                "161580684529652741326520439577180716950",
                "270036148848432267038245748291037256147",
                "164240919069753425461323123192728922420",
                "196965976430831750608344737727124256589",
                "119964949003959259738776420308476516929",
                "79566107920491443477303924063466858176",
                "183489952794093010577973599411033653249"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-41041-3734a02f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/users/UsersResource.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "177971599284690762872500196286090950261",
              "length": 1987.0
            },
            "id": "CVE-2023-41041-687dffcc",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/users/UsersResource.java",
              "function": "changeUser"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "216190859915552726671707505792069809036",
              "length": 51.0
            },
            "id": "CVE-2023-41041-6ff7d846",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/security/MongoDbSessionDAO.java",
              "function": "MongoDbSessionDAO"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "42969598992628811007418162585422548335",
                "129270767240439870002979386602469291687",
                "195644706902333249416207183022077255403",
                "145959312696064374414380141649091626876",
                "270635682734959252454013416655399601973",
                "264223227450532739831757798318921650367",
                "117965714684140543914357528698007776983",
                "15960549298264863438098401489941237952",
                "313536966802587798741958444495912324202",
                "176313486542914927986242141580789541901",
                "63748329843849395147891703975018627947",
                "98974393538302937198698715673152659946",
                "300400252508782761894359536624424934153",
                "45122382258819996150089145662010296256",
                "221429576862532000916330050317507484770"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-41041-7372daeb",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/security/UserSessionTerminationService.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "231599065360380975265126084640003307412",
                "31844377698528594010841653711324487791",
                "102759620533056643542345242583888466862",
                "208834215886668150795133794399509010745",
                "92587853850753827298076658066852921043",
                "232713435891563423370564253052393730843",
                "101470999581502964495224045093947059610",
                "263381509280174591614987832985473471528",
                "305816738857877351835032555247733577818",
                "12910442899967059879586487341587291082",
                "141491756221816601406731901866418176723",
                "178683035265916581533508390289691993032"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2023-41041-7f88f56f",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/security/MongoDBSessionServiceImpl.java"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "35077265241604652514115800190892099476",
              "length": 209.0
            },
            "id": "CVE-2023-41041-854bf19a",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/test/java/org/graylog2/rest/resources/users/UsersResourceTest.java",
              "function": "TestUsersResource"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "61324654159581862474343455939420987261",
              "length": 237.0
            },
            "id": "CVE-2023-41041-ae782b4c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/security/MongoDBSessionServiceImpl.java",
              "function": "MongoDBSessionServiceImpl"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "171852257995191230062368283324368320704",
              "length": 404.0
            },
            "id": "CVE-2023-41041-af960441",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/main/java/org/graylog2/rest/resources/users/UsersResource.java",
              "function": "updateExistingSession"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "291538798465515942759212257739787982711",
              "length": 318.0
            },
            "id": "CVE-2023-41041-d71b5acb",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://github.com/graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3",
            "target": {
              "file": "graylog2-server/src/test/java/org/graylog2/rest/resources/users/UsersResourceTest.java",
              "function": "setUp"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "bb88f3d0b2b0351669ab32c60b595ab7242a3fe3"
            }
          ],
          "repo": "https://github.com/graylog2/graylog2-server",
          "type": "GIT"
        }
      ],
      "versions": [
        "0.10.0",
        "0.10.0-preview.2",
        "0.10.0-rc.1",
        "0.10.0-rc.2",
        "0.10.0-rc.3",
        "0.10.0-rc.4",
        "0.11.0",
        "0.20.0",
        "0.20.0-preview.1",
        "0.20.0-preview.2",
        "0.20.0-preview.3",
        "0.20.0-preview.4",
        "0.20.0-preview.5",
        "0.20.0-preview.6",
        "0.20.0-preview.7",
        "0.20.0-preview.8",
        "0.20.0-rc.1",
        "0.20.0-rc.1-1",
        "0.20.0-rc.2",
        "0.20.0-rc.3",
        "0.20.1",
        "0.20.2-rc.1",
        "0.20.2-snapshot",
        "0.20.2-snapshot.2",
        "0.21.0-beta1",
        "0.21.0-beta2",
        "0.21.0-beta3",
        "0.21.0-beta4",
        "0.21.0-rc.1",
        "0.9",
        "0.9.1",
        "0.9.2",
        "0.9.3",
        "0.9.4",
        "0.9.4p1",
        "0.9.5",
        "0.9.5p1",
        "0.9.6",
        "0.9.6-PREVIEW",
        "0.9.6-PREVIEW.2",
        "0.9.6-PREVIEW.3",
        "0.9.6-beta",
        "0.9.7-preview.1",
        "1.0.0",
        "1.0.0-beta.1",
        "1.0.0-beta.2",
        "1.0.0-beta.3",
        "1.0.0-rc.1",
        "1.0.0-rc.2",
        "1.0.0-rc.3",
        "1.0.0-rc.4",
        "1.0.1",
        "1.1.0",
        "1.1.0-beta.1",
        "1.1.0-beta.2",
        "1.1.0-beta.3",
        "1.1.0-rc.1",
        "1.1.0-rc.2",
        "1.1.0-rc.3",
        "1.1.1",
        "1.1.2",
        "1.2.0",
        "1.2.0-rc.1",
        "1.2.0-rc.2",
        "1.2.0-rc.3",
        "1.2.0-rc.4",
        "2.0.0-alpha.1",
        "2.0.0-alpha.2",
        "2.0.0-alpha.3",
        "2.0.0-alpha.4",
        "2.0.0-alpha.5",
        "2.0.0-beta.1",
        "2.0.0-beta.2",
        "2.0.0-beta.3",
        "2.0.0-rc.1",
        "2.1.0-alpha.1",
        "2.1.0-alpha.2",
        "2.1.0-beta.1",
        "2.1.0-beta.2",
        "2.1.0-beta.3",
        "2.1.0-beta.4",
        "2.1.0-rc.1",
        "2.2.0",
        "2.2.0-alpha.1",
        "2.2.0-alpha.2",
        "2.2.0-alpha.3",
        "2.2.0-alpha.4",
        "2.2.0-beta.1",
        "2.2.0-beta.2",
        "2.2.0-beta.3",
        "2.2.0-beta.4",
        "2.2.0-beta.5",
        "2.2.0-beta.6",
        "2.2.0-rc.1",
        "2.3.0-alpha.1",
        "2.3.0-alpha.2",
        "2.3.0-alpha.3",
        "2.3.0-beta.1",
        "2.3.0-rc.1",
        "2.4.0-alpha.1",
        "2.4.0-alpha.2",
        "2.4.0-alpha.3",
        "3.0.0-alpha.0",
        "3.0.0-alpha.1",
        "3.0.0-alpha.2",
        "3.0.0-alpha.3",
        "3.0.0-alpha.4",
        "3.0.0-alpha.5",
        "3.0.0-beta.1",
        "3.1.0",
        "3.1.0-beta.1",
        "3.1.0-beta.2",
        "3.1.0-beta.3",
        "3.1.0-rc.1",
        "3.1.0-rc.2",
        "3.2.0-beta.1",
        "3.2.0-beta.2",
        "3.2.0-beta.3",
        "3.2.0-beta.4",
        "3.2.0-rc.1",
        "3.3.0-beta.1",
        "3.3.0-beta.2",
        "3.3.0-beta.3",
        "3.3.0-rc.1",
        "4.0.0",
        "4.0.0-beta.1",
        "4.0.0-beta.2",
        "4.0.0-beta.3",
        "4.0.0-beta.4",
        "4.0.0-rc.1",
        "4.0.0-rc.2",
        "4.0.1",
        "4.1.0",
        "4.1.0-beta.1",
        "4.1.0-beta.2",
        "4.1.0-rc.1",
        "4.2.0-beta.1",
        "4.3.0-beta.1",
        "4.3.0-beta.2",
        "4.3.0-beta.3",
        "4.3.0-rc.1",
        "5.0.0",
        "5.0.0-alpha.1",
        "5.0.0-beta.1",
        "5.0.0-beta.2",
        "5.0.0-beta.3",
        "5.0.0-beta.4",
        "5.0.0-beta.5",
        "5.0.0-rc.1",
        "5.0.0-rc.2",
        "5.0.1",
        "5.0.2",
        "5.0.3",
        "5.0.4",
        "5.0.5",
        "5.0.6",
        "5.0.7",
        "5.0.8",
        "v0.20.0-preview.1",
        "v0.20.0-rc.1-1"
      ]
    }
  ],
  "aliases": [
    "GHSA-3fqm-frhg-7c85"
  ],
  "details": "Graylog is a free and open log management platform. In a multi-node Graylog cluster, after a user has explicitly logged out, a user session may still be used for API requests until it has reached its original expiry time. Each node maintains an in-memory cache of user sessions. Upon a cache-miss, the session is loaded from the database. After that, the node operates solely on the cached session. Modifications to sessions will update the cached version as well as the session persisted in the database. However, each node maintains their isolated version of the session. When the user logs out, the session is removed from the node-local cache and deleted from the database. The other nodes will however still use the cached session. These nodes will only fail to accept the session id if they intent to update the session in the database. They will then notice that the session is gone. This is true for most API requests originating from user interaction with the Graylog UI because these will lead to an update of the session's \"last access\" timestamp. If the session update is however prevented by setting the `X-Graylog-No-Session-Extension:true` header in the request, the node will consider the (cached) session valid until the session is expired according to its timeout setting. No session identifiers are leaked. After a user has logged out, the UI shows the login screen again, which gives the user the impression that their session is not valid anymore. However, if the session becomes compromised later, it can still be used to perform API requests against the Graylog cluster. The time frame for this is limited to the configured session lifetime, starting from the time when the user logged out. This issue has been addressed in versions 5.0.9 and 5.1.3. Users are advised to upgrade.\n\n\n",
  "id": "CVE-2023-41041",
  "modified": "2025-10-10T04:37:00.516648Z",
  "published": "2023-08-30T22:15:10Z",
  "references": [
    {
      "type": "EVIDENCE",
      "url": "https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3fqm-frhg-7c85"
    },
    {
      "type": "FIX",
      "url": "https://github.com/Graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3"
    }
  ],
  "related": [
    "GHSA-3fqm-frhg-7c85"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
      "type": "CVSS_V3"
    }
  ]
}