{"schema_version":"1.7.3","id":"CVE-2022-49999","published":"2025-06-18T11:00:58Z","modified":"2025-10-21T11:40:18.881793Z","related":["SUSE-SU-2025:02264-1","SUSE-SU-2025:02537-1"],"summary":"btrfs: fix space cache corruption and potential double allocations","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: fix space cache corruption and potential double allocations\n\nWhen testing space_cache v2 on a large set of machines, we encountered a\nfew symptoms:\n\n1. \"unable to add free space :-17\" (EEXIST) errors.\n2. Missing free space info items, sometimes caught with a \"missing free\n   space info for X\" error.\n3. Double-accounted space: ranges that were allocated in the extent tree\n   and also marked as free in the free space tree, ranges that were\n   marked as allocated twice in the extent tree, or ranges that were\n   marked as free twice in the free space tree. If the latter made it\n   onto disk, the next reboot would hit the BUG_ON() in\n   add_new_free_space().\n4. On some hosts with no on-disk corruption or error messages, the\n   in-memory space cache (dumped with drgn) disagreed with the free\n   space tree.\n\nAll of these symptoms have the same underlying cause: a race between\ncaching the free space for a block group and returning free space to the\nin-memory space cache for pinned extents causes us to double-add a free\nrange to the space cache. This race exists when free space is cached\nfrom the free space tree (space_cache=v2) or the extent tree\n(nospace_cache, or space_cache=v1 if the cache needs to be regenerated).\nstruct btrfs_block_group::last_byte_to_unpin and struct\nbtrfs_block_group::progress are supposed to protect against this race,\nbut commit d0c2f4fa555e (\"btrfs: make concurrent fsyncs wait less when\nwaiting for a transaction commit\") subtly broke this by allowing\nmultiple transactions to be unpinning extents at the same time.\n\nSpecifically, the race is as follows:\n\n1. An extent is deleted from an uncached block group in transaction A.\n2. btrfs_commit_transaction() is called for transaction A.\n3. btrfs_run_delayed_refs() -> __btrfs_free_extent() runs the delayed\n   ref for the deleted extent.\n4. __btrfs_free_extent() -> do_free_extent_accounting() ->\n   add_to_free_space_tree() adds the deleted extent back to the free\n   space tree.\n5. do_free_extent_accounting() -> btrfs_update_block_group() ->\n   btrfs_cache_block_group() queues up the block group to get cached.\n   block_group->progress is set to block_group->start.\n6. btrfs_commit_transaction() for transaction A calls\n   switch_commit_roots(). It sets block_group->last_byte_to_unpin to\n   block_group->progress, which is block_group->start because the block\n   group hasn't been cached yet.\n7. The caching thread gets to our block group. Since the commit roots\n   were already switched, load_free_space_tree() sees the deleted extent\n   as free and adds it to the space cache. It finishes caching and sets\n   block_group->progress to U64_MAX.\n8. btrfs_commit_transaction() advances transaction A to\n   TRANS_STATE_SUPER_COMMITTED.\n9. fsync calls btrfs_commit_transaction() for transaction B. Since\n   transaction A is already in TRANS_STATE_SUPER_COMMITTED and the\n   commit is for fsync, it advances.\n10. btrfs_commit_transaction() for transaction B calls\n    switch_commit_roots(). This time, the block group has already been\n    cached, so it sets block_group->last_byte_to_unpin to U64_MAX.\n11. btrfs_commit_transaction() for transaction A calls\n    btrfs_finish_extent_commit(), which calls unpin_extent_range() for\n    the deleted extent. It sees last_byte_to_unpin set to U64_MAX (by\n    transaction B!), so it adds the deleted extent to the space cache\n    again!\n\nThis explains all of our symptoms above:\n\n* If the sequence of events is exactly as described above, when the free\n  space is re-added in step 11, it will fail with EEXIST.\n* If another thread reallocates the deleted extent in between steps 7\n  and 11, then step 11 will silently re-add that space to the space\n  cache as free even though it is actually allocated. Then, if that\n  space is allocated *again*, the free space tree will be corrupted\n  (namely, the wrong item will be deleted).\n* If we don't catch this free space tree corr\n---truncated---","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d0c2f4fa555e70324ec2a129b822ab58f172cc62"},{"fixed":"92dc4c1a8e58bcc7a183a4c86b055c24cc88d967"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d0c2f4fa555e70324ec2a129b822ab58f172cc62"},{"fixed":"a2e54eb64229f07f917b05d0c323604fda9b89f7"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"d0c2f4fa555e70324ec2a129b822ab58f172cc62"},{"fixed":"ced8ecf026fd8084cf175530ff85c76d6085d715"}]}],"versions":["v5.11","v5.12","v5.12-rc1","v5.12-rc1-dontuse","v5.12-rc2","v5.12-rc3","v5.12-rc4","v5.12-rc5","v5.12-rc6","v5.12-rc7","v5.12-rc8","v5.13","v5.13-rc1","v5.13-rc2","v5.13-rc3","v5.13-rc4","v5.13-rc5","v5.13-rc6","v5.13-rc7","v5.14","v5.14-rc1","v5.14-rc2","v5.14-rc3","v5.14-rc4","v5.14-rc5","v5.14-rc6","v5.14-rc7","v5.15","v5.15-rc1","v5.15-rc2","v5.15-rc3","v5.15-rc4","v5.15-rc5","v5.15-rc6","v5.15-rc7","v5.15.1","v5.15.10","v5.15.11","v5.15.12","v5.15.13","v5.15.14","v5.15.15","v5.15.16","v5.15.17","v5.15.18","v5.15.19","v5.15.2","v5.15.20","v5.15.21","v5.15.22","v5.15.23","v5.15.24","v5.15.25","v5.15.26","v5.15.27","v5.15.28","v5.15.29","v5.15.3","v5.15.30","v5.15.31","v5.15.32","v5.15.33","v5.15.34","v5.15.35","v5.15.36","v5.15.37","v5.15.38","v5.15.39","v5.15.4","v5.15.40","v5.15.41","v5.15.42","v5.15.43","v5.15.44","v5.15.45","v5.15.46","v5.15.47","v5.15.48","v5.15.49","v5.15.5","v5.15.50","v5.15.51","v5.15.52","v5.15.53","v5.15.54","v5.15.55","v5.15.56","v5.15.57","v5.15.58","v5.15.59","v5.15.6","v5.15.60","v5.15.61","v5.15.62","v5.15.63","v5.15.64","v5.15.7","v5.15.8","v5.15.9","v5.16","v5.16-rc1","v5.16-rc2","v5.16-rc3","v5.16-rc4","v5.16-rc5","v5.16-rc6","v5.16-rc7","v5.16-rc8","v5.17","v5.17-rc1","v5.17-rc2","v5.17-rc3","v5.17-rc4","v5.17-rc5","v5.17-rc6","v5.17-rc7","v5.17-rc8","v5.18","v5.18-rc1","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v5.19.1","v5.19.2","v5.19.3","v5.19.4","v5.19.5"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49999.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["312448290253527222988718145206611320600","58959170561268465319111943638196870131","243390251233205987429798399812205739094","256508063766543634882536653612679478151","85196719570340410194534915750618434252","339092124622972174773170983582367258467","10207133191480636039733843277035745202","299910617383310943313714671855673516348","251331490848351049357872004587207309422","195616233429871976983369701947699270014","79171704205628185140763800443028502472","315794419357012175020898151285849730587","220682107327892735545415050522026835","65104799077304498579216209487780359486","119541807870757693261003068415481770353","92194779980529558539350076932608184794","121318426447199310025972867235336378863","180595486924508757621376039742857450559","255935210168074752332533781678708587846","321629603726001335545982187748629244948","335609443416814740726699418274033094571","338382989024818235392898083159579678665","134816365958422310452812130285613389004","277317516365515867402682080113787611349"],"threshold":0.9},"id":"CVE-2022-49999-0a338ba1","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/extent-tree.c"}},{"deprecated":false,"digest":{"line_hashes":["290907258235401718923500602803928173714","288915128920615355842303634341738467117","127459524321229119238087214578577056102","328716432242649750431710627921419803674","316348269549672022533599458005323777817","293877116677000808454268798738459774638","12069137623470395674927265850506406493","299826184930066349386250379109236689423","265492134085653590873789269080412594392","121148317989907872721905087275203127554","196131039743162190289220782624426123251","49138519021087407683182211456386367040","232724015829606203034267462061900876601","20715203196721252059281985134060202193","244270585351686465317150140358259269474","279204308540820749806022775341674370347","155324541164290874812005011080493442430","270619429989400745304677377768687029332","231358228023166890358941981734432961626","188867562897169521822115234066185123294","320351838112604210024302481669636873895","135757563915096071107490066443028110878","316061625233026491507508640903153972658","102799732039694890997443974308259911889","257572393749620406828683020973460839045","56357600843078978088820468056004545899","101184436433708325555063281833912238865","93512927153945069708773359791713108751","193084477229603494784118511430472314720","117166629227922531125877719266712815178","30536600216990495953166093666144554989","333016856692278374007384808015436542885","113395355667634568410275596454293369722","199989444521751159636998618346257235945","55273146663216805141802797412127034684","89395032219222136317371615985718056968","161116058246080062535802889174746512064","186160688525880135375146219970614706829","119808467010705292470006695096319332995","259156337963067545182483330880640979012","292391831558099193063025921595305839907","255702211177890622581852570176111644906","161491179633992101893247324881492213394","131106859531995003035328940626032747353","74848309333528858080795708617478643374","213460344505502867072749719270241885081","250892235979759420007353099882343744422","106579762740815169702775886674958750812","66199848712951646872918147052059541858","312647550305337246160638020131556114124","191210083444379847894071275682405206890"],"threshold":0.9},"id":"CVE-2022-49999-0ebc4e24","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/block-group.c"}},{"deprecated":false,"digest":{"function_hash":"302126754594868553927250777472207788233","length":312},"id":"CVE-2022-49999-1302cc57","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/extent-tree.c","function":"__exclude_logged_extent"}},{"deprecated":false,"digest":{"line_hashes":["290907258235401718923500602803928173714","288915128920615355842303634341738467117","127459524321229119238087214578577056102","328716432242649750431710627921419803674","316348269549672022533599458005323777817","293877116677000808454268798738459774638","12069137623470395674927265850506406493","299826184930066349386250379109236689423","265492134085653590873789269080412594392","121148317989907872721905087275203127554","196131039743162190289220782624426123251","49138519021087407683182211456386367040","232724015829606203034267462061900876601","20715203196721252059281985134060202193","244270585351686465317150140358259269474","279204308540820749806022775341674370347","155324541164290874812005011080493442430","270619429989400745304677377768687029332","231358228023166890358941981734432961626","188867562897169521822115234066185123294","320351838112604210024302481669636873895","135757563915096071107490066443028110878","316061625233026491507508640903153972658","102799732039694890997443974308259911889","257572393749620406828683020973460839045","56357600843078978088820468056004545899","101184436433708325555063281833912238865","93512927153945069708773359791713108751","193084477229603494784118511430472314720","117166629227922531125877719266712815178","30536600216990495953166093666144554989","333016856692278374007384808015436542885","113395355667634568410275596454293369722","199989444521751159636998618346257235945","55273146663216805141802797412127034684","89395032219222136317371615985718056968","161116058246080062535802889174746512064","186160688525880135375146219970614706829","119808467010705292470006695096319332995","259156337963067545182483330880640979012","292391831558099193063025921595305839907","229325342852854970730839547287726466357","161491179633992101893247324881492213394","131106859531995003035328940626032747353","74848309333528858080795708617478643374","213460344505502867072749719270241885081","250892235979759420007353099882343744422","106579762740815169702775886674958750812","66199848712951646872918147052059541858","312647550305337246160638020131556114124","191210083444379847894071275682405206890"],"threshold":0.9},"id":"CVE-2022-49999-181b0b1b","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/block-group.c"}},{"deprecated":false,"digest":{"function_hash":"322870623796543319816572908561128544785","length":1515},"id":"CVE-2022-49999-22677221","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/extent-tree.c","function":"btrfs_trim_fs"}},{"deprecated":false,"digest":{"function_hash":"227836436162788758027425010833627089184","length":174},"id":"CVE-2022-49999-29aaa159","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/block-group.c","function":"space_cache_v1_done"}},{"deprecated":false,"digest":{"function_hash":"198372502871398156047983677049874641659","length":102},"id":"CVE-2022-49999-3085db62","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_wait_space_cache_v1_finished"}},{"deprecated":false,"digest":{"function_hash":"104698172227235789175596359106129925698","length":4470},"id":"CVE-2022-49999-31e372fd","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/extent-tree.c","function":"find_free_extent"}},{"deprecated":false,"digest":{"function_hash":"302126754594868553927250777472207788233","length":312},"id":"CVE-2022-49999-3efab795","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/extent-tree.c","function":"__exclude_logged_extent"}},{"deprecated":false,"digest":{"function_hash":"326627177030440135098545499632468034134","length":306},"id":"CVE-2022-49999-3fd44c51","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_wait_block_group_cache_done"}},{"deprecated":false,"digest":{"line_hashes":["197961697258745493898882575577969370210","204628161058288388371818055167768185818","49227386935171335489891213330181377906","103205286187433486772428730165815549953"],"threshold":0.9},"id":"CVE-2022-49999-45292d9a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/ctree.h"}},{"deprecated":false,"digest":{"function_hash":"326627177030440135098545499632468034134","length":306},"id":"CVE-2022-49999-45ee4a3a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_wait_block_group_cache_done"}},{"deprecated":false,"digest":{"line_hashes":["155123625366276526624436533375831942335","46106215621998206544980243579622054539","100086482586881327243786151495761472403","222177227300496175168467062626538221773","155362336930551269377027995850236451280","231493025287621535991146114177104407235"],"threshold":0.9},"id":"CVE-2022-49999-471177f6","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/block-group.h"}},{"deprecated":false,"digest":{"function_hash":"142460969238983418134784354762240656203","length":1564},"id":"CVE-2022-49999-6f2b4293","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/extent-tree.c","function":"btrfs_trim_fs"}},{"deprecated":false,"digest":{"function_hash":"97610243383541257923726676786747637609","length":2165},"id":"CVE-2022-49999-705a173a","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_update_block_group"}},{"deprecated":false,"digest":{"function_hash":"104698172227235789175596359106129925698","length":4470},"id":"CVE-2022-49999-7a28d6b8","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/extent-tree.c","function":"find_free_extent"}},{"deprecated":false,"digest":{"function_hash":"165880591131060571492325697096895009468","length":4270},"id":"CVE-2022-49999-81ac3c19","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/extent-tree.c","function":"find_free_extent"}},{"deprecated":false,"digest":{"function_hash":"129415534765699479956485492169455377612","length":363},"id":"CVE-2022-49999-8585dd99","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/extent-tree.c","function":"btrfs_pin_extent_for_log_replay"}},{"deprecated":false,"digest":{"function_hash":"227836436162788758027425010833627089184","length":174},"id":"CVE-2022-49999-94091ea5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/block-group.c","function":"space_cache_v1_done"}},{"deprecated":false,"digest":{"line_hashes":["312448290253527222988718145206611320600","58959170561268465319111943638196870131","243390251233205987429798399812205739094","256508063766543634882536653612679478151","85196719570340410194534915750618434252","339092124622972174773170983582367258467","10207133191480636039733843277035745202","299910617383310943313714671855673516348","251331490848351049357872004587207309422","195616233429871976983369701947699270014","79171704205628185140763800443028502472","315794419357012175020898151285849730587","220682107327892735545415050522026835","65104799077304498579216209487780359486","119541807870757693261003068415481770353","92194779980529558539350076932608184794","121318426447199310025972867235336378863","180595486924508757621376039742857450559","255935210168074752332533781678708587846","321629603726001335545982187748629244948","335609443416814740726699418274033094571","338382989024818235392898083159579678665","134816365958422310452812130285613389004","277317516365515867402682080113787611349"],"threshold":0.9},"id":"CVE-2022-49999-9dd69b37","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/extent-tree.c"}},{"deprecated":false,"digest":{"line_hashes":["155123625366276526624436533375831942335","46106215621998206544980243579622054539","100086482586881327243786151495761472403","222177227300496175168467062626538221773","155362336930551269377027995850236451280","231493025287621535991146114177104407235"],"threshold":0.9},"id":"CVE-2022-49999-9e28922e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/block-group.h"}},{"deprecated":false,"digest":{"function_hash":"162814797138948828404448014456827399749","length":1283},"id":"CVE-2022-49999-9fdd828b","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_cache_block_group"}},{"deprecated":false,"digest":{"function_hash":"162814797138948828404448014456827399749","length":1283},"id":"CVE-2022-49999-a11acc81","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_cache_block_group"}},{"deprecated":false,"digest":{"line_hashes":["197961697258745493898882575577969370210","204628161058288388371818055167768185818","49227386935171335489891213330181377906","103205286187433486772428730165815549953"],"threshold":0.9},"id":"CVE-2022-49999-a18f48a0","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/ctree.h"}},{"deprecated":false,"digest":{"function_hash":"129415534765699479956485492169455377612","length":363},"id":"CVE-2022-49999-a321634e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/extent-tree.c","function":"btrfs_pin_extent_for_log_replay"}},{"deprecated":false,"digest":{"function_hash":"227836436162788758027425010833627089184","length":174},"id":"CVE-2022-49999-a7f9de1e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/block-group.c","function":"space_cache_v1_done"}},{"deprecated":false,"digest":{"function_hash":"142460969238983418134784354762240656203","length":1564},"id":"CVE-2022-49999-a9fe8582","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/extent-tree.c","function":"btrfs_trim_fs"}},{"deprecated":false,"digest":{"line_hashes":["290907258235401718923500602803928173714","288915128920615355842303634341738467117","127459524321229119238087214578577056102","328716432242649750431710627921419803674","316348269549672022533599458005323777817","293877116677000808454268798738459774638","12069137623470395674927265850506406493","299826184930066349386250379109236689423","265492134085653590873789269080412594392","121148317989907872721905087275203127554","196131039743162190289220782624426123251","49138519021087407683182211456386367040","232724015829606203034267462061900876601","20715203196721252059281985134060202193","244270585351686465317150140358259269474","279204308540820749806022775341674370347","155324541164290874812005011080493442430","270619429989400745304677377768687029332","231358228023166890358941981734432961626","188867562897169521822115234066185123294","320351838112604210024302481669636873895","135757563915096071107490066443028110878","316061625233026491507508640903153972658","102799732039694890997443974308259911889","257572393749620406828683020973460839045","56357600843078978088820468056004545899","101184436433708325555063281833912238865","93512927153945069708773359791713108751","193084477229603494784118511430472314720","117166629227922531125877719266712815178","30536600216990495953166093666144554989","333016856692278374007384808015436542885","113395355667634568410275596454293369722","199989444521751159636998618346257235945","55273146663216805141802797412127034684","89395032219222136317371615985718056968","161116058246080062535802889174746512064","186160688525880135375146219970614706829","119808467010705292470006695096319332995","259156337963067545182483330880640979012","292391831558099193063025921595305839907","255702211177890622581852570176111644906","161491179633992101893247324881492213394","131106859531995003035328940626032747353","74848309333528858080795708617478643374","213460344505502867072749719270241885081","250892235979759420007353099882343744422","106579762740815169702775886674958750812","66199848712951646872918147052059541858","312647550305337246160638020131556114124","191210083444379847894071275682405206890"],"threshold":0.9},"id":"CVE-2022-49999-b4cf4526","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/block-group.c"}},{"deprecated":false,"digest":{"function_hash":"129415534765699479956485492169455377612","length":363},"id":"CVE-2022-49999-c26ba01e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/extent-tree.c","function":"btrfs_pin_extent_for_log_replay"}},{"deprecated":false,"digest":{"function_hash":"318529625515289045202525592031269017370","length":2070},"id":"CVE-2022-49999-c2dc9576","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_update_block_group"}},{"deprecated":false,"digest":{"function_hash":"162814797138948828404448014456827399749","length":1283},"id":"CVE-2022-49999-cf30703e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_cache_block_group"}},{"deprecated":false,"digest":{"function_hash":"198372502871398156047983677049874641659","length":102},"id":"CVE-2022-49999-d1bae348","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_wait_space_cache_v1_finished"}},{"deprecated":false,"digest":{"line_hashes":["155123625366276526624436533375831942335","46106215621998206544980243579622054539","100086482586881327243786151495761472403","222177227300496175168467062626538221773","155362336930551269377027995850236451280","231493025287621535991146114177104407235"],"threshold":0.9},"id":"CVE-2022-49999-d8018496","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/block-group.h"}},{"deprecated":false,"digest":{"line_hashes":["312448290253527222988718145206611320600","58959170561268465319111943638196870131","243390251233205987429798399812205739094","256508063766543634882536653612679478151","85196719570340410194534915750618434252","339092124622972174773170983582367258467","10207133191480636039733843277035745202","299910617383310943313714671855673516348","251331490848351049357872004587207309422","195616233429871976983369701947699270014","190909876590788463691245579799327602070","333442514984537007638483732889595807777","27186742683003879043392047511741944846","65104799077304498579216209487780359486","119541807870757693261003068415481770353","92194779980529558539350076932608184794","121318426447199310025972867235336378863","180595486924508757621376039742857450559","255935210168074752332533781678708587846","321629603726001335545982187748629244948","335609443416814740726699418274033094571","338382989024818235392898083159579678665","134816365958422310452812130285613389004","277317516365515867402682080113787611349"],"threshold":0.9},"id":"CVE-2022-49999-dee27d92","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@92dc4c1a8e58bcc7a183a4c86b055c24cc88d967","target":{"file":"fs/btrfs/extent-tree.c"}},{"deprecated":false,"digest":{"function_hash":"302126754594868553927250777472207788233","length":312},"id":"CVE-2022-49999-df2c873f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/extent-tree.c","function":"__exclude_logged_extent"}},{"deprecated":false,"digest":{"line_hashes":["197961697258745493898882575577969370210","204628161058288388371818055167768185818","49227386935171335489891213330181377906","103205286187433486772428730165815549953"],"threshold":0.9},"id":"CVE-2022-49999-e53ce39e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/ctree.h"}},{"deprecated":false,"digest":{"function_hash":"198372502871398156047983677049874641659","length":102},"id":"CVE-2022-49999-e6004d7e","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_wait_space_cache_v1_finished"}},{"deprecated":false,"digest":{"function_hash":"97610243383541257923726676786747637609","length":2165},"id":"CVE-2022-49999-f30fb5e5","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a2e54eb64229f07f917b05d0c323604fda9b89f7","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_update_block_group"}},{"deprecated":false,"digest":{"function_hash":"326627177030440135098545499632468034134","length":306},"id":"CVE-2022-49999-f467aa72","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@ced8ecf026fd8084cf175530ff85c76d6085d715","target":{"file":"fs/btrfs/block-group.c","function":"btrfs_wait_block_group_cache_done"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.12.0"},{"fixed":"5.15.65"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"5.19.6"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-49999.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/92dc4c1a8e58bcc7a183a4c86b055c24cc88d967"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a2e54eb64229f07f917b05d0c323604fda9b89f7"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ced8ecf026fd8084cf175530ff85c76d6085d715"}]}