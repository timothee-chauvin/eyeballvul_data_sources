{"schema_version":"1.7.3","id":"CVE-2025-22074","published":"2025-04-16T14:12:25Z","modified":"2025-10-22T11:12:08.743255Z","related":["MGASA-2025-0142","MGASA-2025-0146"],"summary":"ksmbd: fix r_count dec/increment mismatch","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nksmbd: fix r_count dec/increment mismatch\n\nr_count is only increased when there is an oplock break wait,\nso r_count inc/decrement are not paired. This can cause r_count\nto become negative, which can lead to a problem where the ksmbd\nthread does not terminate.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"09aeab68033161cb54f194da93e51a11aee6144b"},{"fixed":"4790bcb269e5d6d88200a67c54ae6d627332a3be"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"a4261bbc33fbf99b99c80aa3a2c5097611802980"},{"fixed":"457db486203c90e10c3efc87fd45cc7000b1cd36"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f17d1c63a76b0fe8e9c78023a86507a3a6d62cfa"},{"fixed":"20378cf48359f39dee0ef9b61470ebe77bd49c0d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3aa660c059240e0c795217182cf7df32909dd917"},{"fixed":"c2ec33d46b4d1c8085dab5d02e00b21f4f0fb8a9"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"3aa660c059240e0c795217182cf7df32909dd917"},{"fixed":"ddb7ea36ba7129c2ed107e2186591128618864e1"}]}],"versions":["v6.12.20","v6.12.21","v6.12.22","v6.13.10","v6.13.8","v6.13.9","v6.14","v6.14-rc7","v6.14.1","v6.6.84","v6.6.85","v6.6.86"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22074.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.6.87"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.23"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.13.11"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.14.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22074.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/20378cf48359f39dee0ef9b61470ebe77bd49c0d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/457db486203c90e10c3efc87fd45cc7000b1cd36"},{"type":"WEB","url":"https://git.kernel.org/stable/c/4790bcb269e5d6d88200a67c54ae6d627332a3be"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c2ec33d46b4d1c8085dab5d02e00b21f4f0fb8a9"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ddb7ea36ba7129c2ed107e2186591128618864e1"}]}