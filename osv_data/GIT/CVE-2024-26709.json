{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26709.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "276912185917144501836023899936871822654",
                "195278543701619752555149941691276080889",
                "33773823572186211505390720369907995424",
                "242642143329444624887050976702271277176",
                "322694615472289139151073442676712171275"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26709-2317a683",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0846dd77c8349ec92ca0079c9c71d130f34cb192",
            "target": {
              "file": "arch/powerpc/kernel/iommu.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "278099343863181281362819944450932843747",
              "length": 323.0
            },
            "id": "CVE-2024-26709-8e5d84a7",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@0846dd77c8349ec92ca0079c9c71d130f34cb192",
            "target": {
              "file": "arch/powerpc/kernel/iommu.c",
              "function": "spapr_tce_platform_iommu_attach_dev"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "278099343863181281362819944450932843747",
              "length": 323.0
            },
            "id": "CVE-2024-26709-983169a8",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c90fdea9cac9eb419fc266e75d625cb60c8f7f6c",
            "target": {
              "file": "arch/powerpc/kernel/iommu.c",
              "function": "spapr_tce_platform_iommu_attach_dev"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "276912185917144501836023899936871822654",
                "195278543701619752555149941691276080889",
                "33773823572186211505390720369907995424",
                "242642143329444624887050976702271277176",
                "322694615472289139151073442676712171275"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-26709-fc6c1cdf",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c90fdea9cac9eb419fc266e75d625cb60c8f7f6c",
            "target": {
              "file": "arch/powerpc/kernel/iommu.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "a8ca9fc9134c1a43e6d4db7ff59496bbd7075def"
            },
            {
              "fixed": "c90fdea9cac9eb419fc266e75d625cb60c8f7f6c"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "a8ca9fc9134c1a43e6d4db7ff59496bbd7075def"
            },
            {
              "fixed": "0846dd77c8349ec92ca0079c9c71d130f34cb192"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.6",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.7.1",
        "v6.7.2",
        "v6.7.3",
        "v6.7.4",
        "v6.7.5",
        "v6.8-rc1",
        "v6.8-rc2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-26709.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.7.6"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/iommu: Fix the missing iommu_group_put() during platform domain attach\n\nThe function spapr_tce_platform_iommu_attach_dev() is missing to call\niommu_group_put() when the domain is already set. This refcount leak\nshows up with BUG_ON() during DLPAR remove operation as:\n\n  KernelBug: Kernel bug in state 'None': kernel BUG at arch/powerpc/platforms/pseries/iommu.c:100!\n  Oops: Exception in kernel mode, sig: 5 [#1]\n  LE PAGE_SIZE=64K MMU=Radix SMP NR_CPUS=8192 NUMA pSeries\n  <snip>\n  Hardware name: IBM,9080-HEX POWER10 (raw) 0x800200 0xf000006 of:IBM,FW1060.00 (NH1060_016) hv:phyp pSeries\n  NIP:  c0000000000ff4d4 LR: c0000000000ff4cc CTR: 0000000000000000\n  REGS: c0000013aed5f840 TRAP: 0700   Tainted: G          I         (6.8.0-rc3-autotest-g99bd3cb0d12e)\n  MSR:  8000000000029033 <SF,EE,ME,IR,DR,RI,LE>  CR: 44002402  XER: 20040000\n  CFAR: c000000000a0d170 IRQMASK: 0\n  ...\n  NIP iommu_reconfig_notifier+0x94/0x200\n  LR  iommu_reconfig_notifier+0x8c/0x200\n  Call Trace:\n    iommu_reconfig_notifier+0x8c/0x200 (unreliable)\n    notifier_call_chain+0xb8/0x19c\n    blocking_notifier_call_chain+0x64/0x98\n    of_reconfig_notify+0x44/0xdc\n    of_detach_node+0x78/0xb0\n    ofdt_write.part.0+0x86c/0xbb8\n    proc_reg_write+0xf4/0x150\n    vfs_write+0xf8/0x488\n    ksys_write+0x84/0x140\n    system_call_exception+0x138/0x330\n    system_call_vectored_common+0x15c/0x2ec\n\nThe patch adds the missing iommu_group_put() call.",
  "id": "CVE-2024-26709",
  "modified": "2025-10-15T07:58:10.200841Z",
  "published": "2024-04-03T14:55:11Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0846dd77c8349ec92ca0079c9c71d130f34cb192"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c90fdea9cac9eb419fc266e75d625cb60c8f7f6c"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "powerpc/iommu: Fix the missing iommu_group_put() during platform domain attach"
}