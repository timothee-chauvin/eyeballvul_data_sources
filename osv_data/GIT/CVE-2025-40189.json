{"schema_version":"1.7.3","id":"CVE-2025-40189","published":"2025-11-12T21:56:30Z","modified":"2025-11-13T03:11:02.724499Z","summary":"net: usb: lan78xx: Fix lost EEPROM read timeout error(-ETIMEDOUT) in lan78xx_read_raw_eeprom","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnet: usb: lan78xx: Fix lost EEPROM read timeout error(-ETIMEDOUT) in lan78xx_read_raw_eeprom\n\nSyzbot reported read of uninitialized variable BUG with following call stack.\n\nlan78xx 8-1:1.0 (unnamed net_device) (uninitialized): EEPROM read operation timeout\n=====================================================\nBUG: KMSAN: uninit-value in lan78xx_read_eeprom drivers/net/usb/lan78xx.c:1095 [inline]\nBUG: KMSAN: uninit-value in lan78xx_init_mac_address drivers/net/usb/lan78xx.c:1937 [inline]\nBUG: KMSAN: uninit-value in lan78xx_reset+0x999/0x2cd0 drivers/net/usb/lan78xx.c:3241\n lan78xx_read_eeprom drivers/net/usb/lan78xx.c:1095 [inline]\n lan78xx_init_mac_address drivers/net/usb/lan78xx.c:1937 [inline]\n lan78xx_reset+0x999/0x2cd0 drivers/net/usb/lan78xx.c:3241\n lan78xx_bind+0x711/0x1690 drivers/net/usb/lan78xx.c:3766\n lan78xx_probe+0x225c/0x3310 drivers/net/usb/lan78xx.c:4707\n\nLocal variable sig.i.i created at:\n lan78xx_read_eeprom drivers/net/usb/lan78xx.c:1092 [inline]\n lan78xx_init_mac_address drivers/net/usb/lan78xx.c:1937 [inline]\n lan78xx_reset+0x77e/0x2cd0 drivers/net/usb/lan78xx.c:3241\n lan78xx_bind+0x711/0x1690 drivers/net/usb/lan78xx.c:3766\n\nThe function lan78xx_read_raw_eeprom failed to properly propagate EEPROM\nread timeout errors (-ETIMEDOUT). In the fallthrough path, it first\nattempted to restore the pin configuration for LED outputs and then\nreturned only the status of that restore operation, discarding the\noriginal timeout error.\n\nAs a result, callers could mistakenly treat the data buffer as valid\neven though the EEPROM read had actually timed out with no data or partial\ndata.\n\nTo fix this, handle errors in restoring the LED pin configuration separately.\nIf the restore succeeds, return any prior EEPROM timeout error correctly\nto the caller.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8b1b2ca83b200fa46fdfb81e80ad5fe34537e6d4"},{"fixed":"a72a7c4f675080a324d4c2167bd2314d968279f1"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"8b1b2ca83b200fa46fdfb81e80ad5fe34537e6d4"},{"fixed":"49bdb63ff64469a6de8ea901aef123c75be9bbe7"}]}],"versions":["v6.13","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.15","v6.15-rc1","v6.15-rc2","v6.15-rc3","v6.15-rc4","v6.15-rc5","v6.15-rc6","v6.15-rc7","v6.16","v6.16-rc1","v6.16-rc2","v6.16-rc3","v6.16-rc4","v6.16-rc5","v6.16-rc6","v6.16-rc7","v6.17","v6.17-rc1","v6.17-rc2","v6.17-rc3","v6.17-rc4","v6.17-rc5","v6.17-rc6","v6.17-rc7","v6.17.1","v6.17.2","v6.17.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40189.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"181668809237692264891164326996655041466","length":1041},"id":"CVE-2025-40189-33591b3d","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@49bdb63ff64469a6de8ea901aef123c75be9bbe7","target":{"file":"drivers/net/usb/lan78xx.c","function":"lan78xx_read_raw_eeprom"}},{"deprecated":false,"digest":{"line_hashes":["86363083932509703151196780981161762581","323782541957464913372034886937035714624","287374451548925543544275306505578201213","257218631217115732214132126143527653873","111105591477393120895394714009783695570","327590103585110992361081988932912304842"],"threshold":0.9},"id":"CVE-2025-40189-77be466e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a72a7c4f675080a324d4c2167bd2314d968279f1","target":{"file":"drivers/net/usb/lan78xx.c"}},{"deprecated":false,"digest":{"line_hashes":["86363083932509703151196780981161762581","323782541957464913372034886937035714624","287374451548925543544275306505578201213","257218631217115732214132126143527653873","111105591477393120895394714009783695570","327590103585110992361081988932912304842"],"threshold":0.9},"id":"CVE-2025-40189-8f560096","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@49bdb63ff64469a6de8ea901aef123c75be9bbe7","target":{"file":"drivers/net/usb/lan78xx.c"}},{"deprecated":false,"digest":{"function_hash":"181668809237692264891164326996655041466","length":1041},"id":"CVE-2025-40189-a0b7bfae","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@a72a7c4f675080a324d4c2167bd2314d968279f1","target":{"file":"drivers/net/usb/lan78xx.c","function":"lan78xx_read_raw_eeprom"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.14.0"},{"fixed":"6.17.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40189.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/49bdb63ff64469a6de8ea901aef123c75be9bbe7"},{"type":"WEB","url":"https://git.kernel.org/stable/c/a72a7c4f675080a324d4c2167bd2314d968279f1"}]}