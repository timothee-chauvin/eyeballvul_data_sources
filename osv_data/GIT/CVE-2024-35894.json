{"schema_version":"1.7.3","id":"CVE-2024-35894","published":"2024-05-19T08:34:49Z","modified":"2025-10-21T21:29:07.029911Z","summary":"mptcp: prevent BPF accessing lowat from a subflow socket.","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: prevent BPF accessing lowat from a subflow socket.\n\nAlexei reported the following splat:\n\n WARNING: CPU: 32 PID: 3276 at net/mptcp/subflow.c:1430 subflow_data_ready+0x147/0x1c0\n Modules linked in: dummy bpf_testmod(O) [last unloaded: bpf_test_no_cfi(O)]\n CPU: 32 PID: 3276 Comm: test_progs Tainted: GO       6.8.0-12873-g2c43c33bfd23\n Call Trace:\n  <TASK>\n  mptcp_set_rcvlowat+0x79/0x1d0\n  sk_setsockopt+0x6c0/0x1540\n  __bpf_setsockopt+0x6f/0x90\n  bpf_sock_ops_setsockopt+0x3c/0x90\n  bpf_prog_509ce5db2c7f9981_bpf_test_sockopt_int+0xb4/0x11b\n  bpf_prog_dce07e362d941d2b_bpf_test_socket_sockopt+0x12b/0x132\n  bpf_prog_348c9b5faaf10092_skops_sockopt+0x954/0xe86\n  __cgroup_bpf_run_filter_sock_ops+0xbc/0x250\n  tcp_connect+0x879/0x1160\n  tcp_v6_connect+0x50c/0x870\n  mptcp_connect+0x129/0x280\n  __inet_stream_connect+0xce/0x370\n  inet_stream_connect+0x36/0x50\n  bpf_trampoline_6442491565+0x49/0xef\n  inet_stream_connect+0x5/0x50\n  __sys_connect+0x63/0x90\n  __x64_sys_connect+0x14/0x20\n\nThe root cause of the issue is that bpf allows accessing mptcp-level\nproto_ops from a tcp subflow scope.\n\nFix the issue detecting the problematic call and preventing any action.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"124a4885b55f3039c697feb53edc5ad88bf21161"},{"fixed":"ee3c845787b621cfe82c2e52c513024a9d7a78f5"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5684ab1a0effbfeb706f47d85785f653005b97b1"},{"fixed":"3ffb1ab698376f09cc33101c07c1be229389fe29"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"5684ab1a0effbfeb706f47d85785f653005b97b1"},{"fixed":"fcf4692fa39e86a590c14a4af2de704e1d20a3b5"}]}],"versions":["v6.6","v6.6-rc7","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.8.1","v6.8.2","v6.8.3","v6.8.4","v6.9-rc1"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35894.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.8.5"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-35894.json"}}],"references":[{"type":"ADVISORY","url":"https://security.netapp.com/advisory/ntap-20250321-0002/"},{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3ffb1ab698376f09cc33101c07c1be229389fe29"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ee3c845787b621cfe82c2e52c513024a9d7a78f5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/fcf4692fa39e86a590c14a4af2de704e1d20a3b5"}]}