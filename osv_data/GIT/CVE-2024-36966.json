{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-36966.json",
        "vanir_signatures": [
          {
            "deprecated": false,
            "digest": {
              "function_hash": "23708952962092179376324341803368497945",
              "length": 370.0
            },
            "id": "CVE-2024-36966-58c1763c",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7af2ae1b1531feab5d38ec9c8f472dc6cceb4606",
            "target": {
              "file": "fs/erofs/super.c",
              "function": "erofs_kill_sb"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "function_hash": "23708952962092179376324341803368497945",
              "length": 370.0
            },
            "id": "CVE-2024-36966-96549fca",
            "signature_type": "Function",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f9b877a7ee312ec8ce17598a7ef85cb820d7c371",
            "target": {
              "file": "fs/erofs/super.c",
              "function": "erofs_kill_sb"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "33446765441053605166874070845872740089",
                "35163136198852552349100189646274777581",
                "25765696499212903717998095644356119600",
                "156531841808446450355224787653337743789",
                "320064449528929427484989411592759524626",
                "334373505251339868005639578359034105509",
                "83016369573164065758139801585438818323",
                "162748141031782093729180899615270387131",
                "114692075166010113441664737956863055341",
                "135207685588290264965207569022102748640",
                "307055425198658619684858451096028203880"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-36966-b1b21868",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@f9b877a7ee312ec8ce17598a7ef85cb820d7c371",
            "target": {
              "file": "fs/erofs/super.c"
            }
          },
          {
            "deprecated": false,
            "digest": {
              "line_hashes": [
                "33446765441053605166874070845872740089",
                "35163136198852552349100189646274777581",
                "25765696499212903717998095644356119600",
                "156531841808446450355224787653337743789",
                "320064449528929427484989411592759524626",
                "334373505251339868005639578359034105509",
                "83016369573164065758139801585438818323",
                "162748141031782093729180899615270387131",
                "114692075166010113441664737956863055341",
                "135207685588290264965207569022102748640",
                "307055425198658619684858451096028203880"
              ],
              "threshold": 0.9
            },
            "id": "CVE-2024-36966-b5d7c09c",
            "signature_type": "Line",
            "signature_version": "v1",
            "source": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@7af2ae1b1531feab5d38ec9c8f472dc6cceb4606",
            "target": {
              "file": "fs/erofs/super.c"
            }
          }
        ]
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "aca740cecbe57b12bd9c1fc632092af5ebacda0c"
            },
            {
              "fixed": "f9b877a7ee312ec8ce17598a7ef85cb820d7c371"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "aca740cecbe57b12bd9c1fc632092af5ebacda0c"
            },
            {
              "fixed": "dcdd49701e429c55b3644fd70fc58d85745f8cfe"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        },
        {
          "events": [
            {
              "introduced": "aca740cecbe57b12bd9c1fc632092af5ebacda0c"
            },
            {
              "fixed": "7af2ae1b1531feab5d38ec9c8f472dc6cceb4606"
            }
          ],
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "type": "GIT"
        }
      ],
      "versions": [
        "v6.5",
        "v6.5-rc2",
        "v6.5-rc3",
        "v6.5-rc4",
        "v6.5-rc5",
        "v6.5-rc6",
        "v6.5-rc7",
        "v6.6",
        "v6.6-rc1",
        "v6.6-rc2",
        "v6.6-rc3",
        "v6.6-rc4",
        "v6.6-rc5",
        "v6.6-rc6",
        "v6.6-rc7",
        "v6.6.1",
        "v6.6.10",
        "v6.6.11",
        "v6.6.12",
        "v6.6.13",
        "v6.6.14",
        "v6.6.15",
        "v6.6.16",
        "v6.6.17",
        "v6.6.18",
        "v6.6.19",
        "v6.6.2",
        "v6.6.20",
        "v6.6.21",
        "v6.6.22",
        "v6.6.23",
        "v6.6.24",
        "v6.6.25",
        "v6.6.26",
        "v6.6.27",
        "v6.6.28",
        "v6.6.29",
        "v6.6.3",
        "v6.6.30",
        "v6.6.31",
        "v6.6.4",
        "v6.6.5",
        "v6.6.6",
        "v6.6.7",
        "v6.6.8",
        "v6.6.9",
        "v6.7",
        "v6.7-rc1",
        "v6.7-rc2",
        "v6.7-rc3",
        "v6.7-rc4",
        "v6.7-rc5",
        "v6.7-rc6",
        "v6.7-rc7",
        "v6.7-rc8",
        "v6.8",
        "v6.8-rc1",
        "v6.8-rc2",
        "v6.8-rc3",
        "v6.8-rc4",
        "v6.8-rc5",
        "v6.8-rc6",
        "v6.8-rc7",
        "v6.8.1",
        "v6.8.10",
        "v6.8.2",
        "v6.8.3",
        "v6.8.4",
        "v6.8.5",
        "v6.8.6",
        "v6.8.7",
        "v6.8.8",
        "v6.8.9",
        "v6.9-rc1",
        "v6.9-rc2",
        "v6.9-rc3",
        "v6.9-rc4",
        "v6.9-rc5"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2024-36966.json"
      },
      "package": {
        "ecosystem": "Linux",
        "name": "Kernel"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "6.6.0"
            },
            {
              "fixed": "6.6.32"
            }
          ],
          "type": "ECOSYSTEM"
        },
        {
          "events": [
            {
              "introduced": "6.7.0"
            },
            {
              "fixed": "6.8.11"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: reliably distinguish block based and fscache mode\n\nWhen erofs_kill_sb() is called in block dev based mode, s_bdev may not\nhave been initialised yet, and if CONFIG_EROFS_FS_ONDEMAND is enabled,\nit will be mistaken for fscache mode, and then attempt to free an anon_dev\nthat has never been allocated, triggering the following warning:\n\n============================================\nida_free called for id=0 which is not allocated.\nWARNING: CPU: 14 PID: 926 at lib/idr.c:525 ida_free+0x134/0x140\nModules linked in:\nCPU: 14 PID: 926 Comm: mount Not tainted 6.9.0-rc3-dirty #630\nRIP: 0010:ida_free+0x134/0x140\nCall Trace:\n <TASK>\n erofs_kill_sb+0x81/0x90\n deactivate_locked_super+0x35/0x80\n get_tree_bdev+0x136/0x1e0\n vfs_get_tree+0x2c/0xf0\n do_new_mount+0x190/0x2f0\n [...]\n============================================\n\nNow when erofs_kill_sb() is called, erofs_sb_info must have been\ninitialised, so use sbi->fsid to distinguish between the two modes.",
  "id": "CVE-2024-36966",
  "modified": "2025-10-15T11:31:44.613769Z",
  "published": "2024-06-08T12:52:59Z",
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/7af2ae1b1531feab5d38ec9c8f472dc6cceb4606"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/dcdd49701e429c55b3644fd70fc58d85745f8cfe"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f9b877a7ee312ec8ce17598a7ef85cb820d7c371"
    }
  ],
  "related": [
    "MGASA-2024-0263",
    "MGASA-2024-0266"
  ],
  "schema_version": "1.7.3",
  "summary": "erofs: reliably distinguish block based and fscache mode"
}