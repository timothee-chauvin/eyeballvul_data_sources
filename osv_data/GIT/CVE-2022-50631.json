{"schema_version":"1.7.3","id":"CVE-2022-50631","published":"2025-12-08T23:59:57.228Z","modified":"2025-12-09T03:14:12.080373Z","summary":"RISC-V: kexec: Fix memory leak of fdt buffer","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nRISC-V: kexec: Fix memory leak of fdt buffer\n\nThis is reported by kmemleak detector:\n\nunreferenced object 0xff60000082864000 (size 9588):\n  comm \"kexec\", pid 146, jiffies 4294900634 (age 64.788s)\n  hex dump (first 32 bytes):\n    d0 0d fe ed 00 00 12 ed 00 00 00 48 00 00 11 40  ...........H...@\n    00 00 00 28 00 00 00 11 00 00 00 02 00 00 00 00  ...(............\n  backtrace:\n    [<00000000f95b17c4>] kmemleak_alloc+0x34/0x3e\n    [<00000000b9ec8e3e>] kmalloc_order+0x9c/0xc4\n    [<00000000a95cf02e>] kmalloc_order_trace+0x34/0xb6\n    [<00000000f01e68b4>] __kmalloc+0x5c2/0x62a\n    [<000000002bd497b2>] kvmalloc_node+0x66/0xd6\n    [<00000000906542fa>] of_kexec_alloc_and_setup_fdt+0xa6/0x6ea\n    [<00000000e1166bde>] elf_kexec_load+0x206/0x4ec\n    [<0000000036548e09>] kexec_image_load_default+0x40/0x4c\n    [<0000000079fbe1b4>] sys_kexec_file_load+0x1c4/0x322\n    [<0000000040c62c03>] ret_from_syscall+0x0/0x2\n\nIn elf_kexec_load(), a buffer is allocated via kvmalloc() to store fdt.\nWhile it's not freed back to system when kexec kernel is reloaded or\nunloaded.  Then memory leak is caused.  Fix it by introducing riscv\nspecific function arch_kimage_file_post_load_cleanup(), and freeing the\nbuffer there.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"6261586e0c91db14c34f894f4bc48f2300cff1d4"},{"fixed":"c66ad198b6497dee8f45d7ed5c03629c4525c7d0"},{"fixed":"dc387c34d8dd10b02a333df098f8fd9bba177a45"},{"fixed":"96df59b1ae23f5c11698c3c2159aeb2ecd4944a4"}]}],"versions":["v5.18","v5.18-rc2","v5.18-rc3","v5.18-rc4","v5.18-rc5","v5.18-rc6","v5.18-rc7","v5.19","v5.19-rc1","v5.19-rc2","v5.19-rc3","v5.19-rc4","v5.19-rc5","v5.19-rc6","v5.19-rc7","v5.19-rc8","v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.0.1","v6.0.10","v6.0.11","v6.0.12","v6.0.13","v6.0.14","v6.0.15","v6.0.16","v6.0.17","v6.0.2","v6.0.3","v6.0.4","v6.0.5","v6.0.6","v6.0.7","v6.0.8","v6.0.9","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1","v6.1.2","v6.1.3"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50631.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.19.0"},{"fixed":"6.0.18"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.1.0"},{"fixed":"6.1.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-50631.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/96df59b1ae23f5c11698c3c2159aeb2ecd4944a4"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c66ad198b6497dee8f45d7ed5c03629c4525c7d0"},{"type":"WEB","url":"https://git.kernel.org/stable/c/dc387c34d8dd10b02a333df098f8fd9bba177a45"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50631.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-50631"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/50xxx/CVE-2022-50631.json"}}