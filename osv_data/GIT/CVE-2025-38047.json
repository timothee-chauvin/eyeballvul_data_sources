{"schema_version":"1.7.3","id":"CVE-2025-38047","published":"2025-06-18T09:33:30Z","modified":"2025-10-22T12:02:32.619863Z","related":["SUSE-SU-2025:02853-1"],"summary":"x86/fred: Fix system hang during S4 resume with FRED enabled","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nx86/fred: Fix system hang during S4 resume with FRED enabled\n\nUpon a wakeup from S4, the restore kernel starts and initializes the\nFRED MSRs as needed from its perspective.  It then loads a hibernation\nimage, including the image kernel, and attempts to load image pages\ndirectly into their original page frames used before hibernation unless\nthose frames are currently in use.  Once all pages are moved to their\noriginal locations, it jumps to a \"trampoline\" page in the image kernel.\n\nAt this point, the image kernel takes control, but the FRED MSRs still\ncontain values set by the restore kernel, which may differ from those\nset by the image kernel before hibernation.  Therefore, the image kernel\nmust ensure the FRED MSRs have the same values as before hibernation.\nSince these values depend only on the location of the kernel text and\ndata, they can be recomputed from scratch.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ff45746fbf005f96e42bea466698e3fdbf926013"},{"fixed":"c42f740a07eea4807e98d2d8febc549c957a7b49"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ff45746fbf005f96e42bea466698e3fdbf926013"},{"fixed":"e7090fe75a2826363c71ad1fb4e95e58141478df"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"ff45746fbf005f96e42bea466698e3fdbf926013"},{"fixed":"e5f1e8af9c9e151ecd665f6d2e36fb25fec3b110"}]}],"versions":["v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.25","v6.12.26","v6.12.27","v6.12.28","v6.12.29","v6.12.3","v6.12.30","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.14.2","v6.14.3","v6.14.4","v6.14.5","v6.14.6","v6.14.7","v6.14.8","v6.8","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38047.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"88505685834627941786938323080369070342","length":1213},"id":"CVE-2025-38047-61fd5138","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e5f1e8af9c9e151ecd665f6d2e36fb25fec3b110","target":{"file":"arch/x86/power/cpu.c","function":"__restore_processor_state"}},{"deprecated":false,"digest":{"line_hashes":["288560035662289484122934072837756905245","31100415468828247971708006668270302684","15672690938154744285685666534382990507","181536417524592210412504301606428081964","233137973711070950186176896553353918678","207189465818982051776686548107053239441","176405597314878428073069191796432377712","118510544967642253075472365623839614873"],"threshold":0.9},"id":"CVE-2025-38047-a29ef683","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e5f1e8af9c9e151ecd665f6d2e36fb25fec3b110","target":{"file":"arch/x86/power/cpu.c"}},{"deprecated":false,"digest":{"line_hashes":["288560035662289484122934072837756905245","31100415468828247971708006668270302684","15672690938154744285685666534382990507","181536417524592210412504301606428081964","233137973711070950186176896553353918678","207189465818982051776686548107053239441","176405597314878428073069191796432377712","118510544967642253075472365623839614873"],"threshold":0.9},"id":"CVE-2025-38047-b2ab3255","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e7090fe75a2826363c71ad1fb4e95e58141478df","target":{"file":"arch/x86/power/cpu.c"}},{"deprecated":false,"digest":{"function_hash":"88505685834627941786938323080369070342","length":1213},"id":"CVE-2025-38047-be0a65d7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e7090fe75a2826363c71ad1fb4e95e58141478df","target":{"file":"arch/x86/power/cpu.c","function":"__restore_processor_state"}},{"deprecated":false,"digest":{"line_hashes":["288560035662289484122934072837756905245","31100415468828247971708006668270302684","15672690938154744285685666534382990507","181536417524592210412504301606428081964","233137973711070950186176896553353918678","207189465818982051776686548107053239441","176405597314878428073069191796432377712","118510544967642253075472365623839614873"],"threshold":0.9},"id":"CVE-2025-38047-d1c0f24d","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c42f740a07eea4807e98d2d8febc549c957a7b49","target":{"file":"arch/x86/power/cpu.c"}},{"deprecated":false,"digest":{"function_hash":"88505685834627941786938323080369070342","length":1213},"id":"CVE-2025-38047-feb08e7f","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@c42f740a07eea4807e98d2d8febc549c957a7b49","target":{"file":"arch/x86/power/cpu.c","function":"__restore_processor_state"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.9.0"},{"fixed":"6.12.31"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.14.9"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-38047.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/c42f740a07eea4807e98d2d8febc549c957a7b49"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e5f1e8af9c9e151ecd665f6d2e36fb25fec3b110"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e7090fe75a2826363c71ad1fb4e95e58141478df"}]}