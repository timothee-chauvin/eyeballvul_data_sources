{"schema_version":"1.7.3","id":"CVE-2025-22126","published":"2025-04-16T14:13:09.399Z","modified":"2025-11-20T09:05:15.685373Z","related":["ALSA-2025:9080","SUSE-SU-2025:01919-1","SUSE-SU-2025:01951-1","SUSE-SU-2025:01964-1","SUSE-SU-2025:01965-1","SUSE-SU-2025:01967-1"],"summary":"md: fix mddev uaf while iterating all_mddevs list","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nmd: fix mddev uaf while iterating all_mddevs list\n\nWhile iterating all_mddevs list from md_notify_reboot() and md_exit(),\nlist_for_each_entry_safe is used, and this can race with deletint the\nnext mddev, causing UAF:\n\nt1:\nspin_lock\n//list_for_each_entry_safe(mddev, n, ...)\n mddev_get(mddev1)\n // assume mddev2 is the next entry\n spin_unlock\n            t2:\n            //remove mddev2\n            ...\n            mddev_free\n            spin_lock\n            list_del\n            spin_unlock\n            kfree(mddev2)\n mddev_put(mddev1)\n spin_lock\n //continue dereference mddev2->all_mddevs\n\nThe old helper for_each_mddev() actually grab the reference of mddev2\nwhile holding the lock, to prevent from being freed. This problem can be\nfixed the same way, however, the code will be complex.\n\nHence switch to use list_for_each_entry, in this case mddev_put() can free\nthe mddev1 and it's not safe as well. Refer to md_seq_show(), also factor\nout a helper mddev_put_locked() to fix this problem.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f26514342255855f4ca3c0a92cb1cdea01c33004"},{"fixed":"ca9f84de76723b358dfc0606668efdca54afc2e5"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f26514342255855f4ca3c0a92cb1cdea01c33004"},{"fixed":"d69a23d8e925f8052d657652a6875ec2712c7e33"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f26514342255855f4ca3c0a92cb1cdea01c33004"},{"fixed":"e2a9f73ee408a460f4c9dfe03b4741d6b11652b8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f26514342255855f4ca3c0a92cb1cdea01c33004"},{"fixed":"5462544ccbad3fc938a71b01fa5bd3a0dc2b750a"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"f26514342255855f4ca3c0a92cb1cdea01c33004"},{"fixed":"8542870237c3a48ff049b6c5df5f50c8728284fa"}]}],"versions":["v6.0","v6.0-rc1","v6.0-rc2","v6.0-rc3","v6.0-rc4","v6.0-rc5","v6.0-rc6","v6.0-rc7","v6.1","v6.1-rc1","v6.1-rc2","v6.1-rc3","v6.1-rc4","v6.1-rc5","v6.1-rc6","v6.1-rc7","v6.1-rc8","v6.1.1","v6.1.10","v6.1.100","v6.1.101","v6.1.102","v6.1.103","v6.1.104","v6.1.105","v6.1.106","v6.1.107","v6.1.108","v6.1.109","v6.1.11","v6.1.110","v6.1.111","v6.1.112","v6.1.113","v6.1.114","v6.1.115","v6.1.116","v6.1.117","v6.1.118","v6.1.119","v6.1.12","v6.1.120","v6.1.121","v6.1.122","v6.1.123","v6.1.124","v6.1.125","v6.1.126","v6.1.127","v6.1.128","v6.1.129","v6.1.13","v6.1.130","v6.1.131","v6.1.132","v6.1.133","v6.1.134","v6.1.14","v6.1.15","v6.1.16","v6.1.17","v6.1.18","v6.1.19","v6.1.2","v6.1.20","v6.1.21","v6.1.22","v6.1.23","v6.1.24","v6.1.25","v6.1.26","v6.1.27","v6.1.28","v6.1.29","v6.1.3","v6.1.30","v6.1.31","v6.1.32","v6.1.33","v6.1.34","v6.1.35","v6.1.36","v6.1.37","v6.1.38","v6.1.39","v6.1.4","v6.1.40","v6.1.41","v6.1.42","v6.1.43","v6.1.44","v6.1.45","v6.1.46","v6.1.47","v6.1.48","v6.1.49","v6.1.5","v6.1.50","v6.1.51","v6.1.52","v6.1.53","v6.1.54","v6.1.55","v6.1.56","v6.1.57","v6.1.58","v6.1.59","v6.1.6","v6.1.60","v6.1.61","v6.1.62","v6.1.63","v6.1.64","v6.1.65","v6.1.66","v6.1.67","v6.1.68","v6.1.69","v6.1.7","v6.1.70","v6.1.71","v6.1.72","v6.1.73","v6.1.74","v6.1.75","v6.1.76","v6.1.77","v6.1.78","v6.1.79","v6.1.8","v6.1.80","v6.1.81","v6.1.82","v6.1.83","v6.1.84","v6.1.85","v6.1.86","v6.1.87","v6.1.88","v6.1.89","v6.1.9","v6.1.90","v6.1.91","v6.1.92","v6.1.93","v6.1.94","v6.1.95","v6.1.96","v6.1.97","v6.1.98","v6.1.99","v6.10","v6.10-rc1","v6.10-rc2","v6.10-rc3","v6.10-rc4","v6.10-rc5","v6.10-rc6","v6.10-rc7","v6.11","v6.11-rc1","v6.11-rc2","v6.11-rc3","v6.11-rc4","v6.11-rc5","v6.11-rc6","v6.11-rc7","v6.12","v6.12-rc1","v6.12-rc2","v6.12-rc3","v6.12-rc4","v6.12-rc5","v6.12-rc6","v6.12-rc7","v6.12.1","v6.12.10","v6.12.11","v6.12.12","v6.12.13","v6.12.14","v6.12.15","v6.12.16","v6.12.17","v6.12.18","v6.12.19","v6.12.2","v6.12.20","v6.12.21","v6.12.22","v6.12.23","v6.12.24","v6.12.3","v6.12.4","v6.12.5","v6.12.6","v6.12.7","v6.12.8","v6.12.9","v6.13","v6.13-rc1","v6.13-rc2","v6.13-rc3","v6.13-rc4","v6.13-rc5","v6.13-rc6","v6.13-rc7","v6.14","v6.14-rc1","v6.14-rc2","v6.14-rc3","v6.14-rc4","v6.14-rc5","v6.14-rc6","v6.14-rc7","v6.14.1","v6.2","v6.2-rc1","v6.2-rc2","v6.2-rc3","v6.2-rc4","v6.2-rc5","v6.2-rc6","v6.2-rc7","v6.2-rc8","v6.3","v6.3-rc1","v6.3-rc2","v6.3-rc3","v6.3-rc4","v6.3-rc5","v6.3-rc6","v6.3-rc7","v6.4","v6.4-rc1","v6.4-rc2","v6.4-rc3","v6.4-rc4","v6.4-rc5","v6.4-rc6","v6.4-rc7","v6.5","v6.5-rc1","v6.5-rc2","v6.5-rc3","v6.5-rc4","v6.5-rc5","v6.5-rc6","v6.5-rc7","v6.6","v6.6-rc1","v6.6-rc2","v6.6-rc3","v6.6-rc4","v6.6-rc5","v6.6-rc6","v6.6-rc7","v6.6.1","v6.6.10","v6.6.11","v6.6.12","v6.6.13","v6.6.14","v6.6.15","v6.6.16","v6.6.17","v6.6.18","v6.6.19","v6.6.2","v6.6.20","v6.6.21","v6.6.22","v6.6.23","v6.6.24","v6.6.25","v6.6.26","v6.6.27","v6.6.28","v6.6.29","v6.6.3","v6.6.30","v6.6.31","v6.6.32","v6.6.33","v6.6.34","v6.6.35","v6.6.36","v6.6.37","v6.6.38","v6.6.39","v6.6.4","v6.6.40","v6.6.41","v6.6.42","v6.6.43","v6.6.44","v6.6.45","v6.6.46","v6.6.47","v6.6.48","v6.6.49","v6.6.5","v6.6.50","v6.6.51","v6.6.52","v6.6.53","v6.6.54","v6.6.55","v6.6.56","v6.6.57","v6.6.58","v6.6.59","v6.6.6","v6.6.60","v6.6.61","v6.6.62","v6.6.63","v6.6.64","v6.6.65","v6.6.66","v6.6.67","v6.6.68","v6.6.69","v6.6.7","v6.6.70","v6.6.71","v6.6.72","v6.6.73","v6.6.74","v6.6.75","v6.6.76","v6.6.77","v6.6.78","v6.6.79","v6.6.8","v6.6.80","v6.6.81","v6.6.82","v6.6.83","v6.6.84","v6.6.85","v6.6.86","v6.6.87","v6.6.9","v6.7","v6.7-rc1","v6.7-rc2","v6.7-rc3","v6.7-rc4","v6.7-rc5","v6.7-rc6","v6.7-rc7","v6.7-rc8","v6.8","v6.8-rc1","v6.8-rc2","v6.8-rc3","v6.8-rc4","v6.8-rc5","v6.8-rc6","v6.8-rc7","v6.9","v6.9-rc1","v6.9-rc2","v6.9-rc3","v6.9-rc4","v6.9-rc5","v6.9-rc6","v6.9-rc7"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22126.json","vanir_signatures":[{"deprecated":false,"digest":{"function_hash":"264157903126612595414097695788053416235","length":2441},"id":"CVE-2025-22126-12a0ea76","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d69a23d8e925f8052d657652a6875ec2712c7e33","target":{"file":"drivers/md/md.c","function":"md_seq_show"}},{"deprecated":false,"digest":{"function_hash":"55723492914928537107220945074918493522","length":758},"id":"CVE-2025-22126-16627da4","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8542870237c3a48ff049b6c5df5f50c8728284fa","target":{"file":"drivers/md/md.c","function":"md_exit"}},{"deprecated":false,"digest":{"function_hash":"316307616885469143101256147584417599388","length":2566},"id":"CVE-2025-22126-31d352c7","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5462544ccbad3fc938a71b01fa5bd3a0dc2b750a","target":{"file":"drivers/md/md.c","function":"md_seq_show"}},{"deprecated":false,"digest":{"line_hashes":["256713397592851412776079750380289434619","285498720494039822659612491896496655137","173792649382535274234317251733052314756","267545312880957590423396453379191269494","161669249988971068076668785577849230505","21343687862718971613356098391050723087","177956135307451131269782229117604763157","86408264289078480975134579716169646698","320091254676834219377017077786984434089","18003739451382553205381170977620731815","155182380107132198015488486537196621424","260193866165975703888448662712526243467","114003478532873056316927477700123730023","168468908883183128823531787364526318355","96526952104016288177970768639537976960","299370063714694586327751157242623404215","160579398051676562370913778197276480462","265979324431187106000889656393023270970","286207367550871152928797367836594979014","239076635090400713566084297377896167569","121731483301932803650805949680745028845","187114553035298429778989387409043722063","16235434545623933334265247453265168189","90742407445264672794618129145039622593","184995433841583345458901487580281080600","59526245422044070227046002604897351387","168468908883183128823531787364526318355","96526952104016288177970768639537976960","208691310728849401252413962546749132876","282826268526178555596853571301114935271","104204473339238637296683253852551676430","286207367550871152928797367836594979014","35396238140035067940400327263840927485"],"threshold":0.9},"id":"CVE-2025-22126-3813abdb","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d69a23d8e925f8052d657652a6875ec2712c7e33","target":{"file":"drivers/md/md.c"}},{"deprecated":false,"digest":{"function_hash":"55723492914928537107220945074918493522","length":758},"id":"CVE-2025-22126-3a16c985","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5462544ccbad3fc938a71b01fa5bd3a0dc2b750a","target":{"file":"drivers/md/md.c","function":"md_exit"}},{"deprecated":false,"digest":{"function_hash":"59272461247435734366241647150590864241","length":573},"id":"CVE-2025-22126-3d4ea6f0","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d69a23d8e925f8052d657652a6875ec2712c7e33","target":{"file":"drivers/md/md.c","function":"md_notify_reboot"}},{"deprecated":false,"digest":{"function_hash":"59272461247435734366241647150590864241","length":573},"id":"CVE-2025-22126-4403cbb2","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8542870237c3a48ff049b6c5df5f50c8728284fa","target":{"file":"drivers/md/md.c","function":"md_notify_reboot"}},{"deprecated":false,"digest":{"function_hash":"133301897953135926021263601625240483417","length":2573},"id":"CVE-2025-22126-6ad8adca","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8542870237c3a48ff049b6c5df5f50c8728284fa","target":{"file":"drivers/md/md.c","function":"md_seq_show"}},{"deprecated":false,"digest":{"line_hashes":["256713397592851412776079750380289434619","285498720494039822659612491896496655137","173792649382535274234317251733052314756","267545312880957590423396453379191269494","161669249988971068076668785577849230505","21343687862718971613356098391050723087","177956135307451131269782229117604763157","86408264289078480975134579716169646698","320091254676834219377017077786984434089","18003739451382553205381170977620731815","155182380107132198015488486537196621424","260193866165975703888448662712526243467","114003478532873056316927477700123730023","168468908883183128823531787364526318355","96526952104016288177970768639537976960","299370063714694586327751157242623404215","160579398051676562370913778197276480462","265979324431187106000889656393023270970","286207367550871152928797367836594979014","239076635090400713566084297377896167569","121731483301932803650805949680745028845","187114553035298429778989387409043722063","16235434545623933334265247453265168189","90742407445264672794618129145039622593","184995433841583345458901487580281080600","59526245422044070227046002604897351387","168468908883183128823531787364526318355","96526952104016288177970768639537976960","208691310728849401252413962546749132876","282826268526178555596853571301114935271","104204473339238637296683253852551676430","286207367550871152928797367836594979014","35396238140035067940400327263840927485"],"threshold":0.9},"id":"CVE-2025-22126-8898d62a","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e2a9f73ee408a460f4c9dfe03b4741d6b11652b8","target":{"file":"drivers/md/md.c"}},{"deprecated":false,"digest":{"line_hashes":["256713397592851412776079750380289434619","285498720494039822659612491896496655137","173792649382535274234317251733052314756","267545312880957590423396453379191269494","161669249988971068076668785577849230505","21343687862718971613356098391050723087","177956135307451131269782229117604763157","86408264289078480975134579716169646698","320091254676834219377017077786984434089","18003739451382553205381170977620731815","155182380107132198015488486537196621424","260193866165975703888448662712526243467","114003478532873056316927477700123730023","168468908883183128823531787364526318355","96526952104016288177970768639537976960","299370063714694586327751157242623404215","160579398051676562370913778197276480462","265979324431187106000889656393023270970","286207367550871152928797367836594979014","239076635090400713566084297377896167569","121731483301932803650805949680745028845","187114553035298429778989387409043722063","16235434545623933334265247453265168189","90742407445264672794618129145039622593","184995433841583345458901487580281080600","59526245422044070227046002604897351387","168468908883183128823531787364526318355","96526952104016288177970768639537976960","208691310728849401252413962546749132876","282826268526178555596853571301114935271","104204473339238637296683253852551676430","286207367550871152928797367836594979014","35396238140035067940400327263840927485"],"threshold":0.9},"id":"CVE-2025-22126-8a01ed1e","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@8542870237c3a48ff049b6c5df5f50c8728284fa","target":{"file":"drivers/md/md.c"}},{"deprecated":false,"digest":{"function_hash":"59272461247435734366241647150590864241","length":573},"id":"CVE-2025-22126-93060efa","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5462544ccbad3fc938a71b01fa5bd3a0dc2b750a","target":{"file":"drivers/md/md.c","function":"md_notify_reboot"}},{"deprecated":false,"digest":{"line_hashes":["256713397592851412776079750380289434619","285498720494039822659612491896496655137","173792649382535274234317251733052314756","267545312880957590423396453379191269494","161669249988971068076668785577849230505","21343687862718971613356098391050723087","177956135307451131269782229117604763157","86408264289078480975134579716169646698","320091254676834219377017077786984434089","18003739451382553205381170977620731815","155182380107132198015488486537196621424","260193866165975703888448662712526243467","114003478532873056316927477700123730023","168468908883183128823531787364526318355","96526952104016288177970768639537976960","299370063714694586327751157242623404215","160579398051676562370913778197276480462","265979324431187106000889656393023270970","286207367550871152928797367836594979014","239076635090400713566084297377896167569","121731483301932803650805949680745028845","187114553035298429778989387409043722063","16235434545623933334265247453265168189","90742407445264672794618129145039622593","184995433841583345458901487580281080600","59526245422044070227046002604897351387","168468908883183128823531787364526318355","96526952104016288177970768639537976960","208691310728849401252413962546749132876","282826268526178555596853571301114935271","104204473339238637296683253852551676430","286207367550871152928797367836594979014","35396238140035067940400327263840927485"],"threshold":0.9},"id":"CVE-2025-22126-9c7ef0da","signature_type":"Line","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@5462544ccbad3fc938a71b01fa5bd3a0dc2b750a","target":{"file":"drivers/md/md.c"}},{"deprecated":false,"digest":{"function_hash":"59272461247435734366241647150590864241","length":573},"id":"CVE-2025-22126-ab812916","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e2a9f73ee408a460f4c9dfe03b4741d6b11652b8","target":{"file":"drivers/md/md.c","function":"md_notify_reboot"}},{"deprecated":false,"digest":{"function_hash":"55723492914928537107220945074918493522","length":758},"id":"CVE-2025-22126-e039d196","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e2a9f73ee408a460f4c9dfe03b4741d6b11652b8","target":{"file":"drivers/md/md.c","function":"md_exit"}},{"deprecated":false,"digest":{"function_hash":"55723492914928537107220945074918493522","length":758},"id":"CVE-2025-22126-e05ee740","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@d69a23d8e925f8052d657652a6875ec2712c7e33","target":{"file":"drivers/md/md.c","function":"md_exit"}},{"deprecated":false,"digest":{"function_hash":"316307616885469143101256147584417599388","length":2566},"id":"CVE-2025-22126-e355eb79","signature_type":"Function","signature_version":"v1","source":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git@e2a9f73ee408a460f4c9dfe03b4741d6b11652b8","target":{"file":"drivers/md/md.c","function":"md_seq_show"}}]}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"6.0.0"},{"fixed":"6.1.135"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.88"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.25"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.14.2"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22126.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/5462544ccbad3fc938a71b01fa5bd3a0dc2b750a"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8542870237c3a48ff049b6c5df5f50c8728284fa"},{"type":"WEB","url":"https://git.kernel.org/stable/c/ca9f84de76723b358dfc0606668efdca54afc2e5"},{"type":"WEB","url":"https://git.kernel.org/stable/c/d69a23d8e925f8052d657652a6875ec2712c7e33"},{"type":"WEB","url":"https://git.kernel.org/stable/c/e2a9f73ee408a460f4c9dfe03b4741d6b11652b8"},{"type":"WEB","url":"https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html"}]}