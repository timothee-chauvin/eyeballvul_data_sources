{"schema_version":"1.7.3","id":"CVE-2022-48643","published":"2024-04-28T13:00:03.181Z","modified":"2025-12-04T11:25:14.508163Z","summary":"netfilter: nf_tables: fix nft_counters_enabled underflow at nf_tables_addchain()","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: fix nft_counters_enabled underflow at nf_tables_addchain()\n\nsyzbot is reporting underflow of nft_counters_enabled counter at\nnf_tables_addchain() [1], for commit 43eb8949cfdffa76 (\"netfilter:\nnf_tables: do not leave chain stats enabled on error\") missed that\nnf_tables_chain_destroy() after nft_basechain_init() in the error path of\nnf_tables_addchain() decrements the counter because nft_basechain_init()\nmakes nft_is_base_chain() return true by setting NFT_CHAIN_BASE flag.\n\nIncrement the counter immediately after returning from\nnft_basechain_init().","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"c907dfe4eaca9665694a0340de1458a093abe354"},{"fixed":"710e3f526bd23a0d33435dedc52c3144de284378"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"6d7ddee503951641f3ec6f0e3269446970bbcdab"},{"fixed":"91aa52652f4b37089aff3cb53e83049d826fef6d"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"98a621ef45e3605c7487f7fa6fec7df94697d6a2"},{"fixed":"8bcad2a931313aeba076b76922d5813ef97d0a91"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"43eb8949cfdffa764b92bc6c54b87cbe5b0003fe"},{"fixed":"921ebde3c0d22c8cba74ce8eb3cc4626abff1ccd"}]}],"versions":["v5.10.140","v5.10.141","v5.10.142","v5.10.143","v5.10.144","v5.10.145","v5.15.64","v5.15.65","v5.15.66","v5.15.67","v5.15.68","v5.15.69","v5.15.70","v5.19.10","v5.19.11","v5.19.6","v5.19.7","v5.19.8","v5.19.9","v6.0-rc2","v6.0-rc3","v6.0-rc4"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48643.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.10.140"},{"fixed":"5.10.146"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.15.64"},{"fixed":"5.15.71"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.19.6"},{"fixed":"5.19.12"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2022-48643.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/710e3f526bd23a0d33435dedc52c3144de284378"},{"type":"WEB","url":"https://git.kernel.org/stable/c/8bcad2a931313aeba076b76922d5813ef97d0a91"},{"type":"WEB","url":"https://git.kernel.org/stable/c/91aa52652f4b37089aff3cb53e83049d826fef6d"},{"type":"WEB","url":"https://git.kernel.org/stable/c/921ebde3c0d22c8cba74ce8eb3cc4626abff1ccd"},{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/48xxx/CVE-2022-48643.json"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2022-48643"}],"database_specific":{"cna_assigner":"Linux","osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2022/48xxx/CVE-2022-48643.json"}}